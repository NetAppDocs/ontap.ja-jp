= 
:allow-uri-read: 


Windows を使用する SMB クライアントは、ファイルごとに読み取り専用ビットを設定できます。NFS クライアントでは、ファイルごとに読み取り専用ビットを使用するプロトコル操作がないため、ファイルごとに読み取り専用ビットは設定されません。

ONTAPは、Windowsを使用するSMBクライアントがファイルを作成する際に、そのファイルに読み取り専用ビットを設定できます。ONTAPは、NFSクライアントとSMBクライアント間でファイルを共有する場合にも、読み取り専用ビットを設定できます。NFSクライアントとSMBクライアントで使用される一部のソフトウェアでは、読み取り専用ビットを有効にする必要があります。

ONTAP が NFS クライアントと SMB クライアント間で共有されるファイルに対する適切な読み取りおよび書き込み権限を維持するために、読み取り専用ビットを次のルールに従って処理します：

* NFSは、読み取り専用ビットが有効になっているファイルを、書き込み許可ビットが有効になっていないものとして扱います。
* NFS クライアントがすべての書き込み許可ビットを無効にし、それらのビットの少なくとも 1 つが以前に有効になっていた場合、ONTAP はそのファイルの読み取り専用ビットを有効にします。
* NFS クライアントが書き込み権限ビットを有効にすると、ONTAP はそのファイルの読み取り専用ビットを無効にします。
* ファイルの読み取り専用ビットが有効になっていて、NFS クライアントがファイルの権限を検出しようとすると、ファイルの権限ビットは NFS クライアントに送信されません。代わりに、ONTAP は書き込み権限ビットをマスクした状態で権限ビットを NFS クライアントに送信します。
* ファイルの読み取り専用ビットが有効になっているときに、SMBクライアントがこの読み取り専用ビットを無効にすると、そのファイルに対する所有者の書き込み権限ビットが有効になります。
* 読み取り専用ビットが有効になっているファイルは、root のみが書き込み可能です。


読み取り専用ビットは、ACL および Unix モード ビットと次のように相互作用します：

ファイルに読み取り専用ビットが設定されている場合：

* そのファイルの ACL は変更されません。NFS クライアントには、読み取り専用ビットが設定される前と同じ ACL が表示されます。
* ファイルへの書き込みアクセスを許可する Unix モード ビットはすべて無視されます。
* NFS クライアントと SMB クライアントはどちらもファイルを読み取ることはできますが、変更することはできません。
* ACLとUNIXモードビットは、読み取り専用ビットが優先されるため無視されます。つまり、ACLが書き込みアクセスを許可していても、読み取り専用ビットによって変更は禁止されます。


ファイルに読み取り専用ビットが設定されていない場合：

* ONTAP は、ACL と UNIX モード ビットに基づいてアクセスを決定します。
+
** ACL または UNIX モード ビットのいずれかが書き込みアクセスを拒否した場合、NFS および SMB クライアントはファイルを変更できません。
** ACL も UNIX モード ビットも書き込みアクセスを拒否しない場合は、NFS および SMB クライアントはファイルを変更できます。




[NOTE]
====
ファイル権限の変更は SMB クライアントでは直ちに有効になりますが、NFS クライアントが属性キャッシュを有効にしている場合は、NFS クライアントでは直ちに有効にならない場合があります。

====