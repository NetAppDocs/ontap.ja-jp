---
sidebar: sidebar 
permalink: anti-ransomware/index.html 
keywords: ransomware, security, autonomous protection, arp, detect, detection, threat, attack, suspect, anti-ransomware, entropy, abnormal volume activity, antiransomware, extension conformity, ransomware protection strategy 
summary: ONTAP 9.10.1以降のAutonomous RansProtection（ARP）機能では、NAS（NFSおよびSMB）環境のワークロード分析を使用して、ランサムウェア攻撃を示す可能性のある異常なアクティビティをプロアクティブに検出して警告します。 
---
= Autonomous Ransomware Protection Overview
:toc: macro
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toc: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/
:toc-position: content


[role="lead"]
ONTAP 9.10.1以降のAutonomous RansProtection（ARP）機能では、NAS（NFSおよびSMB）環境のワークロード分析を使用して、ランサムウェア攻撃を示す可能性のある異常なアクティビティをプロアクティブに検出して警告します。

攻撃の疑いがある場合、ARPは、スケジュールされたSnapshotコピーからの既存の保護に加えて、新しいSnapshotコピーも作成します。



== ライセンスとイネーブルメント

ARPにはライセンスが必要ですが、使用しているONTAP のバージョンによって異なります。

[cols="2*"]
|===
| ONTAP リリース | 使用許諾 


 a| 
ONTAP 9.11.1以降
 a| 
anti_Ransomware



 a| 
ONTAP 9.10.1
 a| 
MT_EK_MGMT（マルチテナントキー管理）

|===
* ONTAP 9.11.1以降にアップグレードしていて、ARPがすでにシステムに設定されている場合は、新しいアンチランサムウェアライセンスを購入する必要はありません。新しいARP設定の場合、新しいライセンスが必要です。
* ONTAP 9.11.1以降からONTAP 9.10.1にリバートする際に、ランサムウェア対策ライセンスでARPを有効にしていると、警告メッセージが表示され、ARPの再設定が必要になる場合があります。 link:../revert/anti-ransomware-license-task.html["ARPのリバートについて説明します"]。


ONTAP System ManagerまたはONTAP CLIを使用して、ボリューム単位でARPを設定できます。



== ONTAP ランサムウェア攻撃からの保護戦略

ランサムウェアの効果的な検出戦略には、複数の保護レイヤを含める必要があります。

例えは、車両の安全機能です。シートベルトなどの単一の機能に頼らず、事故時に完全に身を守ることができます。エアバッグ、アンチロックブレーキ、および前方衝突警告はすべて、より良い結果をもたらす追加の安全機能です。ランサムウェア攻撃からの保護は、同様の方法で確認する必要があります。

ONTAP には、ランサムウェアからの保護に役立つFPolicy、Snapshotコピー、SnapLock 、Active IQ デジタルアドバイザなどの機能が含まれていますが、以下では機械学習機能を備えたARP搭載機能に焦点を当てて説明します。

ONTAPのその他のランサムウェア対策機能の詳細については、を参照してください link:https://www.netapp.com/media/7334-tr4572.pdf["TR-4572 ：『 NetApp Solution for Ransomware 』"^]



== ARPが検出するもの

ランサムウェア攻撃には次の 2 種類があります。

* データを暗号化することによる、ファイルへのサービス拒否。
攻撃者は、身代金が支払われない限り、このデータへのアクセスを妨害します。
* 機密専有データの盗難。
攻撃者は、身代金が支払われない限り、このデータをパブリックドメインにリリースする可能性があります。


ARPは最初のタイプに対応し、以下に基づくランサムウェア対策検出メカニズムを使用します。

* 受信データを暗号化データまたはプレーンテキストとして識別する。
* 検出する分析
+
** ** Entropy **：ファイル内のデータのランダム性の評価
** **ファイル拡張子タイプ**：通常の拡張子タイプと一致しない拡張子
** **ファイルIOPS **：データ暗号化による異常なボリュームアクティビティの急増（ONTAP 9.11.1以降）





NOTE: ランサムウェア攻撃の安全性を完全に保証できるランサムウェア検出や防御システムはありません。攻撃が検出されない可能性はありますが、ウィルス対策ソフトウェアが侵入を検出できなかった場合、NetApp ARPは重要な追加防御レイヤとして機能します。ARPは、少数のファイルのみが暗号化された後、ほとんどのランサムウェア攻撃の拡散を検出し、データを保護するためのアクションを自動的に実行し、攻撃の疑いがあることを警告します。



== 学習モードとアクティブモード

ARPには2つのモードがあります。

. 学習中
. アクティブ


ARPをイネーブルにすると、ARPはラーニングモードで実行されます。学習モードでは、ONTAP システムは、前述の分析領域（エントロピー、ファイル拡張子タイプ、ファイルIOPS）に基づいてアラートプロファイルを作成します。ARPをラーニングモードで実行して、ワークロード特性を評価するのに十分な時間が経過したら、アクティブモードに切り替えてデータの保護を開始できます。ARPがアクティブモードに切り替わると、ONTAP はARPスナップショットを作成して、脅威が検出された場合にデータを保護します。

ARPは最低30日間はラーニングモードのままにすることをお勧めしますが、いつでもアクティブモードに切り替えることができます。切り替えが早すぎると、誤検出が多すぎる可能性があります。ONTAP 9.13.1以降では、ARPによって最適な学習期間間隔が自動的に決定され、30日前にスイッチが自動化されます。

アクティブモードで、ファイル拡張子が異常としてフラグされている場合は、アラートを評価する必要があります。アラートに対処してデータを保護したり、アラートを誤検出としてマークしたりできます。false positiveをマークすると、ONTAP はARPアラートプロファイルを更新し、その後ファイル拡張子にフラグが付けられないようにします。コマンド `security anti-ransomware volume workload-behavior show` ボリュームで検出されたファイル拡張子が表示されます。（このコマンドをラーニングモードの早い段階で実行し、ファイルタイプが正確に表現されている場合は、ONTAPが他のメトリックを収集しているため、そのデータをアクティブモードに移行するためのベースとして使用しないでください）。

ONTAP 9.11.1以降では、ARPの検出パラメータをカスタマイズできます。詳細については、を参照してください xref:manage-parameters-task.html[ARP攻撃検出パラメータを管理します。]。



== 脅威の評価とARPスナップショット

アクティブモードでは、ARPは学習した分析に対して測定された受信データに基づいて脅威の確率を評価します。ARPが脅威を検出すると、測定値が割り当てられます。

* **低**：ボリューム内で新しいファイル拡張子が初めて観察されたときに割り当てられます。
* **中程度**:同じファイル拡張子を持つ複数のファイルが観察されます。
+
** ONTAP 9.10.1では、中程度へのエスカレーションのしきい値は100個以上です。ONTAP 9.11.1以降では、ファイル数を変更できます。デフォルト値は20です。




脅威が少ない状況では、ONTAPが異常を検出し、ボリュームのSnapshotを作成して可能な限り最適なリカバリポイントを作成します。ARPスナップショットは、 `anti-ransomware-backup` タグを付け、その名前で識別できます。例： `Anti_ransomware_backup.2022-12-20_1248`。

ONTAPがランサムウェアのプロファイルに異常が一致しているかどうかを判断する分析レポートを実行すると、脅威は「中程度」にエスカレーションされます。低レベルのままの脅威はログに記録され、System Managerの[**イベント*]セクションに表示されますが、ONTAPは低レベルの脅威に関するアラートを送信しません。攻撃の可能性が中程度の場合、ONTAP によってEMS通知が生成され、脅威を評価するように求められます。詳細については、を参照してください xref:respond-abnormal-task.html[異常な活動に対応する。]。

脅威に関する情報は、レベルに関係なく、System Managerの[**イベント*]セクションまたはを使用して表示できます `security anti-ransomware volume show -vserver _svm_name_` コマンドを実行します

ARPスナップショットは最低2日間保持されます。ONTAP 9.11.1以降では、保持設定を変更できます。詳細については、を参照してください xref:modify-automatic-shapshot-options-task.html[Snapshotコピーのオプションを変更します]。



== ランサムウェア攻撃のあとに ONTAP でデータをリカバリする方法

攻撃の疑いがある場合、システムはその時点でボリュームの Snapshot コピーを作成し、そのコピーをロックします。あとで攻撃が確認されれば、ボリュームをこのSnapshotにリストアして、データ損失を最小限に抑えることができます。

ロックされた Snapshot コピーは、通常の方法で削除できません。ただし、後で攻撃をフォールスポジティブとしてマークする場合、ロックされたコピーは削除されます。

影響を受けるファイルと攻撃時間に関する知識を持つことで、ボリューム全体をスナップショットの 1 つに戻すだけでなく、さまざまな Snapshot コピーから影響を受けるファイルを選択的にリカバリできます。

ARPは、実績のあるONTAP データ保護とディザスタリカバリテクノロジを基盤として、ランサムウェア攻撃に対応しています。データのリカバリの詳細については、次のトピックを参照してください。

* link:../task_dp_recover_snapshot.html["Snapshot コピーからのリカバリ（ System Manager ）"]
* link:../data-protection/restore-contents-volume-snapshot-task.html["Snapshot コピーからのファイルのリストア（ CLI ）"]
* link:https://www.netapp.com/blog/smart-ransomware-recovery["スマートなランサムウェアリカバリ"^]

