---
sidebar: sidebar 
permalink: concepts/capacity-measurements.html 
keywords: capacity, measurement, physical, logical, storage, used storage, local tier capacity, aggregate capacity, block, capacity concern, add capacity, volume, used capacity, available capacity, total capacity, inactive capacity, static insights, dynamic insights, snapshot copy, snapshot copies, inactive data, overprovision, overflows, snapshot copy policy, snapshot copy reserves, reserves, policy, top volumes 
summary: ONTAPストレージ容量は、物理スペースまたは論理スペースのいずれかで測定できます。これらの測定値の報告方法は、ONTAPバージョンと、System Managerまたはコマンドラインインターフェイス（CLI）を使用しているかどうかによって異なります。ストレージの使用状況を監視するときは、容量に関連するさまざまな用語、物理容量と論理容量の違い、容量の種類の報告方法を理解することが重要です。 
---
= ONTAP容量レポートと測定について学ぶ
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
ONTAPストレージ容量は、物理スペースまたは論理スペースのいずれかで測定できます。これらの測定値の報告方法は、ONTAPバージョンと、System Managerまたはコマンドラインインターフェイス（CLI）のどちらを使用しているかによって異なります。ストレージの使用状況を監視する際には、容量に関連するさまざまな用語、物理容量と論理容量の違い、および容量タイプの報告方法を理解することが重要です。

* *物理容量*：物理スペースとは、ボリュームまたはローカル層で使用されるストレージの物理ブロックを指します。ストレージ効率化機能（重複排除や圧縮など）によってデータが削減されるため、通常、物理使用容量の値は使用済み論理容量の値よりも小さくなります。
* *論理容量*：論理スペースとは、ボリュームまたはローカル階層内の使用可能なスペース（論理ブロック）を指します。論理スペースとは、重複排除や圧縮の結果を考慮せずに、理論上使用できるスペースを指します。使用済み論理スペースの値は、使用済み物理スペースの量と、設定されているストレージ効率化機能（重複排除や圧縮など）による削減量から算出されます。この測定値は、Snapshotコピー、クローン、その他のコンポーネントが含まれており、データ圧縮やその他の物理スペースの削減が反映されていないため、物理使用容量よりも大きく表示されることがよくあります。したがって、論理容量の合計はプロビジョニングされたスペースよりも大きくなる可能性があります。




== CLIでの容量レポート

ONTAP CLI では、使用している ONTAP のバージョンによって物理使用済みスペースの報告方法が異なります。ONTAP 9.13.1 以前では、 `physical used` パラメータが  `volume show` コマンド出力に表示され、ボリュームに適用されたすべてのストレージ効率化による節約分が含まれます。ONTAP 9.14.1 以降では、 `physical used` パラメータには、温度感応型ストレージ（TSSE）、インライン圧縮、コンパクション、ボリューム間重複排除などのアグリゲートレベルのストレージ効率化による節約分が含まれないため、ボリュームの物理使用済みスペースを正確に反映しません。ONTAP 9.14.1 以降では、ボリュームの正確な物理使用済みスペースを確認するには、 `vol show-footprint` コマンドと  `effective_total_footprint` パラメータを使用してください。

[cols="4"]
|===
| ONTAPバージョン | コマンド | パラメータ | 概要 


.3+| 9.14.1以降 | `volume show-footprint` | `effective_total_footprint` | アグリゲートからの削減量を含む、実際に使用されているディスク容量を反映します。 


| `volume show-space` | `physical used` | アグリゲートからの削減量を含む、ボリュームレベルのストレージ効率による削減量を反映します。 


| `volume show` | `physical used` | 集約レベルのストレージ効率の節約は含まれていないため、link:..volumes/enable-temperature-sensitive-efficiency-concept.html["TSSE対応プラットフォーム"]のボリュームの物理的な使用領域を正確に反映しません。 


.3+| 9.13.1以前 | `volume show-footprint` | `effective_total_footprint` | アグリゲートからの削減量を含む、実際に使用されているディスク容量を反映します。 


| `volume show-space` | `physical used` | ボリュームレベルのストレージ効率化による削減量のみを反映します。 


| `volume show` | `total physical used` | ボリュームレベルのストレージ効率化による削減量のみを反映します。 
|===
.関連情報
* link:https://kb.netapp.com/on-prem/ontap/OHW/OHW-KBs/What_is_the_Change_in_Physical_Used_Space_Reporting_for_9.14.1_and_later["9.14.1 以降の物理使用領域レポートの変更"^]の詳細については、こちらをご覧ください。
* link:../volumes/commands-display-space-usage-reference.html["スペース使用情報を表示するためのコマンド"]についての詳細をご覧ください。




== System Managerの容量レポート

使用容量の測定値は、ONTAP のバージョンに応じて System Manager で異なる方法で表示されます。ONTAP 9.7 以降、System Manager は物理容量と論理容量の両方の測定値を提供します。


NOTE: System Managerでは、ルート ストレージ階層（アグリゲート）の容量は考慮されません。

[cols="30,30,40"]
|===


| System Managerのバージョン | 容量を表す用語 | 参照される容量のタイプ 


 a| 
9.9.1以降
 a| 
使用済み論理容量
 a| 
ストレージ効率設定が有効になっている場合に使用される論理スペース）



 a| 
9.7 と 9.8
 a| 
使用済み
 a| 
使用済み論理スペース（ストレージ効率設定が有効になっている場合）



 a| 
9.5 および 9.6（クラシック表示）
 a| 
使用済み
 a| 
使用済みの物理スペース

|===


== 容量測定関連の用語

容量のタイプに使用される用語は次のとおりです。

* *割り当て容量*：Storage VM 内のボリュームに割り当てられたスペースの量。
* *使用可能*：ストレージ VM またはローカル層でデータを保存したりボリュームをプロビジョニングしたりするために使用できる物理スペースの量。
* *ボリューム全体の容量*：ストレージ VM 上のすべてのボリュームの使用済みストレージと使用可能なストレージの合計。
* *クライアント データ*：クライアント データ（物理または論理）によって使用されるスペースの量。
+
** ONTAP 9.13.1 以降では、クライアント データによって使用される容量は *論理使用容量* と呼ばれ、スナップショットによって使用される容量は別途表示されます。
** ONTAP 9.12.1 以前では、クライアント データによって使用される容量とスナップショットによって使用される容量を合計したものは、*使用済み論理容量*と呼ばれます。


* *コミット済み*：ローカル階層のコミット済み容量。
* *データ削減*：取り込まれたデータのサイズと保存されたデータのサイズの比率。
+
** ONTAP 9.13.1以降、データ削減機能では、重複排除や圧縮など、ほとんどのStorage Efficiency機能の結果が考慮されますが、Snapshotやシンプロビジョニングはデータ削減率に含まれません。
** ONTAP 9.12.1以前では、データ削減比率は次のように表示されます。
+
*** *容量*パネルに表示されるデータ削減値は、すべての使用済み論理容量と使用済み物理容量の全体的な比率であり、Snapshotやその他のストレージ効率化機能の使用から得られる利点が含まれます。
*** 詳細パネルを表示すると、概要パネルに表示された *全体* の比率と、クライアント データのみで使用される使用済み論理容量とクライアント データのみで使用される物理使用領域の比率（*スナップショットとクローンなし* と呼ばれます）の両方が表示されます。




* *使用済み論理容量*：
+
** ONTAP 9.13.1 以降では、クライアント データによって使用される容量は *論理使用容量* と呼ばれ、スナップショットによって使用される容量は別途表示されます。
** ONTAP 9.12.1 以前では、スナップショットによって使用される容量に追加されたクライアント データによって使用される容量は、*論理使用容量*と呼ばれます。


* *論理使用率 %*：スナップショット リザーブを除く、プロビジョニング済みサイズに対する現在の使用済み論理容量の割合。この値には、ボリュームの効率化による削減量が含まれるため、100%を超える場合があります。
* *最大容量*：ストレージ VM 上のボリュームに割り当てられるスペースの最大量。
* *物理使用量*：ボリュームまたはローカル層の物理ブロックで使用されている容量。
* *物理使用率 %*：プロビジョニングされたサイズと比較した、ボリュームの物理ブロックで使用されている容量の割合。
* *プロビジョニングされた容量*：Cloud Volumes ONTAPシステムから割り当てられ、ユーザーまたはアプリケーションのデータを保存する準備ができているファイル システム（ボリューム）。
* *予約済み*：ローカル階層ですでにプロビジョニングされているボリューム用にリザーブされているスペースの量。
* *使用済み*：データが含まれているスペースの量。
* *使用済みおよび予約済み*：物理的な使用済みスペースとリザーブ スペースの合計。




== Storage VMの容量

Storage VMの最大容量は、各ボリュームに割り当てられているスペースの合計に、残りの未割り当てのスペースを足したものです。

* ボリュームに割り当てられているスペースは、FlexVol、FlexGroup、FlexCacheボリュームの使用済み容量と使用可能容量の合計です。
* ボリュームの容量は、そのボリュームが制限されている場合、オフラインの場合、または削除後にリカバリ キューに登録されている場合も、合計に含まれます。
* ボリュームに自動拡張が設定されている場合は、ボリュームの最大オートサイズが使用されます。自動拡張が設定されていない場合は、ボリュームの実際の容量が使用されます。


次の図は、ボリューム全体の容量の測定値と最大容量の関係を示しています。

image:max-cap-limit-cap-x-volumes.gif["最大容量制限は割り当てスペースと使用可能スペースで構成され、ボリューム全体の容量は割り当てスペースのみを占有します。"]

ONTAP 9.13.1以降、クラスタ管理者はlink:../manage-max-cap-limit-svm-in-sm-task.html["ストレージ VM の最大容量制限を有効にする"]。ただし、データ保護用のボリューム、SnapMirrorリレーションシップ内のボリューム、またはMetroCluster構成内のボリュームを含むストレージVMには、ストレージ制限を設定できません。また、ストレージVMの最大容量を超えるクォータを設定することもできません。

一度設定した最大容量を、現在割り当てられている容量よりも小さいサイズに変更することはできません。

ストレージVMが最大容量制限に達すると、特定の操作を実行できなくなります。System Managerは、link:../insights-system-optimization-task.html["*インサイト*"]で次の手順を提案します。



== System Managerの容量測定単位

System Managerは、1024（2^10^）バイトのバイナリ単位に基づいてストレージ容量を計算します。

* ONTAP 9.10.1以降のSystem Managerでは、ストレージ容量の単位はKiB、MiB、GiB、TiB、PiBとして表示されます。
* ONTAP 9.10.0以前のSystem Managerでは、これらの単位はKB、MB、GB、TB、PBとして表示されます。



NOTE: スループットの単位については、ONTAPのすべてのリリースのSystem Managerで、KB/秒、MB/秒、GB/秒、PB/秒が引き続き使用されます。

[cols="20,20,30,30"]
|===


| ONTAP 9.10.0 以前の System Manager に表示される容量単位 | ONTAP 9.10.1以降のSystem Managerに表示される容量単位 | 計算式 | バイト単位の値 


 a| 
KB
 a| 
KiB
 a| 
1024
 a| 
1024バイト



 a| 
MB
 a| 
MiB
 a| 
1024 * 1024
 a| 
1,048,576バイト



 a| 
GB
 a| 
GiB
 a| 
1024 * 1024 * 1024
 a| 
1,073,741,824バイト



 a| 
TB
 a| 
TiB
 a| 
1024 * 1024 * 1024 * 1024
 a| 
1,099,511,627,776バイト



 a| 
PB
 a| 
PiB
 a| 
1024 * 1024 * 1024 * 1024 * 1024
 a| 
1,125,899,906,842,624バイト

|===
.関連情報
link:../task_admin_monitor_capacity_in_sm.html["System Manager でクラスタ、階層、SVM の容量を監視する"]

link:../volumes/logical-space-reporting-enforcement-concept.html["ボリュームの論理スペースのレポートと適用"]
