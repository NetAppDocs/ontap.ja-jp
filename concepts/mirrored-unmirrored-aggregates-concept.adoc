---
permalink: concepts/mirrored-unmirrored-aggregates-concept.html 
sidebar: sidebar 
keywords: mirrored, unmirrored, aggregate, local tier, plex, syncmirror, dparity, raid group 
summary: ONTAP には、SyncMirror というオプション機能があります。この機能を使用すると、コピー内のローカル階層（アグリゲート）データまたはプレックスを同期的にミラーリングし、別々のRAIDグループに格納することができます。プレックスを使用すると、 RAID タイプで保護されるディスク数よりも多くのディスクで障害が発生した場合や、 RAID グループのディスクへの接続が切断された場合に、データ損失を防ぐことができます。 
---
= ミラーされた、ミラーされていないローカル階層（アグリゲート）
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP には、SyncMirror というオプション機能があります。この機能を使用すると、コピー内のローカル階層（アグリゲート）データまたはプレックスを同期的にミラーリングし、別々のRAIDグループに格納することができます。プレックスを使用すると、 RAID タイプで保護されるディスク数よりも多くのディスクで障害が発生した場合や、 RAID グループのディスクへの接続が切断された場合に、データ損失を防ぐことができます。

System ManagerまたはCLIを使用してローカル階層を作成する場合は、ローカル階層をミラーリングするかミラーしないかを指定できます。



== ミラーされていないローカル階層（アグリゲート）の機能

ローカル階層をミラーリングするように指定しない場合、ミラーされていないローカル階層（アグリゲート）として作成されます。ミラーされていないローカル階層には、プレックス_（データのコピー）が1つだけ含まれ、このローカル階層に属するすべてのRAIDグループが含まれます。

次の図に、1つのプレックスを含む、ディスクで構成されたミラーされていないローカル階層を示します。ローカル階層には、rg0、rg1、rg2、rg3の4つのRAIDグループがあります。各RAIDグループには6本のデータディスクがあり、パリティディスクとdparity（ダブルパリティ）ディスクが1本ずつ含まれます。ローカル階層で使用されるすべてのディスクは'同じプールであるpool0から提供されます

image:drw-plexum-scrn-en-noscale.gif["この図は上述の説明を表したものです。"]

次の図に、1つのプレックスを含む、アレイLUNを含むミラーされていないローカル階層を示します。rg0 と rg1 の 2 つの RAID グループがあります。ローカル階層で使用されるすべてのアレイLUNは'同じプールであるpool0から提供されます

image:unmirrored-aggregate-with-array-luns.gif["この図は上述の説明を表したものです。"]



== ミラーされたローカル階層（アグリゲート）の機能

ミラーされたアグリゲートには、 2_bプレックス _ （データコピー）があります。これらのアグリゲートでは、 SyncMirror 機能を使用してデータを複製し、冗長性を確保します。

ローカル階層を作成するときに、ミラーされたローカル階層として指定することができます。  また、ミラーされていない既存のローカル階層に2つ目のプレックスを追加して、ミラーされた階層にすることもできます。SyncMirror 機能を使用すると、ONTAP は元のプレックス（plex0）のデータを新しいプレックス（plex1）にコピーします。プレックスは物理的に分離されており（各プレックスには独自の RAID グループと独自のプールがあり）、同時に更新されます。

この構成では、アグリゲートのRAIDレベルで保護されるディスク数よりも多くのディスクで障害が発生した場合や接続が切断された場合に、影響を受けていないプレックスで障害の原因 を修正する間もデータの提供が継続されるため、データ損失が防止されます。問題のあるプレックスが修正されたら、 2 つのプレックスが再同期化され、ミラー関係が再確立されます。

システム上のディスクとアレイLUNは'pool0とpool1という2つのプールに分かれていますplex0 は pool0 からストレージを取得し、 plex1 は pool1 からストレージを取得します。

次の図は、SyncMirror 機能を有効にして実装したディスクで構成されるローカル階層を示しています。ローカル階層「plex1」用に2つ目のプレックスが作成されました。plex1 のデータは plex0 のデータの複製であり、 RAID グループも同じです。32本のスペアディスクは、各プールに16本のディスクを使用してpool0またはpool1に割り当てられます。

image:drw-plexm-scrn-en-noscale.gif["この図は上述の説明を表したものです。"]

次の図は、SyncMirror 機能を有効にして実装したアレイLUNで構成されるローカル階層を示しています。ローカル階層「plex1」用に2つ目のプレックスが作成されました。plex1 は plex0 の複製であり、 RAID グループも同じです。

image:mirrored-aggregate-with-array-luns.gif["この図は上述の説明を表したものです。"]


NOTE: ストレージのパフォーマンスと可用性を最適化するために、ミラーアグリゲートでは少なくとも20%の空きスペースを確保することを推奨します。ミラーされていないアグリゲートでは10%が推奨されますが、追加の10%のスペースはファイルシステムで増分変更に対応するために使用できます。増分変更を行うと、ONTAPのcopy-on-write Snapshotベースのアーキテクチャにより、ミラーされたアグリゲートのスペース使用率が向上します。これらのベストプラクティスに従わないと、パフォーマンスに悪影響を及ぼす可能性があります。
