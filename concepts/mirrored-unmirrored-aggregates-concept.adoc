---
permalink: concepts/mirrored-unmirrored-aggregates-concept.html 
sidebar: sidebar 
keywords: mirrored, unmirrored, aggregate, local tier, plex, syncmirror, dparity, raid group 
summary: ONTAPには_ raid_というオプションの機能があります。この機能を使用すると、異なるSyncMirrorグループに格納されているコピー（_plexes_）内のローカル階層のデータを同期的にミラーリングできます。プレックスを使用すると、RAIDタイプで保護されるディスク数よりも多くのディスクで障害が発生した場合や、RAIDグループのディスクへの接続が失われた場合でも、データ損失を防ぐことができます。 
---
= ミラーされたローカル階層とミラーされないローカル階層
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
raid_raid_を使用するONTAPと、異なるSyncMirrorグループに格納されているコピー（_plexes_）のローカル階層のデータを同期的にミラーリングできます。プレックスを使用すると、RAIDタイプで保護されるディスク数よりも多くのディスクで障害が発生した場合や、RAIDグループのディスクへの接続が失われた場合でも、データ損失を防ぐことができます。

ローカル層を作成するときに、ローカル層をミラーリングするかミラーリングしないかを指定できます。


NOTE: ONTAP 9.7より前のバージョンでは、ローカル階層を表すために_aggregate_という用語が使用されていました。ONTAPのバージョンに関係なく、ONTAP CLIでは_aggregate_という用語が使用されます。ローカル階層の詳細については、を参照してくださいlink:../disks-aggregates/index.html["ディスクとローカル階層"]。



== ミラーされていないローカル階層の仕組み

ローカル階層をミラーリングするように指定しない場合、ローカル階層はミラーされていないとして作成されます。ミラーされていないローカル階層には、プレックス_（データのコピー）が1つだけ含まれ、このローカル階層に属するすべてのRAIDグループが含まれます。

次の図は、ディスクで構成され、1つのプレックスにグループ化された、ミラーされていないローカル階層を示しています。ローカル階層には、rg0、rg1、rg2、rg3の4つのRAIDグループがあります。各RAIDグループには、6本のデータディスク、1本のパリティディスク、および1本のdparity（ダブルパリティ）ディスクがあります。ローカル階層で使用されるすべてのディスクは'同じプールであるpool0から提供されます

image:drw-plexum-scrn-en-noscale.gif["1つのプレックスを含むディスクで構成されるミラーされていないローカル階層"]

次の図は、アレイLUNで構成されたミラーされていないローカル階層を1つのプレックスにグループ化した状態を示しています。このノードには、rg0とrg1の2つのRAIDグループがあります。ローカル階層で使用されるすべてのアレイLUNは'同じプールであるpool0から提供されます

image:unmirrored-aggregate-with-array-luns.gif["アレイLUNと1つのプレックスで構成されるミラーされていないローカル階層"]



== ミラーされたローカル階層の機能

ミラーされたローカル階層には、2つの_プレックス_（データのコピー）があります。これらの階層では、SyncMirror機能を使用してデータを複製し、冗長性を確保します。

ローカル階層を作成するときに、ミラーリングするように指定できます。また、ミラーされていない既存のローカル階層に2つ目のプレックスを追加して、ミラーされた階層にすることもできます。SyncMirrorを使用すると、ONTAPは元のプレックス（plex0）のデータを新しいプレックス（plex1）にコピーします。プレックスは物理的に分離されており（各プレックスには独自のRAIDグループと独自のプールがあります）、同時に更新されます。

この構成では、ローカル階層のRAIDレベルで保護されるディスク数よりも多くのディスクで障害が発生した場合や接続が失われた場合に、障害の原因を修正しながら影響を受けないプレックスがデータの提供を継続するため、データ損失に対する保護が強化されます。問題のあるプレックスが修正されると、2つのプレックスが再同期され、ミラー関係が再確立されます。

システム上のディスクとアレイLUNは、との `pool1`2つのプールに分割されます `pool0`。plex0はpool0からストレージを取得し、plex1はpool1からストレージを取得します。

次の図は、SyncMirrorを有効にして実装したディスクで構成されるローカル階層を示しています。ローカル階層用に2つ目のプレックスが作成されています `plex1`。plex1のデータはplex0のデータのコピーであり、RAIDグループも同じです。各プールに16本のディスクを使用して、32本のスペアディスクがpool0またはpool1に割り当てられます。

image:drw-plexm-scrn-en-noscale.gif["SyncMirror機能を備えたディスクで構成されるローカル階層"]

次の図は、SyncMirror機能を有効にして実装したアレイLUNで構成されるローカル階層を示しています。ローカル階層用に2つ目のプレックスが作成されています `plex1`。plex1はplex0のコピーであり、RAIDグループも同じです。

image:mirrored-aggregate-with-array-luns.gif["SyncMirror機能を備えたアレイLUNで構成されるローカル階層"]


NOTE: ストレージのパフォーマンスと可用性を最適化するために、ミラーアグリゲートでは少なくとも20%の空きスペースを確保することを推奨します。ミラーされていないアグリゲートでは10%が推奨されますが、追加の10%のスペースはファイルシステムで増分変更に対応するために使用できます。増分変更を行うと、ONTAPのcopy-on-write Snapshotベースのアーキテクチャにより、ミラーされたアグリゲートのスペース使用率が向上します。これらのベストプラクティスに従わないと、パフォーマンスに悪影響を及ぼす可能性があります。
