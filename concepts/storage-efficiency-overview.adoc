---
permalink: concepts/storage-efficiency-overview.html 
sidebar: sidebar 
keywords: storage efficiency, storage efficiencies, storage efficiency technologies, space utilization, space savings, optimizing, space optimization, minimizing, wasted space, reducing, footprint, thin provisioning, deduplication, zero block, zero-block, inline, deduplication, background deduplication, postprocessing, post-processing, compression, compaction, flex-clone technologies 
summary: ストレージ効率は、ストレージ リソースを最適化し、無駄なスペースを最小限に抑え、書き込まれたデータの物理的なフットプリントを削減することで、ストレージ システムが使用可能なスペースをどれだけ効率的に使用しているかを示す指標です。 
---
= ONTAP Storage Efficiencyの概要
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ストレージ効率とは、ストレージ リソースを最適化し、無駄なスペースを最小限に抑え、書き込まれたデータの物理的なフットプリントを削減することで、ストレージ システムが利用可能なスペースをどれだけ効率的に使用しているかを示す指標です。ストレージ効率が高いほど、最小限のスペースに最大限のデータ量を、最小限のコストで保存できます。例えば、重複したデータ ブロックやゼロで埋められたデータ ブロックを検出して排除するストレージ効率化テクノロジーを活用することで、必要な物理ストレージの総量を削減し、全体的なコストを削減できます。

ONTAPには、データによって消費される物理的ハードウェアやクラウド ストレージの量を減らしつつ、データの読み取り、データセットのコピー、VMのプロビジョニングを高速化するなどしてシステムのパフォーマンスを大幅に向上させる、さまざまなStorage Efficiencyテクノロジが搭載されています。

.ONTAPのStorage Efficiencyテクノロジには、次のようなものがあります。
* *シンプロビジョニング*
+
xref:thin-provisioning-concept.html[シンプロビジョニング]を使用すると、事前に予約するのではなく、必要に応じてボリュームまたはLUNにストレージを割り当てることができます。これにより、現在使用されていないスペースを予約することなく、潜在的な使用量に基づいてボリュームまたはLUNを過剰割り当てできるため、必要な物理ストレージの量を削減できます。

* *重複排除*
+
xref:deduplication-concept.html[重複排除]は、ボリュームに必要な物理ストレージの量を3つの異なる方法で削減します。

+
** *ゼロブロック重複排除*
+
ゼロ ブロック重複排除では、ゼロだけで埋められたデータ ブロックが検出、排除され、メタデータのみが更新されます。通常、ゼロ ブロックで使用されていたスペースが100%解放されます。ゼロ ブロック重複排除は、すべての重複排除ボリュームでデフォルトで有効になっています。

** *インライン重複排除*
+
インライン重複排除では、重複するデータ ブロックが検出され、データがディスクに書き込まれる前に一意の共有ブロックへの参照に置き換えられます。インライン重複排除により、VMのプロビジョニングが20～30%高速化されます。インライン重複排除は、ONTAPのバージョンとプラットフォームに応じて、ボリュームレベルかアグリゲートレベルで実行できます。AFFシステムとASAシステムでは、デフォルトで有効になっています。FASシステムでは、インライン重複排除を手動で有効にする必要があります。

** *バックグラウンド重複排除*
+
バックグラウンド重複排除でも、重複するデータ ブロックが検出され、一意の共有ブロックへの参照に置き換えられますが、データがディスクに書き込まれたあとで置き換えが行われるので、さらにストレージ効率が高くなります。バックグラウンド重複排除は、ストレージ システムで特定の条件が満たされたときに実行されるように設定できます。たとえば、ボリュームの利用率が10%に達したときにバックグラウンド重複排除が実行されるように設定できます。バックグラウンド重複排除は、手動でトリガーすることも、指定したスケジュールに基づいて実行されるように設定することもできます。AFFシステムとASAシステムでは、デフォルトで有効になっています。FASシステムでは、バックグラウンド重複排除を手動で有効にする必要があります。



+
重複排除は、ボリューム内と、アグリゲート内のボリューム間でサポートされます。通常、重複排除されたデータの読み取りがパフォーマンスに影響することはありません。

* *圧縮*
+
xref:compression-concept.html[圧縮]は、データ ブロックを圧縮グループにまとめ、各グループを単一のブロックとして格納することで、ボリュームに必要な物理ストレージの容量を削減します。読み取りまたは上書き要求を受信すると、ファイル全体ではなく、少数のブロック グループのみが読み取られます。このプロセスにより、読み取りと上書きのパフォーマンスが最適化され、圧縮対象ファイルのサイズのスケーラビリティが向上します。

+
圧縮は、インラインまたはポストプロセスで実行できます。インライン圧縮では、メモリ内のデータがディスクに書き込まれる前に圧縮されるので、スペースを即座に削減できます。ポストプロセス圧縮では、まず圧縮されていない状態でブロックがディスクに書き込まれ、その後スケジュールされた時刻にデータが圧縮されます。AFAシステムでは、デフォルトで有効になっています。その他のすべてのシステムでは、圧縮を手動で有効にする必要があります。

* *コンパクション*
+
コンパクションでは、4KBのブロックに格納されているもののサイズが4KB未満のデータ チャンクが単一のブロックに結合されることにより、ボリュームに必要な物理ストレージの量が削減されます。コンパクションはデータがメモリ上にある間に実行されるため、ディスク上で不要なスペースが消費されることはありません。AFFシステムとASAシステムでは、デフォルトで有効になっています。FASシステムでは、コンパクションを手動で有効にする必要があります。

* *FlexCloneボリューム、ファイル、LUN*
+
xref:flexclone-volumes-files-luns-concept.html[FlexCloneテクノロジー]は、Snapshotメタデータを活用して、ボリューム、ファイル、またはLUNの書き込み可能なポイントインタイムコピーを作成します。コピーは親とデータ ブロックを共有し、コピーまたは親に変更が書き込まれるまで、メタデータに必要なストレージ以外は消費しません。変更が書き込まれると、差分のみが保存されます。

+
従来の手法でコピーを作成すると数分から数時間かかりますが、FlexCloneテクノロジを使用すれば大規模なデータセットのコピーもほぼ瞬時に作成できます。

* *温度に依存したストレージ効率*
+
ONTAPは、link:../volumes/enable-temperature-sensitive-efficiency-concept.html["温度に敏感なストレージ効率"]ボリュームのデータへのアクセス頻度を評価し、その頻度とデータに適用される圧縮レベルをマッピングすることで、メリットを提供します。アクセス頻度の低いコールドデータについては、大きなデータブロックを圧縮します。アクセス頻度が高く、上書きされる頻度が高いホットデータについては、小さなデータブロックを圧縮することで、処理効率を高めます。

+
ONTAP 9.8で導入された温度感応ストレージ効率（TSSE）は、新規作成されたシンプロビジョニングAFFボリュームで自動的に有効化されます。ONTAP 9.15.1で導入されたlink:builtin-storage-efficiency-concept.html["AFF A70、AFF A90、およびAFF A1Kプラットフォーム"]、ハードウェアオフロードプロセッサを使用するボリュームでは有効化されません。




NOTE: TSSEはシック プロビジョニングされたボリュームではサポートされていません。

* *CPUまたは専用オフロード プロセッサのストレージ効率*
+
ONTAP 9.15.1以降、link:builtin-storage-efficiency-concept.html["CPUまたは専用オフロード プロセッサによるストレージ効率化"]は一部のAFFおよびFASプラットフォームで自動的に有効になり、設定は不要です。これらのプラットフォームでは、温度に依存するストレージ効率化は使用されません。圧縮は、データがコールド状態になるのを待たずに開始され、メインCPUまたは専用オフロード プロセッサを使用して実行されます。また、これらのプラットフォームでは、連続する物理ブロックのシーケンシャル パッキングを使用して、圧縮データのストレージ効率をさらに向上させます。



これらのテクノロジのメリットは、最小限の労力で日常業務に活かすことができます。たとえば、5,000人のユーザーにホーム ディレクトリ用のストレージを提供する必要があり、ユーザー1人あたりに必要な最大容量は1GBと見積もっているとします。潜在的なストレージ ニーズの合計を満たすために、事前に5TBのアグリゲートを予約しておくことができます。ただし、ホーム ディレクトリの容量要件は組織全体で大きく異なることもわかっています。組織全体で5TBの容量を予約する代わりに、2TBのアグリゲートを作成できます。その後、シン プロビジョニングを使用して、各ユーザーに名目上1GBのストレージを割り当て、必要な場合にのみストレージを割り当てることができます。アグリゲートを継続的に監視し、必要に応じて実際の物理サイズを増やすことができます。

別の例として、仮想デスクトップ インフラ（VDI）を使用していて、仮想デスクトップ間で大量の重複データが発生している状況があるとします。重複排除機能を使用すれば、VDI全体で重複する情報ブロックが自動的に排除され、元のブロックへのポインタに置き換えられるので、ストレージの使用量を減らせます。圧縮など、ONTAPのその他のStorage Efficiencyテクノロジも、ユーザが操作しなくてもバックグラウンドで実行されるようにできます。

ONTAPのディスク パーティショニング テクノロジによっても、ストレージ効率が向上します。RAID DPテクノロジは、パフォーマンスの低下や、ディスクミラーリングのオーバーヘッド増大を伴うことなく、二重ディスク障害からデータを保護します。ONTAP 9の高度なSSDパーティショニングにより、使用可能な容量が20%近く増加します。

NetAppは、オンプレミスのONTAPで利用可能な同じストレージ効率機能をクラウドでも提供します。オンプレミスのONTAPからクラウドにデータを移行しても、既存のストレージ効率は維持されます。例えば、ビジネス クリティカルなデータを含むSQLデータベースをオンプレミス システムからクラウドに移行したいとします。NetApp Consoleのデータ レプリケーションを使用してデータを移行し、移行プロセスの一環として、クラウドのスナップショットに最新のオンプレミス ポリシーを適用できます。
