---
permalink: consistency-groups/configure-hierarchy-task.html 
sidebar: sidebar 
keywords: consistency groups, application protection, parent, child, hierarchy 
summary: 大規模なアプリケーションワークロードの管理とデータ保護のための階層型整合グループを作成します。 
---
= 階層型ONTAPコンシステンシーグループを構成する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
階層整合グループを使用すると、複数のボリュームにまたがる大規模なワークロードを管理できます。作成した親整合グループは、子整合グループの傘として機能します。

階層整合グループの親には、最大5つの個別の整合グループを含めることができます。階層型整合性グループは、整合性グループまたは個 々 のボリューム間で異なるローカルSnapshotポリシーをサポートできます。リモート保護ポリシーを使用する場合は、階層整合グループ全体（親と子）に適用されます。

ONTAP 9 .13.1以降では、およびをxref:modify-task.html[子整合グループ間でボリュームを移動します]使用できますxref:modify-geometry-task.html[コンシステンシグループの形状を変更します]。

整合グループのオブジェクト制限については、を参照してくださいxref:limits.html[整合性グループのオブジェクトの制限]。



== 新しいLUNまたはボリュームを含む階層整合グループを作成する

階層整合グループを作成する場合は、新しいLUNを追加できます。ONTAP 9 .13.1以降では、新しいNVMeネームスペースとNASボリュームも使用できます。

[role="tabbed-block"]
====
.System Manager
--
.手順
. Storage > Consistency groups * を選択します。
. [+ Add]*を選択し、ストレージオブジェクトのプロトコルを選択します。
+
ONTAP 9.10.1~9.12.1では、新しいストレージオブジェクトの唯一のオプションは**新しいLUNを使用する**です。.13.1以降では、新しいONTAP 9ネームスペースと新しいNASボリュームを使用した整合グループの作成がサポートされます。

. 整合グループに名前を付けます。ボリュームまたはLUNの数と各ボリュームまたはLUNの容量を指定します。
+
.. **アプリケーションタイプ**: ONTAP 9.12.1以降を使用している場合は、アプリケーションタイプを選択します。値を選択しない場合'デフォルトではコンシステンシ・グループには** Other **のタイプが割り当てられますの一貫性のタグ付けの詳細については、をxref:modify-tags-task.html[アプリケーションタグとコンポーネントタグ]参照してください。リモート保護ポリシーを使用する場合は、*[その他]*を選択する必要があります。


. ホストオペレーティングシステムとLUNの形式を選択します。ホストイニシエータ情報を入力します。
+
.. [**New LUNs]の場合**：ホストオペレーティングシステムとLUN形式を選択します。ホストイニシエータ情報を入力します。
.. [**New NAS volumes]の場合**：SVMのNAS構成に基づいて、適切なエクスポートオプション（NFSまたはSMB/CIFS）を選択します。
.. [**New NVMe Namespaces]の場合**：ホストオペレーティングシステムとNVMeサブシステムを選択します。


. 子整合グループを追加するには、*[その他のオプション]*を選択し、*+子整合グループを追加*を選択します。
. パフォーマンスレベル、LUNまたはボリュームの数、およびLUNまたはボリュームあたりの容量を選択します。使用しているプロトコルに基づいて、適切なエクスポート設定またはオペレーティングシステム情報を指定します。
. 必要に応じて、ローカルSnapshotポリシーを選択し、アクセス権限を設定します。
. 最大5つの子整合性グループについて、同じ手順を繰り返します。
. [ 保存（ Save ） ] を選択します。
. ONTAPジョブが完了すると表示されるメインの整合グループメニューに戻って、整合グループが作成されたことを確認します。保護ポリシーを設定する場合は、該当するポリシー（remoteまたはlocal）の下にチェックマークの付いた緑色の盾が表示されていることを確認します。


--
.CLI
--
.開始する前に
* このタスクを実行するには、admin権限レベルが必要です。
* ONTAP 9.15.1以降では、admin権限レベルのすべてのユーザがこのタスクを実行できます。ONTAP 9.14.1では、このタスクを実行するには、クラスタ管理者またはSVMの管理者である必要があります。


CLIで新しいボリュームを含む階層整合グループを作成する場合は、子整合グループをそれぞれ個別に作成する必要があります。

.ステップ
. コマンドを使用して、新しい整合グループを作成し `consistency-group create`ます。
+
`consistency-group create -vserver <SVM_name> -consistency-group <consistency_group_name> -parent-consistency-group <parent_consistency_group_name> -volume-prefix <volume_prefix> -volume-count <number_of_volumes> -size <size>`

. CLIのプロンプトが表示されたら、新しい親整合グループの作成を確認します。と入力し `y`ます。
. 必要に応じて、手順1を繰り返して子整合グループをさらに作成します。
+
の詳細については `consistency-group create`、をlink:https://docs.netapp.com/us-en/ontap-cli/search.html?q=consistency-group+create["ONTAPコマンド リファレンス"^]参照してください。



--
====


== 既存のボリュームを含む階層整合性グループを作成する

既存のボリュームを階層整合グループにまとめることができます。

[role="tabbed-block"]
====
.System Manager
--
.手順
. Storage > Consistency groups * を選択します。
. 「*+追加*」を選択し、既存のボリュームを使用する*を選択します。
. Storage VMを選択します。
. 対象に含める既存のボリュームを選択します。整合グループにまだ含まれていないボリュームのみが選択可能になります。
. 子コンシステンシグループを追加するには、 * + 子コンシステンシグループの追加 * を選択します。必要な整合グループを作成します。この整合グループには、自動的にという名前が付けられます。
+
.. **コンポーネントタイプ**: ONTAP 9.12.1以降を使用している場合は、「データ」、「ログ」、または「その他」のコンポーネントタイプを選択します。値を選択しない場合'デフォルトではコンシステンシ・グループには** Other **のタイプが割り当てられますの一貫性のタグ付けの詳細については、をxref:modify-tags-task.html[アプリケーションタグとコンポーネントタグ]参照してください。リモート保護ポリシーを使用する場合は、* other *を使用する必要があります。


. 既存のボリュームを各整合グループに割り当てます。
. 必要に応じて、ローカルSnapshotポリシーを選択します。
. 最大5つの子整合性グループについて、同じ手順を繰り返します。
. [ 保存（ Save ） ] を選択します。
. ONTAPジョブが完了すると表示されるメインの整合グループメニューに戻って、整合グループが作成されたことを確認します。保護ポリシーを選択した場合は、メニューから整合グループを選択して、保護ポリシーが適切に設定されていることを確認します。適切なポリシータイプの下にチェックマークが付いた緑色の盾が表示されます。


--
.CLI
--
ONTAP 9 14.1以降では、CLIを使用して階層整合グループを作成できます。

.開始する前に
* このタスクを実行するには、admin権限レベルが必要です。
* ONTAP 9.15.1以降では、admin権限レベルのすべてのユーザがこのタスクを実行できます。ONTAP 9.14.1では、このタスクを実行するには、クラスタ管理者またはSVMの管理者である必要があります。


.手順
. 新しい親整合グループをプロビジョニングし、新しい子整合グループにボリュームを割り当てます。
+
`consistency-group create -vserver <svm_name> -consistency-group <child_consistency_group_name> -parent-consistency-group <parent_consistency_group_name> -volumes <volume_names>`

. と入力して `y`、新しい親整合グループと子整合グループの作成を確定します。
+
の詳細については `consistency-group create`、をlink:https://docs.netapp.com/us-en/ontap-cli/search.html?q=consistency-group+create["ONTAPコマンド リファレンス"^]参照してください。



--
====
.次のステップ
* xref:xref:modify-geometry-task.html[整合グループのジオメトリの変更]
* xref:modify-task.html[整合グループの変更]
* xref:protect-task.html[整合グループの保護]

