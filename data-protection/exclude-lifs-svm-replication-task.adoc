---
permalink: data-protection/exclude-lifs-svm-replication-task.html 
sidebar: sidebar 
keywords: lifs, network, settings, svm, replication 
summary: ソース SVM とデスティネーション SVM が異なるサブネットにある場合は、snapmirror policy create コマンドの -discard-configs network オプションを使用して、LIF および関連するネットワーク設定を SVM レプリケーションから除外できます。 
---
= ONTAP SnapMirror SVMレプリケーションからLIFと関連ネットワーク設定を除外する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ソース SVM とデスティネーション SVM が異なるサブネットにある場合は、 `snapmirror policy create`コマンドの `-discard-configs network`オプションを使用して、LIF および関連するネットワーク設定を SVM レプリケーションから除外できます。

.開始する前に
ソース / デスティネーション クラスタとSVMのピア関係が確立されている必要があります。

詳細については、link:../peering/create-cluster-relationship-93-later-task.html["クラスタ ピア関係の作成"]およびlink:../peering/create-intercluster-svm-peer-relationship-93-later-task.html["SVMクラスタ間ピア関係を作成する"]を参照してください。

.タスク概要
 `snapmirror create`コマンドの `-identity-preserve`オプションは、SVM レプリケーション関係を作成するときに `true`に設定する必要があります。

.手順
. デスティネーションSVMを作成します。
+
`vserver create -vserver _SVM_ -subtype dp-destination`

+
SVM名はソース クラスタとデスティネーション クラスタの間で一意である必要があります。

+
次の例では、 `svm_backup`という名前のデスティネーション SVM を作成します：

+
[listing]
----
cluster_dst:> vserver create -vserver svm_backup -subtype dp-destination
----
. デスティネーション クラスタから、 `vserver peer create`コマンドを使用して SVM ピア関係を作成します。
+
詳細については、link:../peering/create-intercluster-svm-peer-relationship-93-later-task.html["SVMクラスタ間ピア関係を作成する"]を参照してください。

+
 `vserver peer create`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/vserver-peer-create.html["ONTAPコマンド リファレンス"^]をご覧ください。

. ジョブ スケジュールを作成します。
+
`job schedule cron create -name _job_name_ -month _month_ -dayofweek _day_of_week_ -day _day_of_month_ -hour _hour_ -minute _minute_`

+
 `-month`、 `-dayofweek`、および `-hour`の場合、 `all`を指定して、それぞれ毎月、曜日ごと、および時間ごとにジョブを実行できます。

+
[NOTE]
====
SVM SnapMirror関係のFlexVolに設定可能な最短スケジュール（RPO）は15分です。SVM SnapMirror関係のFlexGroupボリュームに設定可能な最短スケジュール（RPO）は30分です。

====
+
次の例では、土曜日の午前3：00に実行される `my_weekly`という名前のジョブ スケジュールを作成します：

+
[listing]
----
cluster_dst::> job schedule cron create -name my_weekly -dayofweek "Saturday" -hour 3 -minute 0
----
. カスタム レプリケーション ポリシーを作成します。
+
`snapmirror policy create -vserver _SVM_ -policy _policy_ -type async-mirror|vault|mirror-vault -comment _comment_ -tries transfer_tries -transfer-priority low|normal -is-network-compression-enabled true|false -discard-configs network`

+
次の例は、LIFを除外するSnapMirror DR用のカスタム レプリケーション ポリシーを作成します。

+
[listing]
----
cluster_dst::> snapmirror policy create -vserver svm1 -policy DR_exclude_LIFs -type async-mirror -discard-configs network
----
+
次の例は、LIFを除外するユニファイド レプリケーション用のカスタム レプリケーション ポリシーを作成します。

+
[listing]
----
cluster_dst::> snapmirror policy create -vserver svm1 -policy unified_exclude_LIFs -type mirror-vault -discard-configs network
----
+
[NOTE]
====
今後のフェイルオーバーやフェイルバックのシナリオに備えて、ソース クラスタに同じカスタムSnapMirrorポリシーを作成することを検討してください。

====
+
 `snapmirror policy create`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-policy-create.html["ONTAPコマンド リファレンス"^]を参照してください。

. デスティネーションSVMまたはデスティネーション クラスタから次のコマンドを実行して、レプリケーション関係を作成します。
+
`snapmirror create -source-path _SVM_: -destination-path _SVM_: -type DP|XDP -schedule _schedule_ -policy _policy_ -identity-preserve true|false -discard-configs true|false`

+
[NOTE]
====
 `-source-path`および `-destination-path`オプションでは、SVM名の後にコロン（：）を入力する必要があります。以下の例をご覧ください。

====
+
次の例は、LIFを除外するSnapMirror DR関係を作成します。

+
[listing]
----
cluster_dst::> snapmirror create -source-path svm1: -destination-path svm_backup: -type XDP -schedule my_weekly -policy DR_exclude_LIFs -identity-preserve true
----
+
次の例は、LIFを除外するSnapMirrorユニファイド レプリケーション関係を作成します。

+
[listing]
----
cluster_dst::> snapmirror create -source-path svm1: -destination-path svm_backup: -type XDP -schedule my_weekly -policy unified_exclude_LIFs -identity-preserve true -discard-configs true
----
+
 `snapmirror create`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-create.html["ONTAPコマンド リファレンス"^]を参照してください。

. デスティネーションSVMを停止します。
+
`vserver stop`

+
`_SVM name_`

+
次の例は、svm_backupという名前のデスティネーションSVMを停止します。

+
[listing]
----
cluster_dst::> vserver stop -vserver svm_backup
----
. デスティネーションSVMまたはデスティネーション クラスタから、レプリケーション関係を初期化します。
+
`snapmirror initialize -source-path _SVM_: -destination-path _SVM_:`

+
次の例では、ソース `svm1`とデスティネーション `svm_backup`の関係を初期化します：

+
[listing]
----
cluster_dst::> snapmirror initialize -source-path svm1: -destination-path svm_backup:
----
+
 `snapmirror initialize`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-initialize.html["ONTAPコマンド リファレンス"^]を参照してください。



.終了後の操作
災害発生時のデータ アクセス用に、デスティネーションSVMでネットワークとプロトコルを設定する必要があります。

.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-create.html["snapmirror create"^]
* link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-initialize.html["snapmirror initialize"^]
* link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-policy-create.html["snapmirror policy create"^]

