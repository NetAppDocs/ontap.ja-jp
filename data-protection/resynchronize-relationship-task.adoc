---
permalink: data-protection/resynchronize-relationship-task.html 
sidebar: sidebar 
keywords: resynchronize, replication, relationship, snapmirror, mirror, snapshot copy, restore, disaster recovery, DR, resync, protection relationship, data protection 
summary: デスティネーション ボリュームを書き込み可能にした後、ソース ボリュームとデスティネーション ボリュームに共通のSnapshotコピーが存在しないために更新が失敗した後、または関係のレプリケーション ポリシーを変更する場合は、レプリケーション関係を再同期する必要があります。 
---
= ONTAP SnapMirrorレプリケーション関係を再同期する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
デスティネーション ボリュームを書き込み可能にした後、ソース ボリュームとデスティネーション ボリュームに共通のSnapshotコピーが存在しないために更新が失敗した後、または関係のレプリケーション ポリシーを変更する場合は、レプリケーション関係を再同期する必要があります。

ONTAP 9.8以降では、System Managerを使用して逆再同期処理を実行し、既存の保護関係を削除し、ソース ボリュームとデスティネーション ボリュームの機能を切り替えることができます。ソースを修理または交換する間デスティネーション ボリュームでデータを提供し、その後ソースを更新し、システムの元の構成を再確立できます。

[NOTE]
====
System Managerでは、クラスタ内関係の逆再同期はサポートされません。クラスタ内関係の逆再同期処理は、ONTAP CLIを使用して実行できます。

====
.タスク概要
* 再同期の際にベースライン転送は不要ですが、再同期には時間がかかる場合があります。再同期はオフピークの時間帯に実行することを推奨します。
* ファンアウト構成またはカスケード構成の一部であるボリュームの再同期には時間がかかります。長時間にわたってSnapMirror関係のステータスが「preparing」と表示されることも珍しくありません。
* ONTAP 9.13.1以降、ONTAPは再同期時間を短縮するために、デフォルトでクイック再同期を使用するようになりました。クイック再同期をデフォルトで使用するには、以下の条件を満たす必要があります：
+
** FlexVolボリュームにボリューム上のクローンがありません
** MirrorAllSnapshotsポリシーを使用する場合
+

NOTE:  `-quick-resync`を使用すると、転送されたデータブロックのストレージ効率が削除されるため、再同期デスティネーション ボリュームで追加のスペースが消費される可能性があります。この追加のスペース消費は、再同期デスティネーションでのインラインまたはレプリケーション後のストレージ効率適用の一部として回復されます。

+
 `-quick-resync`パラメータはオプションです。 `snapmirror resync`コマンドで `-quick-resync true|false`パラメータを使用して、クイック再同期を有効または無効にすることができます。

+
 `-quick-resync`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-resync.html["ONTAPコマンド リファレンス"^]を参照してください。





.手順
System ManagerまたはONTAP CLIを使用して、このタスクを実行できます。ONTAP CLIを使用する場合は、デスティネーション ボリュームを書き込み可能にするか、レプリケーション関係を更新するかに関係なく同じ手順です。

[role="tabbed-block"]
====
.System Managerの逆再同期
--
link:make-destination-volume-writeable-task.html["関係を解除する"]してデスティネーションを書き込み可能にした後、関係を逆方向に再同期します：

. デスティネーション クラスタで、*保護 > 関係*をクリックします。
. 元に戻したい切断された関係の上にマウスを移動し、image:icon_kabob.gif["メニューオプションアイコン"]をクリックして、*逆再同期*を選択します。
. *逆再同期関係*ウィンドウで、*逆再同期*をクリックします。
. *関係*の下で、関係の*転送ステータス*を表示して逆再同期の進行状況を監視します。


.次の手順
元のソースが再び使用可能になったら、反転した関係を解除してもう一度逆再同期処理を実行することで、元の関係を再確立できます。逆再同期プロセスにより、データを提供しているサイトから元のソースに変更がすべてコピーされ、元のソースが再び読み取り / 書き込み可能になります。

--
.System Managerの再同期
--
. *保護 > 関係*をクリックします。
. 再同期する関係にマウスを移動し、image:icon_kabob.gif["メニューオプションアイコン"]をクリックして、*解除*を選択します。
. 関係の状態が「切断」と表示されたら、image:icon_kabob.gif["メニューオプションアイコン"]をクリックして*再同期*を選択します。
. *[関係]*で、関係の状態をチェックして再同期の進捗を監視します。再同期が完了すると、状態が「ミラーリング」に変わります。


--
.CLI
--
. ソース ボリュームとデスティネーション ボリュームを再同期します。
+
[source, cli]
----
snapmirror resync -source-path <SVM:volume|cluster://SVM/volume> -destination-path <SVM:volume|cluster://SVM/volume> -type DP|XDP -policy <policy>
----
+

NOTE: このコマンドはデスティネーションSVMまたはデスティネーション クラスタから実行する必要があります。

+
次の例では、 `svm1`のソース ボリューム `volA`と `svm_backup`のデスティネーション ボリューム `volA_dst`間の関係を再同期します：

+
[listing]
----
cluster_dst::> snapmirror resync -source-path svm1:volA -destination-path svm_backup:volA_dst
----
+
 `snapmirror resync`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-resync.html["ONTAPコマンド リファレンス"^]を参照してください。



--
====
.関連情報
* link:resync-svm-destination-task.html["ONTAP SnapMirrorデスティネーションSVM上のデータを再同期する"]

