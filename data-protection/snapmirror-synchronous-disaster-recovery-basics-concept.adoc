---
permalink: data-protection/snapmirror-synchronous-disaster-recovery-basics-concept.html 
sidebar: sidebar 
keywords: snapmirror, synchronous, disaster, recovery 
summary: ONTAP 9.5 以降では、 16GB 以上のメモリを搭載したすべての FAS プラットフォームと AFF プラットフォーム、およびすべての ONTAP Select プラットフォームで SnapMirror Synchronous （ SM-S ）テクノロジがサポートされます。SnapMirror Synchronous テクノロジは、ノード単位のライセンスされる機能で、ボリュームレベルの同期データレプリケーションを提供します。 
---
= SnapMirror Synchronous ディザスタリカバリの基本
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.5 以降では、 16GB 以上のメモリを搭載したすべての FAS プラットフォームと AFF プラットフォーム、およびすべての ONTAP Select プラットフォームで SnapMirror Synchronous （ SM-S ）テクノロジがサポートされます。SnapMirror Synchronous テクノロジは、ノード単位のライセンスされる機能で、ボリュームレベルの同期データレプリケーションを提供します。

この機能は、データ損失ゼロが求められる金融や医療などの業種で、同期レプリケーションに関する規制や国の規定に対応します。

SnapMirror Synchronous レプリケーションの HA ペアあたりの最大処理数は、コントローラのモデルによって異なります。

|===


| プラットフォーム | ONTAP 9.9.1 より前のリリースでは、 HA ペアあたりの SnapMirror 同期処理の数が許容されます | ONTAP 9.9.1 の HA ペアあたりの最大 SnapMirror 同期処理数 | ONTAP 9.10.1 で HA ペアあたり許可される SnapMirror 同期処理の数 | ONTAP 9.11.1のHAペアあたりで許可されているSnapMirror同期処理の数 


 a| 
AFF
 a| 
80
 a| 
160
 a| 
200
 a| 
400



 a| 
FAS
 a| 
40
 a| 
80
 a| 
80
 a| 
80



 a| 
ONTAP Select の場合
 a| 
20
 a| 
40
 a| 
40
 a| 
40

|===


== サポートされている機能

ONTAP 9.10.1 では、次の機能が SnapMirror Synchronous テクノロジでサポートされます。ただし、ソースとデスティネーションのクラスタのすべてのノードで ONTAP 9.10.1 が実行されている必要があります。

* NFSv4.2


ONTAP 9.5 以降では、 SnapMirror Synchronous テクノロジは、 NFSv3 、 FC 、および iSCSI の各プロトコルをサポートしており、いずれのネットワークでもレイテンシは 10 ミリ秒以内に抑えられます。

ONTAP 9.7 の SnapMirror Synchronous テクノロジでは、次の機能がサポートされています。

* アプリケーションで作成されたSnapshotコピーのレプリケーションでは、SnapMirrorラベルがSyncポリシーまたはStrictSyncポリシーに関連付けられたルールに一致するSnapshotコピーのみがレプリケートされます。Snapshot ポリシーを使用して作成され、スケジュール設定された Snapshot コピーはレプリケートされません。
* FC-NVMe
* LUNクローンとNVMeネームスペースクローンには、アプリケーションで作成されたSnapshotコピーに基づくLUNクローンもサポートされます。


ONTAP 9.6 の SnapMirror Synchronous テクノロジでは、次の機能がサポートされます。ただし、ソースクラスタとデスティネーションクラスタのすべてのノードで ONTAP 9.6 が実行されている場合に限ります。

* SVM DR
+
** SnapMirror Synchronous ソースは SVM DR ソースにすることもできます。たとえば、 SM-S を 1 つに、 SVM DR をもう 1 つにしたファンアウト構成などです。
** SM-S は DP ソースのカスケードをサポートしていないため、 SnapMirror Synchronous ソースを SVM DR デスティネーションにすることはできません。デスティネーションクラスタで SVM DR のフリップ再同期を実行する前に、同期関係を解放する必要があります。
** SVM DR は DP ボリュームのレプリケーションをサポートしていないため、 SnapMirror Synchronous デスティネーションを SVM DR ソースにすることはできません。同期ソースの再同期を逆に行うと、 SVM DR にデスティネーションクラスタの DP ボリュームが含まれなくなります。


* NFSv4.0 および NFSv4.1
* SMB 2.0 以降
* 混在プロトコルアクセス（ NFSv3 と SMB ）
* SnapMirror Synchronous 関係のプライマリボリュームに対するウィルス対策
* SnapMirror Synchronous関係のプライマリボリュームに対するハードクォータまたはソフトクォータクォータクォータルールはデスティネーションにレプリケートされないため、クォータデータベースはデスティネーションにレプリケートされません。
* SnapMirror Synchronous 関係のプライマリボリュームに対する FPolicy
* SnapMirror Synchronousミラー-ミラーカスケード：SnapMirror Synchronous関係のデスティネーションボリュームからの関係は非同期SnapMirror関係である必要があります。
* NASのソースボリュームとデスティネーションボリュームの間のタイムスタンプのパリティONTAP 9.5をONTAP 9.6にアップグレードした場合、タイムスタンプはソースボリューム内の新規または変更されたファイルについてのみレプリケートされます。ソースボリューム内の既存のファイルのタイムスタンプは同期されません。
* メタデータ処理頻度の上限の削除
* TLS 1.2 暗号化を使用した機密データ転送時のセキュリティ
* クローンの自動削除




== サポートされない機能です

Synchronous SnapMirror 関係では、次の機能はサポートされません。

* MCC
* SFMoD
* SFCoD
* VVol
* SANとNASの混在アクセスSnapMirror Synchronous関係のプライマリボリュームは、NASデータまたはSANデータを提供できます。SnapMirror Synchronous 関係のプライマリボリュームから SAN アクセスと NAS アクセスの両方を行うことはできません。
* SANアクセスLUNとNVMeアクセスLUNとNVMeネームスペースの混在は、同じボリュームまたはSVMではサポートされていません。
* SnapLock ボリューム
* FlexGroup ボリューム
* FlexCache ボリューム
* SnapRestore
* DP_Optimized （ DPO ）システム
* デスティネーションボリュームでのダンプおよび SMTape を使用したテープバックアップまたはリストア
* ソースボリュームへのテープベースのリストア
* ソースボリュームのしきい値の下限（最小 QoS ）
* ファンアウト構成で確立できる SnapMirror Synchronous 関係は 1 つだけで、ソースボリュームからの残りの関係はすべて非同期 SnapMirror 関係にする必要があります。
* グローバルスロットル




== 動作モード

SnapMirror Synchronous には、使用する SnapMirror ポリシーに基づいて 2 つの動作モードがあります。

* * Syncモード* Syncモードでは'最初にプライマリ・ストレージへのI/Oがセカンダリ・ストレージにレプリケートされますその後、プライマリストレージに I/O が書き込まれ、 I/O の発行元のアプリケーションに確認応答が送信されます何らかの理由でセカンダリストレージへの書き込みが完了しない場合、アプリケーションはプライマリストレージへの書き込みを継続できます。エラー状態が解消されると、 SnapMirror Synchronous テクノロジは自動的にセカンダリストレージを再同期し、プライマリストレージからセカンダリストレージへの同期モードでのレプリケーションを再開します。Sync モードでは、セカンダリレプリケーションに障害問題が発生するまで RPO=0 と非常に低い RTO を実現できます。この場合、 RPO と RTO は不確定になりますが、セカンダリレプリケーションが失敗し、再同期が完了するまでの時間と同じになります。
* * StrictSyncモード* SnapMirror Synchronousは、必要に応じてStrictSyncモードで実行できます。何らかの理由でセカンダリストレージへの書き込みが完了しない場合、アプリケーション I/O が失敗し、プライマリストレージとセカンダリストレージが同一に保たれます。プライマリへのアプリケーション I/O は、 SnapMirror 関係のステータスが「 InSync 」に戻るまで再開されません。プライマリストレージで障害が発生した場合は、フェイルオーバー後にセカンダリストレージでアプリケーション I/O を再開できます。データ損失は発生しません。StrictSync モードの RPO は常にゼロで、 RTO も非常に低く抑えられます。




== 関係のステータス

SnapMirror Synchronous 関係のステータスは、通常の動作中は常に「 InSync 」ステータスになります。何らかの理由で SnapMirror 転送に失敗すると、デスティネーションがソースと同期していない状態になり、ステータスが「 OutofSync 」になります。

SnapMirror Synchronous 関係の場合、システムは一定の間隔で自動的に関係のステータス（「 InSync 」または「 OutofSync 」）をチェックします。関係のステータスが「 OutofSync 」の場合、 ONTAP は自動的に再同期プロセスを開始して、関係を「 InSync 」ステータスに戻します。再同期が実行されるのは、ソースまたはデスティネーションでの計画外のストレージフェイルオーバーやネットワークの停止などによって転送に失敗した場合のみです。「 snapmirror quiesce 」や「 Snapmirror break 」などのユーザが開始した操作では、自動再同期は実行されません。

StrictSync モードでは、 SnapMirror Synchronous 関係のステータスが「 OutofSync 」になると、プライマリボリュームへの I/O 処理がすべて停止します。Sync モードでは SnapMirror Synchronous 関係の OutofSync 状態はプライマリに影響を与えず ' プライマリ・ボリュームでは I/O 処理が許可されます

http://www.netapp.com/us/media/tr-4733.pdf["ネットアップテクニカルレポート 4733 ：『 SnapMirror Synchronous for ONTAP 9.6 』"^]
