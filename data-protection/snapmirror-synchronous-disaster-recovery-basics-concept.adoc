---
permalink: data-protection/snapmirror-synchronous-disaster-recovery-basics-concept.html 
sidebar: sidebar 
keywords: snapmirror, synchronous, disaster, recovery 
summary: ONTAP 9.5 以降では、 16GB 以上のメモリを搭載したすべての FAS プラットフォームと AFF プラットフォーム、およびすべての ONTAP Select プラットフォームで SnapMirror Synchronous （ SM-S ）テクノロジがサポートされます。SnapMirror Synchronous テクノロジは、ノード単位のライセンスされる機能で、ボリュームレベルの同期データレプリケーションを提供します。 
---
= SnapMirror Synchronous ディザスタリカバリの基本
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.5 以降では、 16GB 以上のメモリを搭載したすべての FAS プラットフォームと AFF プラットフォーム、およびすべての ONTAP Select プラットフォームで SnapMirror Synchronous （ SM-S ）テクノロジがサポートされます。SnapMirror Synchronous テクノロジは、ノード単位のライセンスされる機能で、ボリュームレベルの同期データレプリケーションを提供します。

この機能は、データ損失ゼロが求められる金融や医療などの業種で、同期レプリケーションに関する規制や国の規定に対応します。

SnapMirror Synchronous レプリケーションの HA ペアあたりの最大処理数は、コントローラのモデルによって異なります。

次の表に、プラットフォームの種類とONTAP のリリース別にHAペアで実行できるSnapMirror Synchronous処理の数を示します。

|===


| プラットフォーム | ONTAP 9.9.1より前のリリース | ONTAP 9.9.1 | ONTAP 9.10.1 | ONTAP 9.11.1\ONTAP 9.12.1 


 a| 
AFF
 a| 
80
 a| 
160
 a| 
200
 a| 
400



 a| 
FAS
 a| 
40
 a| 
80
 a| 
80
 a| 
80



 a| 
ONTAP Select の場合
 a| 
20
 a| 
40
 a| 
40
 a| 
40

|===


== サポートされている機能

ONTAP 9.12.1では、AFF / ASAプラットフォームでのみ、ノンストップのSnapMirror Synchronous処理（NDO）がサポートされます。ノンストップオペレーションをサポートしているため、ダウンタイムをスケジュールせずに、一般的なメンテナンスタスクを多数実行できます。サポートされる処理には、テイクオーバーとギブバック、およびボリュームの移動があります。ただし、1つのノードが2つのクラスタのそれぞれで稼働している必要があります。

ONTAP 9.10.1では、次の機能がSnapMirror Synchronousテクノロジでサポートされます。ただし、ソースとデスティネーションのクラスタのすべてのノードでONTAP 9.10.1が実行されている必要があります。

* NFSv4.2
* NVMe/FC


ONTAP 9.5 以降では、 SnapMirror Synchronous テクノロジは、 NFSv3 、 FC 、および iSCSI の各プロトコルをサポートしており、いずれのネットワークでもレイテンシは 10 ミリ秒以内に抑えられます。

SnapMirror Synchronousでは、階層化ポリシーが「なし」、「Snapshot」、または「自動」であるFabricPool アグリゲート上のソースボリュームとデスティネーションボリュームがサポートされます。FabricPool アグリゲートのデスティネーションボリュームを「すべて」の階層化ポリシーに設定することはできません。

ONTAP 9.7 の SnapMirror Synchronous テクノロジでは、次の機能がサポートされています。

* 実行時に適切なラベルでSnapshotコピーがタグ付けされている場合、アプリケーションで作成されたSnapshotコピーのレプリケーション `snapshot create` SnapMirror Synchronousは、CLIまたはONTAP APIを使用して、アプリケーションを休止すると、ユーザが作成したSnapshotコピーと外部スクリプトで作成したSnapshotコピーの両方をレプリケートします。Snapshot ポリシーを使用して作成され、スケジュール設定された Snapshot コピーはレプリケートされません。アプリケーションで作成されたSnapshotコピーのレプリケートの詳細については、ナレッジベースの記事： link:https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapMirror/How_to_replicate_application_created_snapshots_with_SnapMirror_Synchronous["アプリケーションで作成されたSnapshotをSnapMirror Synchronousでレプリケートする方法"^]。
* FC-NVMe
* LUNクローンとNVMeネームスペースクローンには、アプリケーションで作成されたSnapshotコピーに基づくLUNクローンもサポートされます。


ONTAP 9.6 の SnapMirror Synchronous テクノロジでは、次の機能がサポートされます。ただし、ソースクラスタとデスティネーションクラスタのすべてのノードで ONTAP 9.6 が実行されている場合に限ります。

* SVM DR
+
** SnapMirror Synchronous ソースは SVM DR ソースにすることもできます。たとえば、 SM-S を 1 つに、 SVM DR をもう 1 つにしたファンアウト構成などです。
** SM-S は DP ソースのカスケードをサポートしていないため、 SnapMirror Synchronous ソースを SVM DR デスティネーションにすることはできません。デスティネーションクラスタで SVM DR のフリップ再同期を実行する前に、同期関係を解放する必要があります。
** SVM DR は DP ボリュームのレプリケーションをサポートしていないため、 SnapMirror Synchronous デスティネーションを SVM DR ソースにすることはできません。同期ソースの再同期を逆に行うと、 SVM DR にデスティネーションクラスタの DP ボリュームが含まれなくなります。


* NFSv4.0 および NFSv4.1
* SMB 2.0 以降
* 混在プロトコルアクセス（NFSv3とSMB）
* SnapMirror Synchronous 関係のプライマリボリュームに対するウィルス対策
* SnapMirror Synchronous関係のプライマリボリュームに対するハードクォータまたはソフトクォータクォータクォータルールはデスティネーションにレプリケートされないため、クォータデータベースはデスティネーションにレプリケートされません。
* SnapMirror Synchronous 関係のプライマリボリュームに対する FPolicy
* SnapMirror Synchronousミラー-ミラーカスケード：SnapMirror Synchronous関係のデスティネーションボリュームからの関係は非同期SnapMirror関係である必要があります。
* NASのソースボリュームとデスティネーションボリュームの間のタイムスタンプのパリティONTAP 9.5をONTAP 9.6にアップグレードした場合、タイムスタンプはソースボリューム内の新規または変更されたファイルについてのみレプリケートされます。ソースボリューム内の既存のファイルのタイムスタンプは同期されません。
* メタデータ処理頻度の上限の削除
* TLS 1.2 暗号化を使用した機密データ転送時のセキュリティ
* クローンの自動削除




== サポートされない機能です

Synchronous SnapMirror 関係では、次の機能はサポートされません。

* 改ざん防止Snapshotコピー
* 整合グループ
* MetroCluster 構成
* SFMoD
* SFCoD
* VVol
* SANアクセスLUNとNVMeアクセスLUNとNVMeネームスペースの混在は、同じボリュームまたはSVMではサポートされていません。
* SnapLock ボリューム
* FlexGroup ボリューム
* FlexCache ボリューム
* SnapRestore
* DP_Optimized （ DPO ）システム
* デスティネーションボリュームでのダンプおよび SMTape を使用したテープバックアップまたはリストア
* ソースボリュームへのテープベースのリストア
* ソースボリュームのしきい値の下限（最小 QoS ）
* ファンアウト構成で確立できる SnapMirror Synchronous 関係は 1 つだけで、ソースボリュームからの残りの関係はすべて非同期 SnapMirror 関係にする必要があります。
* グローバルスロットル




== 動作モード

SnapMirror Synchronous には、使用する SnapMirror ポリシーに基づいて 2 つの動作モードがあります。

* * Syncモード* Syncモードでは'アプリケーションI/O処理はプライマリ・ストレージ・システムとセカンダリ・ストレージ・システムに並行して送信されます何らかの理由でセカンダリストレージへの書き込みが完了しない場合、アプリケーションはプライマリストレージへの書き込みを継続できます。エラー状態が解消されると、 SnapMirror Synchronous テクノロジは自動的にセカンダリストレージを再同期し、プライマリストレージからセカンダリストレージへの同期モードでのレプリケーションを再開します。Sync モードでは、セカンダリレプリケーションに障害問題が発生するまで RPO=0 と非常に低い RTO を実現できます。この場合、 RPO と RTO は不確定になりますが、セカンダリレプリケーションが失敗し、再同期が完了するまでの時間と同じになります。
* * StrictSyncモード* SnapMirror Synchronousは、必要に応じてStrictSyncモードで実行できます。何らかの理由でセカンダリストレージへの書き込みが完了しない場合、アプリケーション I/O が失敗し、プライマリストレージとセカンダリストレージが同一に保たれます。プライマリへのアプリケーションI/Oは、SnapMirror関係がに戻るまで再開されません `InSync` ステータス。プライマリストレージで障害が発生した場合は、フェイルオーバー後にセカンダリストレージでアプリケーション I/O を再開できます。データ損失は発生しません。StrictSync モードの RPO は常にゼロで、 RTO も非常に低く抑えられます。




== 関係のステータス

SnapMirror Synchronous関係のステータスは、常ににあります `InSync` 通常動作中のステータス。何らかの理由でSnapMirror転送に失敗した場合、デスティネーションはソースと同期されておらず、に移動できます `OutofSync` ステータス。

SnapMirror Synchronous関係については、関係のステータスが自動的にチェックされます  `InSync` または `OutofSync`）を一定の間隔で入力します。関係のステータスがの場合 `OutofSync`ONTAP は自動再同期プロセスを自動的にトリガーして、関係をに戻します `InSync` ステータス。再同期が実行されるのは、ソースまたはデスティネーションでの計画外のストレージフェイルオーバーやネットワークの停止などによって転送に失敗した場合のみです。など、ユーザが開始した処理 `snapmirror quiesce` および `snapmirror break` 自動再同期はトリガーしないでください。

関係のステータスがになる場合 `OutofSync` StrictSyncモードのSnapMirror Synchronous関係では、プライマリボリュームに対するI/O処理がすべて停止されます。。 `OutofSync` SyncモードでのSnapMirror Synchronous関係の状態はプライマリへの影響を受けず、プライマリボリュームでI/O処理が許可されます。

.関連情報
http://www.netapp.com/us/media/tr-4733.pdf["ネットアップテクニカルレポート4733：『SnapMirror Synchronous config ration and best bests.』"^]
