---
permalink: disks-aggregates/add-disks-local-tier-aggr-task.html 
sidebar: sidebar 
keywords: add, expand, aggregate, add drives, add disks, add capacity, local tier, add disks to local tier, add disks to aggregate, increase storage, increase aggregate size, local tier, capacity, disk, expand storage, add drives, add disks, add capacity 
summary: ローカル層にディスクを追加して、関連付けられているボリュームにさらに多くのストレージを提供できます。 
---
= ONTAPローカル層に容量を追加する
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
ローカル層にディスクを追加して、関連付けられているボリュームにさらに多くのストレージを提供できるようにすることができます。


NOTE: ONTAP 9.7より前のバージョンでは、System Managerは_ローカル階層_を説明するために_aggregate_という用語を使用しています。ONTAPバージョンに関係なく、ONTAP CLIでは_aggregate_という用語が使用されます。ローカル階層の詳細については、link:../disks-aggregates/index.html["ディスクとローカル階層"]を参照してください。

[role="tabbed-block"]
====
.System Manager（ONTAP 9.8以降）
--

NOTE: ONTAP 9.12.1以降では、System Managerを使用してローカル階層のコミット済み容量を確認し、ローカル階層に追加の容量が必要かどうかを判断できます。link:../concepts/capacity-measurements-in-sm-concept.html["System Managerでの容量の監視"]を参照してください。

.手順
. *Storage > Tiers*を選択します。
. 容量を追加するローカル層の名前の横にあるimage:icon_kabob.gif["メニューオプションアイコン"]を選択します。
. *容量の追加* を選択します。
+

NOTE: 追加できるスペア ディスクがない場合、*容量の追加*オプションは表示されず、ローカル層の容量を増やすことはできません。

. インストールされているONTAPのバージョンに応じて、次の手順を実行します。
+
[cols="30,70"]
|===


| このバージョンの ONTAP がインストールされている場合... | 次の手順を実行します。 


 a| 
ONTAP 9.11.1以降
 a| 
.. ディスクのタイプと数を選択します。
.. 新しいRAIDグループにディスクを追加する場合は、チェック ボックスをオンにします。RAIDの割り当てが表示されます。
.. *保存*を選択します。




 a| 
ONTAP 9.10.1、9.9、または9.8
 a| 
.. ノードに複数のストレージ階層が含まれている場合は、ローカル階層に追加するディスクの数を選択します。ノードに含まれているストレージ階層が1つだけの場合、追加する容量は自動的に概算されます。
.. *追加*を選択します。


|===
. （オプション）このプロセスは完了するまでに多少時間がかかります。バックグラウンドでプロセスを実行する場合は、*Run in Background* を選択します。
. プロセスが完了すると、*Storage > Tiers* のローカル階層情報で増加した容量を確認できます。


--
.System Manager（ONTAP 9.7以前）
--
.手順
. （ONTAP 9.7のみ）*（クラシックバージョンに戻る）*を選択します。
. *Hardware and Diagnostics > Aggregates*を選択します。
. 容量ディスクを追加するローカル階層を選択し、*Actions > Add Capacity*を選択します。
+

NOTE: ローカル層の他のディスクと同じサイズのディスクを追加する必要があります。

. （ONTAP 9.7 のみ）*新しいエクスペリエンスに切り替える*を選択します。
. 新しいローカル層のサイズを確認するには、*ストレージ > 層* を選択します。


--
.CLI
--
.開始する前に
ストレージを追加するローカル層の RAID グループサイズを把握しておく必要があります。

.タスク概要
パーティション化されたディスクをローカル層に追加する手順は、パーティション化されていないディスクを追加する手順と似ています。

ローカル層を拡張する際は、パーティション化されたディスクを追加するのか、パーティション化されていないディスクを追加するのかを意識する必要があります。既存のローカル層にパーティション化されていないドライブを追加すると、既存のRAIDグループのサイズが新しいRAIDグループに継承されるため、必要なパリティディスクの数に影響する可能性があります。パーティション化されたディスクで構成されたRAIDグループにパーティション化されていないディスクを追加すると、新しいディスクはパーティション化され、未使用のスペアパーティションが残ります。

パーティションをプロビジョニングする場合は、両方のパーティションを含むディスクをスペアとして残しておく必要があります。両方のパーティションを含むスペア ディスクがノードに存在しない場合にノードのコントローラが停止すると、問題に関する有用な情報（コア ファイル）をテクニカル サポートが利用できなくなる可能性があります。

.手順
. ローカル層を所有するシステム上の使用可能な予備ストレージを表示します：
+
`storage aggregate show-spare-disks -original-owner _node_name_`

+
 `-is-disk-shared`パラメータを使用すると、パーティション化されたドライブのみ、またはパーティション化されていないドライブのみを表示できます。

+
[listing]
----
cl1-s2::> storage aggregate show-spare-disks -original-owner cl1-s2 -is-disk-shared true

Original Owner: cl1-s2
 Pool0
  Shared HDD Spares
                                                            Local    Local
                                                             Data     Root Physical
 Disk                        Type     RPM Checksum         Usable   Usable     Size Status
 --------------------------- ----- ------ -------------- -------- -------- -------- --------
 1.0.1                       BSAS    7200 block           753.8GB  73.89GB  828.0GB zeroed
 1.0.2                       BSAS    7200 block           753.8GB       0B  828.0GB zeroed
 1.0.3                       BSAS    7200 block           753.8GB       0B  828.0GB zeroed
 1.0.4                       BSAS    7200 block           753.8GB       0B  828.0GB zeroed
 1.0.8                       BSAS    7200 block           753.8GB       0B  828.0GB zeroed
 1.0.9                       BSAS    7200 block           753.8GB       0B  828.0GB zeroed
 1.0.10                      BSAS    7200 block                0B  73.89GB  828.0GB zeroed
2 entries were displayed.
----
. ローカル層の現在の RAID グループを表示します：
+
[source, cli]
----
storage aggregate show-status <aggr_name>
----
+
[listing]
----
cl1-s2::> storage aggregate show-status -aggregate data_1

Owner Node: cl1-s2
 Aggregate: data_1 (online, raid_dp) (block checksums)
  Plex: /data_1/plex0 (online, normal, active, pool0)
   RAID Group /data_1/plex0/rg0 (normal, block checksums)
                                              Usable Physical
     Position Disk        Pool Type     RPM     Size     Size Status
     -------- ----------- ---- ----- ------ -------- -------- ----------
     shared   1.0.10        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.5         0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.6         0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.11        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.0         0   BSAS    7200  753.8GB  828.0GB (normal)
5 entries were displayed.
----
. アグリゲートへのストレージの追加をシミュレートします。
+
[source, cli]
----
storage aggregate add-disks -aggregate <aggr_name> -diskcount <number_of_disks_or_partitions> -simulate true
----
+
実際にストレージをプロビジョニングしなくてもストレージの追加結果を確認できます。シミュレートしたコマンドから警告が表示された場合は、コマンドを調整してシミュレーションを繰り返すことができます。

+
[listing]
----
cl1-s2::> storage aggregate add-disks -aggregate aggr_test -diskcount 5 -simulate true

Disks would be added to aggregate "aggr_test" on node "cl1-s2" in the
following manner:

First Plex

  RAID Group rg0, 5 disks (block checksum, raid_dp)
                                                      Usable Physical
    Position   Disk                      Type           Size     Size
    ---------- ------------------------- ---------- -------- --------
    shared     1.11.4                    SSD         415.8GB  415.8GB
    shared     1.11.18                   SSD         415.8GB  415.8GB
    shared     1.11.19                   SSD         415.8GB  415.8GB
    shared     1.11.20                   SSD         415.8GB  415.8GB
    shared     1.11.21                   SSD         415.8GB  415.8GB

Aggregate capacity available for volume use would be increased by 1.83TB.
----
. アグリゲートにストレージを追加します。
+
[source, cli]
----
storage aggregate add-disks -aggregate <aggr_name> -raidgroup new -diskcount <number_of_disks_or_partitions>
----
+
Flash Pool ローカル階層を作成するときに、ローカル階層とは異なる checksum を持つディスクを追加する場合、または混合 checksum ローカル階層にディスクを追加する場合は、 `-checksumstyle`パラメータを使用する必要があります。

+
Flash Pool ローカル層にディスクを追加する場合は、 `-disktype`パラメータを使用してディスクタイプを指定する必要があります。

+
 `-disksize`パラメータを使用して、追加するディスクのサイズを指定できます。指定されたサイズとほぼ同じサイズのディスクのみがローカル階層への追加対象として選択されます。

+
[listing]
----
cl1-s2::> storage aggregate add-disks -aggregate data_1 -raidgroup new -diskcount 5
----
. ストレージが正常に追加されたことを確認します。
+
[source, cli]
----
storage aggregate show-status -aggregate <aggr_name>
----
+
[listing]
----
cl1-s2::> storage aggregate show-status -aggregate data_1

Owner Node: cl1-s2
 Aggregate: data_1 (online, raid_dp) (block checksums)
  Plex: /data_1/plex0 (online, normal, active, pool0)
   RAID Group /data_1/plex0/rg0 (normal, block checksums)
                                                              Usable Physical
     Position Disk                        Pool Type     RPM     Size     Size Status
     -------- --------------------------- ---- ----- ------ -------- -------- ----------
     shared   1.0.10                       0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.5                        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.6                        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.11                       0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.0                        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.2                        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.3                        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.4                        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.8                        0   BSAS    7200  753.8GB  828.0GB (normal)
     shared   1.0.9                        0   BSAS    7200  753.8GB  828.0GB (normal)
10 entries were displayed.
----
. ルート パーティションとデータ パーティションの両方を含む少なくとも1本のスペア ドライブがノードに存在することを確認します。
+
[source, cli]
----
storage aggregate show-spare-disks -original-owner <node_name>
----
+
[listing]
----
cl1-s2::> storage aggregate show-spare-disks -original-owner cl1-s2 -is-disk-shared true

Original Owner: cl1-s2
 Pool0
  Shared HDD Spares
                                                            Local    Local
                                                             Data     Root Physical
 Disk                        Type     RPM Checksum         Usable   Usable     Size Status
 --------------------------- ----- ------ -------------- -------- -------- -------- --------
 1.0.1                       BSAS    7200 block           753.8GB  73.89GB  828.0GB zeroed
 1.0.10                      BSAS    7200 block                0B  73.89GB  828.0GB zeroed
2 entries were displayed.
----


--
====
.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-add-disks.html["storage aggregate add-disks"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-show-spare-disks.html["storage aggregate show-spare-disks"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-show-status.html["storage aggregate show-status"^]

