---
permalink: disks-aggregates/create-aggregates-auto-provision-task.html 
sidebar: sidebar 
keywords: ontap 9, create, aggregates, auto-provision, add, local tier, automatic, automatically 
summary: ローカル階層を自動的に追加する（自動プロビジョニングを使用してアグリゲートを作成する）ためのベストプラクティスがお勧めONTAP の方法である場合は、推奨される方法を使用し、ONTAP でローカル階層を追加するようにしてください。 
---
= ローカル階層を自動的に追加する（自動プロビジョニングを使用してアグリゲートを作成する）
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ローカル階層を自動的に追加する（自動プロビジョニングを使用してアグリゲートを作成する）ためのベストプラクティスがONTAP 環境に適している場合は、推奨事項を受け入れて、ONTAP にローカル階層を追加させることができます。

実行するプロセスは、System ManagerまたはCLIを使用するインターフェイスによって異なります。

[role="tabbed-block"]
====
.System Manager の略
--
* System Managerを使用して、ローカル階層を自動的に追加します。*

.手順
. System Manager で、 * Storage > Tiers * をクリックします。
. [*Ties]ページで、をクリックします image:icon-add-local-tier.png["ローカル階層の追加アイコン"] 新しいローカル階層を作成するには、次の手順を実行し
+
Add Local Tier *ページには、ノード上に作成できるローカル階層と使用可能なストレージが推奨数で表示されます。

. 推奨構成の詳細を表示するには、* Recommended details *をクリックします。
+
ONTAP 9.8以降のSystem Managerでは、次の情報が表示されます。

+
** *ローカル階層名*（ONTAP 9.10.1で始まるローカル階層名を編集できます）
** * ノード名 *
** *使用可能なサイズ*
** *ストレージの種類*


+
ONTAP 9.10.1以降では、追加情報 が表示されます。

+
** *ディスク*：ディスクの数、サイズ、タイプが表示されます
** *レイアウト*：RAIDグループのレイアウトを示します。ディスクがパリティかデータか、どのスロットが未使用かなどが含まれます。
** *スペアディスク*：ノード名、スペアディスクの数とサイズ、ストレージの種類が表示されます。


. 次のいずれかの手順を実行します。
+
|===


| 実行する処理 | 操作 


 a| 
System Managerからの推奨事項を承認します。
 a| 
に進みます <<step5-okm-encrypt,暗号化用にオンボードキーマネージャを設定する手順>>。



 a| 
ローカル階層を手動で設定し、System Managerの推奨事項を使用して「*_ not_*」を設定します。
 a| 
に進みます link:create-aggregates-manual-task.html["ローカル階層を手動で追加（アグリゲートの作成）します"]：

** ONTAP 9.10.1以前の場合は、次の手順に従ってCLIを使用します。
** ONTAP 9.11.1以降では、System Managerの使用手順に従います。


|===
. [[step5-okm-encrypt]]（オプション）：オンボードキーマネージャがインストールされている場合は、暗号化用に設定できます。Configure Onboard Key Manager for encryption *チェックボックスをオンにします。
+
.. パスフレーズを入力します。
.. パスフレーズを確認のためにもう一度入力します。
.. パスフレーズは、あとでシステムのリカバリが必要になったときのために保存しておきます。
.. あとで使用できるように、キーデータベースをバックアップしておきます。


. 保存*をクリックしてローカル階層を作成し、ストレージ解決策 に追加します。


--
.CLI の使用
--
* CLIを使用して、自動プロビジョニング*でアグリゲートを作成してください

アグリゲート・レイアウトの推奨事項を生成するには、storage aggregate auto-provisionコマンドを実行します。ONTAP の推奨事項を確認および承認したあとでアグリゲートを作成できます。

.必要なもの
9.2 以降がクラスタで実行されている必要があります。 ONTAP

.このタスクについて
「 storage aggregate auto-provision 」コマンドで生成されたデフォルトの概要には、名前や使用可能なサイズなど、作成が推奨されるアグリゲートが表示されます。リストを確認し、プロンプトに従って推奨されるアグリゲートを作成するかどうかを判断できます。

詳細な要約を表示するには、「 -verbose 」オプションを使用します。このオプションを使用すると、次のレポートが表示されます。

* 作成する新しいアグリゲートのノードごとの概要、検出されたスペア、アグリゲートの作成後の残りのスペアディスクとパーティション
* 作成する新しいデータアグリゲートと、使用されるディスクおよびパーティションの数
* 作成する新しいデータアグリゲートにおけるスペアディスクとパーティションの使用方法を示す RAID グループのレイアウト
* アグリゲートの作成後の残りのスペアディスクとパーティションの詳細


自動プロビジョニング方法に精通していて、環境の準備が整っている場合は、「 -skip-confirmation 」オプションを使用すると、表示と確認を行わずに推奨されるアグリゲートを作成できます。「 storage aggregate auto-provision 」コマンドは、 CLI セッションの「 -confirmations 」設定の影響を受けません。

「 storage aggregate auto-provision 」のマニュアルページには、アグリゲートのレイアウトに関する推奨事項に関する詳細が記載されています。

.手順
. 必要な表示オプションを指定して「 storage aggregate auto-provision 」コマンドを実行します。
+
** オプションなし：標準の概要を表示します
** 「 -verbose 」オプション：詳細な要約を表示します
** --skip-confirmation`option ：表示または確認を行わずに、推奨されるアグリゲートを作成します


. 次のいずれかの手順を実行します。
+
[cols="35,65"]
|===


| 実行する処理 | 操作 


 a| 
ONTAP からの推奨事項を受け入れます。
 a| 
推奨されるアグリゲートの表示を確認し、プロンプトに従って推奨されるアグリゲートを作成します。

[listing]
----
Do you want to create recommended aggregates? {y|n}:y

Info: Creating node1_SSD_1 ...
      Creating node2_SSD_1 ...
----


 a| 
ローカル階層を手動で設定し、ONTAP からの推奨事項を使用する*_ not_*。
 a| 
に進みます link:create-aggregates-manual-task.html["ローカル階層を手動で追加（アグリゲートの作成）します"]。

|===


--
====
.関連情報
http://docs.netapp.com/ontap-9/topic/com.netapp.doc.dot-cm-cmpr/GUID-5CB10C70-AC11-41C0-8C16-B4D0DF916E9B.html["ONTAP 9コマンド"^]
