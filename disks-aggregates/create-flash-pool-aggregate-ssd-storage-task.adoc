---
permalink: disks-aggregates/create-flash-pool-aggregate-ssd-storage-task.html 
sidebar: sidebar 
keywords: create, flash pool, aggregate, local tier, ssd, storage pool, allocation units 
summary: Flash Poolのローカル階層（アグリゲート）を設定するには、SSDストレージプールから既存のHDDローカル階層に1つ以上の割り当て単位を追加します。  
---
= SSDストレージプールの割り当て単位を使用してFlash Poolローカル階層（アグリゲート）を作成します
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Flash Poolのローカル階層（アグリゲート）を設定するには、SSDストレージプールから既存のHDDローカル階層に1つ以上の割り当て単位を追加します。

ONTAP 9.12.1以降では、再設計したSystem Managerを使用して、ストレージプール割り当て単位を使用するFlash Poolローカル階層を作成できます。

.必要なもの
* Flash Poolローカル階層に変換する、HDDで構成された有効なローカル階層を特定しておく必要があります。
* ローカル階層に関連付けられたボリュームが書き込みキャッシュに対応しているかどうかを確認し、対応していない場合は必要な手順を実行して問題を解決しておく必要があります。
* このFlash Poolローカル階層にSSDキャッシュを提供するためのSSDストレージプールを作成しておく必要があります。
+
使用するストレージプールのすべての割り当て単位が、Flash Poolのローカル階層を所有するノードに所有されている必要があります。

* ローカル階層に追加するキャッシュの容量を決めておく必要があります。
+
ローカル階層にキャッシュを追加するには、割り当て単位を使用します。ストレージプールに余裕がある場合は、ストレージプールに SSD を追加することで割り当て単位のサイズをあとから拡張できます。

* SSD キャッシュで使用する RAID タイプを決めておく必要があります。
+
SSDストレージプールからローカル階層にキャッシュを追加したあとで、キャッシュRAIDグループのRAIDタイプを変更することはできません。

* システムの最大キャッシュサイズを決めて、ローカル階層にSSDキャッシュを追加してもそれを超える原因 は作成されないことを確認しておく必要があります。
+
合計キャッシュサイズに追加されるキャッシュの量は、を使用して確認できます `storage pool show` コマンドを実行します

* Flash Poolローカル階層の構成要件を確認しておく必要があります。


.このタスクについて
キャッシュのRAIDタイプをHDD RAIDグループと異なるタイプにする場合は、SSDの容量を追加するときにキャッシュのRAIDタイプを指定する必要があります。ローカル階層にSSDの容量を追加したあとで、キャッシュのRAIDタイプを変更することはできません。

ローカル階層にSSDキャッシュを追加してFlash Poolローカル階層を作成したあとで、SSDキャッシュを削除してローカル階層を元の構成に戻すことはできません。

[role="tabbed-block"]
====
.System Manager の略
--
ONTAP 9.12.1以降では、System Managerを使用してSSDストレージプールにSSDを追加できます。

.手順
. [*ストレージ>階層*]をクリックし、既存のローカルHDDストレージ階層を選択します。
. をクリック image:icon_kabob.gif["メニューオプションアイコン"] し、*[Flash Poolキャッシュの追加]*を選択します。
. ［*ストレージプールを使用する*］を選択します。
. ストレージプールを選択します。
. キャッシュサイズとRAID構成を選択してください。
. [ 保存（ Save ） ] をクリックします。
. ストレージ階層を再度特定し、をクリックします image:icon_kabob.gif["メニューオプションアイコン"]。
. 「* More Details」を選択し、Flash Poolの表示が「* Enabled」になっていることを確認します。


--
.CLI の使用
--
.手順
. アグリゲートを Flash Pool アグリゲートとして使用できるように指定します。
+
`storage aggregate modify -aggregate _aggr_name_ -hybrid-enabled true`

+
この手順が正常に完了しない場合は、ターゲットアグリゲートが書き込みキャッシュに対応しているかどうかを確認してください。

. 使用可能な SSD ストレージプールの割り当て単位を表示します。
+
`storage pool show-available-capacity`

. アグリゲートに SSD の容量を追加します。
+
`storage aggregate add _aggr_name_ -storage-pool _sp_name_ -allocation-units _number_of_units_`

+
キャッシュのRAIDタイプをHDD RAIDグループと異なるタイプにする場合は、このコマンドを入力するときに、を使用してRAIDタイプを変更する必要があります `raidtype` パラメータ

+
新しい RAID グループを指定する必要はありません。 ONTAP では、 HDD RAID グループとは別の RAID グループに SSD キャッシュが自動的に配置されます。

+
キャッシュの RAID グループサイズを設定することはできません。このサイズは、ストレージプール内の SSD の数によって決まります。

+
キャッシュがアグリゲートに追加され、アグリゲートが Flash Pool アグリゲートになります。アグリゲートに追加された各割り当て単位は独自の RAID グループになります。

. SSD キャッシュが存在すること、およびそのサイズを確認します。
+
`storage aggregate show _aggregate_name_`

+
キャッシュのサイズは、に表示されます `Total Hybrid Cache Size`。



--
====
.関連情報
https://www.netapp.com/pdf.html?item=/media/19681-tr-4070.pdf["ネットアップテクニカルレポート 4070 ：『 Flash Pool Design and Implementation Guide 』"^]
