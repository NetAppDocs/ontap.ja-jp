---
permalink: disks-aggregates/determine-space-usage-aggregate-concept.html 
sidebar: sidebar 
keywords: space, usage, aggregate, local tier, volume 
summary: 1 つ以上のローカル階層にあるすべてのボリュームで使用されているスペースの量を表示して、より多くのスペースを解放するためのアクションを実行できます。 
---
= ONTAPローカル階層のスペース使用量を確認する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
1 つ以上のローカル階層にあるすべてのボリュームで使用されているスペースの量を表示して、より多くのスペースを解放するためのアクションを実行できます。


NOTE: ONTAP 9.7より前のバージョンでは、System Managerは_ローカル階層_を説明するために_aggregate_という用語を使用しています。ONTAPバージョンに関係なく、ONTAP CLIでは_aggregate_という用語が使用されます。ローカル階層の詳細については、link:../disks-aggregates/index.html["ディスクとローカル階層"]を参照してください。

WAFLは、ローカル層レベルのメタデータとパフォーマンスのために、総ディスク容量の一定割合を予約します。ローカル層のボリュームの維持に使用される容量はWAFL予約領域から使用され、変更することはできません。

30 TB 未満のローカル層では、WAFLはローカル層レベルのメタデータとパフォーマンス用に合計ディスク領域の10%を予約します。

ONTAP 9.12.1以降、30TB以上のローカル階層において、ローカル階層レベルのメタデータとパフォーマンス用に予約済みのディスクスペースが削減され、ローカル階層で使用可能なスペースが5%増加します。このスペース削減の可用性は、プラットフォームとONTAPのバージョンによって異なります。

[cols="30,30,40"]
|===
| 30 TB以上のローカル階層でONTAPによって予約されているディスク容量 | 適用されるプラットフォーム | ONTAPバージョン 


| 5% | すべてのAFFプラットフォームとFASプラットフォーム | ONTAP 9.14.1以降 


| 5% | AFFプラットフォームとFAS500fプラットフォーム | ONTAP 9.12.1以降 


| 10% | すべてのプラットフォーム | ONTAP 9.11.1以降 
|===
 `aggregate show-space`コマンドを使用すると、1つまたは複数のローカル階層にあるすべてのボリュームのスペース使用量を表示できます。これにより、どのボリュームがそれを含むローカル階層で最も多くのスペースを消費しているかを把握し、より多くのスペースを解放するための対策を講じることができます。

ローカル層の使用済みスペースは、その層に含まれるFlexVolボリュームの使用済みスペースに直接影響されます。ボリューム内のスペースを増やすために行った対策も、ローカル層のスペースに影響します。


NOTE: ONTAP 9.15.1以降では、2つの新しいメタデータカウンタが利用可能になりました。既存のいくつかのカウンタへの変更と合わせて、割り当てられたユーザデータの量をより明確に把握できるようになります。詳細については、link:../volumes/determine-space-usage-volume-aggregate-concept.html["ボリュームまたはローカル階層のスペース使用量を確認する"]を参照してください。

 `aggregate show-space`コマンド出力には次の行が含まれます：

* *ボリューム フットプリント*
+
ローカル階層内のすべてのボリュームフットプリントの合計。これには、含まれるローカル階層内のすべてのボリュームのすべてのデータとメタデータによって使用または予約されているすべてのスペースが含まれます。

* *Aggregate メタデータ*
+
割り当てビットマップやinodeファイルなど、ローカル階層に必要なファイル システム メタデータの合計。

* *スナップショットリザーブ*
+
ボリューム サイズに基づいて、ローカル階層 Snapshot 用に予約されているスペースの量。使用済みスペースとみなされ、ボリュームまたはローカル階層のデータやメタデータには使用できません。

* *Snapshot Reserve使用不可*
+
ローカル層に関連付けられたボリュームによって使用されているため、ローカル層スナップショットには使用できない、ローカル層スナップショット リザーブ用に元々割り当てられていたスペースの量。ローカル層スナップショット リザーブがゼロ以外のローカル層でのみ発生します。

* *合計使用量*
+
ボリューム、メタデータ、または Snapshot によってローカル階層で使用または予約されているすべてのスペースの合計。

* *総物理使用量*
+
現在データに使用されている容量（将来の使用のために予約されている容量ではありません）。ローカル層のSnapshotによって使用される容量も含まれます。



次の例は、Snapshotリザーブが5%のローカル階層の `aggregate show-space`コマンド出力を示しています。Snapshotリザーブが0の場合、この行は表示されません。

....
cluster1::> storage aggregate show-space

						Aggregate : wqa_gx106_aggr1

      Feature                                   Used      Used%
      --------------------------------    ----------     ------
      Volume Footprints                      101.0MB         0%
      Aggregate Metadata                       300KB         0%
      Snapshot Reserve                        5.98GB         5%

      Total Used                              6.07GB         5%
      Total Physical Used                    34.82KB         0%
....
.関連情報
* link:https://kb.netapp.com/Advice_and_Troubleshooting/Data_Storage_Software/ONTAP_OS/Space_Usage["ナレッジベースの記事：スペースの使用"^]
* link:https://www.netapp.com/blog/free-up-storage-capacity-upgrade-ontap/["Free up 5% of your storage capacity by upgrading to ONTAP 9.12.1"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-show-space.html["storage aggregate show-space"^]

