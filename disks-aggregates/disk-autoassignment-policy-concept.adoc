---
permalink: disks-aggregates/disk-autoassignment-policy-concept.html 
sidebar: sidebar 
keywords: disk, auto-assign, spare, policy, automatic, assignment, disk ownership 
summary: 未割り当てディスクの自動割り当てはデフォルトで有効になっています。ディスク所有権の自動割り当ては、HAペア初期化の10分後、および通常のシステム運用中には5分間隔で実行されます。 
---
= ONTAPディスク所有権の自動割り当てについて学習します
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
未割り当てディスクの自動割り当てはデフォルトで有効になっています。ディスク所有権の自動割り当ては、HAペア初期化の10分後、および通常のシステム運用中には5分間隔で実行されます。

HA ペアに新しいディスクを追加する場合、たとえば、障害が発生したディスクを交換する場合、「スペア不足」メッセージに応答する場合、または容量を追加する場合、デフォルトの自動割り当てポリシーにより、ディスクの所有権がスペアとしてノードに割り当てられます。

デフォルトの自動割り当てポリシーは、プラットフォーム固有の特性（DS460Cシェルフのみが含まれるHAペアの場合はDS460Cシェルフ）に基づいており、ディスク所有権の割り当てには次のいずれかの方法（ポリシー）を使用します。

|===


| 割り当て方法 | ノード割り当てへの影響 | 割り当て方法がデフォルトのプラットフォーム構成 


 a| 
ベイ
 a| 
偶数番号のベイはノードAに、奇数番号のベイはノードBに割り当てられます。
 a| 
1台の共有シェルフを使用するHAペア構成内のエントリレベル システム。



 a| 
シェルフ
 a| 
シェルフ内のすべてのディスクがノードAに割り当てられます。
 a| 
1つのスタックに複数のシェルフが含まれるHAペア構成、およびノードごとに1つのスタックに複数のシェルフが含まれるMetroCluster構成内の、エントリレベル システム。



 a| 
スプリット シェルフ

このポリシーは、適用可能なプラットフォームおよびシェルフ構成の `storage disk option`コマンドの `-autoassign-policy`パラメータの「`default`」値に該当します。
 a| 
シェルフ左側のディスクはノードAに、右側のディスクはノードBに割り当てられます。工場からの出荷時、HAペアのシェルフには、シェルフの端から中央に向かって部分的にディスクが搭載されています。
 a| 
ほとんどのAFFプラットフォームと一部のMetroCluster構成。



 a| 
スタック
 a| 
スタック内のすべてのディスクがノードAに割り当てられます。
 a| 
エントリレベルのスタンドアロン システムおよびその他のすべての構成。



 a| 
ハーフドロワー

このポリシーは、適用可能なプラットフォームおよびシェルフ構成の `storage disk option`コマンドの `-autoassign-policy`パラメータの「`default`」値に該当します。
 a| 
DS460Cドロワーの左半分（ドライブ ベイ0～5）のすべてのドライブがノードAに割り当てられ、ドロワーの右半分（ドライブ ベイ6～11）のすべてのドライブがノードBに割り当てられます。

DS460Cシェルフだけが搭載されているHAペアを初期化する場合、ディスク所有権の自動割り当てはサポートされません。ハーフドロワーのポリシーに従って、ルート パーティションが設定されたルート / コンテナ ドライブが含まれるドライブに所有権を手動で割り当てる必要があります。
 a| 
DS460Cシェルフだけが搭載されているHAペア（HAペアの初期化（ブート）後）

HAペアのブート後、ディスク所有権の自動割り当てが自動的に有効になり、ハーフドロワーのポリシーを使用して、残りのドライブ（ルート パーティションが含まれるルート ドライブ / コンテナ ドライブを除く）と今後追加されるすべてのドライブに所有権が割り当てられます。

HAペアに他のシェルフ モデルに加えてDS460Cシェルフが含まれている場合は、ハーフドロワーのポリシーは使用されません。使用されるデフォルト ポリシーは、プラットフォーム固有の特性によって決まります。

|===
自動割り当ての設定と変更：

*  `storage disk option show`コマンドで現在の自動割り当て設定（オン/オフ）を表示できます。
*  `storage disk option modify`コマンドを使用して自動割り当てを無効にできます。
* デフォルトの自動割り当てポリシーが環境に適していない場合は、 `storage disk option modify`コマンドの `-autoassign-policy`パラメータを使用して、ベイ、シェルフ、またはスタックの割り当て方法を指定（変更）できます。
+
link:configure-auto-assignment-disk-ownership-task.html["ディスク所有権の自動割り当ての設定変更"]方法を学びましょう。

+
[NOTE]
====
ハーフドロワーおよびスプリットシェルフでは、デフォルトの自動割り当てポリシーは一意です。これは、ユーザがポリシー（ベイ、シェルフ、スタック）を設定できないためです。

====


アドバンスト ドライブ パーティショニング（ADP）システムで、収容数が半分のシェルフで自動割り当てを機能させるには、シェルフのタイプに基づいて正しいシェルフ ベイにドライブを取り付ける必要があります。

* DS460Cシェルフ以外のシェルフの場合は、左端と右端から中央に向かって均等にドライブを取り付けます。たとえば、DS224Cシェルフのベイ0～5に6本のドライブ、ベイ18～23に6本のドライブを搭載するといった方法になります。
* DS460Cシェルフの場合は、各ドロワーの前列（ドライブ ベイ0、3、6、9）にドライブを取り付けます。残りのドライブについては、前列から後列に向かって順にドロワーを埋めるやり方で、各ドロワーに均等にドライブを分散させます。列がドライブで埋まりきらない場合は、ドライブがドロワーの左右に均等に配置されるように2本ずつ取り付けます。
+
ドライブを各ドロワーの前列に取り付けることで、適切な通気が確保され、過熱を防ぐことができます。



[NOTE]
====
収容数が半分のシェルフで正しいシェルフ ベイにドライブが取り付けられていない場合、コンテナ ドライブに障害が発生して交換したときに、ONTAPは所有権を自動割り当てできません。この場合は、新しいコンテナ ドライブの割り当てを手動で行う必要があります。コンテナ ドライブに所有権を割り当てると、必要なドライブ パーティショニングとパーティショニング割り当てがONTAPによって自動的に処理されます。

====
自動割り当てが機能しない状況では、 `storage disk assign`コマンドを使用してディスク所有権を手動で割り当てる必要があります：

* 自動割り当てを無効にすると、手動で新しいディスクをノードに割り当てるまで、新しいディスクをスペアとして使用することはできません。
* ディスクの自動割り当てを行う際に異なる所有権が必要なスタックまたはシェルフが複数ある場合は、それぞれのスタックまたはシェルフで所有権の自動割り当てが機能するように、各スタックまたはシェルフでいずれかのディスクを手動で割り当てておく必要があります。
* 自動割り当てが有効になっている状態で、アクティブ ポリシーで指定されていないノードにドライブを1本手動で割り当てると、自動割り当てが停止してEMSメッセージが表示されます。


link:manual-assign-disks-ownership-manage-task.html["パーティショニングされていないディスクのディスク所有権の手動割り当て"]方法を学びましょう。

link:manual-assign-ownership-partitioned-disks-task.html["パーティション化されたディスクのディスク所有権を手動で割り当てる"]方法を学びましょう。

.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/storage-disk-assign.html["storage disk assign"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-disk-option-modify.html["storage disk option modify"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-disk-option-show.html["storage disk option show"^]

