---
permalink: disks-aggregates/setup-active-passive-config-root-data-data-task.html 
sidebar: sidebar 
keywords: root-data-data, partitioning, disks, active-passive 
summary: HAペアが工場出荷時にルート・データ・データ・パーティショニングを使用するように設定されている場合、データパーティションの所有権はペアの両ノード間で分割され、アクティブ / アクティブ構成で使用されます。HAペアをアクティブ / パッシブ構成で使用する場合は、データローカル層を作成する前にパーティションの所有権を更新する必要があります。 
---
= ルートデータデータパーティショニングを使用してONTAPノードにアクティブ / パッシブ構成を設定する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
HAペアが工場出荷時にルート・データ・データ・パーティショニングを使用するように設定されている場合、データパーティションの所有権はペアの両ノード間で分割され、アクティブ / アクティブ構成で使用されます。HAペアをアクティブ / パッシブ構成で使用する場合は、データローカル層を作成する前にパーティションの所有権を更新する必要があります。

.開始する前に
* アクティブ ノードおよびパッシブ ノードとして指定するノードを決めておく必要があります。
* HAペアでストレージ フェイルオーバーを設定する必要があります。


.タスク概要
このタスクは、2つのノード（ノードAとノードB）で実行されます。

この手順は、パーティション化されたディスクからデータ ローカル層が作成されていないノード向けに設計されています。

link:https://kb.netapp.com/Advice_and_Troubleshooting/Data_Storage_Software/ONTAP_OS/What_are_the_rules_for_Advanced_Disk_Partitioning%3F["高度なディスク パーティション"^]について学びましょう。

.手順
コマンドはすべてクラスタ シェルで入力します。

. データ パーティションの現在の所有権を確認します。
+
`storage aggregate show-spare-disks -original-owner _passive_node_name_ -fields local-usable-data1-size, local-usable-data2-size`

+
出力から、1つのノードが半数のデータ パーティションを所有し、もう1つのノードが残り半数のデータ パーティションを所有していることがわかります。すべてのデータ パーティションがスペアである必要があります。

. advanced権限レベルに切り替えます。
+
`set advanced`

. パッシブ ノードとして指定するノードが所有する各data1パーティションをアクティブ ノードに割り当てます。
+
`storage disk assign -force -data1 -owner _active_node_name_ -disk _disk_name_`

+
パーティションをディスク名の一部に含める必要はありません。

. パッシブ ノードとして指定するノードが所有する各data2パーティションをアクティブ ノードに割り当てます。
+
`storage disk assign -force -data2 -owner _active_node_name_ -disk _disk_name_`

+
パーティションをディスク名の一部に含める必要はありません。

. すべてのパーティションがアクティブ ノードに割り当てられていることを確認します。
+
`storage aggregate show-spare-disks`

+
[listing]
----
cluster1::*> storage aggregate show-spare-disks

Original Owner: cluster1-01
 Pool0
  Partitioned Spares
                                                            Local    Local
                                                             Data     Root Physical
 Disk                        Type     RPM Checksum         Usable   Usable     Size
 --------------------------- ----- ------ -------------- -------- -------- --------
 1.0.0                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.1                       BSAS    7200 block           753.8GB  73.89GB  828.0GB
 1.0.2                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.3                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.4                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.5                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.6                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.7                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.8                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.9                       BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.10                      BSAS    7200 block           753.8GB       0B  828.0GB
 1.0.11                      BSAS    7200 block           753.8GB       0B  828.0GB

Original Owner: cluster1-02
 Pool0
  Partitioned Spares
                                                            Local    Local
                                                             Data     Root Physical
 Disk                        Type     RPM Checksum         Usable   Usable     Size
 --------------------------- ----- ------ -------------- -------- -------- --------
 1.0.8                       BSAS    7200 block                0B  73.89GB  828.0GB
13 entries were displayed.
----
+
cluster1-02が引き続きスペア ルート パーティションを所有していることに注意してください。

. admin権限に戻ります。
+
`set admin`

. データ アグリゲートを作成します。少なくとも1つのデータ パーティションをスペアとして残しておいてください。
+
`storage aggregate create _new_aggr_name_ -diskcount _number_of_partitions_ -node _active_node_name_`

+
データ アグリゲートが作成され、アクティブ ノードがそのアグリゲートを所有します。

. あるいは、RAID グループのレイアウトとスペアの数に関するベスト プラクティスを含む、ONTAP の推奨ローカル階層レイアウトを使用することもできます：
+
`storage aggregate auto-provision`



.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-auto-provision.html["ストレージアグリゲートの自動プロビジョニング"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-create.html["storage aggregate create"^]
* link:https://docs.netapp.com/us-en/ontap-cli/search.html?q=storage+aggregate+show["storage aggregate show"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-disk-assign.html["storage disk assign"^]

