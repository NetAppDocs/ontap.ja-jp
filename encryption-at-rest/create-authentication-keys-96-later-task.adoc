---
permalink: encryption-at-rest/create-authentication-keys-96-later-task.html 
sidebar: sidebar 
keywords: creating, authentication keys, ontap 9.6, later 
summary: security key-manager key create コマンドを使用して、ノードの認証キーを作成し、構成された KMIP サーバーに保存できます。 
---
= ONTAP 9.6以降での認証キーの作成
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
 `security key-manager key create`コマンドを使用して、ノードの認証キーを作成し、設定されたKMIPサーバに保存できます。

.タスク概要
セキュリティの設定によりデータ認証とFIPS 140-2認証に異なるキーを使用する必要がある場合は、それぞれの認証用のキーを作成する必要があります。そうでない場合は、FIPS準拠の認証キーをデータ アクセスにも使用できます。

ONTAPでは、クラスタ内のすべてのノードについて認証キーが作成されます。

* このコマンドは、オンボード キー マネージャが有効な場合はサポートされません。ただし、オンボード キー マネージャを有効にすると、2つの認証キーが自動的に作成されます。キーを表示するには、次のコマンドを使用します。
+
[listing]
----
security key-manager key query -key-type NSE-AK
----
* 設定済みのキー管理サーバにすでに128個を超える認証キーが格納されている場合は警告が表示されます。
*  `security key-manager key delete`コマンドを使用すると、未使用のキーを削除できます。指定したキーが現在ONTAPで使用されている場合、 `security key-manager key delete`コマンドは失敗します。（このコマンドを使用するには、 `admin`以上の権限が必要です。）
+
[NOTE]
====
MetroCluster環境では、キーを削除する前に、そのキーがパートナー クラスタで使用されていないことを確認する必要があります。パートナー クラスタで、次のコマンドを使用してキーが使用されていないことを確認してください。

** `storage encryption disk show -data-key-id <key-id>`
** `storage encryption disk show -fips-key-id <key-id>`


====


.開始する前に
このタスクを実行するには、クラスタ管理者である必要があります。

.手順
. クラスタ ノードの認証キーを作成します。
+
[source, cli]
----
security key-manager key create -key-tag <passphrase_label> -prompt-for-key true|false
----
+
[NOTE]
====
設定 `prompt-for-key=true`により、システムはクラスタ管理者に暗号化されたドライブの認証に使用するパスフレーズの入力を求めます。設定しない場合は、システムは32バイトのパスフレーズを自動的に生成します。 `security key-manager key create`コマンドは `security key-manager create-key`コマンドを置き換えます。link:https://docs.netapp.com/us-en/ontap-cli/security-key-manager-key-create.html?q=security+key-manager+key+create["ONTAPコマンド リファレンス"^]の `security key-manager key create`の詳細を確認してください。

====
+
次の例では、 `cluster1`の認証キーを作成し、32バイトのパスフレーズを自動的に生成します：

+
[listing]
----
cluster1::> security key-manager key create
Key ID: <id_value>
----
. 認証キーが作成されたことを確認します。
+
[listing]
----
security key-manager key query -node node
----
+
[NOTE]
====
 `security key-manager key query`コマンドは `security key-manager query key`コマンドに置き換わります。

出力に表示されるキーIDは、認証キーへの参照として使用する識別子です。実際の認証キーまたはデータ暗号化キーではありません。

====
+
次の例では、 `cluster1`の認証キーが作成されたことを確認します：

+
[listing]
----
cluster1::> security key-manager key query
       Vserver: cluster1
   Key Manager: external
          Node: node1

Key Tag                               Key Type  Restored
------------------------------------  --------  --------
node1                                 NSE-AK    yes
    Key ID: <id_value>
node1                                 NSE-AK    yes
    Key ID: <id_value>

       Vserver: cluster1
   Key Manager: external
          Node: node2

Key Tag                               Key Type  Restored
------------------------------------  --------  --------
node2                                 NSE-AK    yes
    Key ID: <id_value>
node2                                 NSE-AK    yes
    Key ID: <id_value>
----
+
 `security key-manager key query`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/security-key-manager-key-query.html["ONTAPコマンド リファレンス"^]をご覧ください。



.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/storage-encryption-disk-show.html["storage disk show | more"^]

