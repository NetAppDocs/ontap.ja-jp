---
permalink: encryption-at-rest/return-self-encrypting-disks-keys-not-available-task.html 
sidebar: sidebar 
keywords: returning, fips, drive, sed, service, authentication, keys, lost 
summary: FIPSドライブまたはSEDの認証キーが永久に失われ、KMIPサーバから取得できない場合、FIPSドライブまたはSEDは破損しているとみなされます。ディスクのデータにアクセスしたりリカバリしたりすることはできませんが、SEDの未使用スペースをデータに再び使用できるようにすることができます。 
---
= ONTAPで認証キーが失われた場合にFIPSドライブまたはSEDをサービスに戻す
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
FIPSドライブまたはSEDの認証キーが永久に失われ、KMIPサーバから取得できない場合、FIPSドライブまたはSEDは破損しているとみなされます。ディスクのデータにアクセスしたりリカバリしたりすることはできませんが、SEDの未使用スペースをデータに再び使用できるようにすることができます。

.開始する前に
このタスクを実行するには、クラスタ管理者である必要があります。

.タスク概要
このプロセスは、FIPSドライブまたはSEDの認証キーが永久に失われてリカバリできないことが確実である場合にのみ使用してください。

ディスクがパーティショニングされている場合は、このプロセスを開始する前にパーティショニングを解除する必要があります。


NOTE: ディスクのパーティションを解除するコマンドは、diagレベルでのみ使用可能であり、NetAppサポートの監督下でのみ実行する必要があります。**続行する前にNetAppサポートに連絡することを強くお勧めします。**link:https://kb.netapp.com/Advice_and_Troubleshooting/Data_Storage_Systems/FAS_Systems/How_to_unpartition_a_spare_drive_in_ONTAP["NetAppナレッジベース：ONTAPでスペアドライブのパーティション化を解除する方法"^]を参照することもできます。

.手順
. FIPSドライブまたはSEDを使用可能な状態に戻します。
+
[cols="25,75"]
|===


| SEDS が... | 次の手順を使用します... 


 a| 
FIPS準拠モードでない、またはFIPS準拠モードでFIPSキーを使用できる
 a| 
.. 権限レベルをadvancedに設定します：
`set -privilege advanced`
.. FIPS キーをデフォルトの製造元セキュア ID 0x0 にリセットします：
`storage encryption disk modify -fips-key-id 0x0 -disk _disk_id_`
.. 操作が成功したことを確認します：
`storage encryption disk show-status`操作が失敗した場合は、このトピックの PSID プロセスを使用します。
.. 壊れたディスクをサニタイズする：
`storage encryption disk sanitize -disk _disk_id_`次の手順に進む前に、コマンド `storage encryption disk show-status`で操作が成功したことを確認します。
.. サニタイズされたディスクをアンフェイルします：
`storage disk unfail -spare true -disk _disk_id_`
.. ディスクに所有者がいるかどうかを確認します：
`storage disk show -disk _disk_id_`ディスクに所有者がいない場合は、所有者を割り当てます。
`storage disk assign -owner node -disk _disk_id_`
+
... 完全消去するディスクを所有するノードのノードシェルに切り替えます。
+
`system node run -node _node_name_`

+
 `disk sanitize release`コマンドを実行します。



.. ノードシェルを終了します。ディスクの障害を再度解除します：
`storage disk unfail -spare true -disk _disk_id_`
.. ディスクがスペアになり、アグリゲート内で再利用できる状態になっていることを確認します：
`storage disk show -disk _disk_id_`




 a| 
FIPS準拠モードであるがFIPSキーは使用できず、SEDのPSIDがラベルに印刷されている
 a| 
.. ディスクのPSIDをディスク ラベルで確認します。
.. 権限レベルをadvancedに設定します：
`set -privilege advanced`
.. ディスクを工場出荷時の設定にリセットします：
`storage encryption disk revert-to-original-state -disk _disk_id_ -psid _disk_physical_secure_id_`次の手順に進む前に、コマンド `storage encryption disk show-status`で操作が成功したことを確認します。
.. ONTAP 9.8P5以前を実行している場合は、次の手順に進んでください。ONTAP 9.8P6以降を実行している場合は、サニタイズされたディスクの障害を解除してください。
`storage disk unfail -disk _disk_id_`
.. ディスクに所有者がいるかどうかを確認します：
`storage disk show -disk _disk_id_`ディスクに所有者がいない場合は、所有者を割り当てます。
`storage disk assign -owner node -disk _disk_id_`
+
... 完全消去するディスクを所有するノードのノードシェルに切り替えます。
+
`system node run -node _node_name_`

+
 `disk sanitize release`コマンドを実行します。



.. ノードシェルを終了します。ディスクの障害を再度解除します：
`storage disk unfail -spare true -disk _disk_id_`
.. ディスクがスペアになり、アグリゲート内で再利用できる状態になっていることを確認します：
`storage disk show -disk _disk_id_`


|===


.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/storage-encryption-disk-modify.html["ストレージ暗号化ディスクの変更"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-encryption-disk-revert-to-original-state.html["ストレージ暗号化ディスクの元の状態へのリバート"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-encryption-disk-sanitize.html["ストレージ暗号化ディスク完全消去"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-encryption-disk-show-status.html["storage encryption disk show-status"^]

