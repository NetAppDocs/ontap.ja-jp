---
permalink: error-messages/configure-webhooks-event-notifications-task.html 
sidebar: sidebar 
keywords: configure, important, ems, events, receive, email, notifications, forward, rest, api, webhook 
summary: 重要なイベント通知をWebフック アプリケーションに転送するようにONTAPを設定できます。必要な設定手順は、選択するセキュリティのレベルによって異なります。 
---
= 重要なONTAP EMSイベントを設定して、通知をWebhookアプリケーションに転送します。
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
重要なイベント通知をWebフック アプリケーションに転送するようにONTAPを設定できます。必要な設定手順は、選択するセキュリティのレベルによって異なります。



== EMSイベントの転送を設定するための準備

イベント通知をWebフック アプリケーションに転送するようにONTAPを設定する前に、いくつかの概念と要件を確認しておく必要があります。



=== Webフック アプリケーション

ONTAPのイベント通知を受信できるWebフック アプリケーションが必要です。Webフックはユーザが定義するコールバック ルーチンで、リモート アプリケーションまたはサーバで実行してその機能を拡張します。Webフックは、クライアント（この場合はONTAP）が転送先のURLにHTTP要求を送信することで呼び出され（アクティブ化され）ます。具体的には、ONTAPが、Webフック アプリケーションをホストするサーバに、HTTP POST要求とイベント通知の詳細（XML形式）を送信します。



=== セキュリティ オプション

Transport Layer Security（TLS）プロトコルの使用方法に応じて、いくつかのセキュリティ オプションを使用できます。選択するオプションによって、ONTAPで必要な設定が決まります。

[NOTE]
====
TLSは、インターネットで広く使用されている暗号化プロトコルです。1つ以上の公開鍵証明書を使用して、プライバシー、データの整合性、および認証を提供します。証明書は、信頼された認証局によって発行されます。

====
HTTP:: イベント通知の転送にはHTTPを使用できます。この設定では、接続は安全ではありません。ONTAPクライアントとWebhookアプリケーションのIDは検証されません。さらに、ネットワーク トラフィックは暗号化も保護もされません。設定の詳細については、link:configure-webhooks-event-notifications-task.html#configure-a-webhook-destination-to-use-http["Webフックの転送先でHTTPを使用するための設定"]を参照してください。
HTTPS:: セキュリティを強化するために、Webhookルーチンをホストするサーバに証明書をインストールできます。HTTPSプロトコルは、ONTAPがWebhookアプリケーションサーバのIDを検証するため、および両者がネットワーク トラフィックのプライバシーと整合性を確保するために使用されます。設定の詳細については、link:configure-webhooks-event-notifications-task.html#configure-a-webhook-destination-to-use-https["Webフックの転送先でHTTPSを使用するための設定"]を参照してください。
HTTPS相互認証:: Webhook リクエストを発行する ONTAP システムにクライアント証明書をインストールすることで、HTTPS セキュリティをさらに強化できます。ONTAP が Webhook アプリケーション サーバの ID を検証し、ネットワーク トラフィックを保護することに加えて、Webhook アプリケーションも ONTAP クライアントの ID を検証します。この双方向ピア認証は、_Mutual TLS_ と呼ばれます。設定の詳細については、link:configure-webhooks-event-notifications-task.html#configure-a-webhook-destination-to-use-https-with-mutual-authentication["Webフックの転送先でHTTPS相互認証を使用するための設定"] を参照してください。


.関連情報
* https://www.rfc-editor.org/info/rfc8446["Transport Layer Security（TLS）プロトコル バージョン 1.3"^]




== Webフックの転送先でHTTPを使用するための設定

HTTPを使用してWebフック アプリケーションにイベント通知を転送するようにONTAPを設定できます。これは最も安全性の低いオプションですが、設定は最も簡単です。

.手順
. イベントを受信するための新しい宛先 `restapi-ems`を作成します：
+
`event notification destination create -name restapi-ems -rest-api-url \http://<webhook-application>`

+
上記のコマンドでは、宛先に *HTTP* スキームを使用する必要があります。

+
 `event notification destination create`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/event-notification-destination-create.html["ONTAPコマンド リファレンス"^]をご覧ください。

.  `important-events`フィルターと `restapi-ems`宛先をリンクする通知を作成します：
+
`event notification create -filter-name important-events -destinations restapi-ems`

+
 `event notification create`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/event-notification-create.html["ONTAPコマンド リファレンス"^]をご覧ください。





== Webフックの転送先でHTTPSを使用するための設定

HTTPSを使用してWebフック アプリケーションにイベント通知を転送するようにONTAPを設定できます。ONTAPはサーバ証明書を使用してWebフック アプリケーションの識別情報を確認するとともに、ネットワーク トラフィックを保護します。

.開始する前に
* Webフック アプリケーション サーバの秘密鍵と証明書を生成します。
* ONTAPにインストールするルート証明書を用意します。


.手順
. サーバの秘密鍵と証明書をWebフック アプリケーションをホストするサーバにインストールします。具体的な設定手順は、サーバによって異なります。
. ONTAPにサーバのルート証明書をインストールします。
+
`security certificate install -type server-ca`

+
このコマンドでは、証明書を指定するよう求められます。

.  `restapi-ems` 宛先を作成してイベントを受信します：
+
`event notification destination create -name restapi-ems -rest-api-url \https://<webhook-application>`

+
上記のコマンドでは、宛先に *HTTPS* スキームを使用する必要があります。

.  `important-events`フィルターを新しい `restapi-ems`宛先にリンクする通知を作成します：
+
`event notification create -filter-name important-events -destinations restapi-ems`





== Webフックの転送先でHTTPS相互認証を使用するための設定

HTTPS相互認証を使用してWebフック アプリケーションにイベント通知を転送するようにONTAPを設定できます。この設定では証明書を2つ使用します。ONTAPは、サーバ証明書を使用してWebフック アプリケーションの識別情報を確認するとともに、ネットワーク トラフィックを保護します。加えて、Webフックをホストするアプリケーションは、クライアント証明書を使用してONTAPクライアントの識別情報を確認します。

.開始する前に
ONTAPを設定する前に、次の作業を実行する必要があります。

* Webフック アプリケーション サーバの秘密鍵と証明書を生成します。
* ONTAPにインストールするルート証明書を用意します。
* ONTAPクライアントの秘密鍵と証明書を生成します。


.手順
. タスクlink:configure-webhooks-event-notifications-task.html#configure-a-webhook-destination-to-use-https["Webフックの転送先でHTTPSを使用するための設定"]の最初の 2 つの手順を実行してサーバ証明書をインストールし、ONTAP がサーバの ID を検証できるようにします。
. クライアント証明書を検証するために、適切なルート証明書と中間証明書をWebフック アプリケーションにインストールします。
. ONTAPにクライアント証明書をインストールします。
+
`security certificate install -type client`

+
このコマンドでは、秘密鍵と証明書を指定するよう求められます。

.  `restapi-ems` 宛先を作成してイベントを受信します：
+
`event notification destination create -name restapi-ems -rest-api-url \https://<webhook-application> -certificate-authority <issuer of the client certificate> -certificate-serial <serial of the client certificate>`

+
上記のコマンドでは、宛先に *HTTPS* スキームを使用する必要があります。

.  `important-events`フィルターを新しい `restapi-ems`宛先にリンクする通知を作成します：
+
`event notification create -filter-name important-events -destinations restapi-ems`



.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/security-certificate-install.html["security certificate install"^]

