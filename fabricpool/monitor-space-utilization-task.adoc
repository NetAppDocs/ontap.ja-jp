---
permalink: fabricpool/monitor-space-utilization-task.html 
sidebar: sidebar 
keywords: aggregate, local tier, monitoring, space, utilization, fabricpool 
summary: FabricPoolの高パフォーマンス階層とクラウド階層に格納されているデータ量を把握しておく必要があります。この情報は、ボリュームの階層化ポリシーの変更、FabricPoolライセンスで許可された使用容量の追加、またはクラウド階層のストレージ スペースの拡張が必要かどうかを判断するのに役立ちます。 
---
= FabricPool対応ONTAPローカル層のスペース使用率を監視する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
FabricPoolの高パフォーマンス階層とクラウド階層に格納されているデータ量を把握しておく必要があります。この情報は、ボリュームの階層化ポリシーの変更、FabricPoolライセンスで許可された使用容量の追加、またはクラウド階層のストレージ スペースの拡張が必要かどうかを判断するのに役立ちます。


NOTE: ONTAP 9.7より前のバージョンでは、System Managerは_ローカル階層_を説明するために_aggregate_という用語を使用しています。ONTAPバージョンに関係なく、ONTAP CLIでは_aggregate_という用語が使用されます。ローカル階層の詳細については、link:../disks-aggregates/index.html["ディスクとローカル階層"]を参照してください。

.タスク概要
ONTAP 9.18.1以降、 `storage aggregate show-space`コマンドは、論理参照容量と論理非参照容量の報告方法を変更します。論理参照容量は、すべてのオブジェクト内の参照ブロックと、断片化されたオブジェクト内の参照されていないブロックを報告します。論理非参照容量は、満杯しきい値を超え、オブジェクトの削除およびデフラグの対象となるオブジェクト内の未参照ブロックのみを報告します。

たとえば、ONTAP S3およびStorageGRIDのデフォルトのアグリゲートフルネスしきい値40%を使用する場合、ブロックが参照されていない容量として報告される前に、オブジェクト内のブロックの60%が参照されていない必要があります。

ONTAP 9.18.1より前のリリースでは、論理参照容量はすべてのオブジェクト（フルオブジェクトと断片化オブジェクトの両方）内の参照ブロックを報告します。論理非参照容量はすべてのオブジェクト内の参照されていないブロックを報告します。

.手順
. 次のいずれかのコマンドを使用して情報を表示し、FabricPoolが有効なローカル層のスペース使用率を監視します。
+
|===


| 表示したい場合... | 次に、次のコマンドを使用します： 


 a| 
ローカル階層におけるクラウド階層の使用サイズ
 a| 
`storage aggregate show` と `-instance`パラメータ



 a| 
オブジェクト ストアの参照容量を含む、ローカル階層内のスペース使用率の詳細
 a| 
`storage aggregate show-space`と `-instance`パラメータ



 a| 
ローカル層にアタッチされているオブジェクト ストアのスペース使用率（使用されているライセンス スペースの量を含む）
 a| 
`storage aggregate object-store show-space`



 a| 
ローカル層内のボリュームのリストと、そのデータおよびメタデータのフットプリント
 a| 
`volume show-footprint`

|===
+
CLIコマンドに加え、Active IQ Unified Manager（旧OnCommand Unified Manager）とFabricPool Advisor（ONTAP 9.4以降のクラスタでサポート）またはSystem Managerを使用してスペース使用量を監視することもできます。

+
次の例は、FabricPoolのスペース使用量と関連情報の表示方法を示しています。

+
[listing]
----
cluster1::> storage aggregate show-space -instance

                          Aggregate: MyFabricPool
                                                                   ...
                                               Aggregate Display Name: MyFabricPool
                                                                   ...
                          Total Object Store Logical Referenced Capacity: -
                          Object Store Logical Referenced Capacity Percentage: -
                                                                   ...
                                                       Object Store Size: -
                          Object Store Space Saved by Storage Efficiency: -
                          Object Store Space Saved by Storage Efficiency Percentage: -
                                                 Total Logical Used Size: -
                                                 Logical Used Percentage: -
                                           Logical Unreferenced Capacity: -
                                         Logical Unreferenced Percentage: -

----
+
[listing]
----
cluster1::> storage aggregate show -instance

                           Aggregate: MyFabricPool
                           ...
                           Composite: true
                           Capacity Tier Used Size:
                           ...
----
+
[listing]
----
cluster1::> volume show-footprint

Vserver : vs1
Volume : rootvol

Feature                          Used       Used%
-------------------------------- ---------- -----
Volume Footprint                 KB          %
Volume Guarantee                 MB          %
Flexible Volume Metadata         KB          %
Delayed Frees                    KB          %
Total Footprint                  MB          %

Vserver : vs1
Volume : vol

Feature                          Used       Used%
-------------------------------- ---------- -----
Volume Footprint                 KB          %
Footprint in Performance Tier    KB          %
Footprint in Amazon01            KB          %
Flexible Volume Metadata         MB          %
Delayed Frees                    KB          %
Total Footprint                  MB          %
...
----
. 必要に応じて、次のいずれかの操作を行います。
+
|===


| 状況 | 操作 


 a| 
ボリュームの階層化ポリシーを変更する
 a| 
link:modify-tiering-policy-cooling-period-task.html["ボリュームの階層化ポリシーや階層化の最小クーリング期間の変更によるストレージ階層化の管理"]の手順に従ってください。



 a| 
FabricPoolライセンスで許可された使用容量を増やす
 a| 
NetAppまたはパートナーの営業担当者にお問い合わせください。

https://mysupport.netapp.com/site/global/dashboard["NetAppサポート"^]



 a| 
クラウド階層のストレージ スペースを拡張する
 a| 
クラウド階層として使用するオブジェクト ストアのプロバイダにお問い合わせください。

|===


.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/search.html?q=storage+aggregate+object["ストレージアグリゲートオブジェクト"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-show.html["storage aggregate show"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-show-space.html["storage aggregate show-space"^]

