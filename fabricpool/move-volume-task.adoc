---
permalink: fabricpool/move-volume-task.html 
sidebar: sidebar 
keywords: aggregate, local tier, moving, volume, fabricpool, fabric pool, tiering, policy, policies, block, capacity, cold data, 
summary: FabricPoolでボリューム移動がどのように機能するかを理解することが重要です。ローカル層、接続されたクラウド層、ボリューム（ボリューム階層化ポリシー）の両方で発生する変更は、機能に大きな影響を与える可能性があるためです。 
---
= ボリュームをFabricPool対応ONTAPローカル層に移動する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
link:../volumes/move-volume-task.html["ボリューム移動"]は、ONTAPがボリュームをあるローカル階層（ソース）から別のローカル階層（デスティネーション）に無停止で移動する方法です。ボリュームの移動はさまざまな理由で実行されますが、最も一般的な理由はハードウェアライフサイクル管理、クラスタ拡張、ロード バランシングです。

FabricPoolでボリューム移動がどのように機能するかを理解することが重要です。ローカル層、接続されたクラウド層、ボリューム（ボリューム階層化ポリシー）の両方で発生する変更は、機能に大きな影響を与える可能性があるためです。


NOTE: ONTAP 9.7より前のバージョンでは、System Managerは_ローカル階層_を説明するために_aggregate_という用語を使用しています。ONTAPバージョンに関係なく、ONTAP CLIでは_aggregate_という用語が使用されます。ローカル階層の詳細については、link:../disks-aggregates/index.html["ディスクとローカル階層"]を参照してください。



== デスティネーション ローカル階層

ボリュームの移動先のローカル階層にクラウド階層が接続されていない場合、クラウド階層に保存されているソース ボリュームのデータは、移動先のローカル階層のローカル階層に書き込まれます。

ONTAP 9.8 以降では、ボリュームでlink:determine-data-inactive-reporting-task.html["Inactive Data Reporting"]が有効になっている場合、FabricPoolはボリュームのヒート マップを使用して、コールド データが宛先のローカル階層に書き込まれるとすぐに階層化を開始するためにキューに登録します。

ONTAP 9.8より前のバージョンでは、ボリュームを別のローカル階層に移動すると、ローカル階層のブロックの非アクティブ期間がリセットされます。例えば、ボリューム階層化ポリシーが「Auto」で、ローカル階層に20日間非アクティブなデータがあり、まだ階層化されていない場合、ボリュームの移動後、データの温度は0日にリセットされます。



== 最適化されたボリューム移動

ONTAP 9.6以降、ボリューム移動の宛先ローカル階層がソースローカル階層と同じバケットを使用している場合、バケットに格納されているソースボリューム上のデータはローカル階層に戻されません。階層化されたデータはそのまま残り、ホットデータのみをあるローカル階層から別のローカル階層に移動する必要があります。この最適化されたボリューム移動により、ネットワーク効率が大幅に向上します。

たとえば、300TB の最適化されたボリュームの移動は、300TB のコールド データがローカル層から別の層に移動されても、オブジェクト ストアへの 300TB の読み取りと 300TB の書き込みがトリガーされないことを意味します。

最適化されていないボリュームの移動により、追加のネットワークおよびコンピューティング トラフィック（読み取り/GET および書き込み/PUT）が生成され、ONTAP クラスタおよびオブジェクト ストアに対する要求が増加し、パブリック オブジェクト ストアに階層化するときにコストが上昇する可能性があります。

[NOTE]
====
一部の構成は最適化されたボリューム移動と互換性がありません：

* ボリューム移動中の階層化ポリシーの変更
* 異なる暗号化キーを使用するソースおよびデスティネーションのローカル階層
* FlexCloneボリューム
* FlexClone 親ボリューム
* MetroCluster（ONTAP 9.8以降で最適化されたボリューム移動をサポート）
* 同期されていないFabricPoolミラー バケット


====
ボリューム移動の宛先ローカル層にクラウド層が接続されている場合、クラウド層に保存されているソースボリューム上のデータは、まず宛先ローカル層のローカル層に書き込まれます。その後、ボリュームの階層化ポリシーにこの方法が適切であれば、宛先ローカル層のクラウド層に書き込まれます。

データを最初にローカル階層に書き込むことで、ボリューム移動のパフォーマンスが向上し、カットオーバー時間が短縮されます。ボリューム移動時にボリューム階層化ポリシーが指定されていない場合、デスティネーション ボリュームはソース ボリュームの階層化ポリシーを使用します。

ボリュームの移動を実行するときに異なる階層化ポリシーを指定した場合、指定された階層化ポリシーを使用してデスティネーション ボリュームが作成され、ボリュームの移動は最適化されません。



=== ボリューム メタデータ

ボリュームの移動が最適化されているかどうかに関わらず、ONTAPはローカルデータと階層化データの両方について、場所、ストレージ効率、権限、使用パターンなどに関する膨大な量のメタデータを保存します。メタデータは常にローカル階層に保持され、階層化されません。ボリュームをあるローカル階層から別のローカル階層に移動する場合、この情報も移動先のローカル階層に移動する必要があります。



=== 期間

ボリュームの移動は完了するまでにまだ時間がかかり、最適化されたボリュームの移動には、同量の非階層化データの移動とほぼ同じ時間がかかることが予想されます。

 `volume move show`コマンドによって報告される「スループット」は、クラウド階層から移動されるデータに関するスループットではなく、ローカルで更新されるボリューム データのスループットを表すことを理解することが重要です。


NOTE: SVM DR 関係では、ソース ボリュームと宛先ボリュームは同じ階層化ポリシーを使用する必要があります。

.手順
.  `volume move start`コマンドを使用して、ボリュームをソース ローカル ティアから宛先ローカル ティアに移動します。


.ボリュームの移動の例
次の例では、 `vs1` SVM の `myvol2`という名前のボリュームを、FabricPool対応のローカル階層である `dest_FabricPool`に移動します。

[listing]
----
cluster1::> volume move start -vserver vs1 -volume myvol2
-destination-aggregate dest_FabricPool
----