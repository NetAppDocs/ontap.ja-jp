---
permalink: fabricpool/setup-ontap-s3-cloud-tier-task.html 
sidebar: sidebar 
keywords: tr-4814, fabricpool, setting up, ontap s3, cloud tier, local tier, tiering, storage tiering, storage tier, lif 
summary: ONTAP 9.8以降を実行している場合は、ONTAP S3をFabricPoolのクラウド階層としてセットアップできます。 
---
= ONTAP S3をFabricPoolクラウド階層として設定
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.8以降を実行している場合は、ONTAP S3をFabricPoolのクラウド階層としてセットアップできます。

.開始する前に
* ONTAP S3サーバの名前およびリモート クラスタにあるその関連LIFのIPアドレスを確認しておく必要があります。
+

NOTE: サーバ名は、クライアント アプリケーションで完全修飾ドメイン名（FQDN）として使用されます。ONTAP外で、使用中のSVMデータLIFを指しているDNSレコードを確認します。

* ローカル クラスター上に<<create-lif,クラスタ内LIF>>が存在している必要があります。
+
ローカル クラスタ階層化用に設定すると、ローカル階層（ONTAP CLI ではストレージ アグリゲートとも呼ばれます）がローカル バケットに接続されます。FabricPool は、クラスタ内トラフィックにクラスタ LIF を使用します。

+

NOTE: クラスタLIFリソースが飽和状態になると、パフォーマンスが低下する可能性があります。これを回避するため、NetAppでは、ローカルバケットへの階層化を行う場合は、ローカル階層用のHAペアとローカルバケット用のHAペアを使用して、4ノード以上のクラスタを使用することを推奨しています。単一のHAペアでローカルバケットへの階層化を行うことは推奨されません。

* ONTAP S3 を使用してリモート FabricPool 容量（クラウド）階層化を有効にするには、FabricPool クライアントで link:../s3-config/create-intercluster-lifs-remote-fabricpool-tiering-task.html["クラスタ間LIFを設定する"] を実行し、オブジェクト ストア サーバーで link:../s3-config/create-data-lifs-task.html["データ LIF を設定"] を実行する必要があります。


.タスク概要
ONTAP 9.8以降では、ONTAP S3サーバの負荷分散が有効になっています。サーバのホスト名が複数のIPアドレスに解決される場合、ONTAPは、返されたすべてのIPアドレス（最大16個のIPアドレス）とクライアント接続を確立します。接続が確立されると、IPアドレスはラウンドロビン方式で選択されます。

.手順
ONTAP System ManagerまたはONTAP CLIを使用して、ONTAP S3をFabricPoolのクラウド階層としてセットアップできます。

[role="tabbed-block"]
====
.System Manager
--
. *ストレージ > 階層 > クラウド階層の追加* をクリックし、オブジェクト ストア プロバイダーとして ONTAP S3 を選択します。
. 必要な情報を入力します。
. クラウドミラーを作成する場合は、*FabricPoolミラーとして追加*をクリックします。


FabricPoolミラーを使用するとデータ ストアをシームレスに置き換えることができるため、災害発生時でもデータを使用できるようになります。

--
.CLI
--
. S3サーバとLIFのエントリをDNSサーバに追加します。
+
|===


| オプション | 概要 


 a| 
* 外部 DNS サーバーを使用する場合 *
 a| 
S3サーバの名前とIPアドレスをDNSサーバ管理者に渡します。



 a| 
*ローカルシステムのDNSホストテーブルを使用する場合*
 a| 
次のコマンドを入力します。

[listing]
----
dns host create -vserver <svm_name> -address ip_address -hostname <s3_server_name>
----
|===
.  `storage aggregate object-store config create`コマンドに `-provider-type` `ONTAP_S3`パラメータを指定して、ONTAP S3 構成情報を指定します。
+
**  `storage aggregate object-store config create`ローカルONTAPシステムが提供された情報を使用してONTAP S3サーバにアクセスできない場合、コマンドは失敗します。
**  `-access-key`パラメータを使用して、ONTAP S3サーバへの要求を承認するためのアクセスキーを指定します。
**  `-secret-password`パラメータを使用して、ONTAP S3サーバへの要求を認証するためのパスワード（シークレットアクセスキー）を指定します。
** ONTAP S3サーバのパスワードが変更された場合は、ローカルのONTAPシステムに格納されている対応するパスワードをただちに更新する必要があります。
+
これにより、中断なくONTAP S3オブジェクト ストア内のデータにアクセスできます。

**  `-is-certificate-validation-enabled`パラメータを `false`に設定すると、ONTAP S3の証明書チェックが無効になります。サードパーティの証明機関からの署名付き証明書(`-is-certificate-validation-enabled true`を使用することが推奨されるベストプラクティスです。


+
[listing]
----
cluster1::> storage aggregate object-store config create
-object-store-name myS3 -provider-type ONTAP_S3 -server myS3server
-container-name myS3container -access-key myS3key
-secret-password myS3pass
----
.  `storage aggregate object-store config show`コマンドを使用して、ONTAP_S3設定情報を表示および確認します。
+
 `storage aggregate object-store config modify`コマンドを使用すると、FabricPoolの `ONTAP_S3`構成情報を変更できます。



--
====
[[create-lif]]
.関連情報
* link:../smb-config/create-lif-task.html["SMB用のLIFを作成する"]
* link:../nfs-config/create-lif-task.html["NFS用のLIFを作成する"]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-object-store-config-create.html["storage aggregate object-store config create"^]
* link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-object-store-config-modify.html["storage aggregate object-store config modify"^]
* link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-object-store-config-show.html["storage aggregate object-store config show"^]

