---
permalink: fabricpool/tiering-policies-concept.html 
sidebar: sidebar 
keywords: understanding, fabricpool, tiering, policies, types, modify, volume, clone, cloud migration 
summary: FabricPool 階層化ポリシーを使用すると、データがホットまたはコールドになったときに階層間でデータを効率的に移動できます。階層化ポリシーの概要を理解することで、ストレージ管理のニーズに応じた適切なポリシーを選択できます。 
---
= FabricPool 階層化ポリシーについて
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
FabricPool 階層化ポリシーを使用すると、データがホットまたはコールドになったときに階層間でデータを効率的に移動できます。階層化ポリシーの概要を理解することで、ストレージ管理のニーズに応じた適切なポリシーを選択できます。



== FabricPool 階層化ポリシーのタイプ

FabricPool 階層化ポリシーは、 FabricPool 内のボリュームのユーザデータブロックをクラウド階層に移動するタイミングとそのタイミングを、ホット（アクティブ）のボリューム「 temperature 」またはコールド（非アクティブ）に基づいて決定します。ボリューム「温度」は、頻繁にアクセスされると増加し、アクセスされない場合は減少します。一部の階層化ポリシーには、階層化の最小クーリング期間が関連付けられています。最小クーリング期間は、データが「コールド」とみなされてクラウド階層に移動されるために、 FabricPool のボリューム内のユーザデータが非アクティブのままになる時間を設定します。

FabricPool 階層化ポリシーはボリュームレベルで指定し、次の 4 つのオプションがあります。

* 。 `snapshot-only` 階層化ポリシー（デフォルト）は、アクティブなファイルシステムに関連付けられていないボリュームSnapshotコピーのユーザデータブロックをクラウド階層に移動します。
+
階層化の最小クーリング期間は 2 日です。を使用して、階層化の最小クーリング期間のデフォルト設定を変更できます `-tiering-minimum-cooling-days` パラメータは、のadvanced権限レベルで使用します `volume create` および `volume modify` コマンド有効な値は、 ONTAP 9.8 以降で 2 ～ 183 日です。9.8 より前のバージョンの ONTAP を使用している場合、有効な値は 2~63 日です。

* 。 `auto` 階層化ポリシーはONTAP 9.4以降のリリースでのみサポートされ、Snapshotコピーとアクティブなファイルシステムの両方のコールドユーザデータブロックをクラウド階層に移動します。
+
アクティブなファイルシステムと Snapshot コピーのどちらについても、階層化の最小クーリング期間のデフォルトは 31 日、ボリューム全体の環境を設定します。

+
を使用して、階層化の最小クーリング期間のデフォルト設定を変更できます `-tiering-minimum-cooling-days` パラメータは、のadvanced権限レベルで使用します `volume create` および `volume modify` コマンド有効な値は 2 ～ 183 日です。

* 。 `all` 階層化ポリシーはONTAP 9.6以降でのみサポートされ、アクティブなファイルシステムとSnapshotコピーのすべてのユーザデータブロックをクラウド階層に移動します。これは、に代わるものです `backup` 階層化ポリシー：
+
階層化スキャンの実行後すぐにクラウド階層にデータが移動され、階層化の最小クーリング期間は適用されません。この設定は変更できません。

* 。 `none` 階層化ポリシーは、ボリュームのデータを高パフォーマンス階層に保持し、クラウド階層への移動を禁止します。
+
データがクラウド階層に移動されることはないため、階層化の最小クーリング期間は適用されません。この設定は変更できません。



。 `volume show` コマンドの出力には、ボリュームの階層化ポリシーが表示されます。FabricPool で使用されたことがないボリュームは、になります `none` 出力の階層化ポリシー。



== FabricPool でボリュームの階層化ポリシーを変更した場合の動作

ボリュームの階層化ポリシーを変更するには、を実行します `volume modify` 操作。階層化ポリシーを変更することが、データがコールドと認識されてクラウド階層に移動されるまでの時間にどのように影響するかを理解しておく必要があります。

* から階層化ポリシーを変更しています `snapshot-only` または `none` 終了： `auto` アクティブなファイルシステムのユーザデータブロックのうち、すでにコールドデータがクラウド階層に送信されます。これまでクラウド階層に使用できなかったユーザデータブロックも含まれますONTAP 。
* 階層化ポリシーをに変更しています `all` 別のポリシーから移動した場合、階層化スキャンの次回実行時に、ONTAP によってアクティブなファイルシステムとSnapshotコピーのすべてのユーザブロックがクラウド階層に移動されます。
+
移動されたブロックを高パフォーマンス階層に戻すことはできません。

* から階層化ポリシーを変更しています `auto` 終了： `snapshot-only` または `none` は、クラウド階層に移動済みのアクティブなファイルシステムブロックを原因 高パフォーマンス階層に戻しません。
+
データを高パフォーマンス階層に戻すには、ボリュームの読み取りが必要です。

* ボリュームの階層化ポリシーを変更すると、階層化の最小クーリング期間は常にそのポリシーのデフォルト値にリセットされます。




== ボリュームを移動した場合の階層化ポリシーへの影響

* ボリュームを FabricPool 対応アグリゲートに移動したり FabricPool 対応アグリゲートから移動しても、別の階層化ポリシーを明示的に指定しないかぎり、ボリュームの階層化ポリシーは元のままです。
+
ただし、階層化ポリシーが適用されるのは、ボリュームが FabricPool 対応アグリゲート内にある場合のみです。

* の既存の値 `-tiering-minimum-cooling-days` デスティネーションで別の階層化ポリシーを指定しないかぎり、ボリュームを移動するボリュームのパラメータ。
+
別の階層化ポリシーを指定した場合は、そのポリシーのデフォルトの階層化の最小クーリング期間が使用されます。デスティネーションが FabricPool かどうかは関係ありません。

* アグリゲート間でボリュームを移動し、同時に階層化ポリシーも変更できます。
* を使用する場合は、特に注意が必要です `volume move` この処理にはが含まれます `auto` 階層化ポリシー：
+
次の表に、ソースとデスティネーションの両方がFabricPool対応アグリゲートであることを前提に、の結果を示します `volume move` に関連するポリシーの変更を含む処理 `auto`：

+
|===


| ボリュームの階層化ポリシー | 移動時に設定する階層化ポリシー | ボリューム移動後の結果 


 a| 
`all`
 a| 
`auto`
 a| 
すべてのデータが高パフォーマンス階層に移動されます。



 a| 
`snapshot-only`、 `none`または `auto`
 a| 
`auto`
 a| 
データブロックは、以前ソースと同じデスティネーションの階層に移動されます。



 a| 
`auto` または `all`
 a| 
`snapshot-only`
 a| 
すべてのデータが高パフォーマンス階層に移動されます。



 a| 
`auto`
 a| 
`all`
 a| 
すべてのユーザデータがクラウド階層に移動されます。



 a| 
`snapshot-only`,`auto` または `all`
 a| 
`none`
 a| 
すべてのデータが高パフォーマンス階層に保持されます。

|===




== ボリュームをクローニングした場合の階層化ポリシーへの影響

* ONTAP 9.8 以降では、クローンボリュームは常に階層化ポリシーとクラウド読み出しポリシーの両方を親ボリュームから継承します。
+
ONTAP 9.8より前のリリースでは、親がにある場合を除き、クローンは親から階層化ポリシーを継承します `all` 階層化ポリシー：

* 親ボリュームにが含まれている場合 `never` クラウドの読み出しポリシーでは、そのクローンボリュームにまたはが必要です `never` クラウドの読み出しポリシーまたは `all` 階層化ポリシー、および対応するクラウド取得ポリシー `default`。
* 親ボリュームのクラウド読み出しポリシーをに変更することはできません `never` すべてのクローンボリュームにクラウド読み出しポリシーが設定されている場合を除きます `never`。


ボリュームをクローニングするときは、次のベストプラクティスに注意してください。

* 。 `-tiering-policy` オプションおよび `tiering-minimum-cooling-days` クローンのオプションは、クローンに固有のブロックの階層化動作のみを制御します。そのため、親 FlexVol では、同じ量のデータを移動するか、クローンよりも少ないデータを移動する階層化設定を使用することを推奨します
* 親 FlexVol でのクラウド読み出しポリシーでは、同じ量のデータを移動するか、いずれかのクローンの読み出しポリシーよりも多くのデータを移動する必要があります




== 階層化ポリシーがクラウド移行とどのように連携するか

FabricPool クラウドデータの読み出しは、読み取りパターンに基づいてクラウド階層からパフォーマンス階層へのデータの読み出しを決定する階層化ポリシーで制御されます。読み取りパターンは、シーケンシャルまたはランダムのいずれかです。

次の表に、各ポリシーについて、階層化ポリシーとクラウドデータの読み出しルールを示します。

|===


| 階層化ポリシー | 取得動作 


 a| 
なし
 a| 
シーケンシャルリードとランダムリード



 a| 
Snapshot のみ
 a| 
シーケンシャルリードとランダムリード



 a| 
自動
 a| 
ランダムリード



 a| 
すべて
 a| 
データの取得は行われません

|===
ONTAP 9.8以降では、クラウドへの移行を制御できます `cloud-retrieval-policy` このオプションは、階層化ポリシーで制御されるデフォルトのクラウドの移行または読み出しの動作を上書きします。

次の表に、サポートされているクラウドの読み出しポリシーとその読み出し動作を示します。

|===


| クラウド取得ポリシー | 取得動作 


 a| 
デフォルト
 a| 
階層化ポリシーによって戻されるデータが決定されるため、デフォルトではクラウドデータの取得に変更はありません,`" `cloud-retrieval-policy`。ホストされているアグリゲートタイプに関係なく、このポリシーはすべてのボリュームのデフォルト値です。



 a| 
オンリード
 a| 
クライアントからの読み取りは、すべてクラウド階層からパフォーマンス階層に送られます。



 a| 
なし
 a| 
クラウド階層からパフォーマンス階層にクライアントベースのデータが移動されることはありません



 a| 
ステートアップ
 a| 
* 階層化ポリシー「 none 」の場合、すべてのクラウドデータはクラウド階層からパフォーマンス階層にプルされます
* 階層化ポリシー「スナップショットのみ」の場合、「 AFS データ」はプルされます。


|===