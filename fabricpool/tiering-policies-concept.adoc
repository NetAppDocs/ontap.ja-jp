---
permalink: fabricpool/tiering-policies-concept.html 
sidebar: sidebar 
keywords: understanding, fabricpool, tiering, policies, types, modify, volume, clone, cloud migration 
summary: FabricPool 階層化ポリシーを使用すると、データがホットまたはコールドになったときに階層間でデータを効率的に移動できます。階層化ポリシーの概要を理解することで、ストレージ管理のニーズに応じた適切なポリシーを選択できます。 
---
= FabricPool 階層化ポリシーについて
:icons: font
:imagesdir: ../media/


[role="lead"]
FabricPool 階層化ポリシーを使用すると、データがホットまたはコールドになったときに階層間でデータを効率的に移動できます。階層化ポリシーの概要を理解することで、ストレージ管理のニーズに応じた適切なポリシーを選択できます。



== FabricPool 階層化ポリシーのタイプ

FabricPool 階層化ポリシーは、 FabricPool 内のボリュームのユーザデータブロックをクラウド階層に移動するタイミングとそのタイミングを、ホット（アクティブ）のボリューム「 temperature 」またはコールド（非アクティブ）に基づいて決定します。ボリューム「温度」は、頻繁にアクセスされると増加し、アクセスされない場合は減少します。一部の階層化ポリシーには、階層化の最小クーリング期間が関連付けられています。最小クーリング期間は、データが「コールド」とみなされてクラウド階層に移動されるために、 FabricPool のボリューム内のユーザデータが非アクティブのままになる時間を設定します。

FabricPool 階層化ポリシーはボリュームレベルで指定し、次の 4 つのオプションがあります。

* 「 Snapshot-only 」階層化ポリシー（デフォルト）は、アクティブなファイルシステムに関連付けられていないボリューム Snapshot コピーのユーザデータブロックをクラウド階層に移動します。
+
階層化の最小クーリング期間は 2 日です。階層化の最小クーリング期間のデフォルト設定は 'volume create コマンドおよび volume modify コマンドの advanced 特権レベルで '-tiering-minimum-cooling-days パラメータを使用して変更できます有効な値は、 ONTAP 9.8 以降で 2 ～ 183 日です。9.8 より前のバージョンの ONTAP を使用している場合、有効な値は 2~63 日です。

* 「 auto 」階層化ポリシーは、 ONTAP 9.4 以降のリリースでのみサポートされ、 Snapshot コピーとアクティブファイルシステムの両方のコールドユーザデータブロックをクラウド階層に移動します。
+
アクティブなファイルシステムと Snapshot コピーのどちらについても、階層化の最小クーリング期間のデフォルトは 31 日、ボリューム全体の環境を設定します。

+
階層化の最小クーリング期間のデフォルト設定は 'volume create コマンドおよび volume modify コマンドの advanced 特権レベルで '-tiering-minimum-cooling-days パラメータを使用して変更できます有効な値は 2 ～ 183 日です。

* 「 all 」階層化ポリシーは、 ONTAP 9.6 以降でのみサポートされ、アクティブなファイルシステムと Snapshot コピーの両方のすべてのユーザデータブロックをクラウド階層に移動します。これは 'backup' 階層化ポリシーに代わるものです
+
階層化スキャンの実行後すぐにクラウド階層にデータが移動され、階層化の最小クーリング期間は適用されません。この設定は変更できません。

* 「 none 」階層化ポリシーは、ボリュームのデータをパフォーマンス階層に保持し、クラウド階層への移動を防止します。
+
データがクラウド階層に移動されることはないため、階層化の最小クーリング期間は適用されません。この設定は変更できません。



volume show コマンドの出力には ' ボリュームの階層化ポリシーが表示されますFabricPool で使用されたことがないボリュームの出力には 'none' 階層化ポリシーが表示されます



== FabricPool でボリュームの階層化ポリシーを変更した場合の動作

ボリュームの階層化ポリシーを変更するには 'volume modify 操作を実行します階層化ポリシーを変更することが、データがコールドと認識されてクラウド階層に移動されるまでの時間にどのように影響するかを理解しておく必要があります。

* 階層化ポリシーを「 Snapshot-only 」または「 none 」から「 auto 」に変更すると、 ONTAP は、アクティブなファイルシステム内の既存のコールドユーザデータブロックをクラウド階層に送信します。これは、それらのユーザデータブロックが以前はクラウド階層の対象になっていなかった場合でも同様です。
* 階層化ポリシーを別のポリシーから「 all 」に変更すると、 ONTAP は、階層化スキャンの次回実行時に、アクティブなファイルシステムと Snapshot コピーのすべてのユーザブロックをクラウド階層に移動します。
+
移動されたブロックを高パフォーマンス階層に戻すことはできません。

* 階層化ポリシーを「 auto 」から「 snapshot-only 」または「 none 」に変更しても、パフォーマンス階層に戻すためにクラウド階層にすでに移動されたアクティブなファイルシステムブロックは原因されません。
+
データを高パフォーマンス階層に戻すには、ボリュームの読み取りが必要です。

* ボリュームの階層化ポリシーを変更すると、階層化の最小クーリング期間は常にそのポリシーのデフォルト値にリセットされます。




== ボリュームを移動した場合の階層化ポリシーへの影響

* ボリュームを FabricPool 対応アグリゲートに移動したり FabricPool 対応アグリゲートから移動しても、別の階層化ポリシーを明示的に指定しないかぎり、ボリュームの階層化ポリシーは元のままです。
+
ただし、階層化ポリシーが適用されるのは、ボリュームが FabricPool 対応アグリゲート内にある場合のみです。

* ボリュームの -tiering-minimum-cooling-days パラメータの既存の値は、デスティネーションに別の階層化ポリシーを指定しないかぎり、ボリュームとともに移動します。
+
別の階層化ポリシーを指定した場合は、そのポリシーのデフォルトの階層化の最小クーリング期間が使用されます。デスティネーションが FabricPool かどうかは関係ありません。

* アグリゲート間でボリュームを移動し、同時に階層化ポリシーも変更できます。
* 「ボリューム移動」操作に「 auto 」階層化ポリシーが含まれる場合は、特に注意する必要があります。
+
次の表は ' ソースとデスティネーションの両方が FabricPool 対応アグリゲートであると仮定した場合の 'auto' に関連するポリシー変更を含む 'volume move' 操作の結果をまとめたものです

+
|===


| ボリュームの階層化ポリシー | 移動時に設定する階層化ポリシー | ボリューム移動後の結果 


 a| 
「すべて」
 a| 
「 auto 」と入力します
 a| 
すべてのデータが高パフォーマンス階層に移動されます。



 a| 
'snapshot-only' 、 'none' 、または 'auto' を指定します
 a| 
「 auto 」と入力します
 a| 
データブロックは、以前ソースと同じデスティネーションの階層に移動されます。



 a| 
「 auto 」または「 all 」
 a| 
「スナップショットのみ」
 a| 
すべてのデータが高パフォーマンス階層に移動されます。



 a| 
「 auto 」と入力します
 a| 
「すべて」
 a| 
すべてのユーザデータがクラウド階層に移動されます。



 a| 
'snapshot-only''auto' または 'all' を指定します
 a| 
「 NONE 」
 a| 
すべてのデータが高パフォーマンス階層に保持されます。

|===




== ボリュームをクローニングした場合の階層化ポリシーへの影響

* ONTAP 9.8 以降では、クローンボリュームは常に階層化ポリシーとクラウド読み出しポリシーの両方を親ボリュームから継承します。
+
ONTAP 9.8 より前のリリースでは ' クローンは親から階層化ポリシーを継承しますただし ' 親が階層化ポリシーを「すべて」持っている場合を除きます

* 親ボリュームに「 Never 」クラウド取得ポリシーが設定されている場合、そのクローンボリュームには「 Never 」クラウド取得ポリシーまたは「 all 」階層化ポリシー、および対応するクラウド取得ポリシー「 default 」が設定されている必要があります。
* 親ボリュームのクラウド取得ポリシーは、すべてのクローンボリュームにクラウド取得ポリシーが「 Never 」でない限り、「 Never 」に変更することはできません。


ボリュームをクローニングするときは、次のベストプラクティスに注意してください。

* クローンの -tiering-policy オプションおよび「 tiering-minimum-cooling-days 」オプションは、クローンに固有のブロックの階層化動作のみを制御します。そのため、親 FlexVol では、同じ量のデータを移動するか、クローンよりも少ないデータを移動する階層化設定を使用することを推奨します
* 親 FlexVol でのクラウド読み出しポリシーでは、同じ量のデータを移動するか、いずれかのクローンの読み出しポリシーよりも多くのデータを移動する必要があります




== 階層化ポリシーがクラウド移行とどのように連携するか

FabricPool クラウドデータの読み出しは、読み取りパターンに基づいてクラウド階層からパフォーマンス階層へのデータの読み出しを決定する階層化ポリシーで制御されます。読み取りパターンは、シーケンシャルまたはランダムのいずれかです。

次の表に、各ポリシーについて、階層化ポリシーとクラウドデータの読み出しルールを示します。

|===


| 階層化ポリシー | 取得動作 


 a| 
なし
 a| 
シーケンシャルリードとランダムリード



 a| 
Snapshot のみ
 a| 
シーケンシャルリードとランダムリード



 a| 
自動
 a| 
ランダムリード



 a| 
すべて
 a| 
データの取得は行われません

|===
ONTAP 9.8 以降では、クラウド移行制御の「 cloud-retrieve-policy 」オプションは、階層化ポリシーで制御されるデフォルトのクラウド移行または取得動作を上書きします。

次の表に、サポートされているクラウドの読み出しポリシーとその読み出し動作を示します。

|===


| クラウド取得ポリシー | 取得動作 


 a| 
デフォルト
 a| 
階層化ポリシーは、どのデータをプルバックするかを決定するため、クラウドデータの取得に「デフォルト」「クラウド読み出しポリシー」を使用する変更はありません。ホストされているアグリゲートタイプに関係なく、このポリシーはすべてのボリュームのデフォルト値です。



 a| 
オンリード
 a| 
クライアントからの読み取りは、すべてクラウド階層からパフォーマンス階層に送られます。



 a| 
なし
 a| 
クラウド階層からパフォーマンス階層にクライアントベースのデータが移動されることはありません



 a| 
ステートアップ
 a| 
* 階層化ポリシー「 none 」の場合、すべてのクラウドデータはクラウド階層からパフォーマンス階層にプルされます
* 階層化ポリシー「スナップショットのみ」の場合、「 AFS データ」はプルされます。


|===