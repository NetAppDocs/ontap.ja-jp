---
permalink: file-system-analytics/activity-tracking-task.html 
sidebar: sidebar 
keywords: monitor, volume, ontap, FSA, File System Analytics, 
summary: アクティビティトラッキング機能。ホットオブジェクトを識別し、CSVファイルとしてダウンロードできます。 
---
= FSA による ONTAP アクティビティ追跡の有効化
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.10.1以降のファイルシステム分析にはアクティビティ追跡機能が含まれています。この機能を使用すると、ホットオブジェクトを特定してデータをCSVファイルとしてダウンロードできます。ONTAP 9.11.1以降では、アクティビティ追跡がSVM範囲に拡張されました。また、ONTAP 9.11.1以降では、アクティビティ追跡のタイムラインが設定されており、アクティビティ追跡データを最大5分まで確認できます。

アクティビティトラッキングでは、次の4つのカテゴリでモニタリングを実行できます。

* ディレクトリ
* ファイル
* クライアント
* ユーザ


アクティビティトラッキングには、監視対象のカテゴリごとに、読み取りIOPS、書き込みIOPS、読み取りスループット、書き込みスループットが表示されます。アクティビティトラッキングに関するクエリは、過去5秒間の間にシステムで検出されたホットスポットに関連して、10～15秒ごとに更新されます。

アクティビティ追跡情報はおおよそのものであり、データの正確さは受信I/Oトラフィックの分布によって異なります。

System Managerの[Activity Tracking]をボリュームレベルで表示すると、展開したボリュームのメニューのみがアクティブに更新されます。いずれかのボリュームのビューが折りたたまれている場合は、ボリュームの表示が展開されるまで更新されません。更新を停止するには、 * 更新を一時停止 * ボタンを使用します。アクティビティデータはCSV形式でダウンロードでき、選択したボリュームについてキャプチャされたすべてのポイントインタイムデータが表示されます。

ONTAP 9.11.1以降では、タイムライン機能を使用して、ボリュームまたはSVM上のホットスポットのアクティビティを記録し、約5秒ごとに継続的に更新して過去5分間のデータを保持することができます。タイムラインデータは、ページの表示領域にあるフィールドに対してのみ保持されます。追跡カテゴリを折りたたんだり、タイムラインが表示されないようにスクロールしたりすると、タイムラインはデータの収集を停止します。デフォルトでは、タイムラインは無効になっており、[アクティビティ]タブから移動すると自動的に無効になります。



== 単一のボリュームのアクティビティ追跡を有効にする

アクティビティ追跡は、ONTAP System ManagerまたはCLIを使用して有効にできます。

.タスクの内容
ONTAP REST APIまたはSystem ManagerでRBACを使用する場合は、アクティビティ追跡へのアクセスを管理するためのカスタムロールを作成する必要があります。このプロセスについては、を参照してくださいxref:role-based-access-control-task.html[ロールベースアクセス制御]。

[role="tabbed-block"]
====
.System Manager
--
.手順
. Storage > Volumes （ストレージ）を選択します。目的のボリュームを選択します。個 々 のボリュームメニューから[File System]を選択し、[Activity]タブを選択します。
. 上位のディレクトリ、ファイル、クライアント、およびユーザに関する個々のレポートを表示するには、 * Activity Tracking * をオンにします。
. 更新を行わずにデータをより詳細に分析するには、 * 更新を一時停止 * を選択します。データをダウンロードして、レポートのCSVレコードを作成することもできます。


--
.CLI
--
.手順
. アクティビティトラッキングを有効にする：
+
`volume activity-tracking on -vserver _svm_name_ -volume _volume_name_`

. 次のコマンドを使用して、ボリュームのアクティビティ追跡の状態がオンまたはオフになっているかどうかを確認します。
+
`volume activity-tracking show -vserver _svm_name_ -volume _volume_name_ -state`

. 有効にしたら、ONTAP System ManagerまたはONTAP REST APIを使用してアクティビティ追跡データを表示します。


--
====


== 複数ボリュームのアクティビティ追跡を有効にする

System ManagerまたはCLIを使用して、複数のボリュームのアクティビティ追跡を有効にすることができます。

.タスクの内容
ONTAP REST APIまたはSystem ManagerでRBACを使用する場合は、アクティビティ追跡へのアクセスを管理するためのカスタムロールを作成する必要があります。このプロセスについては、を参照してくださいxref:role-based-access-control-task.html[ロールベースアクセス制御]。

[role="tabbed-block"]
====
.System Manager
--
.特定のボリュームに対して有効化
. Storage > Volumes （ストレージ）を選択します。目的のボリュームを選択します。個 々 のボリュームメニューから[File System]を選択し、[Activity]タブを選択します。
. アクティビティ追跡を有効にするボリュームを選択します。ボリュームリストの上部で、*その他のオプション*ボタンを選択します。［*アクティビティトラッキングを有効にする*］を選択します。
. SVMレベルでアクティビティの追跡を表示するには、表示するSVMを* Storage > Volumes *から選択します。[File System]タブ、[Activity]の順に選択すると、アクティビティ追跡が有効になっているボリュームのデータが表示されます。


.すべてのボリュームに対して有効にする
. Storage > Volumes （ストレージ）を選択します。メニューからSVMを選択します。
. 「* File System *」タブに移動し、「* More *」タブを選択して、SVM内のすべてのボリュームでアクティビティの追跡を有効にします。


--
.CLI
--
ONTAP 9.13.1以降では、ONTAP CLIを使用して複数のボリュームのアクティビティ追跡を有効にすることができます。

.手順
. アクティビティトラッキングを有効にする：
+
`volume activity-tracking on -vserver _svm_name_ -volume [*|!_volume_names_]`

+
 `*`指定したStorage VM上のすべてのボリュームに対してアクティビティ追跡を有効にします。

+
ボリューム名のあとに続けてを使用し `!`、指定したボリュームを除くSVM上のすべてのボリュームに対してアクティビティ追跡を有効にします。

. 処理が成功したことを確認します。
+
`volume show -fields activity-tracking-state`

. 有効にしたら、ONTAP System ManagerまたはONTAP REST APIを使用してアクティビティ追跡データを表示します。


--
====