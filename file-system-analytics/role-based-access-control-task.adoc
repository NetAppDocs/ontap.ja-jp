---
permalink: file-system-analytics/role-based-access-control-task.html 
sidebar: sidebar 
keywords: rbac, file system analytics, control, pre-defined, admin-no-fsa 
summary: 使用している ONTAP のバージョンによっては、File System Analytics を使用するためにカスタム RBAC ロールを作成する必要がある場合があります。 
---
= ONTAP File System Analyticsによるロールベースのアクセス制御
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.12.1以降、ONTAPには `admin-no-fsa`と呼ばれる定義済みのロールベースアクセス制御（RBAC）ロールが含まれています。 `admin-no-fsa`ロールは管理者レベルの権限を付与しますが、ユーザーがONTAP CLI、REST API、およびSystem Managerで `files`エンドポイント（ファイルシステム分析など）に関連する操作を実行することはできません。

 `admin-no-fsa`ロールの詳細については、xref:../authentication/predefined-roles-cluster-administrators-concept.html[クラスタ管理者の事前定義されたロール]を参照してください。

ONTAP 9.12.1より前のONTAPバージョンを使用している場合は、ファイルシステム分析へのアクセスを制御する専用のロールを作成する必要があります。ONTAP 9.12.1より前のバージョンのONTAPでは、ONTAP CLIまたはONTAP REST APIを使用してRBACの権限を設定する必要があります。

[role="tabbed-block"]
====
.System Manager
--
ONTAP 9.12.1 以降では、System Manager を使用して File System Analytics の RBAC 権限を設定できます。

.手順
. *クラスター > 設定*を選択します。*セキュリティ*の下で、*ユーザーとロール*に移動し、image:icon_arrow.gif["矢印アイコン"]を選択します。
. *役割*の下で、image:icon_add.gif["アイコンを追加"]を選択します。
. ロールの名前を入力します。「ロール属性」で、適切なlink:https://docs.netapp.com/us-en/ontap-automation/reference/api_reference.html#access-the-ontap-api-documentation-page["APIエンドポイント"^]を指定して、ユーザーロールのアクセスまたは制限を設定します。ファイルシステム分析のアクセスまたは制限を設定するためのプライマリパスとセカンダリパスについては、以下の表を参照してください。
+
|===
| 制限 | プライマリ パス | セカンダリ パス 


| ボリュームでのアクティビティ追跡 | `/api/storage/volumes`  a| 
** `/_:uuid_/top-metrics/directories`
** `/_:uuid_/top-metrics/files`
** `/_:uuid_/top-metrics/clients`
** `/_:uuid_/top-metrics/users`




| SVMでのアクティビティ追跡 | `/api/svm/svms`  a| 
** `/_:uuid_/top-metrics/directories`
** `/_:uuid_/top-metrics/files`
** `/_:uuid_/top-metrics/clients`
** `/_:uuid_/top-metrics/users`




| すべてのファイルシステム分析処理 | `/api/storage/volumes` | `/_:uuid_/files` 
|===
+
UUID の代わりに `/{asterisk}/`を使用し、エンドポイントのすべてのボリュームまたは SVM のポリシーを設定できます。

+
各エンドポイントに対するアクセス権限を選択します。

. *保存*を選択します。
. ユーザーにロールを割り当てるには、xref:../task_security_administrator_access.html[管理者アクセスの制御]を参照してください。


--
.CLI
--
ONTAP 9.12.1より前にリリースされたONTAPバージョンを使用している場合は、ONTAP CLIを使用してカスタム ロールを作成します。

.手順
. すべての機能にアクセスできるデフォルトのロールを作成します。
+
このロールは、アクティビティ追跡のみにアクセスを制限したロールを作成する前に作成する必要があります。

+
`security login role create -cmddirname DEFAULT -access all -role storageAdmin`

. 制限のあるロールを作成します。
+
`security login role create -cmddirname "volume file show-disk-usage" -access none -role storageAdmin`

. SVMのWebサービスへのアクセスをロールに許可します。
+
** `rest`REST API呼び出し用
** `security`パスワード保護用
** `sysmgr`System Manager アクセス用
+
`vserver services web access create -vserver <svm-name> -name rest -role storageAdmin`

+
`vserver services web access create -vserver <svm-name> -name security -role storageAdmin`

+
`vserver services web access create -vserver <svm-name> -name sysmgr -role storageAdmin`



. ユーザを作成します。
+
ユーザーに適用するアプリケーションごとに、個別のcreateコマンドを発行する必要があります。同じユーザーに対してcreateコマンドを複数回実行した場合、すべてのアプリケーションがそのユーザーに適用され、毎回新しいユーザーが作成されることはありません。アプリケーションタイプの `http`パラメータはONTAP REST APIとSystem Managerに適用されます。

+
`security login create -user-or-group-name storageUser -authentication-method password -application http -role storageAdmin`

. 新しいユーザ クレデンシャルでSystem ManagerにログインするかONTAP REST APIを使用して、ファイルシステム分析のデータにアクセスできます。


--
====
.詳細情報
* xref:../authentication/predefined-roles-cluster-administrators-concept.html[クラスタ管理者の事前定義されたロール]
* xref:../task_security_administrator_access.html[System Managerを使用した管理者アクセスの制御]
* link:https://docs.netapp.com/us-en/ontap-automation/rest/rbac_overview.html["RBAC ロールと ONTAP REST API の詳細"^]
* link:https://docs.netapp.com/us-en/ontap-cli/security-login-create.html["security login create"^]

