---
permalink: flexcache-writeback/flexcache-write-back-guidelines.html 
sidebar: sidebar 
keywords: tr-4743, flexcache writeback, flexcache write-back, flexcache, write-back, write back, guidelines, best practices, performance, ontap tr, netapp tr 
summary: FlexCacheライトバックを使用する際のパフォーマンスを最適化するには、次のガイドラインに従ってください。 
---
= ONTAP FlexCacheライトバックのガイドライン
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
FlexCacheライトバックには、オリジンとキャッシュの間の多くの複雑なやり取りが含まれます。最適なパフォーマンスを実現するには、次のガイドラインに従って環境を構築する必要があります。これらのガイドラインは、コンテンツ作成時に入手可能な最新のONTAPメジャーバージョン（ONTAP 9.15.1）に基づいています。

ベストプラクティスとして、本番環境以外の環境で本番ワークロードをテストします。これらのガイドライン以外でFlexCacheライトバックを実装する場合は、これがさらに重要になります。

次のガイドラインは、NetApp内部で十分にテストされています。それは*_強く_*それらの内にとどまることをお勧めします。そうしないと、予期しない動作が発生する可能性があります。

* ONTAP 9.15.1P5では、FlexCacheライトバックの大幅な機能拡張が導入されました。9.15.1P5以降に現在推奨されているリリースをオリジンクラスタとキャッシュクラスタの両方で実行することを推奨します。
* 現在の反復計算では、FlexCacheボリューム全体に対して1つのコンスティチュエントを使用してFlexCacheライトバックキャッシュを設定する必要があります。マルチコンスティチュエントFlexCachesを使用すると、データが不要にキャッシュから削除される可能性があります。
* テストは、100GB未満のファイルと、キャッシュとオリジンの間のWANラウンドトリップ時間が100msを超えないように実行されました。この制限外のワークロードがあると、予期しないパフォーマンス特性が発生する可能性があります。
* SMB代替データストリームに書き込むと、メインファイルがキャッシュから削除されます。メインファイルのすべてのダーティデータは、そのファイルで他の操作を実行する前にオリジンにフラッシュする必要があります。代替データストリームもオリジンに転送されます。
* ファイル名を変更すると、そのファイルがキャッシュから削除されます。ファイルのすべてのダーティーデータは、そのファイルで他の操作を実行する前に、オリジンにフラッシュする必要があります。
* 現時点では、ライトバックが有効なFlexCacheボリューム上のファイルに対して変更または設定できる属性は次のとおりです。
+
** タイムスタンプ
** モードビット
** NT ACL
** 所有者
** グループ
** サイズ
+
変更または設定されたその他の属性は送信元に転送され、その結果ファイルがキャッシュから削除される可能性があります。他の属性の変更やキャッシュでの設定が必要な場合は、アカウントチームにPVRを開くよう依頼してください。



* 元のボリュームでSnapshotが作成されると、その元のボリュームに関連付けられたライトバックが有効になっているすべてのキャッシュから、未処理のダーティーデータがすべてリコールされます。大量のライトバック処理が実行中の場合は、これらのダーティファイルの削除に時間がかかることがあるため、処理の再試行が複数回必要になることがあります。
* 原点の使用率が80%未満である必要があります。元のボリュームに20%以上のスペースが残っていないと、キャッシュボリュームに排他的ロック委譲が許可されません。この場合、ライトバックが有効なキャッシュへの呼び出しはオリジンに転送されます。これにより、元のスペースが不足して、ライトバックが有効なキャッシュにダーティデータが孤立したままになるのを防ぐことができます。

