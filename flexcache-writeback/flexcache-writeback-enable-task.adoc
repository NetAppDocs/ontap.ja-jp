---
permalink: flexcache-writeback/flexcache-writeback-enable-task.html 
sidebar: sidebar 
keywords: creating, manage, disable, view, flexcache, flex cache, writeback, write-back, write back 
summary: FlexCacheボリュームでFlexCacheライトバック モードを有効にすると、エッジ コンピューティング環境と書き込み負荷の高いワークロードのキャッシュのパフォーマンスが向上します。 
---
= ONTAP FlexCacheライトバックの有効化と管理
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.15.1以降では、FlexCacheボリュームでFlexCacheライトバック モードを有効にして、エッジ コンピューティング環境や書き込み負荷の高いワークロードがあるキャッシュのパフォーマンスを向上できます。また、必要に応じてFlexCacheボリュームでライトバックを有効にするか無効にするかを決定できます。

キャッシュ ボリュームでライトバックを有効にすると、書き込み要求は元のボリュームではなくローカル キャッシュに送信されます。

.開始する前に
advanced権限モードにする必要があります。



== ライトバックが有効な新しいFlexCacheボリュームの作成

.手順
ONTAP System ManagerかONTAP CLIを使用して、ライトバックが有効な新しいFlexCacheボリュームを作成できます。

[role="tabbed-block"]
====
.System Manager
--
. FlexCacheボリュームが元のボリュームとは別のクラスタにある場合は、クラスタ ピア関係を作成します。
+
.. ローカル クラスタで、* 保護 > 概要 * をクリックします。
.. *Intercluster Settings* を展開し、*Add Network Interfaces* をクリックして、クラスタ間インターフェイスをクラスタに追加します。
+
同じ手順をリモート クラスタで繰り返します。

.. リモート クラスタで、* Protection > Overview * をクリックします。Cluster Peers セクションで image:icon_kabob.gif["メニューオプションアイコン"] をクリックし、* Generate Passphrase * をクリックします。
.. 生成されたパスフレーズをコピーし、ローカル クラスタで貼り付けます。
.. ローカル クラスターの [Cluster Peers] で [*Peer Clusters*] をクリックし、ローカル クラスターとリモート クラスターをピアリングします。


. FlexCacheボリュームが元のボリュームとは別のクラスタにある場合は、SVMピア関係を作成します。
+
*Storage VM Peers*で、image:icon_kabob.gif["メニューオプションアイコン"]をクリックし、次に*Peer Storage VMs*をクリックしてStorage VMをピアリングします。

+
FlexCacheボリュームが同じクラスタにある場合、System Managerを使用してSVMピア関係を作成することはできません。

. *ストレージ > ボリューム*を選択します。
. *追加*を選択します。
. *その他のオプション*を選択し、*リモートボリュームのキャッシュとして追加*を選択します。
. *FlexCache 書き戻しを有効にする*を選択します。


--
.CLI
--
. FlexCacheボリュームを別のクラスタに作成する場合は、クラスタ ピア関係を作成します。
+
.. デスティネーション クラスタで、データ保護のソース クラスタとのピア関係を作成します。
+
[source, cli]
----
cluster peer create -generate-passphrase -offer-expiration MM/DD/YYYY HH:MM:SS|1...7days|1...168hours -peer-addrs <peer_LIF_IPs> -initial-allowed-vserver-peers <svm_name>,..|* -ipspace <ipspace_name>
----
+
ONTAP 9.6以降では、クラスタ ピア関係の作成時にTLS暗号化がデフォルトで有効になります。TLS暗号化は、元のボリュームとFlexCacheボリュームの間のクラスタ間通信でサポートされます。必要に応じて、クラスタ ピア関係のTLS暗号化を無効にすることもできます。

+
[listing]
----
cluster02::> cluster peer create -generate-passphrase -offer-expiration 2days -initial-allowed-vserver-peers *

                     Passphrase: UCa+6lRVICXeL/gq1WrK7ShR
                Expiration Time: 6/7/2017 08:16:10 EST
  Initial Allowed Vserver Peers: *
            Intercluster LIF IP: 192.140.112.101
              Peer Cluster Name: Clus_7ShR (temporary generated)

Warning: make a note of the passphrase - it cannot be displayed again.
----
.. ソース クラスタで、ソース クラスタをデスティネーション クラスタに対して認証します。
+
[source, cli]
----
cluster peer create -peer-addrs <peer_LIF_IPs> -ipspace <ipspace>
----
+
[listing]
----
cluster01::> cluster peer create -peer-addrs 192.140.112.101,192.140.112.102

Notice: Use a generated passphrase or choose a passphrase of 8 or more characters.
        To ensure the authenticity of the peering relationship, use a phrase or sequence of characters that would be hard to guess.

Enter the passphrase:
Confirm the passphrase:

Clusters cluster02 and cluster01 are peered.
----


. FlexCacheボリュームが元のボリュームとは異なるSVMにある場合は、 `flexcache`をアプリケーションとしてSVMピア関係を作成します。
+
.. SVMが別のクラスタにある場合は、ピアリングするSVMのSVM権限を作成します。
+
[source, cli]
----
vserver peer permission create -peer-cluster <cluster_name> -vserver <svm-name> -applications flexcache
----
+
次の例は、すべてのローカルSVMに適用されるSVMピア権限を作成する方法を示しています。

+
[listing]
----
cluster1::> vserver peer permission create -peer-cluster cluster2 -vserver "*" -applications flexcache

Warning: This Vserver peer permission applies to all local Vservers. After that no explict
"vserver peer accept" command required for Vserver peer relationship creation request
from peer cluster "cluster2" with any of the local Vservers. Do you want to continue? {y|n}: y
----
.. SVMピア関係を作成します。
+
[source, cli]
----
vserver peer create -vserver <local_SVM> -peer-vserver <remote_SVM> -peer-cluster <cluster_name> -applications flexcache
----


. ライトバックが有効なFlexCacheボリュームを作成します。
+
[source, cli]
----
volume flexcache create -vserver <cache_vserver_name> -volume <cache_flexgroup_name> -aggr-list <list_of_aggregates> -origin-volume <origin flexgroup> -origin-vserver <origin_vserver name> -junction-path <junction_path> -is-writeback-enabled true
----


--
====


== 既存のFlexCacheボリュームでのFlexCacheライトバックの有効化

ONTAP System ManagerまたはONTAP CLIを使用して、既存のFlexCacheボリュームでFlexCacheライトバックを有効にできます。

[role="tabbed-block"]
====
.System Manager
--
. *ストレージ > ボリューム*を選択し、既存のFlexCacheボリュームを選択します。
. ボリュームの概要ページで、右上隅の*編集*をクリックします。
. *ボリュームの編集*ウィンドウで、*FlexCache ライトバックを有効にする*を選択します。


--
.CLI
--
. 既存のFlexCacheボリュームでライトバックを有効にします。
+
[source, cli]
----
volume flexcache config modify -volume <cache_flexgroup_name> -is-writeback-enabled true
----


--
====


== FlexCache書き戻しが有効になっているか確認する

.手順
System ManagerかONTAP CLIを使用して、FlexCacheライトバックが有効になっているかどうかを確認できます。

[role="tabbed-block"]
====
.System Manager
--
. *ストレージ > ボリューム* を選択し、ボリュームを選択します。
. ボリュームの*概要*で*FlexCache詳細*を見つけて、FlexCacheボリュームでFlexCache書き戻しが*有効*に設定されているかどうかを確認します。


--
.CLI
--
. FlexCacheライトバックが有効になっているかどうかを確認します。
+
[source, cli]
----
volume flexcache config show -volume <cache_flexgroup_name> -fields is-writeback-enabled
----


--
====


== FlexCacheボリュームでのライトバックの無効化

FlexCacheボリュームを削除する前に、FlexCacheライトバックを無効にする必要があります。

.手順
System ManagerまたはONTAP CLIを使用して、FlexCacheライトバックを無効にできます。

[role="tabbed-block"]
====
.System Manager
--
. *ストレージ > ボリューム* を選択し、FlexCache ライトバックが有効になっている既存の FlexCache ボリュームを選択します。
. ボリュームの概要ページで、右上隅の*編集*をクリックします。
. *ボリュームの編集*ウィンドウで、*FlexCache 書き戻しを有効にする*の選択を解除します。


--
.CLI
--
. ライトバックを無効にします。
+
[source, cli]
----
volume flexcache config modify -volume <cache_vol_name> -is-writeback-enabled false
----


--
====