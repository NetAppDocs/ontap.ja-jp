---
permalink: flexgroup/convert-flexvol-snapmirror-relationship-task.html 
sidebar: sidebar 
keywords: convert, flexvol, volume, snapmirror, relation, flexgroup 
summary: ONTAPでFlexVolのSnapMirror関係をFlexGroupボリュームのSnapMirror関係に変換するには、まずデスティネーションFlexVolを変換し、そのあとにソースFlexVolを変換する必要があります。 
---
= ONTAP FlexVolボリュームSnapMirror関係をONTAP FlexGroupボリュームSnapMirror関係に変換する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAPでFlexVolのSnapMirror関係をFlexGroupボリュームのSnapMirror関係に変換するには、まずデスティネーションFlexVolを変換し、そのあとにソースFlexVolを変換する必要があります。

.タスク概要
* SnapMirror／SnapVault 関係での変換プロセス以降は、FlexGroups と FlexVol volume の混在はサポートされていません。
* FlexGroupへの変換は、SnapMirror非同期関係でのみサポートされます。
* FlexGroup変換はSnapMirrorクラウド関係ではサポートされていません。
* 変換時間は、いくつかの変数に左右されます。変数には次のようなものがあります。
+
** コントローラのCPU
** 他のアプリケーションによるCPUの使用率
** 初期スナップショットのデータ量
** ネットワーク帯域幅
** 他のアプリケーションによって使用される帯域幅




.開始する前に
* 変換するFlexVolがオンラインになっている必要があります。
* SnapMirror関係のソースFlexVolを複数のSnapMirror関係のソース ボリュームにすることはできません。
+
ONTAP 9.9.1以降では、SnapMirrorファンアウト関係がFlexGroupボリュームでサポートされます。詳細については、link:../flexgroup/create-snapmirror-cascade-fanout-reference.html#considerations-for-creating-cascading-relationships["FlexGroup ボリュームの SnapMirror カスケードおよびファンアウト関係を作成する際の考慮事項"]を参照してください。

* FlexVolの処理と構成が変換プロセスに対応している必要があります。
+
FlexVolに互換性の問題があり、ボリュームの変換が中止された場合、エラー メッセージが生成されます。問題に対処したあと、変換を再試行できます。



.手順
. SnapMirror関係が健全であることを確認します。
+
[source, cli]
----
snapmirror show
----
+
変換できるのはXDPタイプのミラー関係のみです。

+
例：

+
[listing]
----
cluster2::> snapmirror show
                                                                       Progress
Source            Destination Mirror  Relationship   Total             Last
Path        Type  Path        State   Status         Progress  Healthy Updated
----------- ---- ------------ ------- -------------- --------- ------- --------
vs0:src_dpv DP   vs2:dst_dpv  Snapmirrored
                                      Idle           -         true    -
vs0:src_xdp XDP  vs2:dst_xdp  Snapmirrored
                                      Idle           -         true    -
----
. ソース ボリュームが変換に対応しているかどうかを確認します。
+
.. advance権限モードにログインします。
+
[source, cli]
----
set -privilege advanced
----
.. 変換プロセスを確認します。
+
[source, cli]
----
volume conversion start -vserver <src_svm_name> -volume <src_vol> -check-only true
----
+
例：

+
[listing]
----
volume conversion start -vserver vs1 -volume src_vol -check-only true
----
+
ボリュームを変換する前に、すべてのエラーを修正する必要があります。



. デスティネーションFlexVolをFlexGroupボリュームに変換します。
+
.. FlexVol SnapMirror関係を休止します。
+
[source, cli]
----
snapmirror quiesce -destination-path <dest_svm:dest_volume>
----
+
例：

+
[listing]
----
cluster2::> snapmirror quiesce -destination-path vs2:dst_xdp
----
.. 変換を開始します。
+
[source, cli]
----
volume conversion start -vserver <dest_svm> -volume <dest_volume>
----
+
例：

+
[listing]
----
cluster-1::> volume conversion start -vserver vs2 -volume dst_xdp

Warning: After the volume is converted to a FlexGroup, it will not be possible
to change it back to a flexible volume.
Do you want to continue? {y|n}: y

[Job 510] Job succeeded: SnapMirror destination volume "dst_xdp" has been successfully converted to a FlexGroup volume.
You must now convert the relationship's source volume, "vs0:src_xdp", to a FlexGroup.
Then, re-establish the SnapMirror relationship using the "snapmirror resync" command.
----


. ソース FlexVol ボリュームを FlexGroup ボリュームに変換します：`
+
[source, cli]
----
volume conversion start -vserver <src_svm_name> -volume <src_vol_name>
----
+
例：

+
[listing]
----
cluster-1::> volume conversion start -vserver vs0 -volume src_xdp

Warning: Converting flexible volume "src_xdp" in Vserver "vs0" to a FlexGroup
         will cause the state of all Snapshot copies from the volume to be set
         to "pre-conversion". Pre-conversion snapshots cannot be
         restored.
Do you want to continue? {y|n}: y
[Job 57] Job succeeded: success
----
. 関係を再同期します。
+
[source, cli]
----
snapmirror resync -destination-path dest_svm_name:dest_volume
----
+
例：

+
[listing]
----
cluster2::> snapmirror resync -destination-path vs2:dst_xdp
----


.終了後の操作
ソースFlexGroupボリュームを拡張してコンスティチュエントを追加した場合は、デスティネーション ボリュームも拡張する必要があります。

.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-quiesce.html["snapmirror quiesce"^]
* link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-resync.html["snapmirror resync"^]
* link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-show.html["snapmirror show"^]

