---
permalink: flexgroup/move-constituents-task.html 
sidebar: sidebar 
keywords: constituents, flexgroup, volume, flex group, balancing, balance, traffic, free, space, aggregate, snapmirror, snap mirror, 
summary: FlexGroupボリュームの特定のコンスティチュエントのトラフィックがほかよりも多い場合は、アグリゲート間でコンスティチュエントを移動して負荷を分散することができます。コンスティチュエントを移動することで、既存のコンスティチュエントのサイズを変更するためにアグリゲートのスペースを解放することもできます。 
---
= ONTAP FlexGroupボリュームから構成要素を移動する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
FlexGroupボリュームの特定のコンスティチュエントのトラフィックがほかよりも多い場合は、アグリゲート間でコンスティチュエントを移動して負荷を分散することができます。コンスティチュエントを移動することで、既存のコンスティチュエントのサイズを変更するためにアグリゲートのスペースを解放することもできます。

.開始する前に
SnapMirror関係にあるFlexGroupボリューム コンスティチュエントを移動する場合は、SnapMirror関係を初期化しておく必要があります。

.タスク概要
ボリューム移動処理は、FlexGroupボリュームのコンスティチュエントの拡張中は実行できません。

.手順
. 移動するFlexGroupボリューム コンスティチュエントを特定します。
+
`volume show -vserver svm_name -is-constituent true`

+
[listing]
----
cluster1::> volume show -vserver vs2 -is-constituent true
Vserver   Volume       Aggregate    State      Type       Size  Available Used%
--------- ------------ ------------ ---------- ---- ---------- ---------- -----
vs2       fg1          -            online     RW        400TB    15.12TB   62%
vs2       fg1__0001    aggr1        online     RW         25TB     8.12MB   59%
vs2       fg1__0002    aggr2        online     RW         25TB     2.50TB   90%
...
----
. FlexGroupボリューム コンスティチュエントを移動できるアグリゲートを特定します。
+
`volume move target-aggr show -vserver svm_name -volume vol_constituent_name`

+
使用可能なスペースが移動するFlexGroupボリューム コンスティチュエントのサイズよりも大きいアグリゲートを選択する必要があります。

+
[listing]
----
cluster1::> volume move target-aggr show -vserver vs2 -volume fg1_0002
Aggregate Name   Available Size   Storage Type
--------------   --------------   ------------
aggr2            467.9TB          hdd
node12a_aggr3    100.34TB         hdd
node12a_aggr2    100.36TB         hdd
node12a_aggr1    100.36TB         hdd
node12a_aggr4    100.36TB         hdd
5 entries were displayed.
----
. FlexGroupボリューム コンスティチュエントを目的のアグリゲートに移動できることを確認します。
+
`volume move start -vserver svm_name -volume vol_constituent_name -destination-aggregate aggr_name -perform-validation-only true`

+
[listing]
----
cluster1::> volume move start -vserver vs2 -volume fg1_0002 -destination-aggregate node12a_aggr3 -perform-validation-only true
Validation succeeded.
----
. FlexGroupボリューム コンスティチュエントを移動します。
+
`volume move start -vserver svm_name -volume vol_constituent_name -destination-aggregate aggr_name [-allow-mixed-aggr-types {true|false}]`

+
ボリューム移動処理はバックグラウンド プロセスとして実行されます。

+
ONTAP 9.5以降では、 `-allow-mixed-aggr-types`パラメータを `true`に設定することで、FlexGroupボリューム構成要素をFabric Poolから非Fabric Poolへ、あるいはその逆に移動できるようになりました。デフォルトでは、 `-allow-mixed-aggr-types`オプションは `false`に設定されています。

+
[NOTE]
====
 `volume move`コマンドを使用してFlexGroupボリュームで暗号化を有効にすることはできません。

====
+
[listing]
----
cluster1::> volume move start -vserver vs2 -volume fg1_002 -destination-aggregate node12a_aggr3
----
+
[NOTE]
====
アクティブなSnapMirror操作が原因でボリューム移動操作が失敗した場合は、 `snapmirror abort -h`コマンドを使用してSnapMirror操作を中止する必要があります。場合によっては、SnapMirror中止操作も失敗することがあります。そのような場合は、ボリューム移動操作を中止し、後で再試行してください。link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-abort.html["ONTAPコマンド リファレンス"^]の `snapmirror abort`の詳細を確認してください。

====
. ボリューム移動処理の状態を確認します。
+
`volume move show -volume vol_constituent_name`

+
次の例は、ボリューム移動処理のレプリケーション フェーズが完了し、カットオーバー フェーズにあるFlexGroupボリューム コンスティチュエントの状態を示しています。

+
[listing]
----
cluster1::> volume move show -volume fg1_002
Vserver   Volume     State    Move Phase  Percent-Complete Time-To-Complete
--------- ---------- -------- ----------  ---------------- ----------------
vs2       fg1_002    healthy  cutover     -                -
----

