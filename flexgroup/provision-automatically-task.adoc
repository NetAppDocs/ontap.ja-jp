---
permalink: flexgroup/provision-automatically-task.html 
sidebar: sidebar 
keywords: provision, flexgroup, volume, automatic, create, flex group, aggregate, space 
summary: FlexGroup ボリュームは自動的にプロビジョニングできます。ONTAP でアグリゲートが自動的に選択され、 FlexGroup ボリュームが作成されて設定されます。アグリゲートは、最適なパフォーマンスになるようにベストプラクティスに基づいて選択されます。 
---
= FlexGroup ボリュームを自動的にプロビジョニング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
FlexGroup ボリュームは自動的にプロビジョニングできます。ONTAP でアグリゲートが自動的に選択され、 FlexGroup ボリュームが作成されて設定されます。アグリゲートは、最適なパフォーマンスになるようにベストプラクティスに基づいて選択されます。

.必要なもの
クラスタの各ノードにアグリゲートが少なくとも 1 つ必要です。

[NOTE]
====
ONTAP 9.5 で FabricPool 用の FlexGroup ボリュームを作成するには、各ノードに FabricPool であるアグリゲートが少なくとも 1 つ必要です。

====
.このタスクについて
ONTAP は、各ノードから使用可能なスペースが大きい順に 2 つのアグリゲートを選択して FlexGroup ボリュームを作成します。使用可能なアグリゲートが 2 つない場合、 ONTAP はノードごとに 1 つのアグリゲートを選択して FlexGroup ボリュームを作成します。

.手順
. FlexGroup ボリュームをプロビジョニングします。
+
|===


| 使用するポート | 使用するコマンド 


 a| 
ONTAP 9.2 以降
 a| 
「volume create -vserver svm_name -volume fg_name–auto-provision as FlexGroup -size fg_size [–encrypt true ][-qos-policy-group qos_policy_group_name][-support-tieringtrue]」

ONTAP 9.5以降では、FabricPool 用のFlexGroup ボリュームを作成できます。FabricPool で FlexGroup ボリュームを自動的にプロビジョニングするには '-support -tiering' パラメータを 'true' に設定する必要がありますFabricPool のボリューム・ギャランティは ' 常に none に設定する必要がありますFlexGroup ボリュームには、階層化ポリシーと階層化の最小クーリング期間も指定できます。

link:../disks-aggregates/index.html["ディスクおよびアグリゲートの管理"]

ONTAP 9.3 以降では、 FlexGroup ボリュームにスループットの上限（最大 QoS ）を指定して、 FlexGroup ボリュームが消費できるパフォーマンスリソースを制限できます。ONTAP 9.4 以降では、 FlexGroup ボリュームにスループットの下限（最小 QoS ）とアダプティブ QoS を指定できます。

link:../performance-admin/index.html["パフォーマンス管理"]

ONTAP 9.2 以降では、 FlexGroup ボリュームで暗号化を有効にする場合、 -encrypt パラメータを true に設定できます。暗号化されたボリュームを作成するには、ボリューム暗号化ライセンスとキー管理ツールをインストールしておく必要があります。


NOTE: 暗号化は FlexGroup の作成時に有効にする必要があります。既存の FlexGroup ボリュームで暗号化を有効にすることはできません。

link:../encryption-at-rest/index.html["保存データの暗号化"]



 a| 
ONTAP 9.1
 a| 
「 volume FlexGroup deploy -vserver SVM_name -size fg_size 」の略

|===
+
「 size 」パラメータは、 FlexGroup ボリュームのサイズを KB 、 MB 、 GB 、 TB 、 PB 単位で指定します。

+
次の例は、 ONTAP 9.2 で 400TB の FlexGroup ボリュームをプロビジョニングする方法を示しています。

+
[listing]
----
cluster-1::> volume create -vserver vs0 -volume fg –auto-provision-as flexgroup -size 400TB
Warning: The FlexGroup "fg" will be created with the following number of constituents of size 25TB: 16.
The constituents will be created on the following aggregates: aggr1,aggr2
Do you want to continue? {y|n}: y
[Job 34] Job succeeded: Successful
----
+
次の例は、スループットの上限が設定された QoS ポリシーグループを作成して FlexGroup に適用する方法を示しています。

+
[listing]
----
cluster1::> qos policy-group create -policy group pg-vs1 -vserver vs1 -max-throughput 5000iops
----
+
[listing]
----
cluster-1::> volume create -vserver vs0 -volume fg –auto-provision-as flexgroup -size 400TB -qos-policy-group pg-vs1
Warning: The FlexGroup "fg" will be created with the following number of constituents of size 25TB: 16.
The constituents will be created on the following aggregates: aggr1,aggr2
Do you want to continue? {y|n}: y
[Job 34] Job succeeded: Successful
----
+
次の例は、 ONTAP 9.5 の FabricPool のアグリゲートに 400TB の FlexGroup ボリュームをプロビジョニングする方法を示しています。

+
[listing]
----
cluster-1::> volume create -vserver vs0 -volume fg –auto-provision-as flexgroup -size 400TB -support-tiering true -tiering-policy auto
Warning: The FlexGroup "fg" will be created with the following number of constituents of size 25TB: 16.
The constituents will be created on the following aggregates: aggr1,aggr2
Do you want to continue? {y|n}: y
[Job 34] Job succeeded: Successful
----
+
クラスタの各ノードに 8 つのコンスティチュエントで構成される FlexGroup ボリュームが作成されます。コンスティチュエントは、各ノードの最も大きい 2 つのアグリゲートに均等に分散されます。

+
デフォルトでは、FlexGroup ボリュームは、AFF システム以外の「volume」スペース・ギャランティ設定で作成されます。AFF システムの場合、デフォルトでは、FlexGroup ボリュームは「none」というスペース保証で作成されます。

. FlexGroup ボリュームをジャンクションパス「 volume mount -vserver vserver_name -volume vol_name -junction-path junction-path 」でマウントします
+
[listing]
----
cluster1::> volume mount -vserver vs0 -volume fg2 -junction-path /fg2
----


.完了後
クライアントから FlexGroup ボリュームをマウントする必要があります。

ONTAP 9.6 以前を実行していて、 Storage Virtual Machine （ SVM ）で NFSv3 と NFSv4 の両方が設定されている場合、クライアントからの FlexGroup ボリュームのマウントが失敗することがあります。このような場合は、クライアントから FlexGroup ボリュームをマウントする際に、 NFS バージョンを明示的に指定する必要があります。

[listing]
----
# mount -t nfs -o vers=3 192.53.19.64:/fg2 /mnt/fg2
# ls /mnt/fg2
file1  file2
----