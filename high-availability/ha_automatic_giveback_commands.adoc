---
sidebar: sidebar 
permalink: high-availability/ha_automatic_giveback_commands.html 
keywords: ontap, high, availability, ha, pair, automatic, giveback, commands 
summary: 自動ギブバックコマンド 
---
= 自動ギブバックコマンド
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
デフォルトでは、オフラインのノードがオンラインに戻った時点でテイクオーバーパートナーノードがストレージを自動的にギブバックするため、ハイアベイラビリティペア関係がリストアされます。ほとんどの場合、これが望ましい動作です。自動ギブバックを無効にする必要がある場合：テイクオーバーの原因 を調査してからギブバックする場合は、デフォルト以外の設定のやり取りについて確認しておく必要があります。

|===


| 状況 | 使用するコマンド 


 a| 
自動ギブバックを有効にして、テイクオーバーされたノードのブート後、 Waiting for giveback 状態に達し、 Auto giveback 期間が終了するまでの待機時間が経過した時点でギブバックが実行されるようにします。

デフォルト設定は true です。
 a| 
「 storage failover modify ‑ nodename_‑ autogivebacktrue



 a| 
自動ギブバックを無効にするデフォルト設定は true です。

* 注意： * このパラメータを false に設定しても、パニック時のテイクオーバー後の自動ギブバックは無効になりません。パニック時のテイクオーバー後の自動ギブバックは、「‑ auto-giveback-after-panic 」パラメータを false に設定して無効にする必要があります。
 a| 
「 storage failover modify ‑ nodename_‑ autogivebackfalse



 a| 
パニック時のテイクオーバーのあとに実行される自動ギブバックを無効にします（この設定はデフォルトで有効になります）。
 a| 
「 storage failover modify ‑ nodename_‑ auto-giveback ‑ after ‑ panic false 」というメッセージが表示されます



 a| 
自動ギブバックが開始されるまでの待機時間（秒）を設定します（デフォルトは 600 秒）。このオプションで指定した待機時間が経過するまでは、自動ギブバックは実行されません。
 a| 
「 storage failover modify ‑ nodename_‑ delay ‑ seconds_seconds_` 」

|===


== storage failover modify コマンドの設定による自動ギブバックへの影響

自動ギブバックの処理は、 storage failover modify コマンドのパラメータの設定によって異なります。

次の表に'storage failover modify'コマンド・パラメータのデフォルト設定を示しますこれらのパラメータは'パニックによるものではなく'テイクオーバー・イベントに適用されます

|===


| パラメータ | デフォルト設定です 


 a| 
auto-giveback_true_|_false_`
 a| 
「 _TRUE_ 」



 a| 
`-delay-seconds_integer_(seconds)`
 a| 
600



 a| 
`-onreboot_true_|_false_`
 a| 
「 _TRUE_ 」

|===
次の表に '-onreboot' パラメータと -auto-giveback' パラメータの組み合わせが ' パニックによるものではないテイクオーバー・イベントの自動ギブバックにどのように影響するかを示します

|===


| 「 storage failover modify 」パラメータが使用されます | テイクオーバーの原因 | 自動ギブバックの実行 


 a| 
-onreboot_true_`

auto-giveback_true_`
| reboot コマンド | はい。 


| halt コマンド、またはサービスプロセッサからの電源再投入 | はい。 


 a| 
-onreboot_true_`

auto-giveback_false_`
| reboot コマンド | はい。 


| halt コマンド、またはサービスプロセッサからの電源再投入 | いいえ 


 a| 
「 -onreboot_false_`. 」のように指定します

auto-giveback_true_`
| reboot コマンド | 該当しない場合はテイクオーバーは実行されません 


| halt コマンド、またはサービスプロセッサからの電源再投入 | はい。 


 a| 
「 -onreboot_false_`. 」のように指定します

auto-giveback_false_`
| reboot コマンド | いいえ 


| halt コマンド、またはサービスプロセッサからの電源再投入 | いいえ 
|===
auto-giveback' パラメータはパニックおよびその他すべての自動テイクオーバー後のギブバックを制御します-onreboot' パラメータが true' に設定されていて ' 再起動によってテイクオーバーが発生した場合 '-auto-giveback パラメータが 'true' に設定されているかどうかに関係なく ' 常に自動ギブバックが実行されます

環境が再起動し ' ONTAP から発行された halt コマンドが '-onreboot' パラメータによって実行されます-onreboot' パラメータが false に設定されている場合 ' ノードがリブートされてもテイクオーバーは実行されませんしたがって ' 自動ギブバックは '-auto-giveback' パラメータが true に設定されているかどうかに関係なく実行できませんクライアントのアクセスが中断します。



== パニック時に適用される自動ギブバックパラメータの組み合わせとその影響

次の表に、パニック時に適用される「 storage failover modify 」コマンドのパラメータを示します。

|===


| パラメータ | デフォルト設定です 


 a| 
「 -onpanic _true | false_` 」を選択します
 a| 
「 _TRUE_ 」



 a| 
auto-giveback-after-panic_true|false_`

（権限： advanced ）
 a| 
「 _TRUE_ 」



 a| 
auto-giveback_true|false_`
 a| 
「 _TRUE_ 」

|===
次の表に、「 storage failover modify 」コマンドのパラメータの各組み合わせについて、パニック時の自動ギブバックの処理を示します。

[cols="60,40"]
|===


| 「 storage failover 」パラメータを使用します | パニック発生後の自動ギブバックの実行 


| 「 -onpanic true 」 -auto-giveback true 「 -auto-giveback-after-panic true 」のように設定されています | はい。 


| 「 -onpanic true 」 -auto-giveback true `-auto-giveback-after-panic false | はい。 


| 「 -onpanic true 」 -auto-giveback false --auto-giveback-after-panic true | はい。 


| 「 -onpanic true 」 -auto-giveback false --auto-giveback-after-panic false | いいえ 


| 「 -onpanic false 」が「 false 」に設定されている場合、「 -auto-giveback 」または「 -auto-giveback -auto-giveback-after-panic 」に設定された値に関係なく、テイクオーバー / ギブバックは実行されません | いいえ 
|===

NOTE: テイクオーバーが発生する原因としては、パニックに関連しない障害が考えられます。a_failure_は、ノードとそのパートナー間の通信が失われたときに実行されます。これは、_ハートビートlost_とも呼ばれます。障害が原因でテイクオーバーが発生した場合は、によってギブバックが制御されます `-onfailure` ではなくパラメータを使用します `-auto-giveback-after-panic parameter`。


NOTE: ノードでパニックが発生すると、パートナーノードにパニックパケットが送信されます。何らかの理由でパートナーノードがパニックパケットを受信しなかった場合、パニック状態と誤って解釈される可能性があります。パニックパケットを受信しなかった場合、パートナーノードは通信が失われたことだけを認識し、パニック状態になったことは通知しません。この場合、パートナーノードはパニック状態ではなく障害として通信の喪失を処理し、ギブバックはによって制御されます `-onfailure` パラメータ（ではなく） `-auto-giveback-after-panic parameter`）。

詳細については、を参照してください `storage failover modify` パラメータについては、を参照してください link:https://docs.netapp.com/us-en/ontap-cli-9121/storage-failover-modify.html["ONTAP のマニュアルページ"]。
