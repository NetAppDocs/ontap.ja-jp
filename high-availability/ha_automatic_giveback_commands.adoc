---
sidebar: sidebar 
permalink: high-availability/ha_automatic_giveback_commands.html 
keywords: ontap, high, availability, ha, pair, automatic, giveback, commands 
summary: 自動ギブバックのコマンド 
---
= ONTAP自動ギブバックコマンド
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
デフォルトでは、オフラインのノードがオンラインに戻った時点でテイクオーバー パートナー ノードからストレージが自動的にギブバックされ、ハイアベイラビリティ ペア関係がリストアされます。ほとんどの場合、これが望ましい動作です。ギブバックの前にテイクオーバーの原因を調査するなどの目的で自動ギブバックを無効にする必要がある場合は、デフォルト以外の設定の動作について把握しておく必要があります。

|===


| 状況 | 使用するコマンド 


 a| 
自動ギブバックを有効にする（テイクオーバーされたノードがブートしてWaiting for Giveback状態になったあと、自動ギブバックの待機時間が経過した時点でギブバックが実行されるようにする）。

デフォルト設定はtrueです。
 a| 
`storage failover modify ‑node _nodename_ ‑auto‑giveback true`



 a| 
自動ギブバックを無効にする。デフォルト設定はtrueです。

*注：* このパラメータをfalseに設定しても、パニック時のテイクオーバー後の自動ギブバックは無効になりません。パニック時のテイクオーバー後の自動ギブバックを無効にするには、 `‑auto‑giveback‑after‑panic`パラメータをfalseに設定する必要があります。
 a| 
`storage failover modify ‑node _nodename_ ‑auto‑giveback false`



 a| 
パニック時のテイクオーバーのあとに実行される自動ギブバックを無効にする（デフォルトでは有効）。
 a| 
`storage failover modify ‑node _nodename_ ‑auto‑giveback‑after‑panic false`



 a| 
自動ギブバックが開始されるまでの待機時間（秒）を設定する（デフォルトは600）。このオプションで指定した待機時間が経過するまでは、テイクオーバー後に自動ギブバックは実行されません。
 a| 
`storage failover modify ‑node _nodename_ ‑delay‑seconds _seconds_`

|===


== storage failover modifyコマンドの設定による自動ギブバックへの影響

自動ギブバックがどのように実行されるかは、storage failover modifyコマンドのパラメータの設定によって異なります。

次の表は、パニックによって発生しないテイクオーバー イベントに適用される `storage failover modify`コマンド パラメータのデフォルト設定を示しています。

|===


| パラメータ | デフォルトの設定 


 a| 
`-auto-giveback _true_ | _false_`
 a| 
`_true_`



 a| 
`-delay-seconds _integer_ (seconds)`
 a| 
600



 a| 
`-onreboot _true_ | _false_`
 a| 
`_true_`

|===
次の表は、 `-onreboot`および `-auto-giveback`パラメータの組み合わせが、パニック以外の原因によるテイクオーバーイベントの自動ギブバックにどのように影響するかを示しています。

|===


| `storage failover modify`使用されるパラメータ | テイクオーバーの原因 | 自動ギブバックは発生しますか？ 


 a| 
`-onreboot _true_`

`-auto-giveback _true_`
| rebootコマンド | はい 


| haltコマンド、またはサービス プロセッサからの電源再投入 | はい 


 a| 
`-onreboot _true_`

`-auto-giveback _false_`
| rebootコマンド | はい 


| haltコマンド、またはサービス プロセッサからの電源再投入 | いいえ 


 a| 
`-onreboot _false_`

`-auto-giveback _true_`
| rebootコマンド | N/A この場合、テイクオーバーは発生しません 


| haltコマンド、またはサービス プロセッサからの電源再投入 | はい 


 a| 
`-onreboot _false_`

`-auto-giveback _false_`
| rebootコマンド | いいえ 


| haltコマンド、またはサービス プロセッサからの電源再投入 | いいえ 
|===
 `-auto-giveback`パラメータは、パニック発生後のギブバックとその他すべての自動テイクオーバーを制御します。 `-onreboot`パラメータが `true`に設定され、再起動によってテイクオーバーが発生した場合、 `-auto-giveback`パラメータが `true`に設定されているかどうかに関係なく、常に自動ギブバックが実行されます。

 `-onreboot`パラメータは、ONTAPから発行されるリブートコマンドおよびhaltコマンドに適用されます。 `-onreboot`パラメータがfalseに設定されている場合、ノードの再起動時にテイクオーバーは発生しません。したがって、 `-auto-giveback`パラメータがtrueに設定されているかどうかに関係なく、自動ギブバックは実行されません。クライアントの中断が発生します。



== パニック時に適用される自動ギブバック パラメータの組み合わせとその影響

次の表は、パニック状況に適用される `storage failover modify`コマンド パラメータを示しています：

|===


| パラメータ | デフォルトの設定 


 a| 
`-onpanic _true | false_`
 a| 
`_true_`



 a| 
`-auto-giveback-after-panic _true | false_`

（権限：advanced）
 a| 
`_true_`



 a| 
`-auto-giveback _true | false_`
 a| 
`_true_`

|===
次の表は、 `storage failover modify`コマンドのパラメータの組み合わせがパニック状況での自動ギブバックにどのように影響するかを示しています。

[cols="60,40"]
|===


| `storage failover`使用されるパラメータ | パニック後に自動ギブバックは発生しますか？ 


| `-onpanic true`
`-auto-giveback true`
`-auto-giveback-after-panic true` | はい 


| `-onpanic true`
`-auto-giveback true`
`-auto-giveback-after-panic false` | はい 


| `-onpanic true`
`-auto-giveback false`
`-auto-giveback-after-panic true` | はい 


| `-onpanic true`
`-auto-giveback false`
`-auto-giveback-after-panic false` | いいえ 


| `-onpanic false` `-onpanic`が `false`に設定されている場合、 `-auto-giveback`または `-auto-giveback-after-panic`に設定された値に関係なく、テイクオーバー/ギブバックは発生しません。 | いいえ 
|===

NOTE: テイクオーバーは、パニックに関連しない障害によって発生することがあります。_障害_は、ノードとそのパートナー間の通信が失われたときに発生します。これは_ハートビートロス_とも呼ばれます。障害が原因でテイクオーバーが発生した場合、ギブバックは `-auto-giveback-after-panic parameter`ではなく `-onfailure`パラメータによって制御されます。


NOTE: ノードがパニック状態になると、相手ノードにパニックパケットを送信します。何らかの理由で相手ノードがパニックパケットを受信しなかった場合、パニックが障害と誤認される可能性があります。パニックパケットを受信しない場合、相手ノードは通信が失われたことしか認識できず、パニックが発生したことを認識できません。この場合、相手ノードは通信の喪失をパニックではなく障害として処理し、ギブバックは `-onfailure`パラメータによって制御されます（ `-auto-giveback-after-panic parameter`によって制御されるわけではありません）。

 `storage failover modify`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/storage-failover-modify.html["ONTAPコマンド リファレンス"^]をご覧ください。
