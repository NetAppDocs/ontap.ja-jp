---
sidebar: sidebar 
permalink: high-availability/ha_test_takeover_giveback.html 
keywords: ontap, high, availability, ha, pair, test, testing, takeover, giveback 
summary: HA ペアについてのすべての設定が完了したら、テイクオーバー処理やギブバック処理の際に両方のノードのストレージに中断なくアクセスできることを確認する必要があります 
---
= テイクオーバーとギブバックをテストする
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
HA ペアについてのすべての設定が完了したら、テイクオーバー処理やギブバック処理の際に両方のノードのストレージに中断なくアクセスできることを確認する必要があります。テイクオーバーの処理中は、通常はパートナーノードから提供されるデータがローカル（テイクオーバー）ノードで継続して提供されるようにする必要があります。ギブバックの際は、パートナーのストレージを制御および提供する役割がパートナーノードに戻らなければなりません。

.手順
. HA インターコネクトケーブルのケーブル接続を調べて、確実に接続されていることを確認します。
. ライセンスが付与されたプロトコルごとに、両方のノードでファイルを作成および取得できることを確認します。
. 次のコマンドを入力します。
+
`storage failover takeover -ofnode partnernode`

+
コマンドの詳細については、マニュアルページを参照してください。

. 次のいずれかのコマンドを入力して、テイクオーバーが実行されたことを確認します。
+
`storage failover show-takeover`

+
`storage failover show`

+
--
を使用する場合は `storage failover` コマンドの `-auto-giveback` 有効なオプション：

|===


| ノード | パートナー | テイクオーバーが可能です | State 概要の略 


| ノード 1 | ノード 2 | - | ギブバックを待っています 


| ノード 2 | ノード 1 | いいえ | テイクオーバーの発生後、 number of seconds で示された秒数以内に自動ギブバックが開始されます 
|===
を使用する場合は `storage failover` コマンドの `-auto-giveback` オプションを無効にする：

|===


| ノード | パートナー | テイクオーバーが可能です | State 概要の略 


| ノード 1 | ノード 2 | - | ギブバックを待っています 


| ノード 2 | ノード 1 | いいえ | テイクオーバー中です 
|===
--
. パートナーノード（ノード 2 ）に属するディスクのうち、テイクオーバーノード（ノード 1 ）で検出できるすべてのディスクを表示します。
+
`storage disk show -home node2 -ownership`

+
--
次のコマンドは、ノード2に属するディスクのうち、ノード1で検出できるすべてのディスクを表示します。
`cluster::> storage disk show -home node2 -ownership`

|===


| ディスク | アグリゲート | ホーム | オーナー | DR ホーム | ホーム ID | 所有者 ID | DR ホーム ID | 予約者 | プール 


| 1.0.2 | - | ノード 2 | ノード 2 | - | 4078312453 | 4078312453 | - | 4078312452 | プール 0 


| 1.0.3 | - | ノード 2 | ノード 2 | - | 4078312453 | 4078312453 | - | 4078312452 | プール 0 
|===
--
. テイクオーバーノード（ノード 1 ）がパートナーノード（ノード 2 ）のアグリゲートを制御していることを確認します。
+
`aggr show ‑fields home‑id,home‑name,is‑home`

+
--
|===


| アグリゲート | home-id | Home - 名前 h | is-fhome 


 a| 
aggr0_cluster1_01 の実行
 a| 
2014942045
 a| 
ノード 1
 a| 
正しいです



 a| 
aggr0_2 です
 a| 
4078312453
 a| 
ノード 2
 a| 
いいえ



 a| 
aggr1_cluster1_01 があります
 a| 
2014942045
 a| 
ノード 1
 a| 
正しいです



| aggr1_2 の構成ファイル | 4078312453 | ノード 2  a| 
いいえ

|===
テイクオーバー時、パートナーノードのアグリゲートの「 is-home 」の値が false になります。

--
. 「 Waiting for giveback' 」メッセージが表示されたら、パートナー・ノードのデータ・サービスをギブバックします。
+
`storage failover giveback -ofnode partnernode`

. 次のいずれかのコマンドを入力して、ギブバック処理の進捗を監視します。
+
`storage failover show-giveback`

+
`storage failover show`

. ギブバックが正常に完了したというメッセージが表示されたかどうかに応じて、次の手順に進みます。
+
--
|===


| テイクオーバーおよびギブバックの結果 | 作業 


| が完了しました | パートナーノードで手順 2~8 を繰り返します。 


| 失敗 | テイクオーバーまたはギブバックの失敗を修正してから、この手順を繰り返します。 
|===
--

