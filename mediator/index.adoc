---
permalink: mediator/index.html 
sidebar: sidebar 
keywords: ontap mediator, install requirements, mediator requirements 
summary: ONTAP Mediator をインストールするには、すべての前提条件が満たされていることを確認し、インストール パッケージを取得し、ホスト上でインストーラを実行する必要があります。 
---
= ONTAPメディエーターをインストールまたはアップグレードする
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP Mediator をインストールまたはアップグレードするには、すべての前提条件を満たし、インストールパッケージをダウンロードして、ホスト上でインストーラを実行する必要があります。

* ONTAP 9.8以降では、任意のバージョンのONTAP Mediatorを使用してSnapMirrorアクティブ同期関係を監視できます。
* 任意のバージョンのONTAP Mediatorを使用してMetroCluster IP構成を監視できます。




== インストールとアップグレードに関する考慮事項

ONTAP Mediator をアップグレードまたはインストールする前に、これらの点を確認してください。


NOTE: ONTAP Mediator 1.8以前はRed Hat Enterprise Linux（RHEL）FIPSモードと互換性がないため、正常にインストールできません。FIPSモードが有効になっているかどうかは `fips-mode-setup --check`コマンドを使用して確認できます。FIPSモードを無効にするには `fips-modesetup --disable`コマンドを使用してください。FIPSモードを無効にした後、再起動すると、ONTAP Mediator 1.8以前を正常にインストールできます。

* ONTAP Mediatorを最新バージョンにアップグレードする必要があります。古いバージョンもすべてのONTAPリリースで動作しますが、新しいバージョンにはサードパーティ製コンポーネントのセキュリティパッチが含まれています。
* ONTAP Mediatorの新しいバージョンにアップグレードすると、より上位のバージョンが利用可能でない限り、インストーラは推奨されるSCSTバージョンに自動的にアップグレードします。より上位のSCSTバージョンを手動でインストールする手順については、link:manage-task.html["ONTAP Mediatorの管理"]を参照してください。サポートされているバージョンについては、link:whats-new-concept.html#scst-support-matrix["SCSTのサポート対応表"]を参照してください。


[NOTE]
====
* インストールが失敗した場合は、ONTAP Mediatorの新しいバージョンにアップグレードする必要がある場合があります。
* 2025年6月15日以降、コード署名証明書の有効期限が切れているため、ONTAP Mediator 1.9および1.8のインストールまたはアップグレードは行えません。インストールまたはアップグレードに失敗した場合は、代わりにONTAP Mediator 1.9.1パッチバージョンをご使用ください。


====
*  `yum-utils`パッケージをインストールすると、 `needs-restarting`コマンドを使用できます。
* ONTAP Mediator 1.11 以降では、MetroCluster IP 構成で IPv6 がサポートされます。




=== ホストの要件

RHEL または Rocky Linux をインストールし、関連するリポジトリを構成するときは、次の要件に従ってください。

[NOTE]
====
インストールまたは構成プロセスを変更する場合は、追加の手順を実行する必要がある場合があります。

====
.Linuxディストリビューションの要件
* Red Hatのベストプラクティスに従って、RHELまたはRocky Linuxをインストールしてください。CentOS 8.xはサポート終了となったため、CentOS 8.xの互換バージョンは推奨されません。
* ONTAP Mediator をインストールするときは、インストール プログラムが必要なすべてのソフトウェア依存関係を取得してインストールできるように、システムが必要なリポジトリにアクセスできることを確認してください。
* yum インストーラーが RHEL リポジトリ内の依存ソフトウェアを見つけられるようにするには、インストール中またはインストール後に有効な Red Hat サブスクリプションを使用してシステムを登録します。
+
[NOTE]
====
詳細については、Red Hat Subscription Manager のドキュメントを参照してください。

====


.ネットワーク要件
次のポートが ONTAP Mediator で使用可能であり、未使用であることを確認します。

|===


| ポート/サービス | ソース | 送受信方向 | デスティネーション | 目的 


 a| 
22 / TCP
 a| 
管理ホスト
 a| 
インバウンド
 a| 
ONTAP Mediator
 a| 
（オプション）SSH / ONTAP Mediator管理



 a| 
31784 / TCP
 a| 
クラスタ管理LIF
 a| 
インバウンド
 a| 
ONTAP MediatorのWebサーバ
 a| 
（必須）REST API（HTTPS）



 a| 
3260/tcp ^1^
 a| 
ノードデータLIFまたはノード管理LIF
 a| 
双方向
 a| 
ONTAP MediatorのiSCSIターゲット
 a| 
（MetroCluster IP構成に必須）メールボックスのiSCSIデータ接続

|===
SMBC のお客様の場合、ONTAP ではポート 3260 を有効にしたり接続したりする必要はありません。

* サードパーティのファイアウォールを使用している場合は、link:https://docs.netapp.com/us-en/ontap-metrocluster/install-ip/concept_mediator_requirements.html#firewall-requirements-for-ontap-mediator["ONTAP Mediatorのファイアウォール要件"^]を参照してください。
* インターネットにアクセスできない Linux ホストの場合は、必要なパッケージがローカルリポジトリで使用可能であることを確認してください。
+
Linux 環境で Link Aggregation Control Protocol（LACP）を使用している場合は、カーネルを構成して `sysctl net.ipv4.conf.all.arp_ignore`を `2`に設定します。



.OSの要件
OS は次の要件を満たしている必要があります：

* 64ビットの物理インストールまたは仮想マシン
* 8GBのRAM
* 1GBのディスク スペース（アプリケーションのインストール、サーバ ログ、およびデータベースに使用）
* ユーザー：Root アクセス


次の表は ONTAP Mediator の各バージョンでサポートされている OS を示しています。

[cols="30,70"]
|===


| ONTAP Mediatorのバージョン | サポートされるLinuxバージョン 


 a| 
1.11
 a| 
* Red Hat Enterprise Linux
+
** 互換性：9.5 ^1^
** 推奨：10.1、10.0、9.7、9.6、9.4、8.10


* Rocky Linux 10.1、9.7、および 8.10
* Oracle Linux 10.0 および 9.6




 a| 
1.10
 a| 
* Red Hat Enterprise Linux
+
** 互換性：9.5 ^1^
** 推奨：10.0、9.6、9.4、8.10


* Rocky Linux 10.0、9.6、および 8.10




 a| 
1.9.1
 a| 
* Red Hat Enterprise Linux
+
** 互換性：9.3、9.1、8.9、8.7、8.6、8.5、8.4 ^1^
** 推奨：9.5、9.4、9.2、9.0、8.10、8.8


* Rocky Linux 9.5、8.10




 a| 
1.9
 a| 
* Red Hat Enterprise Linux
+
** 互換性：9.3、9.1、8.9、8.7、8.6、8.5、8.4 ^1^
** 推奨：9.5、9.4、9.2、9.0、8.10、8.8


* Rocky Linux 9.5、8.10




 a| 
1.8
 a| 
* Red Hat Enterprise Linux：
+
** 互換性：8.7、8.6、8.5、8.4 ^1^
** 推奨：9.4、9.3、9.2、9.1、9.0、8.10、8.9、8.8


* Rocky Linux 9.4、8.10




 a| 
1.7
 a| 
* Red Hat Enterprise Linux：
+
** 互換性：8.7、8.6、8.5、8.4 ^1^
** 推奨：9.3、9.2、9.1、9.0、8.9、8.8


* Rocky Linux 9.3、8.9




 a| 
1.6
 a| 
* Red Hat Enterprise Linux：
+
** 互換性：8.7、8.6、8.5、8.4 ^1^
** 推奨：9.2、9.1、9.0、8.8


* Rocky Linux 9.2、8.8




 a| 
1.5
 a| 
* Red Hat Enterprise Linux：8.5、8.4、8.3、8.2、8.1、8.0、7.9、7.8、7.7、および 7.6
* CentOS：7.9、7.8、7.7、7.6




 a| 
1.4
 a| 
* Red Hat Enterprise Linux：8.5、8.4、8.3、8.2、8.1、8.0、7.9、7.8、7.7、および 7.6
* CentOS：7.9、7.8、7.7、7.6




 a| 
1.3
 a| 
* Red Hat Enterprise Linux：8.3、8.2、8.1、8.0、7.9、7.8、7.7、および 7.6
* CentOS：7.9、7.8、7.7、7.6




 a| 
1.2
 a| 
* Red Hat Enterprise Linux：8.1、8.0、7.9、7.8、7.7、および 7.6
* CentOS：7.9、7.8、7.7、7.6


|===
. 互換性があるとは、Red Hat がこれらの RHEL バージョンをサポートしなくなったものの、ONTAP Mediator をこれらのバージョンにインストールできることを意味します。


.OS必須パッケージ
ONTAP Mediator には次のパッケージが必要です。


NOTE: パッケージは事前にインストールされているか、ONTAP Mediator インストーラによって自動的にインストールされます。

[cols="25,25,25,25"]
|===


| RHEL / CentOSのすべてのバージョン | RHEL 10.x / Rocky Linux 10 用の追加パッケージ | RHEL 9.x / Rocky Linux 9 用の追加パッケージ | RHEL 8.x / Rocky Linux 8 用の追加パッケージ 


 a| 
* openssl
* openssl-devel
* kernel-devel-$ (uname -r)
* gcc
* make
* libselinux-utils
* パッチ
* bzip2
* perl-Data-Dumper
* perl-ExtUtils-MakeMaker
* efibootmgr
* mokutil

 a| 
* python3.12
* python3.12-devel

 a| 
* elfutils-libelf-devel
* policycoreutils-python-utils
* python3
* python3-devel

 a| 
* elfutils-libelf-devel
* policycoreutils-python-utils
* redhat-lsb-core
* python39
* python39-devel


|===
Mediator インストールパッケージは、次の内容を含む自己解凍型の圧縮 tar ファイルです：

* サポートされているリリースのリポジトリから取得できないすべての依存関係を含むRPMファイル。
* インストール スクリプト。


有効な SSL 証明書を推奨します。



=== OSのアップグレードに関する考慮事項とカーネルの互換性

* カーネルを除くすべてのライブラリパッケージを更新できますが、ONTAP Mediatorに変更を適用するには再起動が必要になる場合があります。再起動が必要な場合は、ダウンタイムをスケジュールしてください。
* OSカーネルを最新の状態に維持してください。カーネルコアを、link:whats-new-concept.html#scst-support-matrix["ONTAP Mediatorのバージョンマトリックス"]に記載されているサポート対象バージョンにアップグレードしてください。システムを再起動する必要があるため、停止期間に備えてメンテナンス時間を設けてください。
+
** 再起動する前に SCST カーネルモジュールをアンインストールし、その後再インストールします。
** カーネル OS のアップグレードを開始する前に、再インストールするサポート対象バージョンの SCST を準備します。




[NOTE]
====
* カーネルのバージョンがオペレーティング システムのバージョンと一致している必要があります。
* テスト済みの SCST モジュールが動作しない可能性があるため、ONTAP Mediator リリースでサポートされている OS バージョンを超えてカーネルをアップグレードしないでください。


====


== UEFIセキュアブートが有効になっている場合はONTAP Mediatorをインストールします

ONTAP Mediator は、UEFI セキュア ブートが有効になっているかどうかに関係なくシステムにインストールできます。

.タスク概要
ONTAP Mediatorが不要な場合、またはONTAP Mediatorのインストールに関する問題をトラブルシューティングする場合は、ONTAP Mediatorをインストールする前にUEFIセキュアブートを無効にすることができます。マシンの設定からUEFIセキュアブートオプションを無効にしてください。

[NOTE]
====
UEFI セキュアブートを無効にする詳細な手順については、ホスト OS のドキュメントを参照してください。

====
UEFI セキュアブートを有効にした ONTAP Mediator をインストールするには、サービスを開始する前にセキュリティキーを登録する必要があります。このキーは SCST インストールのコンパイルステップで生成され、秘密鍵と公開鍵のペアとしてマシンに保存されます。 `mokutil`ユーティリティを使用して、公開鍵をマシンオーナーキー（MOK）として UEFI ファームウェアに追加することで、システムが署名済みモジュールを信頼してロードできるようになります。 `mokutil`パスフレーズは安全な場所に保存してください。システムを再起動して MOK をアクティブ化する際に必要になります。

.手順
. [[step_1_uefi]]システムでUEFIセキュアブートが有効になっているかどうかを確認します：
+
`mokutil --sb-state`

+
結果は、このシステムでUEFIセキュア ブートが有効になっているかどうかを示します。

+
[cols="40,60"]
|===


| 状況 | 移動先... 


 a| 
UEFIセキュアブートが有効になっています
 a| 




 a| 
UEFIセキュアブートが無効になっています
 a| 
link:upgrade-host-os-mediator-task.html["ホストオペレーティングシステムをアップグレードしてから、ONTAP Mediatorをアップグレードします。"]

|===
+
[NOTE]
====
** パスフレーズを作成するように求められます。パスフレーズは安全な場所に保管しておく必要があります。このパスフレーズは、UEFI Boot Managerでキーを有効にする際に必要になります。
** ONTAP Mediator 1.2.0以前のバージョンでは、このモードはサポートされていません。


====
. [[step_2_uefi]] `mokutil`ユーティリティがインストールされていない場合は、次のコマンドを実行します：
+
`yum install mokutil`


