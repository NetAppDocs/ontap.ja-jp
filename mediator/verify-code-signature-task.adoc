---
permalink: mediator/verify-code-signature-task.html 
sidebar: sidebar 
keywords: mediator, new, release, update, install, verify, code, signature 
summary: ONTAP Mediatorのインストール パッケージをインストールする前に、Mediatorのコード署名を検証する必要があります。 
---
= ONTAP Mediatorのコード署名の検証
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
NetAppでは、インストール前にONTAP Mediatorのコード署名を検証することを推奨しています。この手順はオプションです。

.開始する前に
ONTAP Mediator コード署名を検証する前に、システムがこれらの要件を満たしていることを確認してください。

[NOTE]
====
* 2025年6月15日以降、コード署名検証証明書の有効期限が切れているため、ONTAP Mediator 1.9および1.8のインストールまたはアップグレードはできません。代わりに、ONTAP Mediator 1.11または1.10をインストールまたはアップグレードしてください。
* システムが以下の要件を満たしていない場合、検証プロセスは必要なく、直接link:install-mediator-pkg-task.html["ONTAP Mediatorのインストール パッケージのインストール"]に進むことができます。


====
* OpenSSLバージョン1.0.2～3.0：基本的な検証の場合
* OpenSSLバージョン1.1.0以降：時刻認証局（TSA）の処理の場合
* パブリック インターネットへのアクセス：OCSP検証の場合


ダウンロード パッケージには次のファイルが含まれています：

[cols="50,50"]
|===


| ファイル | 概要 


 a| 
`ONTAP-Mediator-production.pub`
 a| 
署名の検証に使用された公開鍵



 a| 
`csc-prod-chain-ONTAP-Mediator.pem`
 a| 
公開証明書CAの信頼チェーン



 a| 
`csc-prod-ONTAP-Mediator.pem`
 a| 
キーの生成に使用された証明書



 a| 
`ontap-mediator-1.11.0`
 a| 
バージョン1.11の製品インストール実行ファイル



 a| 
`ontap-mediator-1.11.0.sig`
 a| 
SHA-256でハッシュ化され、csc-prodキーを使用してRSA署名された、インストーラの署名



 a| 
`ontap-mediator-1.11.0.sig.tsr`
 a| 
OCSCPがインストーラの署名に使用する失効要求



 a| 
`ontap-mediator-1.11.0.tsr`
 a| 
タイムスタンプ署名要求ファイル



 a| 
`tsa-prod-ONTAP-Mediator.pem`
 a| 
TSRの公開証明書



 a| 
`tsa-prod-chain-ONTAP-Mediator.pem`
 a| 
TSRの公開証明書のCAチェーン

|===
.手順
.  `csc-prod-ONTAP-Mediator.pem`でオンライン証明書ステータス プロトコル（OCSP）を使用して失効チェックを実行します。
+
.. 証明書のOCSP URLを見つけます。開発者証明書ではURIが提供されない場合があります：
+
[listing]
----
openssl x509 -noout -ocsp_uri -in csc-prod-chain-ONTAP-Mediator.pem
----
.. 証明書のOCSP要求を生成します。
+
[listing]
----
openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem  -reqout req.der
----
.. OCSP Managerに接続してOCSP要求を送信します。
+
[listing]
----
openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem  -url ${ocsp_uri} -resp_text -respout resp.der -verify_other csc-prod-chain-ONTAP-Mediator.pem
----


. ローカル ホストに照らしてCSCの信頼チェーンと有効期限を検証します。
+
`openssl verify`

+

NOTE: PATH からの `openssl`バージョンには、有効な `cert.pem`（自己署名ではない）が必要です。

+
[listing]
----
openssl verify -untrusted csc-prod-chain-ONTAP-Mediator.pem -CApath ${OPENSSLDIR} csc-prod-ONTAP-Mediator.pem  # Failure action: The Code-Signature-Check certificate has expired or is invalid. Download a newer version of the ONTAP Mediator.
openssl verify -untrusted tsa-prod-chain-ONTAP-Mediator.pem -CApath ${OPENSSLDIR} tsa-prod-ONTAP-Mediator.pem  # Failure action: The Time-Stamp certificate has expired or is invalid. Download a newer version of the ONTAP Mediator.
----
. 関連する証明書を使用して、 `ontap-mediator-1.11.0.sig.tsr`および `ontap-mediator-1.11.0.tsr`ファイルを検証します：
+
[role="tabbed-block"]
====
.OpenSSL 3.x
--
`openssl ts -verify -data ontap-mediator-1.11.0.sig -in ontap-mediator-1.11.0.sig.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -untrusted tsa-prod-ONTAP-Mediator.pem`

--
.OpenSSL 1.x
--
`openssl ts -verify -data ontap-mediator-1.11.0 -in ontap-mediator-1.11.0.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -partial_chain`

--
====
+

NOTE: `.tsr`ファイルには、インストーラに関連付けられたタイムスタンプレスポンスとコード署名が含まれています。処理では、タイムスタンプにTSAの有効な署名があり、入力ファイルが変更されていないことを確認します。検証はマシン上でローカルに実行されます。TSAサーバーにアクセスする必要はありません。

. キーに照らして署名を検証します。
+
`openssl -dgst -verify`

+
[listing]
----
openssl dgst -sha256 -verify ONTAP-Mediator-production.pub -signature ontap-mediator-1.11.0.sig ontap-mediator-1.11.0
----

