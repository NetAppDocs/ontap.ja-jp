---
permalink: mediator/verify-code-signature-task.html 
sidebar: sidebar 
keywords: mediator, new, release, update, install, verify, code, signature 
summary: ONTAPメディエーターのインストールパッケージをインストールする前に、メディエーターコードの署名を確認する必要があります。 
---
= ONTAPメディエーターコード署名の確認
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
NetApp、インストール前にONTAP Mediator のコード署名を確認することを推奨しています。この手順はオプションです。

.開始する前に
ONTAP Mediator コード署名を検証する前に、システムがこれらの要件を満たしていることを確認してください。

[NOTE]
====
* 2025年6月15日以降、コード署名検証証明書の有効期限が切れているため、 ONTAP Mediator 1.9および1.8のインストールまたはアップグレードはできません。代わりに、 ONTAP Mediator 1.11 または 1.10 をインストールするか、アップグレードしてください。
* システムが以下の要件を満たしていない場合は、検証プロセスは必要なく、に直接移動できます。link:install-mediator-pkg-task.html["ONTAPメディエーターインストールパッケージのインストール"]


====
* OpenSSLバージョン1.0.2～3.0（基本検証用）
* タイムスタンプ局（TSA）操作用のOpenSSLバージョン1.1.0以降
* OCSP検証のためのパブリックインターネットアクセス


ダウンロード パッケージには次のファイルが含まれています。

[cols="50,50"]
|===


| ファイル | 説明 


 a| 
`ONTAP-Mediator-production.pub`
 a| 
署名の検証に使用される公開鍵



 a| 
`csc-prod-chain-ONTAP-Mediator.pem`
 a| 
パブリック証明書CAの信頼チェーン



 a| 
`csc-prod-ONTAP-Mediator.pem`
 a| 
キーの生成に使用する証明書



 a| 
`ontap-mediator-1.11.0`
 a| 
バージョン 1.11 の製品インストール実行ファイル



 a| 
`ontap-mediator-1.11.0.sig`
 a| 
SHA-256はハッシュ化され、CSC-prodキーを使用してRSA署名されます（インストーラの署名）。



 a| 
`ontap-mediator-1.11.0.sig.tsr`
 a| 
OCSCPがインストーラの署名に使用する失効要求



 a| 
`ontap-mediator-1.11.0.tsr`
 a| 
タイムスタンプ署名要求ファイル



 a| 
`tsa-prod-ONTAP-Mediator.pem`
 a| 
TSRのパブリック証明書



 a| 
`tsa-prod-chain-ONTAP-Mediator.pem`
 a| 
TSRのパブリック証明書CAチェーン

|===
.手順
. Online Certificate Status Protocol（OCSP）を使用して、で失効チェックを実行します `csc-prod-ONTAP-Mediator.pem`。
+
.. 証明書の OCSP URL を見つけます。開発者証明書では URI が提供されない場合があります。
+
[listing]
----
openssl x509 -noout -ocsp_uri -in csc-prod-chain-ONTAP-Mediator.pem
----
.. 証明書のOCSP要求を生成します。
+
[listing]
----
openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem  -reqout req.der
----
.. OCSP Managerに接続してOCSP要求を送信します。
+
[listing]
----
openssl ocsp -issuer csc-prod-chain-ONTAP-Mediator.pem -CAfile csc-prod-chain-ONTAP-Mediator.pem -cert csc-prod-ONTAP-Mediator.pem  -url ${ocsp_uri} -resp_text -respout resp.der -verify_other csc-prod-chain-ONTAP-Mediator.pem
----


. CSCの信頼チェーンと有効期限をローカルホストと照合して確認します。
+
`openssl verify`

+

NOTE:  `openssl`パスのバージョンは有効な（自己署名ではない）必要があります `cert.pem`。

+
[listing]
----
openssl verify -untrusted csc-prod-chain-ONTAP-Mediator.pem -CApath ${OPENSSLDIR} csc-prod-ONTAP-Mediator.pem  # Failure action: The Code-Signature-Check certificate has expired or is invalid. Download a newer version of the ONTAP Mediator.
openssl verify -untrusted tsa-prod-chain-ONTAP-Mediator.pem -CApath ${OPENSSLDIR} tsa-prod-ONTAP-Mediator.pem  # Failure action: The Time-Stamp certificate has expired or is invalid. Download a newer version of the ONTAP Mediator.
----
. 確認する `ontap-mediator-1.11.0.sig.tsr`そして `ontap-mediator-1.11.0.tsr`関連する証明書を使用するファイル:
+
[role="tabbed-block"]
====
.OpenSSL 3.x
--
`openssl ts -verify -data ontap-mediator-1.11.0.sig -in ontap-mediator-1.11.0.sig.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -untrusted tsa-prod-ONTAP-Mediator.pem`

--
.OpenSSL 1.x
--
`openssl ts -verify -data ontap-mediator-1.11.0 -in ontap-mediator-1.11.0.tsr -CAfile tsa-prod-chain-ONTAP-Mediator.pem -partial_chain`

--
====
+

NOTE: `.tsr`ファイルには、インストーラーに関連付けられたタイムスタンプ応答とコード署名が含まれています。タイムスタンプにTSAからの有効な署名があり、入力ファイルが変更されていないことが確認されます。マシンはローカルで検証を実行します。  TSA サーバーにアクセスする必要はありません。

. キーに対する署名を確認します。
+
`openssl -dgst -verify`

+
[listing]
----
openssl dgst -sha256 -verify ONTAP-Mediator-production.pub -signature ontap-mediator-1.11.0.sig ontap-mediator-1.11.0
----

