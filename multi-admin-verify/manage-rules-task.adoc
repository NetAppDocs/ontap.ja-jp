---
sidebar: sidebar 
permalink: multi-admin-verify/manage-rules-task.html 
keywords: ontap, mav, multi, admin, multi admin verify, verification, administrator, protected, operation, rules, manage 
summary: 承認が必要な操作を指定するには、マルチ管理者検証（MAV）ルールを作成します。操作が開始されるたびに、保護された操作が傍受され、承認リクエストが生成されます。 
---
= ONTAPで保護された操作のマルチ管理者検証ルールを管理する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
マルチ管理者認証（MAV）ルールを作成して、承認が必要な処理を指定します。保護対象処理が開始されると、処理が傍受され、承認要求が生成されます。

ルールは、MAVを有効にする前であれば、適切なRBAC機能を持つ任意の管理者が作成できますが、MAVを有効にしたあとにルール セットを変更するにはMAVの承認が必要です。

1つの操作につき1つのMAVルールのみ作成できます。例えば、複数の `volume-snapshot-delete`ルールを作成することはできません。必要なルール制約はすべて、1つのルール内に含める必要があります。

link:../multi-admin-verify/index.html#rule-protected-commands["これらのコマンド"]を保護するためのルールを作成できます。コマンドの保護機能が最初に利用可能になったONTAPバージョン以降、各コマンドを保護できます。

MAV システムのデフォルト コマンドのルール（ `security multi-admin-verify` link:../multi-admin-verify/index.html#system-defined-rules["コマンド"]）は変更できません。

システム定義の操作に加えて、マルチ管理者検証が有効になっている場合は次のコマンドがデフォルトで保護されますが、ルールを変更してこれらのコマンドの保護を削除できます：

* link:https://docs.netapp.com/us-en/ontap-cli/security-login-password.html["security login password"^]
* link:https://docs.netapp.com/us-en/ontap-cli/security-login-unlock.html["security login unlock"^]
* link:https://docs.netapp.com/us-en/ontap-cli/set.html["設定"^]




== ルールの制約

ルールを作成する際に、 `-query`オプションを任意で指定して、リクエストをコマンド機能のサブセットに制限できます。 `-query`オプションは、SVM、ボリューム、Snapshot名などの構成要素を制限するためにも使用できます。

たとえば、 `volume snapshot delete`コマンドでは、 `-query`を `-snapshot !hourly*,!daily*,!weekly*`に設定できます。これは、時間別、日次、または週次属性がプレフィックスとして付いたボリューム スナップショットが MAV 保護から除外されることを意味します。

[listing]
----
smci-vsim20::> security multi-admin-verify rule show
                                               Required  Approval
Vserver Operation                              Approvers Groups
------- -------------------------------------- --------- -------------
vs01    volume snapshot delete                 -         -
          Query: -snapshot !hourly*,!daily*,!weekly*
----

NOTE: 除外された設定要素はMAVによって保護されず、どの管理者も削除したり名前を変更したりすることができます。

デフォルトでは、保護された操作が入力されると、対応する `security multi-admin-verify request create _"protected_operation"_`コマンドが自動的に生成されるようにルールが規定されています。このデフォルトを変更して、 `request create`コマンドを別途入力するように設定することもできます。

デフォルトでは、ルールは次のグローバルMAV設定を継承しますが、ルール固有の例外を指定できます。

* Required Number of Approvers
* Approval Groups
* Approval Expiry period
* Execution Expiry period




== System Managerの手順

保護された操作ルールを初めて追加する場合は、System Managerの手順を参照してください。link:enable-disable-task.html#system-manager-procedure["複数管理者による検証を有効にします。"]

既存のルール セットを変更するには、次の手順を実行します。

. *Cluster > Settings*を選択します。
. *セキュリティ*セクションの*複数管理者承認*の横にあるimage:icon_gear.gif["アクションアイコン"]を選択します。
. image:icon_add.gif["アイコンを追加"]を選択して、少なくとも 1 つのルールを追加します。既存のルールを変更または削除することもできます。
+
** Operation – サポートされているコマンドをリストから選択します。
** Query – 必要なコマンド オプションと値を入力します。
** オプションのパラメータ：グローバル設定を適用する場合は、空白のままにします。グローバル設定を上書きする場合は、特定のルールに対して別の値を割り当てます。
+
*** Required number of approvers
*** Approval groups








== CLIの手順


NOTE: すべての `security multi-admin-verify rule`コマンドは、 `security multi-admin-verify rule show`を除き、実行前にMAV管理者の承認が必要です。

[cols="50,50"]
|===
| 次の操作を行う場合： | 入力するコマンド 


| ルールを作成します。  a| 
`security multi-admin-verify rule create -operation _"protected_operation"_ [-query _operation_subset_] [_parameters_]`



| 現在の管理者の認証情報を変更する  a| 
`security login modify <parameters>`

*例*：次のルールでは、ルートボリュームを削除するには承認が必要です。

`security multi-admin-verify rule create  -operation "volume delete" -query "-vserver vs0"`



| ルールを変更する  a| 
`security multi-admin-verify rule modify -operation _"protected_operation"_ [_parameters_]`



| ルールを削除します。  a| 
`security multi-admin-verify rule delete -operation _"protected_operation"_`



| ルールを表示  a| 
`security multi-admin-verify rule show`

|===
.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/search.html?q=security+multi-admin-verify+rule["セキュリティ多管理者検証ルール"^]
* link:https://docs.netapp.com/us-en/ontap-cli/security-login-modify.html["security login modify"^]

