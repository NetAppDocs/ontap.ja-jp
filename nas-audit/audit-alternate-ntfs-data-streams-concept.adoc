---
permalink: nas-audit/audit-alternate-ntfs-data-streams-concept.html 
sidebar: sidebar 
keywords: considerations, audit, alternate, ntfs data streams 
summary: NTFS 代替データストリームを持つファイルを監査する場合は、一定の考慮事項に注意する必要があります。 
---
= 代替 NTFS データストリームを監査する際の考慮事項
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
NTFS 代替データストリームを持つファイルを監査する場合は、一定の考慮事項に注意する必要があります。

監査対象のオブジェクトの場所は、2つのタグを使用してイベントレコードに記録されます `ObjectName` タグ（パス）および `HandleID` タグ（ハンドル）ログに記録されるストリーム要求を適切に識別するには、 NTFS 代替データストリームでこれらのフィールドに記録される ONTAP レコードを把握しておく必要があります。

* EVTX ID ： 4656 のイベント（オープンおよび作成の監査イベント）
+
** 代替データストリームのパスは、に記録されます `ObjectName` タグ（Tag）：
** 代替データストリームのハンドルは、に記録されます `HandleID` タグ（Tag）：


* EVTX ID ： 4663 のイベント（読み取り、書き込み、属性の取得など、その他すべての監査イベント）
+
** 代替データストリームではなく、ベースファイルのパスがに記録されます `ObjectName` タグ（Tag）：
** 代替データストリームのハンドルは、に記録されます `HandleID` タグ（Tag）：




.例
次の例は、を使用して代替データストリームのEVTX ID：4663イベントを特定する方法を示しています `HandleID` タグ（Tag）：にもかかわらず `ObjectName` 読み取り監査イベントに記録されたタグ（パス）は、ベースファイルパスへのタグです `HandleID` タグを使用すると、代替データストリームの監査レコードとしてイベントを識別できます。

ストリームファイル名はという形式になります `base_file_name:stream_name`。この例では、を使用しています `dir1` ディレクトリには、次のパスを持つ代替データストリームを持つベースファイルが含まれています。

[listing]
----

/dir1/file1.txt
/dir1/file1.txt:stream1
----
[NOTE]
====
次のイベント例の出力はご覧のように省略されています。この出力にはイベントで使用可能なすべての出力タグが表示されているわけではありません。

====
EVTX ID 4656（オープンの監査イベント）の場合、代替データストリームの監査レコード出力で代替データストリーム名がに記録されています `ObjectName` タグ：

[listing]
----

- <Event>
- <System>
  <Provider Name="Netapp-Security-Auditing" />
  <EventID>4656</EventID>
  <EventName>Open Object</EventName>
  [...]
  </System>
- <EventData>
  [...]
  **<Data Name="ObjectType"\>Stream</Data\>
  <Data Name="HandleID"\>00000000000401;00;000001e4;00176767</Data\>
  <Data Name="ObjectName"\>\(data1\);/dir1/file1.txt:stream1</Data\>          **
  [...]
  </EventData>
  </Event>
- <Event>
----
EVTX ID 4663（読み取りの監査イベント）の場合、同じ代替データストリームの監査レコード出力でベースファイル名がに記録されています `ObjectName` タグ。ただし、のハンドル `HandleID` Tagは代替データストリームのハンドルであり、このイベントと代替データストリームを関連付けるために使用できます。

[listing]
----

- <Event>
- <System>
  <Provider Name="Netapp-Security-Auditing" />
  <EventID>4663</EventID>
  <EventName>Read Object</EventName>
  [...]
  </System>
- <EventData>
  [...]
  **<Data Name="ObjectType"\>Stream</Data\>
  <Data Name="HandleID"\>00000000000401;00;000001e4;00176767</Data\>
  <Data Name="ObjectName"\>\(data1\);/dir1/file1.txt</Data\> **
  [...]
  </EventData>
  </Event>
- <Event>
----