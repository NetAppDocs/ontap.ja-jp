---
permalink: nas-audit/fpolicy-passthrough-read-enhances-usability-concept.html 
sidebar: sidebar 
keywords: fpolicy, passthrough-read, enhances, usability, hierarchical, storage management 
summary: パススルーリードを使用すると、オフラインファイルに対する読み取りアクセスを（階層型ストレージ管理（HSM）サーバとして機能している）FPolicyサーバから提供できます。セカンダリストレージシステムからプライマリストレージシステムにファイルをリコールする必要はありません。 
---
= FPolicyパススルーリードによる階層型ストレージ管理のユーザビリティの向上
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
パススルーリードを使用すると、オフラインファイルに対する読み取りアクセスを（階層型ストレージ管理（HSM）サーバとして機能している）FPolicyサーバから提供できます。セカンダリストレージシステムからプライマリストレージシステムにファイルをリコールする必要はありません。

SMBサーバ上にあるファイルにHSMを提供するようにFPolicyサーバが設定されている場合、ポリシーベースのファイル移行が実行されます。この場合、ファイルはセカンダリストレージにオフラインで保存され、スタブファイルのみがプライマリストレージに残ります。スタブファイルはクライアントからは通常のファイルとして認識されますが、実際には元のファイルと同じサイズのスパースファイルです。スパースファイルにはSMBオフラインビットが設定されており、セカンダリストレージに移行された実際のファイルを参照しています。

通常、オフラインファイルの読み取り要求を受信した場合は、要求されたコンテンツをプライマリストレージにリコールしてから、プライマリストレージ経由でアクセスする必要があります。データをプライマリストレージにリコールする必要があるため、望ましくない影響がいくつかあります。望ましくない影響としては、コンテンツをリコールしてから要求に応答する必要があることが原因でクライアント要求に対するレイテンシが増加したり、プライマリストレージでリコールされるファイルに必要なスペースが増加したりすることがあります。

FPolicyパススルーリードを使用すると、移行されたオフラインファイルに対する読み取りアクセスをHSMサーバ（FPolicyサーバ）が提供できます。セカンダリストレージシステムからプライマリストレージシステムにファイルをリコールする必要はありません。プライマリストレージにファイルをリコールする代わりに、読み取り要求をセカンダリストレージから直接処理できます。

[NOTE]
====
FPolicyのパススルーリード処理では、コピーオフロード（ODX）はサポートされません。

====
パススルーリードには次のような利点があり、ユーザビリティが向上します。

* 要求されたデータをリコールするための十分なスペースがプライマリストレージにない場合でも、読み取り要求を処理できます。
* スクリプトやバックアップソリューションで多数のオフラインファイルにアクセスする必要がある場合など、データリコールが急増する可能性がある場合は、容量とパフォーマンスの管理が向上します。
* Snapshotコピー内のオフラインファイルに対する読み取り要求を処理できます。
+
Snapshotコピーは読み取り専用であるため、スタブファイルがSnapshotコピー内にある場合、FPolicyサーバは元のファイルをリストアできません。パススルーリードを使用すると、この問題が解消されます。

* 読み取り要求をセカンダリストレージ上のファイルにアクセスして処理するタイミングと、オフラインファイルをプライマリストレージにリコールするタイミングを制御するポリシーを設定できます。
+
たとえば、オフラインファイルがプライマリストレージに移行されるまでに、指定した期間内にオフラインファイルにアクセスできる回数を指定するポリシーをHSMサーバ上に作成できます。このタイプのポリシーにより、滅多にアクセスされないファイルのリコールを回避できます。





== FPolicyパススルーリードが有効になっている場合の読み取り要求の管理方法

Storage Virtual Machine（SVM）とFPolicyサーバ間の接続を最適な形で設定できるように、FPolicyパススルーリードが有効になっている場合の読み取り要求の管理方法を理解しておく必要があります。

FPolicyパススルーリードが有効になっている場合にSVMがオフラインのファイルに対する要求を受信すると、FPolicyは標準の接続チャネルを介してFPolicyサーバ（HSMサーバ）に通知を送信します。

通知を受信すると、FPolicyサーバは通知で送信されたファイルパスからデータを読み取り、要求されたデータをSVMとFPolicyサーバの間に確立されたパススルーリード権限付きデータ接続を介してSVMに送信します。

データが送信されると、FPolicyサーバは読み取り要求にallowまたはdenyとして応答します。読み取り要求が許可されたか拒否されたかに基づいて、ONTAPは要求された情報またはエラーメッセージをクライアントに送信します。
