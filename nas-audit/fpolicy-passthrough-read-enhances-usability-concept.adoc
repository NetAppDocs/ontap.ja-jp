---
permalink: nas-audit/fpolicy-passthrough-read-enhances-usability-concept.html 
sidebar: sidebar 
keywords: fpolicy, passthrough-read, enhances, usability, hierarchical, storage management 
summary: パススルーリードを使用すると、移行されたオフラインファイルに対する読み取りアクセスを（階層型ストレージ管理（ HSM ）サーバとして機能している） FPolicy サーバから提供できます。セカンダリストレージシステムからプライマリストレージシステムにファイルをリコールする必要はありません。 
---
= FPolicy のパススルーリードによる階層型ストレージ管理の利便性向上
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
パススルーリードを使用すると、移行されたオフラインファイルに対する読み取りアクセスを（階層型ストレージ管理（ HSM ）サーバとして機能している） FPolicy サーバから提供できます。セカンダリストレージシステムからプライマリストレージシステムにファイルをリコールする必要はありません。

FPolicy サーバが SMB サーバ上にあるファイルに対して HSM を提供するように構成されている場合は、ポリシーベースのファイル移行が行われます。この場合、ファイルはセカンダリストレージ上にオフライン格納され、スタブファイルのみがプライマリストレージ上に残ります。スタブファイルはクライアントからは通常のファイルとして認識されますが、実際には元のファイルと同じサイズのスパースファイルです。スパースファイルは SMB のオフラインビットが設定されており、セカンダリストレージに移行された実際のファイルを参照しています。

通常、オフラインファイルの読み取り要求を受信した場合は、要求されたコンテンツをプライマリストレージにリコールしてから、プライマリストレージからアクセスする必要があります。データをプライマリストレージにリコールする必要があることから、いくつかの好ましくない影響が生じます。特に、コンテンツをリコールしてから要求に応じる必要があるためにクライアント要求に対するレイテンシが大きくなる点と、プライマリストレージで必要となる領域の使用量がリコールされるファイルのサイズだけ増える点が挙げられます。

FPolicy のパススルーリードを使用すると、移行されたオフラインファイルに対する読み取りアクセスを HSM サーバ（ FPolicy サーバ）から提供できます。セカンダリストレージシステムからプライマリストレージシステムにファイルをリコールする必要はありません。プライマリストレージにファイルをリコールして戻す代わりに、読み取り要求をセカンダリストレージから直接処理できます。

[NOTE]
====
FPolicy のパススルーリード処理では、コピーオフロード（ ODX ）はサポートされません。

====
パススルーリードは、次のような利点を提供してユーザビリティを向上します。

* 要求されたデータをリコールするための十分なスペースがプライマリストレージになくても、読み取り要求を処理できます。
* スクリプトやバックアップ解決策で多数のオフラインファイルへのアクセスが必要になる場合など、データのリコールが急増した場合でも容量やパフォーマンスの管理を適切に行うことができます。
* Snapshot コピー内のオフラインファイルに対する読み取り要求を処理できます。
+
Snapshot コピーは読み取り専用であるため、スタブファイルが Snapshot コピー内にある場合、 FPolicy サーバは元のファイルをリストアできません。パススルーリードを使用すると、この問題は解消されます。

* セカンダリストレージ上のファイルへのアクセスによって読み取り要求が処理されるタイミングや、オフラインファイルをプライマリストレージにリコールするタイミングを制御するポリシーを設定できます。
+
たとえば、オフラインファイルがプライマリストレージに移行されるまでの指定した期間内にオフラインファイルにアクセスできる回数を指定するポリシーを HSM サーバ上に作成できます。このタイプのポリシーにより、滅多にアクセスされないファイルのリコールを回避できます。





== FPolicy パススルーリードが有効になっている場合の読み取り要求の管理方法

Storage Virtual Machine （ SVM ）および FPolicy サーバ間の接続を最適な形で設定できるように、 FPolicy パススルーリードが有効になっている場合の読み取り要求の管理方法を理解しておく必要があります。

FPolicy パススルーリードが有効になっている場合に SVM がオフラインのファイルに対する要求を受け取ると、 FPolicy によって標準の接続チャネル経由で FPolicy サーバ（ HSM サーバ）に通知が送信されます。

通知を受け取ったあと、 FPolicy サーバはその通知で送信されたファイルパスからデータを読み取り、要求されたデータを SVM および FPolicy 間に確立されたパススルーリード権限付きデータ接続を介して SVM に送信します。

データが送信されると、 FPolicy サーバは読み取り要求に allow または deny として応答します。読み取り要求が許可されたか拒否されたかによって、 ONTAP は要求された情報またはエラーメッセージをクライアントに送信します。
