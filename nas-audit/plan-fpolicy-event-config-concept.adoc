---
permalink: nas-audit/plan-fpolicy-event-config-concept.html 
sidebar: sidebar 
keywords: plan, fpolicy event configuration 
summary: FPolicy イベントを設定する前に、 FPolicy イベントを作成することの意味を理解する必要があります。イベントで監視するプロトコル、監視するイベント、使用するイベントフィルタを決定する必要があります。この情報は、設定する値を計画するのに役立ちます。 
---
= FPolicy イベントの設定の概要を計画します
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
FPolicy イベントを設定する前に、 FPolicy イベントを作成することの意味を理解する必要があります。イベントで監視するプロトコル、監視するイベント、使用するイベントフィルタを決定する必要があります。この情報は、設定する値を計画するのに役立ちます。



== FPolicy イベントを作成することの意味

FPolicy イベントを作成することは、どのファイルアクセス操作を監視するか、またどの監視対象イベント通知を外部 FPolicy サーバに送信するかを決定するために、 FPolicy プロセスで必要となる情報を定義することを意味します。FPolicy イベントの設定では、次の設定情報を定義します。

* Storage Virtual Machine （ SVM ）名
* イベント名
* 監視するプロトコル
+
FPolicy は、 SMB 、 NFSv3 、および NFSv4 のファイルアクセス処理を監視できます。

* 監視するファイル操作
+
すべてのファイル操作が各プロトコルに対して有効であるとは限りません。

* 構成するファイルフィルタ
+
ファイル操作とフィルタの特定の組み合わせのみが有効です。各プロトコルには、サポートされる独自の組み合わせがあります。

* ボリュームのマウントおよびアンマウント操作を監視するかどうか


[NOTE]
====
3 つのパラメータ (`-protocol'-file-operations'`-filters`) との依存関係があります以下の組み合わせが 3 つのパラメータで有効です。

* -protocol' および -file-operations パラメータを指定できます
* 3 つのパラメータをすべて同時に指定することもできます。
* いずれのパラメータも指定しないでください。


====


== FPolicy イベント構成に含まれるもの

次に示す使用可能な FPolicy イベント設定パラメータの一覧は、構成を計画するのに役立ちます。

[cols="70,30"]
|===


| 情報のタイプ | オプション 


 a| 
SVM

この FPolicy イベントに関連付ける SVM の名前を指定します。

各 FPolicy 設定は、単一の SVM 内で定義されます。FPolicy ポリシーの構成要素となる外部エンジン、ポリシーイベント、ポリシーのスコープ、およびポリシーを、すべて同じ SVM に関連付ける必要があります。
 a| 
「 -vserver `vserver_name` 」



 a| 
_ イベント名 _

FPolicy イベントに割り当てる名前を指定します。FPolicy ポリシーを作成する際には、イベント名を使用して FPolicy イベントをポリシーに関連付けます。

この名前に指定できる文字数は最大 256 文字です。

[NOTE]
====
MetroCluster または SVM ディザスタリカバリ設定でイベントを設定する場合、この名前は最大 200 文字にする必要があります。

====
名前には、次の ASCII 文字の任意の組み合わせを含めることができます。

* 「 a 」 ～ 「 z 」
* 「 A 」 ～ 「 Z 」
* 0 ～ 9
* "`_`","`-`","`.")

 a| 
`-event-name`event_name`



 a| 
プロトコル _

FPolicy イベント用に設定するプロトコルを指定します。「 -protocol 」のリストには、次のいずれかの値を指定できます。

* CIFS
* 「 NFSv3 」
* 「 NFSv4 」


[NOTE]
====
-protocol' を指定する場合は '-file-operations パラメータに有効な値を指定する必要がありますプロトコルのバージョンによって、有効な値が変わる可能性があります。

==== a| 
「 -protocol 」「 protocol 」



 a| 
_ ファイル操作 _

FPolicy イベントのファイル操作のリストを指定します。

イベントは '-protocol' パラメータで指定されたプロトコルを使用して ' すべてのクライアント要求からこのリストに指定された操作をチェックします1 つ以上のファイル操作をカンマで区切って指定できます。-file-operations のリストには ' 次の値を 1 つ以上含めることができます

* ファイルクローズ操作の場合は 'close
* ファイル作成操作のための 'create
* 「 create-dir 」は、ディレクトリ作成操作を表します
* ファイル削除操作の場合は「削除」
* ディレクトリ削除操作の場合は '`edelete_dir`
* 属性取得操作の場合は 'getattr
* リンク操作の場合は 'link
* ルックアップ操作用の「 lookup 」
* 「 open 」はファイルオープン操作を表します
* 「ファイルの読み取り操作」を参照してください
* ファイル書き込み操作の場合は「 write 」です
* ファイル名変更操作の場合は「 re name 」
* 「 rename_dir 」は、ディレクトリ名変更操作を表します
* 属性設定操作用の 'setattr
* シンボリック・リンク操作用の 'ymlink


[NOTE]
====
-file-operations を指定する場合は '-protocol パラメータに有効なプロトコルを指定する必要があります

==== a| 
`-file-doperations `file_doperations`,...



 a| 
_ フィルタ _

指定したプロトコルにおける所定のファイル操作に対するフィルタのリストを指定します。-filters パラメータ内の値は ' クライアント要求をフィルタリングするために使用されますリストには次の値を 1 つ以上指定できます。

[NOTE]
====
-filters' パラメータを指定する場合は '-file-doperations' および '-protocol' パラメータに有効な値も指定する必要があります

====
* 「モニタ ADS 」オプションを使用して、代替データストリームのクライアント要求をフィルタリングします。
* close-with-modification オプション：変更してクローズ操作を要求するクライアント要求をフィルタリングします。
* close-without-modification オプション：変更せずにクローズ操作を要求するクライアント要求をフィルタリングします。
* 最初の読み取りを要求するクライアント要求をフィルタリングするための 'first-read' オプション
* 最初の書き込みを要求するクライアント要求をフィルタリングするための 'first-write オプション
* オフライン・ビット・セットのクライアント要求をフィルタリングするための offline-bit' オプション
+
このフィルタを設定すると、オフラインのファイルがアクセスされた場合のみ FPolicy サーバが通知を受信します。

* open-with-delete-intent' オプションを使用して ' 削除目的で開くクライアント要求をフィルタリングします
+
このフィルタを設定すると、削除するためにファイルが開かれた場合のみ FPolicy サーバが通知を受信します。これは 'FILE_DELETE_ON_CLOSE フラグを指定した場合に ' ファイルシステムによって使用されます

* 書き込み目的で開くクライアント要求をフィルタリングするための 'open-with-write-intent' オプション
+
このフィルタを設定すると、書き込むためにファイルを開いた場合のみ FPolicy サーバが通知を受信します。

* write-with-size-change オプション：サイズの変更を伴う書き込みを要求するクライアント要求をフィルタリングします

 a| 
`-filter`filter`,...



 a| 
_ フィルタ _ 続き

* 「 etattr-with-owner-change 」オプション：ファイルまたはディレクトリの所有者を変更するクライアント属性設定要求をフィルタリングします。
* 「 etattr-with-group-change 」オプション：ファイルまたはディレクトリのグループを変更するクライアント属性設定要求をフィルタリングします。
* 「 setattr-with-sacl-change 」オプション：ファイルまたはディレクトリの SACL を変更するクライアント属性設定要求をフィルタリングします。
+
このフィルタは、 SMB プロトコルと NFSv4 プロトコルに対してのみ使用できます。

* 「 setattr-with-dacl-change 」オプション：ファイルまたはディレクトリの DACL を変更するクライアント属性設定要求をフィルタリングします。
+
このフィルタは、 SMB プロトコルと NFSv4 プロトコルに対してのみ使用できます。

* setattr-with-modify-time-change オプション：ファイルまたはディレクトリの変更日時を変更するクライアント属性設定要求をフィルタリングします。
* setattr-with-access-time-change オプション：ファイルまたはディレクトリのアクセス日時を変更するクライアント属性設定要求をフィルタリングします。
* 「 etattr-with-creation-time-change 」オプション：ファイルまたはディレクトリの作成時刻を変更するクライアント属性設定要求をフィルタリングします。
+
このオプションは、 SMB プロトコルに対してのみ使用できます。

* setattr-with-mode-change オプション：ファイルまたはディレクトリのモードビットを変更するクライアント属性設定要求をフィルタリングします。
* setattr-with--size-change オプション：ファイルのサイズを変更するクライアント属性設定要求をフィルタリングします。
* setattr-with-allocation-size-change オプション：ファイルの割り当てサイズを変更するクライアント属性設定要求をフィルタリングします。
+
このオプションは、 SMB プロトコルに対してのみ使用できます。

* ディレクトリ操作のクライアント要求をフィルタリングするには 'exclude-directory' オプションを使用します
+
このフィルタを指定すると、ディレクトリ操作は監視されません。


 a| 
`-filter`filter`,...



 a| 
は、ボリューム処理が必要です _

ボリュームのマウントおよびアンマウント操作に対して監視が必要かどうかを指定します。デフォルトは「 false 」です。
 a| 
-volume-operation '{`true|`false`}

|===