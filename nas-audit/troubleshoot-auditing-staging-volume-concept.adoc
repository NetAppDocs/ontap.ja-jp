---
permalink: nas-audit/troubleshoot-auditing-staging-volume-concept.html 
sidebar: sidebar 
keywords: troubleshoot, audit, stage, volume space, issues 
summary: ステージング ボリュームや監査イベント ログを格納するボリュームに十分なスペースがない場合、問題が発生することがあります。十分なスペースがないと新しい監査レコードを作成できないため、クライアントからデータにアクセスできず、アクセス要求が失敗します。ボリュームのスペースに関するこれらの問題について、トラブルシューティングを行って問題を解決する方法を確認しておく必要があります。 
---
= ONTAPの監査およびステージング ボリュームのスペースに関する問題のトラブルシューティング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ステージング ボリュームや監査イベント ログを格納するボリュームに十分なスペースがない場合、問題が発生することがあります。十分なスペースがないと新しい監査レコードを作成できないため、クライアントからデータにアクセスできず、アクセス要求が失敗します。ボリュームのスペースに関するこれらの問題について、トラブルシューティングを行って問題を解決する方法を確認しておく必要があります。



== イベント ログ ボリュームに関するスペースの問題のトラブルシューティング

イベント ログ ファイルを含むボリュームでスペースが不足すると、監査でログ レコードをログ ファイルに変換できなくなります。その結果、クライアント アクセスに失敗します。イベント ログ ボリュームのスペースに関する問題のトラブルシューティング方法を把握しておく必要があります。

* Storage Virtual Machine（SVM）管理者およびクラスタ管理者は、ボリュームとアグリゲートの使用量と設定に関する情報を表示して、ボリュームでスペースが不足していないかを確認できます。
* イベント ログを含むボリュームでスペースが不足している場合、SVM管理者およびクラスタ管理者は、いくつかのイベント ログ ファイルを削除するかボリュームのサイズを大きくすることで、スペースに関する問題を解決できます。
+
[NOTE]
====
イベント ログ ボリュームを含むアグリゲートがいっぱいになっている場合は、ボリュームのサイズを大きくする前に、アグリゲートのサイズを大きくする必要があります。アグリゲートのサイズを大きくすることができるのは、クラスタ管理者だけです。

====
* 監査設定を変更して、イベント ログ ファイルのデスティネーション パスを別のボリューム上のディレクトリに変更できます。
+
[NOTE]
====
次の場合はデータへのアクセスが拒否されます。

** デスティネーション ディレクトリが削除されている
** デスティネーション ディレクトリをホストするボリュームのファイル リミットが最大レベルに達している


====


詳細については以下を参照してください。

* link:../volumes/index.html["ボリュームに関する情報の表示方法とボリューム サイズの増加方法"]。
* link:../disks-aggregates/index.html["アグリゲートに関する情報の表示方法とアグリゲートの管理方法"]。




== ステージング ボリュームに関するスペースの問題のトラブルシューティング

Storage Virtual Machine（SVM）のステージング ファイルを含むボリュームのいずれかでスペースが不足すると、監査でログ レコードをステージング ファイルに書き込むことができなくなります。その結果、クライアント アクセスに失敗します。この問題のトラブルシューティングを行うには、ボリュームの使用量に関する情報を表示して、SVMで使用されているステージング ボリュームのいずれかがいっぱいになっていないかを確認する必要があります。

統合イベントログファイルを含むボリュームに十分なスペースがあるにもかかわらず、スペース不足が原因でクライアントアクセスが失敗する場合は、ステージングボリュームのスペースが不足している可能性があります。SVM管理者は、SVMのステージングファイルを含むステージングボリュームのスペースが不足していないかどうかを確認するために、管理者に連絡する必要があります。ステージングボリュームのスペース不足のために監査イベントを生成できない場合、監査サブシステムはEMSイベントを生成します。次のメッセージが表示されます： `No space left on device`。ステージングボリュームに関する情報は管理者のみが表示できます。SVM管理者は表示できません。

すべてのステージング ボリューム名は `MDV_aud_`で始まり、その後にそのステージング ボリュームを含むアグリゲートのUUIDが続きます。次の例は、クラスタ内のデータSVMにファイル サービス監査設定が作成されたときに自動的に作成された、管理SVM上の4つのシステム ボリュームを示しています：

[listing]
----
cluster1::> volume show -vserver cluster1
Vserver   Volume       Aggregate    State      Type       Size  Available Used%
--------- ------------ ------------ ---------- ---- ---------- ---------- -----
cluster1  MDV_aud_1d0131843d4811e296fc123478563412
                       aggr0        online     RW          5GB     4.75GB    5%
cluster1  MDV_aud_8be27f813d7311e296fc123478563412
                       root_vs0     online     RW          5GB     4.75GB    5%
cluster1  MDV_aud_9dc4ad503d7311e296fc123478563412
                       aggr1        online     RW          5GB     4.75GB    5%
cluster1  MDV_aud_a4b887ac3d7311e296fc123478563412
                       aggr2        online     RW          5GB     4.75GB    5%
4 entries were displayed.
----
ステージング ボリュームでスペースが不足している場合は、ボリュームのサイズを大きくすることで、スペースに関する問題を解決できます。

[NOTE]
====
ステージング ボリュームを含むアグリゲートがいっぱいになっている場合は、ボリュームのサイズを大きくする前に、アグリゲートのサイズを大きくする必要があります。アグリゲートのサイズを大きくすることができるのは、クラスタ管理者だけです。SVM管理者はこの操作を行うことができません。

====
使用可能なスペースが2GB未満（ONTAP 9.14.1以前）または5GB未満（ONTAP 9.15.1以降）のアグリゲートがあると、SVMの監査の作成に失敗します。SVMの監査の作成に失敗した場合、作成されたステージング ボリュームは削除されます。
