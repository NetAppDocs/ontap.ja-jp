---
sidebar: sidebar 
permalink: networking/create_svms.html 
keywords: create, creation, creating, add, adding, svm, storage, virtual, machine, create svms, create storage virtual machines, create an svm to serve data to clients, system manager 
summary: クライアントにデータを提供するための SVM を作成する 
---
= ONTAPネットワーク用のSVMを作成する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
クライアントにデータを提供するには、SVMを作成する必要があります。

.開始する前に
* このタスクを実行するには、クラスタ管理者である必要があります。
* SVMのルート ボリュームに設定するセキュリティ形式を決めておく必要があります。
+
このSVMにHyper-V over SMBまたはSQL Server over SMBソリューションを実装する予定がある場合は、ルート ボリュームにNTFSセキュリティ形式を使用してください。Hyper-VファイルまたはSQLデータベース ファイルを格納するボリュームは、作成時にNTFSセキュリティ形式に設定する必要があります。ルート ボリュームのセキュリティ形式をNTFSに設定することで、UNIXセキュリティ形式またはmixedセキュリティ形式のデータ ボリュームを誤って作成することがなくなります。

* ONTAP 9.13.1以降では、ストレージVMの最大容量を設定できます。また、SVMの容量がしきい値に近づいた場合にアラートを設定することもできます。詳細については、xref:../volumes/manage-svm-capacity.html[SVMの容量の管理]を参照してください。


[role="tabbed-block"]
====
.System Manager
--
System Managerを使用してStorage VMを作成できます。

.手順
. *Storage VM* を選択します。
. image:icon_add.gif["アイコンを追加"]をクリックしてストレージ VM を作成します。
. Storage VMの名前を指定します。
. アクセス プロトコルを選択します。
+
** SMB / CIFS、NFS
** iSCSI
** FC
** NVMe
+
... *SMB/CIFS を有効にする* を選択した場合は、次の設定を完了します：






|===


| フィールドまたはチェックボックス | 概要 


 a| 
管理者名
 a| 
SMB/CIFS ストレージ VM の管理者ユーザ名を指定します。



 a| 
パスワード
 a| 
SMB/CIFS ストレージ VM の管理者パスワードを指定します。



 a| 
サーバ名
 a| 
SMB/CIFS ストレージ VM のサーバ名を指定します。



 a| 
Active Directory ドメイン
 a| 
SMB/CIFS ストレージ VM のユーザ認証を提供するための Active Directory ドメインを指定します。



 a| 
組織単位
 a| 
SMB/CIFS サーバに関連付けられている Active Directory ドメイン内の組織単位を指定します。「CN=Computers」はデフォルト値ですが、変更できます。



 a| 
ストレージVM内の共有にアクセスする際にデータを暗号化します
 a| 
SMB 3.0 を使用してデータを暗号化し、SMB/CIFS ストレージ VM 内の共有への不正なファイル アクセスを防ぐには、このチェック ボックスをオンにします。



 a| 
ドメイン
 a| 
SMB/CIFS ストレージ VM にリストされているドメインを追加、削除、または並べ替えます。



 a| 
ネーム サーバ
 a| 
SMB/CIFS ストレージ VM のネーム サーバーを追加、削除、または並べ替えます。



 a| 
デフォルト言語
 a| 
Storage VM とそのボリュームのデフォルトの言語エンコード設定を指定します。Storage VM内の個々のボリュームの設定を変更する場合はCLIを使用してください。



 a| 
ネットワーク インターフェイス
 a| 
ストレージVM用に設定するネットワークインターフェイスごとに、既存のサブネット（少なくとも1つ存在する場合）を選択するか、*Without a subnet*を指定して、*IP Address*と*Subnet Mask*のフィールドに入力します。必要に応じて、*Use the same subnet mask and gateway for all of the following interfaces*チェックボックスをオンにしてください。ホームポートはシステムによって自動的に選択されるようにすることも、リストから使用するポートを手動で選択することもできます。



 a| 
管理者アカウントの管理
 a| 
ストレージVM管理者アカウントを管理する場合は、このチェックボックスをオンにします。オンにした場合は、ユーザ名とパスワードを指定してパスワードを確認し、ストレージVM管理用のネットワーク インターフェイスを追加するかどうかを指定します。

|===
. *Enable NFS* を選択した場合は、次の設定を完了します。


|===


| フィールドまたはチェックボックス | 概要 


 a| 
NFSクライアントアクセスを許可するチェックボックス
 a| 
NFSストレージVM上に作成されたすべてのボリュームがマウントおよびトラバースにルートボリュームパス「/」を使用する場合は、このチェックボックスをオンにします。エクスポートポリシー「default」にルールを追加して、マウントトラバースが中断されないようにします。



 a| 
ルール
 a| 
image:icon_add.gif["アイコンを追加"]をクリックしてルールを作成します。

* クライアント仕様：ホスト名、IP アドレス、ネットグループ、またはドメインを指定します。
* アクセス プロトコル：次のオプションの組み合わせを選択します。
+
** SMB / CIFS
** FlexCache
** NFS
+
*** NFSv3
*** NFSv4




* アクセス詳細：ユーザのタイプごとに、読み取り専用、読み取り/書き込み、スーパーユーザのいずれかのアクセス レベルを指定します。ユーザのタイプには次のものがあります：
+
** All
** All (as anonymous user)
** UNIX
** Kerberos 5
** Kerberos 5i
** Kerberos 5p
** NTLM




ルールを保存します。



 a| 
デフォルト言語
 a| 
Storage VM とそのボリュームのデフォルトの言語エンコード設定を指定します。Storage VM内の個々のボリュームの設定を変更する場合はCLIを使用してください。



 a| 
ネットワーク インターフェイス
 a| 
ストレージVM用に設定するネットワークインターフェイスごとに、既存のサブネット（少なくとも1つ存在する場合）を選択するか、*Without a subnet*を指定して、*IP Address*と*Subnet Mask*のフィールドに入力します。必要に応じて、*Use the same subnet mask and gateway for all of the following interfaces*チェックボックスをオンにしてください。ホームポートはシステムによって自動的に選択されるようにすることも、リストから使用するポートを手動で選択することもできます。



 a| 
管理者アカウントの管理
 a| 
ストレージVM管理者アカウントを管理する場合は、このチェックボックスをオンにします。オンにした場合は、ユーザ名とパスワードを指定してパスワードを確認し、ストレージVM管理用のネットワーク インターフェイスを追加するかどうかを指定します。

|===
. *iSCSI を有効にする* を選択した場合は、次の設定を完了します：


|===


| フィールドまたはチェックボックス | 概要 


 a| 
ネットワーク インターフェイス
 a| 
ストレージVM用に設定するネットワークインターフェイスごとに、既存のサブネット（少なくとも1つ存在する場合）を選択するか、*Without a subnet*を指定して、*IP Address*と*Subnet Mask*のフィールドに入力します。必要に応じて、*Use the same subnet mask and gateway for all of the following interfaces*チェックボックスをオンにしてください。ホームポートはシステムによって自動的に選択されるようにすることも、リストから使用するポートを手動で選択することもできます。



 a| 
管理者アカウントの管理
 a| 
ストレージVM管理者アカウントを管理する場合は、このチェックボックスをオンにします。オンにした場合は、ユーザ名とパスワードを指定してパスワードを確認し、ストレージVM管理用のネットワーク インターフェイスを追加するかどうかを指定します。

|===
. *FC を有効にする* を選択した場合は、次の設定を完了します：


|===


| フィールドまたはチェックボックス | 概要 


 a| 
FCポートの設定
 a| 
ストレージVMに含めるノード上のネットワークインターフェースを選択します。ノードごとに2つのネットワークインターフェースが推奨されます。



 a| 
管理者アカウントの管理
 a| 
ストレージVM管理者アカウントを管理する場合は、このチェックボックスをオンにします。オンにした場合は、ユーザ名とパスワードを指定してパスワードを確認し、ストレージVM管理用のネットワーク インターフェイスを追加するかどうかを指定します。

|===
. *NVMe/FC を有効にする* を選択した場合は、次の構成を完了します：


|===


| フィールドまたはチェックボックス | 概要 


 a| 
FCポートの設定
 a| 
ストレージVMに含めるノード上のネットワークインターフェースを選択します。ノードごとに2つのネットワークインターフェースが推奨されます。



 a| 
管理者アカウントの管理
 a| 
ストレージVM管理者アカウントを管理する場合は、このチェックボックスをオンにします。オンにした場合は、ユーザ名とパスワードを指定してパスワードを確認し、ストレージVM管理用のネットワーク インターフェイスを追加するかどうかを指定します。

|===
. *NVMe/TCP を有効にする* を選択した場合は、次の構成を完了します：


|===


| フィールドまたはチェックボックス | 概要 


 a| 
ネットワーク インターフェイス
 a| 
ストレージVM用に設定するネットワークインターフェイスごとに、既存のサブネット（少なくとも1つ存在する場合）を選択するか、*Without a subnet*を指定して、*IP Address*と*Subnet Mask*のフィールドに入力します。必要に応じて、*Use the same subnet mask and gateway for all of the following interfaces*チェックボックスをオンにしてください。ホームポートはシステムによって自動的に選択されるようにすることも、リストから使用するポートを手動で選択することもできます。



 a| 
管理者アカウントの管理
 a| 
ストレージVM管理者アカウントを管理する場合は、このチェックボックスをオンにします。オンにした場合は、ユーザ名とパスワードを指定してパスワードを確認し、ストレージVM管理用のネットワーク インターフェイスを追加するかどうかを指定します。

|===
. 変更を保存します。


--
.CLI
--
ONTAP CLIを使用してサブネットを作成します。

.手順
. SVMのルート ボリュームを格納するためのアグリゲートを決定します。
+
`storage aggregate show -has-mroot false`

+
ルート ボリュームを格納するための空きスペースが1GB以上あるアグリゲートを選択する必要があります。SVMでNASの監査を設定する場合は、ルート アグリゲートに少なくとも3GBの追加の空きスペースと、監査を有効にしたときに監査ステージング ボリュームの作成に使用される追加のスペースが必要です。

+

NOTE: 既存のSVMでNASの監査がすでに有効になっている場合は、アグリゲートの作成が完了したあとすぐにアグリゲートのステージング ボリュームが作成されます。

. SVMのルート ボリュームを作成するアグリゲートの名前を控えます。
. SVMを作成するときに言語を指定する予定であり、使用する値がわからない場合は、指定する言語の値を確認し、その値を控えます。
+
`vserver create -language ?`

. SVMの作成時にSnapshotポリシーを指定する予定があり、ポリシーの名前がわからない場合は、使用可能なポリシーを一覧表示し、使用するSnapshotポリシーの名前を特定して記録します：
+
`volume snapshot policy show -vserver _vserver_name_`

. SVMを作成するときにクォータ ポリシーを指定する予定であり、ポリシーの名前がわからない場合は、使用可能なポリシーの一覧を表示し、使用するクォータ ポリシーの名前を確認して、その名前を控えます。
+
`volume quota policy show -vserver _vserver_name_`

. SVMを作成します。
+
`vserver create -vserver _vserver_name_ -aggregate _aggregate_name_ ‑rootvolume _root_volume_name_ -rootvolume-security-style {unix|ntfs|mixed} [-ipspace _IPspace_name_] [-language <language>] [-snapshot-policy _snapshot_policy_name_] [-quota-policy _quota_policy_name_] [-comment _comment_]`

+
....
vserver create -vserver vs1 -aggregate aggr3 -rootvolume vs1_root ‑rootvolume-security-style ntfs -ipspace ipspace1 -language en_US.UTF-8
....
+
`[Job 72] Job succeeded: Vserver creation completed`

. SVMの設定が正しいことを確認します。
+
`vserver show -vserver vs1`

+
....
Vserver: vs1
Vserver Type: data
Vserver Subtype: default
Vserver UUID: 11111111-1111-1111-1111-111111111111
Root Volume: vs1_root
Aggregate: aggr3
NIS Domain: -
Root Volume Security Style: ntfs
LDAP Client: -
Default Volume Language Code: en_US.UTF-8
Snapshot Policy: default
Comment:
Quota Policy: default
List of Aggregates Assigned: -
Limit on Maximum Number of Volumes allowed: unlimited
Vserver Admin State: running
Vserver Operational State: running
Vserver Operational State Stopped Reason: -
Allowed Protocols: nfs, cifs, ndmp
Disallowed Protocols: fcp, iscsi
QoS Policy Group: -
Config Lock: false
IPspace Name: ipspace1
Is Vserver Protected: false
....
+
この例では、コマンドを実行すると「vs1」という名前のSVMがIPspace「ipspace1」に作成されます。ルート ボリュームは、「vs1_root」という名前で、NTFSセキュリティ形式を使用してaggr3に作成されます。



--
====

NOTE: ONTAP 9.13.1以降では、アダプティブQoSポリシーグループテンプレートを設定して、SVM内のボリュームにスループットの下限と上限を適用できます。このポリシーは、SVMを作成した後にのみ適用できます。このプロセスの詳細については、xref:../performance-admin/adaptive-policy-template-task.html[アダプティブ ポリシー グループ テンプレートの設定]を参照してください。
