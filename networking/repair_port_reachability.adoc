---
sidebar: sidebar 
permalink: networking/repair_port_reachability.html 
keywords: port, reachability, repair, fix, error, switch, configuration, cable, cabling, wiring, wire, wired, re-cabled, layer 2, repair port reachability, network port reachability show -detail -node -port, repair reachability decision tree, unexpected ports, unreachable ports, lifs and repaired ports, vlans and repaired ports, interface groups and repaired ports 
summary: ポートを再接続した場合やスイッチの設定が変わった場合は、新しいブロードキャストドメインや既存のブロードキャストドメインにポートを修復しなければならないことがあります 
---
= ポートの到達可能性を修復します
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ブロードキャストドメインが自動的に作成されます。ただし、ポートがケーブル接続されている場合やスイッチの設定が変更された場合は、別のブロードキャストドメイン（新規または既存）にポートを修復する必要があります。

ONTAP では、ブロードキャストドメインコンスティチュエント（イーサネットポート）レイヤ 2 の到達可能性に基づいて、ネットワーク配線の問題を自動的に検出し、解決策を推奨できます。

配線が正しくないと、予期しないブロードキャストドメインポート割り当てが原因に実行される可能性があります。ONTAP 9.10.1 以降では、クラスタのセットアップ後や新しいノードが既存のクラスタに追加されたときにポートに到達できるかどうかを確認することで、ネットワーク配線に問題がないかどうかが自動的に確認されます。

[role="tabbed-block"]
====
.System Manager の略
--
ポートに到達可能性問題が検出された場合、問題を解決する修復処理を推奨します。

クラスタのセットアップが完了すると、ダッシュボードにネットワークの配線に関する問題が報告されます。

新しいノードをクラスタに追加したあと、ノードページにネットワークの配線の問題が表示されます。

ネットワークダイアグラムでネットワークの配線の状態を確認することもできます。ポート到達可能性の問題は、ネットワークダイアグラムで赤いエラーアイコンで示されます。

.クラスタのセットアップ後
クラスタのセットアップ後にネットワークの配線問題が検出されると、ダッシュボードにメッセージが表示されます。

image:auto-detect-01.png["クラスタセットアップ後のメッセージ"]

.手順
. メッセージに示されているように配線を修正します。
. リンクをクリックして、 [ ブロードキャストドメインの更新 ] ダイアログを起動します。
[ ブロードキャストドメインの更新 ] ダイアログボックスが開きます。
image:auto-detect-02.png["[ ブロードキャストドメインの更新 ] ダイアログ"]
. ノード、問題、現在のブロードキャストドメイン、および想定されるブロードキャストドメインなど、ポートに関する情報を確認します。
. 修復するポートを選択し、 [* Fix] をクリックします。
ポートは現在のブロードキャストドメインから想定されるブロードキャストドメインに移動されます。


.ノードの追加後
新しいノードをクラスタに追加したあとに、ネットワークの配線問題が検出されると、 Nodes ページにメッセージが表示されます。

image:auto-detect-03.png["ノード参加後のメッセージです"]

.手順
. メッセージに示されているように配線を修正します。
. リンクをクリックして、 [ ブロードキャストドメインの更新 ] ダイアログを起動します。
[ ブロードキャストドメインの更新 ] ダイアログボックスが開きます。
image:auto-detect-02.png["[ ブロードキャストドメインの更新 ] ダイアログ"]
. ノード、問題、現在のブロードキャストドメイン、および想定されるブロードキャストドメインなど、ポートに関する情報を確認します。
. 修復するポートを選択し、 [* Fix] をクリックします。
ポートは現在のブロードキャストドメインから想定されるブロードキャストドメインに移動されます。


--
.CLI の使用
--
.作業を開始する前に
このタスクを実行するには、クラスタ管理者である必要があります。

.このタスクについて
ONTAP が検出したレイヤ 2 到達可能性に基づいて、ポートのブロードキャストドメイン設定を自動的に修復するコマンドが用意されています。

.手順
. スイッチの構成とケーブル接続を確認します。
. ポートの到達可能性を確認します。
+
`network port reachability show -detail -node -port`

+
コマンド出力に到達可能性の結果が含まれています。

. 次のデシジョンツリーとテーブルを使用して、到達可能性の結果を理解し、次に何をすべきかを判断します。
+
image:ontap_nm_image1.png["到達可能性決定ツリーを修復します"]



[cols="20,80"]
|===


| プレゼンスステータス | 説明 


 a| 
わかりました
 a| 
ポートに割り当てられているブロードキャストドメインにレイヤ 2 の到達可能性があります。
reachable-status が「 OK 」であるのに、「予想外のポート」がある場合は、 1 つ以上のブロードキャストドメインをマージすることを検討してください。詳細については、次の _unexpected ports_row を参照してください。

reachable-status が「 OK 」であるが、「到達不能ポート」がある場合は、 1 つ以上のブロードキャストドメインをスプリットすることを検討してください。詳細については、次の _Unreachable Ports_row を参照してください。

reachable-status が「 OK 」で、予期しないポートや到達不能なポートがない場合は、設定が正しいことを確認してください。



 a| 
予期しないポートです
 a| 
ポートには、割り当てられたブロードキャストドメインにレイヤ 2 に到達できることがありますが、少なくとも 1 つの他のブロードキャストドメインにレイヤ 2 に到達できることもあります。

物理接続とスイッチの設定を調べて、ポートに割り当てられているブロードキャストドメインを1つ以上のブロードキャストドメインにマージする必要がないかどうかを確認します。

詳細については、を参照してください link:merge_broadcast_domains.html["ブロードキャストドメインをマージします"]。



 a| 
到達不能ポート
 a| 
1 つのブロードキャストドメインが 2 つの異なる到達可能性セットにパーティショニングされている場合は、ブロードキャストドメインをスプリットして ONTAP 構成を物理ネットワークトポロジと同期できます。

通常、到達不能ポートのリストでは、物理ポートとスイッチの設定が正確であることを確認したあとに別のブロードキャストドメインにスプリットする必要があるポートを定義します。

詳細については、を参照してください link:split_broadcast_domains.html["ブロードキャストドメインをスプリットします"]。



 a| 
誤設定 - 到達可能性
 a| 
ポートに割り当てられているブロードキャストドメインにレイヤ 2 に到達できるかどうかは関係ありませんが、ポートは別のブロードキャストドメインにレイヤ 2 に到達できるかどうかは関係ありません。

ポートに到達できるかどうかを修復できます。次のコマンドを実行すると、ポートに到達できるブロードキャストドメインにポートが割り当てられます。

`network port reachability repair -node -port`



 a| 
到達不能
 a| 
既存のどのブロードキャストドメインにもレイヤ 2 で接続できません。

ポートに到達できるかどうかを修復できます。次のコマンドを実行すると、自動的に作成されたデフォルトの IPspace 内の新しいブロードキャストドメインにポートが割り当てられます。

`network port reachability repair -node -port`

*注：*すべてのインターフェイスグループ（ifgrp）メンバーポートがレポートされた場合 `no-reachability`を実行します。 `network port reachability repair` 各メンバーポートでコマンドを実行すると、それぞれのポートが原因形式でifgrpから削除されて新しいブロードキャストドメインに配置され、ifgrp自体が削除されます。を実行する前に `network port reachability repair` コマンドを入力し、物理ネットワークトポロジに基づいて、ポートに到達可能なブロードキャストドメインが想定どおりであることを確認します。



 a| 
multi-domain-reachable
 a| 
ポートには、割り当てられたブロードキャストドメインにレイヤ 2 に到達できることがありますが、少なくとも 1 つの他のブロードキャストドメインにレイヤ 2 に到達できることもあります。

物理接続とスイッチの設定を調べて、ポートに割り当てられているブロードキャストドメインを1つ以上のブロードキャストドメインにマージする必要がないかどうかを確認します。

詳細については、を参照してください link:merge_broadcast_domains.html["ブロードキャストドメインをマージします"]。



 a| 
不明です
 a| 
reachable-status が「 unknown 」の場合は、数分待ってからもう一度コマンドを実行してください。

|===
ポートを修復したら、取り外された LIF と VLAN がないか確認します。ポートがインターフェイスグループに属していた場合は、そのインターフェイスグループに何が起こったかを理解する必要もあります。

.LIF
ポートを修復して別のブロードキャストドメインに移動すると、修復されたポートで設定されていたすべての LIF に新しいホームポートが自動的に割り当てられます。可能であれば、同じノード上の同じブロードキャストドメインからこのホームポートが選択されます。別のノードのホームポートを選択するか、適切なホームポートが存在しない場合は、ホームポートがクリアされます。

LIFのホームポートが別のノードに移動された場合、またはクリアされた場合、LIFは「削除された」とみなされます。削除されたこれらの LIF は、次のコマンドで確認できます。

`displaced-interface show`

取り外された LIF がある場合は、次のいずれかを行う必要があります。

* 取り外した LIF のホームをリストアします。
+
`displaced-interface restore`

* LIF のホームを手動で設定します。
+
`network interface modify -home-port -home-node`

* 現在設定されている LIF のホームに問題がなければ、「 remove-interface 」テーブルからエントリを削除します。
+
`displaced-interface delete`



.VLAN
修復されたポートに VLAN がある場合、それらの VLAN は自動的に削除されますが、「取り外された」としても記録されます。これらの取り外された VLAN を表示できます。

`displaced-vlans show`

取り外された VLAN がある場合は、次のいずれかを行う必要があります。

* VLAN を別のポートにリストアします。
+
`displaced-vlans restore`

* 「取り外した VLAN 」テーブルからエントリを削除します。
+
`displaced-vlans delete`



.インターフェイスグループ
修復されたポートがインターフェイスグループの一部であった場合、そのインターフェイスグループからは削除されます。インターフェイスグループに割り当てられている唯一のメンバーポートである場合、インターフェイスグループ自体が削除されます。

--
====
.関連トピック
link:https://docs.netapp.com/us-en/ontap/networking/verify_your_network_configuration.html["アップグレード後にネットワーク設定を確認します"]

link:monitor_the_reachability_of_network_ports.html["ネットワークポートの到達可能性を監視します"]
