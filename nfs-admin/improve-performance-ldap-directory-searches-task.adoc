---
permalink: nfs-admin/improve-performance-ldap-directory-searches-task.html 
sidebar: sidebar 
keywords: improve, performance, ldap, directory, netgroup, host, search, ptr, forward, reverse, rfc 5952, export rule, 
summary: LDAP環境がホスト単位のネットグループ検索を許可するように設定されている場合は、この機能を利用するようにONTAPを設定し、ホスト単位のネットグループ検索を実行することができます。これにより、ネットグループ検索の処理速度を大幅に引き上げ、ネットグループ検索時のレイテンシによるNFSクライアント アクセスの問題を減らすことができます。 
---
= ONTAP NFS SVMのLDAPディレクトリネットグループ別ホスト検索のパフォーマンスを向上
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
LDAP環境がホスト単位のネットグループ検索を許可するように設定されている場合は、この機能を利用するようにONTAPを設定し、ホスト単位のネットグループ検索を実行することができます。これにより、ネットグループ検索の処理速度を大幅に引き上げ、ネットグループ検索時のレイテンシによるNFSクライアント アクセスの問題を減らすことができます。

.開始する前に
LDAP ディレクトリには `netgroup.byhost` マップが含まれている必要があります。

DNSサーバには、NFSクライアントに対するフォワード（A）およびリバース（PTR）ルックアップ レコードの両方が含まれている必要があります。

ネットグループ内のIPv6アドレスを指定する際には、常にRFC 5952で指定されているとおりに各アドレスを短縮および圧縮する必要があります。

.タスク概要
NISサーバは `netgroup`、 `netgroup.byuser`、 `netgroup.byhost`という3つの個別のマップにネットグループ情報を保存します。 `netgroup.byuser`マップと `netgroup.byhost`マップの目的は、ネットグループ検索を高速化することです。ONTAPは、NISサーバ上でホストごとのネットグループ検索を実行し、マウント応答時間を短縮できます。

デフォルトでは、LDAPディレクトリにはNISサーバのような `netgroup.byhost`マップはありません。ただし、サードパーティ製ツールを使用すれば、NIS `netgroup.byhost`マップをLDAPディレクトリにインポートして、ホストごとのネットグループ検索を高速化できます。LDAP環境でホストごとのネットグループ検索を許可するように設定している場合は、ONTAPのLDAPクライアントに `netgroup.byhost`マップ名、DN、検索範囲を指定して設定することで、ホストごとのネットグループ検索を高速化できます。

ホスト単位のネットグループ検索の結果をより迅速に受け取ることで、ONTAPは、エクスポートへのアクセスをNFSクライアントから要求されたときに、より速くエクスポート ルールを処理できます。これにより、ネットグループ検索によるレイテンシの問題によってアクセスが遅延する可能性が低下します。

.手順
. LDAP ディレクトリにインポートした NIS `netgroup.byhost` マップの正確な完全識別名を取得します。
+
マップのDNは、インポートに使用したサードパーティ ツールによって異なる場合があります。最高のパフォーマンスを得るために、正確なマップDNを指定してください。

. 権限レベルをadvancedに設定します： `set -privilege advanced`
. Storage Virtual Machine（SVM）のLDAPクライアント設定でホスト別ネットグループ検索を有効にします： `vserver services name-service ldap client modify -vserver vserver_name -client-config config_name -is-netgroup-byhost-enabled true -netgroup-byhost-dn netgroup-by-host_map_distinguished_name -netgroup-byhost-scope netgroup-by-host_search_scope`
+
`-is-netgroup-byhost-enabled` {`true` `false`} は、LDAPディレクトリのホスト別ネットグループ検索を有効または無効にします。デフォルトは `false`です。

+
`-netgroup-byhost-dn` `netgroup-by-host_map_distinguished_name`LDAPディレクトリ内の `netgroup.byhost`マップの識別名を指定します。これは、ネットグループとホスト間の検索におけるベースDNを上書きします。このパラメータを指定しない場合、ONTAPは代わりにベースDNを使用します。

+
`-netgroup-byhost-scope` {`base`|`onelevel` `subtree`} は、ネットグループによるホスト検索の検索範囲を指定します。このパラメータを指定しない場合、デフォルトは `subtree`です。

+
LDAPクライアント構成がまだ存在しない場合は、 `vserver services name-service ldap client create`コマンドを使用して新しいLDAPクライアント構成を作成するときにこれらのパラメータを指定することにより、ホスト別のネットグループ検索を有効にすることができます。

+
[NOTE]
====
 `-ldap-servers`フィールドは `-servers`フィールドを置き換えます。 `-ldap-servers`フィールドを使用して、LDAPサーバのホスト名またはIPアドレスのいずれかを指定できます。

====
. admin権限レベルに戻ります： `set -privilege admin`


.例
次のコマンドは、既存のLDAPクライアント構成「`ldap_corp`」を変更し、 `netgroup.byhost`「`nisMapName="netgroup.byhost",dc=corp,dc=example,dc=com`」という名前のマップとデフォルトの検索範囲 `subtree`を使用して、ホストごとのネットグループ検索を有効にします：

[listing]
----
cluster1::*> vserver services name-service ldap client modify -vserver vs1 -client-config ldap_corp -is-netgroup-byhost-enabled true -netgroup-byhost-dn nisMapName="netgroup.byhost",dc=corp,dc=example,dc=com
----
.終了後の操作
クライアント アクセスの問題を回避するには、ディレクトリ内の `netgroup.byhost`と `netgroup`マップを常に同期しておく必要があります。

.関連情報
https://datatracker.ietf.org/doc/html/rfc5952["IETF RFC 5952：IPv6アドレステキスト表現に関する推奨事項"]
