---
permalink: nfs-admin/multidomain-searches-unix-windows-user-concept.html 
sidebar: sidebar 
keywords:  
summary: ONTAP は、 UNIX ユーザを Windows ユーザにマッピングする際のマルチドメイン検索をサポートしています。一致する結果が返されるまで、検出されたすべての信頼できるドメインで、変換後のパターンに一致する名前が検索されます。また、信頼できる優先ドメインのリストを設定することもできます。このリストは、検出された信頼できるドメインのリストの代わりに使用され、一致する結果が返されるまで順に検索されます。 
---
= UNIX ユーザから Windows ユーザへのネームマッピングのためのマルチドメイン検索
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP は、 UNIX ユーザを Windows ユーザにマッピングする際のマルチドメイン検索をサポートしています。一致する結果が返されるまで、検出されたすべての信頼できるドメインで、変換後のパターンに一致する名前が検索されます。また、信頼できる優先ドメインのリストを設定することもできます。このリストは、検出された信頼できるドメインのリストの代わりに使用され、一致する結果が返されるまで順に検索されます。



== ドメインの信頼性が UNIX ユーザから Windows ユーザへのネームマッピング検索に与える影響

マルチドメインのユーザ名マッピングの仕組みを理解するには、ドメインの信頼性が ONTAP に与える影響を理解しておく必要があります。SMB サーバのホームドメインとの Active Directory 信頼関係は、双方向の信頼にすることも、インバウンドとアウトバウンドの 2 つのタイプがある単一方向の信頼のどちらかにすることもできます。ホームドメインは、 SVM 上の SMB サーバが属しているドメインです。

* _ 双方向の信頼 _
+
双方向の信頼では、両方のドメインが相互に信頼しています。SMB サーバのホームドメインが別のドメインと双方向の信頼関係にある場合、このホームドメインは信頼できるドメインに属しているユーザを認証および認可でき、その反対に、この信頼できるドメインはホームドメインに属しているユーザを認証および認可することができます。

+
UNIX ユーザから Windows ユーザへのネームマッピング検索は、ホームドメインと他方のドメインの間に双方向の信頼関係が確立されたドメインでのみ実行できます。

* アウトバウンドの信頼 _
+
アウトバウンドの信頼では、ホームドメインが他方のドメインを信頼しています。この場合、ホームドメインはアウトバウンドの信頼できるドメインに属しているユーザを認証および認可できます。

+
ホームドメインとアウトバウンドの信頼関係にあるドメインは、 UNIX ユーザから Windows ユーザへのネームマッピング検索の実行時に _not_searched になります。

* インバウンドの信頼 _
+
インバウンドの信頼では、 SMB サーバのホームドメインが他方のドメインによって信頼されています。この場合、ホームドメインはインバウンドの信頼できるドメインに属しているユーザを認証または認可できません。

+
ホームドメインとインバウンドの信頼関係にあるドメインは、 UNIX ユーザから Windows ユーザへのネームマッピング検索の実行時に _not_searched になります。





== ワイルドカード（ * ）を使用したネームマッピングのためのマルチドメイン検索の設定

マルチドメインネームマッピング検索は、 Windows ユーザ名のドメインセクションにワイルドカードを使用することで容易になります。次の表に、マルチドメイン検索を有効にするためにネームマッピングエントリのドメイン部にワイルドカードを使用する方法を示します。

[cols="3*"]
|===
| パターン（ Pattern ） | 交換 | 結果 


 a| 
ルート
 a| 
｛ Asterisk ｝ ｛ backslash ｝ ｛ backslash ｝ 管理者
 a| 
UNIX ユーザ「 root 」は「 administrator 」という名前のユーザにマッピングされます。「 administrator 」という名前の最初の一致するユーザが見つかるまで、すべての信頼できるドメインが順に検索されます。



 a| 
*
 a| 
｛ Asterisk ｝ ｛ backslash ｝ ｛ backslash ｝ ｛ Asterisk ｝
 a| 
有効な UNIX ユーザは、対応する Windows ユーザにマッピングされます。該当する名前のユーザとの最初の一致が見つかるまで、すべての信頼できるドメインが順に検索されます。

[NOTE]
====
パターン ｛ Asterisk ｝ ｛ backslash ｝ ｛ backslash ｝ ｛ Asterisk ｝ は、 UNIX から Windows へのネームマッピングでのみ有効で、反対方向では無効です。

====
|===


== マルチドメインの名前検索の実行方法

マルチドメインの名前検索に使用する信頼できるドメインのリストを決定する方法は 2 つあります。

* ONTAP で作成された自動検出された双方向の信頼リストを使用します
* 自分で作成した信頼できる優先ドメインリストを使用します


ユーザ名のドメインセクションにワイルドカードを使用して UNIX ユーザが Windows ユーザにマッピングされている場合、 Windows ユーザはすべての信頼できるドメインで次のように検索されます。

* 信頼できるドメインの優先リストが設定されている場合、マッピング先の Windows ユーザはこの検索リスト内でのみ順に検索されます。
* 信頼できるドメインの優先リストが設定されていない場合は、ホームドメインと双方向の信頼関係にあるすべてのドメインで Windows ユーザの検索が行われます。
* ホームドメインと双方向の信頼関係にあるドメインが存在しない場合、ホームドメインでユーザの検索が行われます。


UNIX ユーザがユーザ名にドメインセクションのない Windows ユーザにマッピングされている場合は、ホームドメインで Windows ユーザの検索が行われます。
