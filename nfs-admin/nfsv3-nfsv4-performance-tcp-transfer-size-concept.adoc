---
permalink: nfs-admin/nfsv3-nfsv4-performance-tcp-transfer-size-concept.html 
sidebar: sidebar 
keywords: nfsv3, nfsv4, performance, improvement, modify, tcp, transfer, size 
summary: TCP 最大転送サイズを変更することで、高レイテンシ ネットワーク経由でストレージ システムに接続する NFSv3 および NFSv4 クライアントのパフォーマンスを向上させることができます。 
---
= ONTAP SVM の NFSv3 および NFSv4 のパフォーマンス向上と TCP 転送サイズについて学習します
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
TCP 最大転送サイズを変更することで、高レイテンシ ネットワーク経由でストレージ システムに接続する NFSv3 および NFSv4 クライアントのパフォーマンスを向上させることができます。

クライアントが、レイテンシが10ミリ秒を超える広域ネットワーク（WAN）やメトロエリアネットワーク（MAN）などの高レイテンシネットワーク経由でストレージシステムにアクセスする場合、TCP最大転送サイズを変更することで接続パフォーマンスを向上できる可能性があります。ローカルエリアネットワーク（LAN）などの低レイテンシネットワーク経由でストレージシステムにアクセスするクライアントの場合、これらのパラメータを変更してもほとんど、あるいは全く効果が得られません。スループットの向上がレイテンシへの影響を上回らない場合は、これらのパラメータを使用しないでください。

これらのパラメータを変更することでストレージ環境が改善されるかどうかを判断するには、まず、パフォーマンスが低いNFSクライアントの包括的なパフォーマンス評価を実施する必要があります。パフォーマンスの低下が、クライアントでの過剰なラウンドトリップ遅延や小さなリクエストによるものかどうかを確認してください。このような状況では、クライアントとサーバーは、接続を介して送信される小さなリクエストとレスポンスの待機にデューティサイクルの大部分を費やすため、利用可能な帯域幅を十分に活用できません。

NFSv3 および NFSv4 の要求サイズを増やすと、クライアントとサーバーは利用可能な帯域幅をより効率的に使用して、単位時間あたりに移動するデータ量を増やすことができるため、接続の全体的な効率が向上します。

ストレージ システムとクライアント間の構成は異なる場合があることにご注意ください。ストレージ システムとクライアントは、転送操作の最大サイズとして 1 MB をサポートしています。ただし、ストレージ システムが最大転送サイズ 1 MB をサポートするように設定しているのに、クライアントが 64 KB しかサポートしていない場合、マウント転送サイズは 64 KB 以下に制限されます。

これらのパラメータを変更する前に、大容量の応答を組み立てて送信するために必要な時間、ストレージ システムで追加のメモリ消費が発生することにご注意ください。ストレージ システムへの高レイテンシ接続が多いほど、追加のメモリ消費量は大きくなります。メモリ容量の大きいストレージ システムでは、この変更による影響はほとんどない可能性があります。メモリ容量の小さいストレージ システムでは、パフォーマンスが著しく低下する可能性があります。

これらのパラメータを効果的に使用するには、クラスタ内の複数のノードからデータを取得できる必要があります。クラスタ ネットワーク固有のレイテンシにより、応答のレイテンシが全体的に増加する可能性があります。これらのパラメータを使用すると、全体的なレイテンシが増加する傾向があります。その結果、レイテンシの影響を受けやすいワークロードでは、悪影響が出る可能性があります。
