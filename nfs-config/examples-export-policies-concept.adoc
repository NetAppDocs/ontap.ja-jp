---
permalink: nfs-config/examples-export-policies-concept.html 
sidebar: sidebar 
keywords: examples, ontap, export, policies, implementation, 7-mode 
summary: エクスポート ポリシーの例を確認すると、ONTAPでのエクスポート ポリシーの動作をより深く理解できます。 
---
= ONTAPのNFSエクスポート ポリシーの例について学ぶ
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
エクスポート ポリシーの例を確認すると、ONTAPでのエクスポート ポリシーの動作をより深く理解できます。



== 7-ModeエクスポートのONTAP実装例

次の例は、 `/etc/export`ファイルに表示される7-Modeエクスポートを示しています：

[listing]
----
/vol/vol1 -sec=sys,ro=@readonly_netgroup,rw=@readwrite_netgroup1:
@readwrite_netgroup2:@rootaccess_netgroup,root=@rootaccess_netgroup
----
このエクスポートをクラスター化されたエクスポート ポリシーとして再現するには、3つのエクスポート ルールを含むエクスポート ポリシーを作成し、そのエクスポート ポリシーをボリュームvol1に割り当てる必要があります。

|===
| Rule | 要素 | Value 


 a| 
ルール1
 a| 
`-clientmatch`（クライアント仕様）
 a| 
`@readonly_netgroup`



 a| 
`-ruleindex`(ルールリスト内のエクスポート ルールの位置)
 a| 
`1`



 a| 
`-protocol`
 a| 
`nfs`



 a| 
`-rorule`（読み取り専用アクセスを許可）
 a| 
`sys`（AUTH_SYSで認証されたクライアント）



 a| 
`-rwrule`（読み書きアクセスを許可）
 a| 
`never`



 a| 
`-superuser`（スーパーユーザ アクセスを許可）
 a| 
`none`（rootは匿名にスカッシュされます）



 a| 
ルール2
 a| 
`-clientmatch`
 a| 
`@rootaccess_netgroup`



 a| 
`-ruleindex`
 a| 
`2`



 a| 
`-protocol`
 a| 
`nfs`



 a| 
`-rorule`
 a| 
`sys`



 a| 
`-rwrule`
 a| 
`sys`



 a| 
`-superuser`
 a| 
`sys`



 a| 
ルール3
 a| 
`-clientmatch`
 a| 
`@readwrite_netgroup1,@readwrite_netgroup2`



 a| 
`-ruleindex`
 a| 
`3`



 a| 
`-protocol`
 a| 
`nfs`



 a| 
`-rorule`
 a| 
`sys`



 a| 
`-rwrule`
 a| 
`sys`



 a| 
`-superuser`
 a| 
`none`

|===
. exp_vol1というエクスポート ポリシーを作成します。
+
`vserver export-policy create -vserver NewSVM -policyname exp_vol1`

. ベース コマンドに次のパラメータを使用して 3 つのルールを作成します：
+
** 基本コマンド：+
`vserver export-policy rule create -vserver NewSVM -policyname exp_vol1`
** ルールパラメータ：+
`-clientmatch @readonly_netgroup -ruleindex 1 -protocol nfs -rorule sys -rwrule never -superuser none` +  `-clientmatch @rootaccess_netgroup -ruleindex 2 -protocol nfs -rorule sys -rwrule sys -superuser sys` +  `-clientmatch @readwrite_netgroup1,@readwrite_netgroup2 -ruleindex 3 -protocol nfs -rorule sys -rwrule sys -superuser none`


. ボリュームvol1にポリシーを割り当てます。
+
`volume modify -vserver NewSVM -volume vol1 -policy exp_vol1`





== 7-Mode エクスポートの統合例

次の例は、10 個の qtree ごとに 1 行が含まれる 7-Mode `/etc/export` ファイルを示しています：

[listing]
----

/vol/vol1/q_1472 -sec=sys,rw=host1519s,root=host1519s
/vol/vol1/q_1471 -sec=sys,rw=host1519s,root=host1519s
/vol/vol1/q_1473 -sec=sys,rw=host1519s,root=host1519s
/vol/vol1/q_1570 -sec=sys,rw=host1519s,root=host1519s
/vol/vol1/q_1571 -sec=sys,rw=host1519s,root=host1519s
/vol/vol1/q_2237 -sec=sys,rw=host2057s,root=host2057s
/vol/vol1/q_2238 -sec=sys,rw=host2057s,root=host2057s
/vol/vol1/q_2239 -sec=sys,rw=host2057s,root=host2057s
/vol/vol1/q_2240 -sec=sys,rw=host2057s,root=host2057s
/vol/vol1/q_2241 -sec=sys,rw=host2057s,root=host2057s
----
ONTAPでは、各qtreeに2つのポリシーのいずれかが必要です： `-clientmatch host1519s`を含むルールを持つポリシー、または `-clientmatch host2057s`を含むルールを持つポリシーです。

. exp_vol1q1 と exp_vol1q2 という 2 つのエクスポートポリシーを作成します：
+
** `vserver export-policy create -vserver NewSVM -policyname exp_vol1q1`
** `vserver export-policy create -vserver NewSVM -policyname exp_vol1q2`


. 各ポリシーのルールを作成します：
+
** `vserver export-policy rule create -vserver NewSVM -policyname exp_vol1q1 -clientmatch host1519s -rwrule sys -superuser sys`
** `vserver export-policy rule create -vserver NewSVM -policyname exp_vol1q2 -clientmatch host1519s -rwrule sys -superuser sys`


. qtree にポリシーを適用します。
+
** `volume qtree modify -vserver NewSVM -qtree-path /vol/vol1/q_1472 -export-policy exp_vol1q1`
** [次の 4 つの qtree...]
** `volume qtree modify -vserver NewSVM -qtree-path /vol/vol1/q_2237 -export-policy exp_vol1q2`
** [次の 4 つの qtree...]




後でこれらのホストに qtree を追加する必要がある場合は、同じエクスポートポリシーを使用します。
