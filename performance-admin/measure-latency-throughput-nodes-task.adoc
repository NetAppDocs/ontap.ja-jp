---
permalink: performance-admin/measure-latency-throughput-nodes-task.html 
sidebar: sidebar 
keywords: check, throughput, latency, between, nodes 
summary: network test-path コマンドを使用すると、ネットワークのボトルネックを特定したり、ノード間のネットワークパスを事前検証したりできます。このコマンドは、クラスタ間ノード間またはクラスタ内ノード間で実行できます。 
---
= ONTAPスループットとノード間のレイテンシを確認する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
 `network test-path`コマンドを使用すると、ネットワークのボトルネックを特定したり、ノード間のネットワークパスを事前に検証したりできます。このコマンドは、クラスタ間ノード間またはクラスタ内ノード間で実行できます。

.開始する前に
* このタスクを実行するには、クラスタ管理者である必要があります。
* このタスクには、advanced権限レベルのコマンドが必要です。
* クラスタ間のパスの場合、ソース クラスタとデスティネーション クラスタがピアリングされている必要があります。


.タスク概要
ノード間のネットワーク パフォーマンスが、パス構成に対して期待される値にならない場合があります。たとえば、ソース クラスタとデスティネーション クラスタの間のリンクが10GbEの場合でも、SnapMirrorレプリケーション処理による大量のデータ転送では1Gbpsの伝送速度が観察されることがあります。

 `network test-path`コマンドを使用して、ノード間のスループットとレイテンシを測定できます。このコマンドは、クラスタ間ノード間またはクラスタ内ノード間で実行できます。

[NOTE]
====
このテストはネットワーク パスが一杯になるまでデータを投入するため、システムがビジーでなく、ノード間にネットワーク トラフィックが集中していないときに実行してください。テストは10秒後にタイムアウトします。このコマンドはONTAP 9のノード間でのみ実行できます。

====
この `session-type`オプションは、ネットワークパス上で実行している操作の種類を識別します。たとえば、リモート宛先へのSnapMirrorレプリケーションの場合は「AsyncMirrorRemote」です。種類によってテストで使用されるデータ量が決まります。次の表はセッションタイプを定義しています：

|===


| セッションタイプ | 概要 


 a| 
AsyncMirrorLocal
 a| 
同じクラスタ内のノード間でSnapMirrorによって使用される設定



 a| 
AsyncMirrorRemote
 a| 
異なるクラスター内のノード間でSnapMirrorによって使用される設定（デフォルトタイプ）



 a| 
RemoteDataTransfer
 a| 
同じクラスタ内のノード間のリモートデータアクセスにONTAPが使用する設定（たとえば、別のノードのボリュームに保存されているファイルに対するノードへのNFS要求）

|===
.手順
. advanced権限レベルに切り替えます。
+
`set -privilege advanced`

. ノード間のスループットとレイテンシを測定します。
+
`network test-path -source-node _source_nodename_ |local -destination-cluster _destination_clustername_ -destination-node _destination_nodename_ -session-type Default|AsyncMirrorLocal|AsyncMirrorRemote|SyncMirrorRemote|RemoteDataTransfer`

+
ソースノードはローカルクラスタ内に存在する必要があります。宛先ノードはローカルクラスタ内またはピアクラスタ内に存在できます。 `-source-node`に「local」を指定すると、コマンドを実行するノードが指定されます。

+
次のコマンドは、ローカルクラスタ上の `node1`と `cluster2`上の `node3`間のSnapMirrorタイプのレプリケーション操作のスループットと待機時間を測定します：

+
[listing]
----
cluster1::> network test-path -source-node node1 -destination-cluster cluster2 -destination-node node3 -session-type AsyncMirrorRemote
----
+
出力例（出力の詳細は、ONTAPのバージョンによって異なります）：

+
[listing]
----
Test Duration:      10.88 secs
Send Throughput:    18.23 MB/sec
Receive Throughput: 18.23 MB/sec
MB sent:            198.31
MB received:        198.31
Avg latency in ms:  2301.47
----
+
 `network test-path`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/network-test-path.html["ONTAPコマンド リファレンス"^]を参照してください。

. admin権限に戻ります。
+
`set -privilege admin`



.終了後の操作
パス構成に対して期待される値を得られない場合は、ノードのパフォーマンス統計の確認、ツールを使用したネットワークの問題の切り分け、スイッチ設定の確認などを行います。
