---
permalink: revert/task_download_and_install_ontap_software_image.html 
sidebar: sidebar 
keywords: ontap, software, revert, image, download, downloading, install, installing 
summary: 現在の ONTAP ソフトウェアを元に戻す前に、まずソフトウェアをダウンロードしてインストールする必要があります。 
---
= ONTAPソフトウェア イメージのダウンロードとインストール
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
現在のONTAPソフトウェアをリバートする前に、NetApp Support Siteから対象のソフトウェアバージョンをダウンロードし、インストールする必要があります。



== ONTAPソフトウェア イメージのダウンロード

ソフトウェア イメージは、プラットフォーム モデルに固有です。使用しているクラスタに対応するイメージを取得してください。ソフトウェア イメージ、ファームウェアのバージョン情報、プラットフォーム モデルの最新のファームウェアは、NetApp サポート サイトで入手できます。ソフトウェア イメージには、ONTAPの特定のバージョンのリリース時点でのシステム ファームウェアの最新バージョンが含まれています。


NOTE: NetApp Volume Encryptionを使用しているシステムをONTAP 9.5以降からリバートする場合は、NetApp Volume Encryptionを含む非制限国向けのONTAPソフトウェアイメージをダウンロードする必要があります。NetApp Volume Encryptionを使用しているシステムのリバートに制限国向けのONTAPソフトウェアイメージを使用すると、システムがパニック状態になり、ボリュームにアクセスできなくなります。

.手順
. NetApp Support Siteのlink:http://mysupport.netapp.com/NOW/cgi-bin/software["ソフトウェアのダウンロード"^]領域で対象のONTAPソフトウェアを見つけます。
. NetApp Support Siteからソフトウェアイメージ（例： `97_q_image.tgz`）をコピーします
+
画像は、画像が提供される HTTP サーバーまたは FTP サーバー上のディレクトリ、またはローカルフォルダにコピーできます。





== ONTAP ソフトウェアイメージをインストールする

ターゲットの ONTAP ソフトウェア イメージをNetApp Support Site からダウンロードした後、クラスタ ノードにインストールします。

.手順
. 権限レベルをadvancedに設定します。
+
[source, cli]
----
set -privilege advanced
----
+
詳細プロンプト（(`*>`）が表示されます。

. プロンプトが表示されたら `y`を押して続行します。
. ソフトウェアイメージをインストールします。
+
** 標準構成または 2 ノードMetroCluster構成の場合は、次のコマンドを入力します：
+
[source, cli]
----
system node image update -node * -package <http://example.com/downloads/image.tgz> -replace-package true -replace {image1|image2} -background true -setdefault true
----
+
このコマンドは、すべてのノードに同時にソフトウェアイメージをダウンロードしてインストールします。各ノードにイメージを1つずつダウンロードしてインストールする場合は、 `-background`パラメータを指定しないでください。また、このコマンドは拡張クエリを使用して、代替イメージとしてインストールされる対象のソフトウェアイメージを、ノードのデフォルトイメージに変更します。

** 4ノードまたは8ノードMetroCluster構成の場合は、両方のクラスタで次のコマンドを入力します：
+
[source, cli]
----
system node image update -node * -package <http://example.com/downloads/image.tgz> -replace-package true -replace {image1|image2} -background true -setdefault false
----
+
このコマンドは、すべてのノードに同時にソフトウェアイメージをダウンロードしてインストールします。各ノードにイメージを1つずつダウンロードしてインストールする場合は、 `-background`パラメータを指定しないでください。このコマンドは、拡張クエリを使用して、各ノードに代替イメージとしてインストールされるターゲットソフトウェアイメージを変更します。



. プロンプトが表示されたら `y`を押して続行します。
. ソフトウェア イメージが各ノードにダウンロードされ、インストールされていることを確認します：
+
[source, cli]
----
system node image show-update-progress -node *
----
+
このコマンドは、ソフトウェアイメージのダウンロードとインストールの現在のステータスを表示します。すべてのノードの*実行ステータス*が「Exited」、*終了ステータス*が「Success」と報告されるまで、このコマンドを実行し続けてください。

+
system node image updateコマンドが失敗して、エラーまたは警告メッセージが表示されることがあります。その場合は、エラーまたは警告をすべて解決すると再度コマンドを実行できます。

+
次の例では、2ノード クラスタの両方のノードにソフトウェア イメージをダウンロードしてインストールし、処理が成功しています。

+
[listing]
----
cluster1::*> system node image show-update-progress -node *
There is no update/install in progress
Status of most recent operation:
        Run Status:     Exited
        Exit Status:    Success
        Phase:          Run Script
        Exit Message:   After a clean shutdown, image2 will be set as the default boot image on node0.
There is no update/install in progress
Status of most recent operation:
        Run Status:     Exited
        Exit Status:    Success
        Phase:          Run Script
        Exit Message:   After a clean shutdown, image2 will be set as the default boot image on node1.
2 entries were acted on.
----


.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/system-node-image-update.html["system node image update"^]

