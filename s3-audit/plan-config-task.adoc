---
permalink: s3-audit/plan-config-task.html 
sidebar: sidebar 
keywords: s3, audit, create, configure s3 audit 
summary: このタスクでは、 S3 監査で使用されるパラメータについて説明します。 
---
= S3監査の設定を計画する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
S3監査の設定にはいくつかのパラメータを指定するか、デフォルトを受け入れる必要があります。特に、適切な空きスペースを確保するのに役立つログローテーションパラメータを検討する必要があります。

の詳細については `vserver object-store-server audit create`、をlink:https://docs.netapp.com/us-en/ontap-cli/vserver-object-store-server-audit-create.html["ONTAPコマンド リファレンス"^]参照してください。



== 一般パラメータ

監査の設定を作成するときに指定する必要がある必須パラメータが2つあります。また、指定できるオプションのパラメータも3つあります。

[cols="4,2,1"]
|===


| 情報の種類 | オプション | 必須 


 a| 
SVM 名 _

監査設定を作成するSVMの名前。

SVMがすでに存在し、S3に対して有効になっている必要があります。
 a| 
`-vserver _svm_name_`
 a| 
〇



 a| 
_ ログデスティネーションパス _

変換された監査ログを格納する場所を指定します。SVM上にすでに存在しているパスを指定する必要があります。

パスは最大864文字で、読み取り/書き込み権限が必要です。

パスが無効な場合、監査設定コマンドは失敗します。
 a| 
`-destination _text_`
 a| 
〇



 a| 
_ 監査するイベントのカテゴリ _

監査できるイベントカテゴリは次のとおりです。

* データGetObject、PutObject、およびDeleteObjectイベント
* 管理PutBucketイベントおよびDeleteBucketイベント


デフォルトでは、データイベントのみが監査されます。
 a| 
`-events {data{vbar}management}, ...`
 a| 
いいえ

|===
監査ログファイルの数を制御するには、次のいずれかのパラメータを入力します。値を入力しない場合は、すべてのログファイルが保持されます。

[cols="4,2,1"]
|===


| 情報の種類 | オプション | 必須 


 a| 
ログファイルのローテーションの上限 _

保持する監査ログファイルの数を指定します。この数を超えると、最も古いログファイルがローテーションから除外されます。たとえば、値5を入力すると、最後の5つのログファイルが保持されます。

値0は、すべてのログファイルが保持されることを示します。デフォルト値は0です。
 a| 
`-rotate-limit _integer_`
 a| 
いいえ



 a| 
_ログファイル継続時間制限_

ログファイルが削除されるまでの保持期間を指定します。たとえば、5d0h0mと入力すると、5日以上経過したログが削除されます。

値0は、すべてのログファイルが保持されることを示します。デフォルト値は0です。
 a| 
`-retention duration _integer_time_`
 a| 
いいえ

|===


== 監査ログのローテーションのパラメータ

サイズまたはスケジュールに基づいて監査ログのローテーションを実行できます。デフォルトでは、監査ログのローテーションはサイズに基づいて行われます。



=== ログサイズに基づくログのローテーション

デフォルトのログローテーション方式とデフォルトのログサイズを使用する場合は、ログローテーションのパラメータを設定する必要はありません。デフォルトのログサイズは100MBです。

デフォルトのログサイズを使用しない場合は、カスタムログサイズを指定するようにパラメータを設定できます `-rotate-size`。

ログサイズのみに基づいてローテーションをリセットする場合は、次のコマンドを使用してパラメータの設定を解除し `-rotate-schedule-minute`ます。

`vserver audit modify -vserver _svm_name_ -destination / -rotate-schedule-minute -`



=== スケジュールに基づいたログのローテーション

スケジュールに基づく監査ログのローテーションを選択した場合は、時間に基づくローテーションパラメータを任意の組み合わせで使用して、ログのローテーションをスケジュールできます。

* 時間に基づくローテーションを使用する場合、 `-rotate-schedule-minute`パラメータは必須です。
* その他の時間ベースのローテーションパラメータはすべてオプションです。
+
** `-rotate-schedule-month`
** `-rotate-schedule-dayofweek`
** `-rotate-schedule-day`
** `-rotate-schedule-hour`


* ローテーションスケジュールは、時間に関連するすべての値を使用して計算されます。たとえば、パラメータのみを指定する `-rotate-schedule-minute`と、監査ログファイルのローテーションは、毎月のすべての曜日の毎時間、指定した分に行われます。
* 時間に基づくローテーションパラメータを1つか2つだけ指定した場合（、など `-rotate-schedule-month` `-rotate-schedule-minutes`）、ログファイルのローテーションは、指定した月にのみ、すべての曜日の毎時間、指定した分に行われます。
+
たとえば、監査ログのローテーションを、1月、3月、8月の月曜日、水曜日、土曜日の午前10時30分に実行するように指定できます。

* との `-rotate-schedule-day`両方に値を指定すると `-rotate-schedule-dayofweek`、それらは独立して考慮されます。
+
たとえば、にFridayを指定し、 `-rotate-schedule-day`に13を指定する `-rotate-schedule-dayofweek`と、監査ログのローテーションは、13日の金曜日だけでなく、毎週金曜日、および指定した月の13日にも実行されます。

* スケジュールのみに基づいてローテーションをリセットする場合は、次のコマンドを使用しての設定を解除します `-rotate-size parameter`。
+
`vserver audit modify -vserver _svm_name_ -destination / -rotate-size -`





=== ログサイズとスケジュールに基づいたログのローテーション

ログサイズとスケジュールに基づいてログファイルをローテーションするように選択するには、-rotate-sizeパラメータと時間ベースのローテーションパラメータの両方を任意の組み合わせで設定します。たとえば、が10MBに設定され、 `-rotate-schedule-minute`が15に設定されている場合 `-rotate-size`、ログファイルのサイズが10MBに達したとき、または1時間ごとの15分（いずれか早い方）にログファイルがローテーションされます。

この手順で説明されているコマンドの詳細については、をlink:https://docs.netapp.com/us-en/ontap-cli/["ONTAPコマンド リファレンス"^]参照してください。
