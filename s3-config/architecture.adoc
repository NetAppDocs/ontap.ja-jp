---
permalink: s3-config/architecture.html 
sidebar: sidebar 
keywords: tr-4814, s3 architecture, ontap 9 
summary: ONTAP では、バケットの基盤となるアーキテクチャは FlexGroup ボリュームです。これは、複数の構成メンバー ボリュームから構成される単一の名前空間ですが、単一のボリュームとして管理されます。 
---
= FlexGroup ボリュームを使用した ONTAP S3 アーキテクチャ
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAPでは、バケットの基盤となるアーキテクチャはlink:../flexgroup/definition-concept.html["FlexGroupボリューム"]です。これは、複数の構成メンバーボリュームから構成される単一のネームスペースですが、単一のボリュームとして管理されます。

image:fg-overview-s3-config.gif["FlexGroupボリュームは、構成要素またはメンバーと呼ばれるFlexVolボリュームのグループとして表されます"]

バケットへのアクセスは、権限があるユーザとクライアント アプリケーションにのみ許可されます。

image:s3-svm-layout.png["S3 SVMバケットアクセス"]

[NOTE]
====
FabricPoolエンドポイントとしての用途など、バケットがS3アプリケーション専用になっている場合、基盤となるFlexGroupボリュームではS3プロトコルのみがサポートされます。

ONTAP 9.12.1以降では、NASプロトコルを使用するように事前設定されているlink:../s3-multiprotocol/index.html["マルチプロトコルNASボリューム"]でもS3プロトコルを有効にできるようになりました。マルチプロトコルNASボリュームでS3プロトコルを有効にすると、クライアントアプリケーションはNFS、SMB、S3を使用してデータの読み取りと書き込みを行うことができます。

====


== バケットの制限



=== 最小容量

最小バケット容量は ONTAP プラットフォームによって決まります。

* オンプレミスプラットフォームの場合は95GB。
* Lab on Demandの場合は1.6GB。
* ONTAP Selectの場合は200MB。




=== 最大サイズ

最大バケット容量は、最大FlexGroupサイズの60PBに制限されます。



=== バケットの最大数

バケットの最大数はFlexGroupボリュームあたり1,000個、またはクラスタあたり12,000個（FlexGroupボリューム12個使用）です。



== ONTAP 9.14.1以降でのFlexGroupの自動サイズ変更

ONTAP 9.14.1以降、デフォルトのFlexGroupサイズは、含まれるバケットのサイズに基づいています。FlexGroupボリュームは、バケットが追加または削除されると自動的に拡大または縮小されます。

例えば、最初のBucket_Aが100GBにプロビジョニングされている場合、FlexGroupはシンプロビジョニングによって100GBに設定されます。300GBのBucket_Bと500GBのBucket_Cという2つの追加バケットが作成されると、FlexGroupボリュームは900GBに拡張されます。

（Bucket_A：100GB + Bucket_B：300GB + Bucket_C：500GB = 900GB）

Bucket_Aを削除すると、基盤となるFlexGroupボリュームは800GBに縮小されます。



== ONTAP 9.13.1以前のFlexGroupのデフォルト固定サイズ

バケットを拡張するための容量を確保するには、FlexGroupボリュームのすべてのバケットの使用済み容量の合計が、クラスタ上で使用可能なストレージ アグリゲートに基づくFlexGroupボリュームの最大容量の33%未満である必要があります。これが満たされない場合、作成された新しいバケットは、自動的に作成される新しいFlexGroupボリュームにプロビジョニングされます。

ONTAP 9.14.1より前のバージョンでは、FlexGroupのサイズは環境に応じた以下のデフォルト サイズに固定されていました。

* ONTAP：1.6PB
* ONTAP Select：100TB


FlexGroupボリュームをデフォルト サイズでプロビジョニングするのに十分な容量がクラスタにない場合、ONTAPは既存の環境でプロビジョニングできるようになるまで、デフォルト サイズを半分ずつ縮小していきます。

たとえば、300TBの環境では、FlexGroupボリュームは自動的に200TBでプロビジョニングされます（1.6PB、800TB、400TBのFlexGroupボリュームは環境に対して大きすぎるため）。
