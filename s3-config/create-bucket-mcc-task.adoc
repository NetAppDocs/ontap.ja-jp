---
permalink: s3-config/create-bucket-mcc-task.html 
sidebar: sidebar 
keywords: s3, bucket, system manager, metrocluster, unmirrored, mirrored, aggregate 
summary: ONTAP 9.14.1以降では、MetroCluster FC構成およびIP構成のミラーされたアグリゲートまたはミラーされていないアグリゲートにバケットをプロビジョニングできます。 
---
= MetroCluster構成のミラーされたアグリゲートまたはミラーされていないアグリゲートにバケットを作成する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.14.1以降では、MetroCluster FC構成およびIP構成のミラーされたアグリゲートまたはミラーされていないアグリゲートにバケットをプロビジョニングできます。

.このタスクについて
* デフォルトでは、バケットはミラーされたアグリゲート上にプロビジョニングされます。
* プロビジョニングのガイドラインは、と同じです。 link:create-bucket-task.html["バケットを作成する"] MetroCluster環境でのバケットの作成に適用
* MetroCluster環境では、S3オブジェクトストレージの次の機能は*サポートされません*。
+
** S3 SnapMirrorの略
** S3バケットのライフサイクル管理
** Compliance *モードでのS3オブジェクトのロック
+

NOTE: *ガバナンス*モードでのS3オブジェクトのロックがサポートされています。

** ローカルFabricPool階層化




.作業を開始する前に
S3 サーバを含む SVM がすでに存在している必要があります。



== バケットを作成するプロセス

[role="tabbed-block"]
====
.CLI の使用
--
. アグリゲートとFlexGroup コンポーネントを自分で選択する場合は、権限レベルをadvancedに設定します（それ以外の場合はadmin権限レベルで十分です）。 `set -privilege advanced`
. バケットを作成します。
+
`vserver object-store-server bucket create -vserver <svm_name> -bucket <bucket_name> [-size integer[KB|MB|GB|TB|PB]] [-use-mirrored-aggregates true/false]`

+
を設定します `-use-mirrored-aggregates` オプションをに設定します `true` または `false` ミラーされたアグリゲートとミラーされていないアグリゲートのどちらを使用するかによって異なります。

+

NOTE: デフォルトでは、が表示されます `-use-mirrored-aggregates` オプションはに設定されています `true`。

+
** SVM名はデータSVMである必要があります。
** オプションを指定しない場合、 ONTAP は 5GB のバケットを作成し、システムで使用可能な最上位のサービスレベルに設定します。
** パフォーマンスまたは使用量に基づいて ONTAP でバケットを作成する場合は、次のいずれかのオプションを使用します。
+
*** サービスレベル
+
を含めます `-storage-service-level` オプションに次のいずれかの値を指定します。 `value`、 `performance`または `extreme`。

*** 階層化
+
を含めます `-used-as-capacity-tier true` オプション



** 基盤となる FlexGroup ボリュームを作成するアグリゲートを指定する場合は、次のオプションを使用します。
+
*** 。 `-aggr-list` パラメータは、FlexGroup ボリュームのコンスティチュエントに使用するアグリゲートのリストを指定します。
+
指定したエントリごとに、そのアグリゲート上にコンスティチュエントが 1 つ作成されます。同じアグリゲートを複数回指定すると、そのアグリゲート上に複数のコンスティチュエントを作成できます。

+
FlexGroup 全体で一貫したパフォーマンスが得られるように、すべてのアグリゲートで同じディスクタイプと RAID グループ構成を使用する必要があります。

*** 。 `-aggr-list-multiplier` パラメータは、に表示されるアグリゲートを反復する回数を指定します `-aggr-list` FlexGroup ボリューム作成時のパラメータ。
+
のデフォルト値 `-aggr-list-multiplier` パラメータは4です。





. 必要に応じて QoS ポリシーグループを追加します。
+
`vserver object-store-server bucket modify -bucket _bucket_name_ -qos-policy-group _qos_policy_group_`

. バケットの作成を確認します。
+
`vserver object-store-server bucket show [-instance]`



.例
次の例では、ミラーされたアグリゲート上に1TBのSVM vs1のバケットを作成します。

[listing]
----
cluster-1::*> vserver object-store-server bucket create -vserver svm1.example.com -bucket testbucket  -size 1TB -use-mirrored-aggregates true
----
--
.System Manager の略
--
. S3 対応 Storage VM に新しいバケットを追加
+
.. [ * ストレージ ] 、 [ バケット ] の順にクリックし、 [ * 追加 ] をクリックします。
.. 名前を入力し、 Storage VM を選択してサイズを入力します。
+
デフォルトでは、バケットはミラーされたアグリゲートにプロビジョニングされます。ミラーされていないアグリゲートにバケットを作成する場合は、*[その他のオプション]*を選択し、*[保護]*の*[ SyncMirror階層を使用する]*ボックスをオフにします（次の図を参照）。

+
image:../media/SM_create_bucket_MCC.png["System Manager MetroClusterバケットの作成"]

+
*** この時点で * Save * をクリックすると、次のデフォルト設定でバケットが作成されます。
+
**** どのグループポリシーも有効になっていないかぎり、バケットへのアクセスはユーザに許可されません。
+

NOTE: S3 root ユーザを使用して ONTAP オブジェクトストレージを管理したり権限を共有したりしないでください。オブジェクトストアに無制限にアクセスできます。代わりに、割り当てた管理者権限を持つユーザまたはグループを作成してください。

**** システムで最も利用可能なサービス品質（パフォーマンス）レベル。


*** バケットの設定時にユーザの権限やパフォーマンスレベルを設定するには、「 * More Options * 」をクリックします。あとで設定を変更することもできます。
+
**** 権限を設定するために * More Options * を使用する前に、ユーザーとグループを作成しておく必要があります。
**** S3 オブジェクトストアを FabricPool の階層化に使用する場合は、パフォーマンスサービスレベルではなく、階層化に * 使用（階層化データのパフォーマンスが最適な低コストのメディアを使用）を選択することを検討してください。






. 別の ONTAP システムまたは外部のサードパーティ製アプリケーションである S3 クライアントアプリケーションで、次のように入力して新しいバケットへのアクセスを確認します。
+
** S3 サーバの CA 証明書。
** ユーザーのアクセスキーとシークレットキー。
** S3 サーバの FQDN 名とバケット名。




--
====