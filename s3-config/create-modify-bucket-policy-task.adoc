---
permalink: s3-config/create-modify-bucket-policy-task.html 
sidebar: sidebar 
keywords: modify, bucket, policy 
summary: デフォルトのバケットポリシーにアクセスルールを追加できます。アクセス制御の範囲はコンテナバケットなので、バケットが 1 つしかない場合は最も適しています。 
---
= バケットポリシーを変更する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
デフォルトのバケットポリシーにアクセスルールを追加できます。アクセス制御の範囲はコンテナバケットなので、バケットが 1 つしかない場合は最も適しています。

.作業を開始する前に
S3 サーバとバケットを含む S3 対応の SVM がすでに存在している必要があります。

権限を付与するには、事前にユーザまたはグループを作成しておく必要があります。

.このタスクについて
新しいユーザとグループに新しいステートメントを追加したり、既存のステートメントの属性を変更したりできます。その他のオプションについては、を参照してください `vserver object-store-server bucket policy` マニュアルページ

ユーザとグループの権限は、バケットの作成時または必要に応じてあとから付与できます。バケットの容量と QoS ポリシーグループの割り当てを変更することもできます。

ONTAP 9.9.1以降のリリースでは、ONTAP S3サーバでAWSクライアントオブジェクトのタグ付け機能をサポートする場合の処理が実行されます `GetObjectTagging`、 `PutObjectTagging`および `DeleteObjectTagging` バケットまたはグループポリシーを使用して許可されている必要があります。

実行する手順 は、System ManagerまたはCLIを使用するインターフェイスによって異なります。

[role="tabbed-block"]
====
.System Manager の略
--
.手順
. バケットを編集します。 * Storage > Bucket* をクリックし、目的のバケットをクリックして * Edit * をクリックします。
権限を追加または変更するときに、次のパラメータを指定できます。
+
** * Principal *：アクセス権を付与するユーザまたはグループ。
** *影響*：ユーザまたはグループへのアクセスを許可または拒否します。
** * Actions *：特定のユーザまたはグループに対してバケットで許可されているアクション。
** * Resources *：アクセスが許可または拒否されているバケット内のオブジェクトのパスと名前。
+
デフォルトの * _bucketname_* および * _bketname / * _ * は、バケット内のすべてのオブジェクトへのアクセスを許可します。また、単一のオブジェクトへのアクセスを許可することもできます。たとえば、 *_bketname/_*_readme.txt * と指定します。

** * Conditions *（オプション）：アクセス試行時に評価される式。たとえば、アクセスを許可または拒否する IP アドレスを指定できます。




--
.CLI の使用
--
.手順
. バケットポリシーにステートメントを追加します。
+
`vserver object-store-server bucket policy add-statement -vserver _svm_name_ -bucket _bucket_name_ -effect {allow|deny} -action _object_store_actions_ -principal _user_and_group_names_ -resource _object_store_resources_ [-sid text] [-index integer]`

+
次のパラメータでアクセス権限を定義します。

+
[cols="1,3"]
|===


 a| 
`-effect`
 a| 
この文では ' アクセスを許可または拒否できます



 a| 
`-action`
 a| 
を指定できます `*` すべてのアクション、または次の1つ以上のリストを意味します。 `GetObject, PutObject, DeleteObject, ListBucket, GetBucketAcl,GetObjectAcl, ListBucketMultipartUploads,` および `ListMultipartUploadParts`。



 a| 
`-principal`
 a| 
1 つ以上の S3 ユーザまたはグループのリスト。

** 最大 10 のユーザまたはグループを指定できます。
** S3グループを指定する場合は、の形式で指定する必要があります `group/group_name.`
** `*` には、パブリックアクセス（アクセスキーとシークレットキーを使用しないアクセス）を指定できます。
** プリンシパルを指定しない場合、 SVM 内のすべての S3 ユーザにアクセスが許可されます。




 a| 
`-resource`
 a| 
バケットとバケットに含まれるすべてのオブジェクト。ワイルドカード文字 `*` および `?` リソースを指定するための正規表現を作成するために使用できます。

|===
+
オプションで、テキスト文字列をコメントとして指定できます `-sid` オプション



.例
次の例は、 SVM svm1.example.com および bucket1 にオブジェクトストアサーバのバケットポリシーステートメントを作成し、オブジェクトストアサーバ user1 の readme フォルダへのアクセスを許可するように指定します。

[listing]
----
cluster1::> vserver object-store-server bucket policy statement create -vserver svm1.example.com -bucket bucket1 -effect allow -action GetObject,PutObject,DeleteObject,ListBucket -principal user1 -resource bucket1/readme/* -sid "fullAccessToReadmeForUser1"
----
次の例は、 SVM svm1.example.com および bucket1 にオブジェクトストアサーバのバケットポリシーステートメントを作成し、オブジェクトストアサーバグループ group1 のすべてのオブジェクトへのアクセスを許可するように指定します。

[listing]
----
cluster1::> vserver object-store-server bucket policy statement create -vserver svm1.example.com -bucket bucket1 -effect allow -action GetObject,PutObject,DeleteObject,ListBucket -principal group/group1 -resource bucket1/* -sid "fullAccessForGroup1"
----
--
====