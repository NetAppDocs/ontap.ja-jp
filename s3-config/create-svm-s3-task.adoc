---
permalink: s3-config/create-svm-s3-task.html 
sidebar: sidebar 
keywords: create, svm, s3 
summary: S3は他のプロトコルと同じSVMに配置することもできますが、ネームスペースやワークロードを分離する場合は新しいSVMを作成します。 
---
= ONTAP S3用のSVMを作成する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
S3は他のプロトコルと同じSVMに配置することもできますが、ネームスペースやワークロードを分離する場合は新しいSVMを作成します。

.タスク概要
SVMをS3のオブジェクト ストレージにのみ使用する場合、S3サーバにDNS設定は必要ありません。ただし、他のプロトコルを使用する場合はSVMにDNSを設定できます。

System Managerを使用して新しいStorage VMへのS3アクセスを設定する場合、証明書とネットワークの情報を入力するように求められ、Storage VMとS3オブジェクト ストレージ サーバが1回の操作で作成されます。

.手順
[role="tabbed-block"]
====
.System Manager
--
S3サーバ名の完全修飾ドメイン名（FQDN）を確認しておきます。クライアントはFQDNでS3にアクセスします。S3サーバのFQDNをバケット名で始めることはできません。

Dataインターフェイス ロールに使用するIPアドレスを確認しておきます。

外部のCA署名証明書を使用している場合は、入力するように求められます。システムで生成された証明書を使用することもできます。

. Storage VMでS3を有効にします。
+
.. 新しいストレージ VM を追加します：*ストレージ > ストレージ VM* をクリックし、*追加* をクリックします。
+
既存のストレージVMがない新しいシステムの場合は、*ダッシュボード>プロトコルの構成*をクリックします。

+
既存のストレージ VM に S3 サーバーを追加する場合：*ストレージ > ストレージ VM* をクリックし、ストレージ VM を選択して *設定* をクリックし、 *S3* の下の image:icon_gear.gif["アクションアイコン"] をクリックします。

.. *S3 を有効にする*をクリックし、S3 サーバー名を入力します。
.. 証明書タイプを選択します。
+
システムで生成された証明書と独自の証明書のどちらを選択した場合も、その証明書がクライアント アクセスで必要になります。

.. ネットワーク インターフェイスを入力します。


. システム生成の証明書を選択した場合は、新しいストレージVMの作成が確認されると証明書情報が表示されます。*Download*をクリックし、クライアントがアクセスできるように保存してください。
+
** 今後シークレット キーは表示されません。
** 証明書情報が再度必要になった場合：*ストレージ > ストレージ VM* をクリックし、ストレージ VM を選択して、*設定* をクリックします。




--
.CLI
--
. クラスタでS3のライセンスが有効であることを確認します。
+
[source, cli]
----
system license show -package s3
----
+
有効でない場合は、営業担当者にお問い合わせください。

. SVMを作成します。
+
[source, cli]
----
vserver create -vserver <svm_name> -subtype default -rootvolume <root_volume_name> -aggregate <aggregate_name> -rootvolume-security-style unix -language C.UTF-8 -data-services <data-s3-server> -ipspace <ipspace_name>
----
+
**  `-rootvolume-security-style`オプションにはUNIX設定を使用します。
** デフォルトの C.UTF-8 `-language` オプションを使用します。
**  `ipspace`設定はオプションです。


. 新しく作成したSVMの設定およびステータスを確認します。
+
[source, cli]
----
vserver show -vserver <svm_name>
----
+
 `Vserver Operational State`フィールドには `running`状態が表示される必要があります。 `initializing`状態が表示される場合、ルート ボリュームの作成などの中間操作が失敗したことを意味し、SVMを削除して再作成する必要があります。



.例
次のコマンドは、データ アクセス用のSVMをIPspace ipspaceA内に作成します。

[listing]
----
cluster-1::> vserver create -vserver svm1.example.com -rootvolume root_svm1 -aggregate aggr1 -rootvolume-security-style unix -language C.UTF-8 -data-services data-s3-server -ipspace ipspaceA

[Job 2059] Job succeeded:
Vserver creation completed
----
次のコマンドは、1GBのルートボリュームを持つSVMが作成され、自動的に起動されて `running`状態になっていることを示しています。ルートボリュームにはルールが含まれていないデフォルトのエクスポートポリシーが適用されているため、作成時にルートボリュームはエクスポートされません。デフォルトでは、vsadminユーザーアカウントが作成され、 `locked`状態になっています。vsadminロールは、デフォルトのvsadminユーザーアカウントに割り当てられています。

[listing]
----
cluster-1::> vserver show -vserver svm1.example.com
                                    Vserver: svm1.example.com
                               Vserver Type: data
                            Vserver Subtype: default
                               Vserver UUID: b8375669-19b0-11e5-b9d1-00a0983d9736
                                Root Volume: root_svm1
                                  Aggregate: aggr1
                                 NIS Domain: -
                 Root Volume Security Style: unix
                                LDAP Client: -
               Default Volume Language Code: C.UTF-8
                            Snapshot Policy: default
                                    Comment:
                               Quota Policy: default
                List of Aggregates Assigned: -
 Limit on Maximum Number of Volumes allowed: unlimited
                        Vserver Admin State: running
                  Vserver Operational State: running
   Vserver Operational State Stopped Reason: -
                          Allowed Protocols: nfs, cifs
                       Disallowed Protocols: -
                           QoS Policy Group: -
                                Config Lock: false
                               IPspace Name: ipspaceA
----
--
====