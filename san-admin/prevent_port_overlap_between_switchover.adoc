---
permalink: san-admin/prevent_port_overlap_between_switchover.html 
sidebar: sidebar 
keywords: metrocluster environments, considerations, san configuration, metrocluster, environments, san, configurations, cisco switch, brocade switch, 
summary: 古いポートがオフラインになり、新しいポートがオンラインになったときに重複を回避するには、フロントエンド スイッチを設定します。 
---
= ONTAP MetroClusterスイッチオーバーおよびスイッチバック中のポートの重複を回避する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SAN環境では、古いポートがオフラインになって新しいポートがオンラインになる際にポートの重複が起こらないように、フロントエンド スイッチを設定できます。

スイッチオーバー中に、ファブリック側でディザスタ サイトのFCポートがオフラインであることが検出されてネーム サービスとディレクトリ サービスから削除される前に、サバイバー サイトのFCポートがファブリックにログインする場合があります。

ディザスタ サイトのFCポートが削除される前にサバイバー サイトのFCポートがファブリックにログインしようとすると、WWPNの重複によりログインが拒否される可能性があります。FCスイッチのこの動作は、既存のデバイスではなく前のデバイスのログインを優先するように変更できます。この動作が他のファブリック デバイスに与える影響を確認する必要があります。詳細についてはスイッチ ベンダーにお問い合わせください。

スイッチ タイプに合った正しい手順を実行してください。

.手順
[role="tabbed-block"]
====
.Ciscoスイッチ
--
. スイッチに接続してログインします。
. 設定モードに入ります：
+
....
switch# config t
switch(config)#
....
. ネーム サーバ データベースの最初のデバイス エントリを新しいデバイスで上書きします。
+
[listing]
----
switch(config)# no fcns reject-duplicate-pwwn vsan 1
----
. スイッチでNX-OS 8.xが実行されている場合は、flogi quiesce timeoutがゼロに設定されていることを確認します。
+
.. quiesce timervalを表示します。
+
`switch(config)# show flogi interval info \| i quiesce`

+
....
 Stats:  fs flogi quiesce timerval:  0
....
.. 前の手順の出力でtimervalがゼロになっていない場合は、timervalをゼロに設定します。
+
`switch(config)# flogi scale enable`

+
`switch(config)$ flogi quiesce timeout 0`





--
.Brocadeスイッチ
--
. スイッチに接続してログインします。
.  `switchDisable`コマンドを入力します。
.  `configure`コマンドを入力し、プロンプトで `y`を押します。
+
....
 F-Port login parameters (yes, y, no, n): [no] y
....
. 設定1を選択します。
+
....
- 0: First login take precedence over the second login (default)
- 1: Second login overrides first login.
- 2: the port type determines the behavior
Enforce FLOGI/FDISC login: (0..2) [0] 1
....
. 残りのプロンプトに応答するか、*Ctrl + D* キーを押します。
.  `switchEnable`コマンドを入力します。


--
====
.関連情報
link:https://docs.netapp.com/us-en/ontap-metrocluster/manage/task_perform_switchover_for_tests_or_maintenance.html["テストまたはメンテナンスのためのスイッチオーバーの実行"^]
