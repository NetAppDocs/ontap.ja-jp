---
permalink: san-admin/restore-single-lun-snapvault-backup-task.html 
sidebar: sidebar 
keywords: restore, single, lun, snapvault backup 
summary: 単一のLUNを新しい場所または元の場所に復元できます。SnapVault セカンダリ ボリューム内の任意のSnapshotから復元できます。LUNを元の場所に復元するには、まず新しい場所に復元してからコピーします。 
---
= ONTAP SnapVaultバックアップから単一のLUNを復元する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
単一のLUNを新しい場所または元の場所に復元できます。SnapVault セカンダリ ボリューム内の任意のSnapshotから復元できます。LUNを元の場所に復元するには、まず新しい場所に復元してからコピーします。

.開始する前に
* SnapVault関係を初期化する必要があり、SnapVaultセカンダリ ボリュームには復元する適切なスナップショットが含まれている必要があります。
* SnapVault セカンダリ ボリュームを含むStorage Virtual Machine（SVM）には、LUNコピーへのアクセスに使用されるホストからアクセス可能な、必要なSANプロトコルを備えた1つ以上のLIFが必要です。
* igroup は SnapVault SVM 上にすでに存在している必要があります。


.タスク概要
このプロセスには、SnapVaultセカンダリ ボリュームのSnapshotから読み書き可能なボリューム クローンを作成することが含まれます。クローンからLUNを直接使用することも、必要に応じてLUNの内容を元のLUNの場所にコピーすることもできます。

クローン内のLUNのパスとシリアル番号は、元のLUNとは異なります。永続的な予約は保持されません。

.手順
. SnapVaultバックアップが含まれているセカンダリ ボリュームを確認します。
+
[source, cli]
----
snapmirror show
----
+
[listing]
----
cluster::> snapmirror show

Source         Dest     Mirror  Relation  Total             Last
Path     Type  Path     State   Status    Progress  Healthy Updated
-------- ---- --------- ------- --------- --------- ------- -------
vserverA:srcvolA
         XDP  vserverB:dstvolB
                        Snapmirrored
                                Idle       -         true    -
----
. LUN を復元するスナップショットを特定します。
+
[source, cli]
----
volume snapshot show
----
+
[listing]
----
cluster::> volume snapshot show

Vserver  Volume  Snapshot               State Size   Total% Used%
-------- ------- ---------------------- ----- ------ ------ -----
vserverB
         dstvolB
                 snap2.2013-02-10_0010  valid  124KB     0%    0%
                 snap1.2013-02-10_0015 valid  112KB     0%    0%
                 snap2.2013-02-11_0010  valid  164KB     0%    0%
----
. 目的のスナップショットから読み書き可能なクローンを作成する
+
[source, cli]
----
volume clone create -vserver <SVM_name> -flexclone <flexclone_name> -type <type> -parent-volume <parent_volume_name> -parent-snapshot <snapshot_name>
----
+
ボリューム クローンは、SnapVaultバックアップと同じアグリゲート内に作成されます。クローンを格納するには、アグリゲート内に十分なスペースが必要です。

+
[listing]
----
cluster::> volume clone create -vserver vserverB
  -flexclone dstvolB_clone -type RW -parent-volume dstvolB
  -parent-snapshot daily.2013-02-10_0010
[Job 108] Job succeeded: Successful
----
. ボリューム クローン内の LUN を一覧表示します。
+
[source, cli]
----
lun show -vserver <SVM_name> -volume <flexclone_volume_name>
----
+
[listing]
----
cluster::> lun show -vserver vserverB -volume dstvolB_clone

Vserver   Path                      State   Mapped   Type
--------- ------------------------  ------- -------- --------
vserverB  /vol/dstvolB_clone/lun_A  online  unmapped windows
vserverB  /vol/dstvolB_clone/lun_B  online  unmapped windows
vserverB  /vol/dstvolB_clone/lun_C  online  unmapped windows

3 entries were displayed.
----
+
 `lun show`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/lun-show.html["ONTAPコマンド リファレンス"^]を参照してください。

. SnapVaultバックアップを含むSVM上に目的のホストのigroupがまだ存在しない場合は、igroupを作成します。
+
[source, cli]
----
igroup create -vserver <SVM_name> -igroup <igroup_name> -protocol <protocol> -ostype <os_type> -initiator <initiator_name>
----
+
この例では、iSCSIプロトコルを使用するWindowsホストのigroupを作成します：

+
[listing]
----
cluster::> igroup create -vserver vserverB -igroup temp_igroup
  -protocol iscsi -ostype windows
  -initiator iqn.1991-05.com.microsoft:hostA
----
. 必要な LUN コピーを igroup にマップします。
+
[source, cli]
----
lun mapping create -vserver <SVM_name> -path <lun_path> -igroup <igroup_name>
----
+
[listing]
----
cluster::> lun mapping create -vserver vserverB
  -path /vol/dstvolB_clone/lun_C -igroup temp_igroup
----
+
 `lun mapping create`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/lun-mapping-create.html["ONTAPコマンド リファレンス"^]を参照してください。

. ホストを LUN に接続し、必要に応じて LUN の内容にアクセスします。
+
このLUNは読み取り/書き込み可能で、元のLUNの代わりに使用できます。LUNのシリアル番号が異なるため、ホストは元のLUNとは異なるLUNとして認識します。

. ホスト上のコピー プログラムを使用して、LUNの内容を元のLUNにコピーします。


.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/snapmirror-show.html["snapmirror show"^]

