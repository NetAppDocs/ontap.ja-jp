---
permalink: san-admin/san-provisioning-fc-concept.html 
sidebar: sidebar 
keywords:  
summary: ONTAP で FC SAN を実装する方法について理解する際に必要となる重要な概念について説明します。 
---
= FCを使用したSANプロビジョニング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP で FC SAN を実装する方法について理解する際に必要となる重要な概念について説明します。



== FCターゲットノードをネットワークに接続する方法

ストレージシステムとホストにはアダプタが搭載されているため、ケーブルを使用してFCスイッチに接続できます。

ノードを FC SAN に接続すると、各 SVM の LIF の World Wide Port Name （ WWPN ；ワールドワイドポート名）がスイッチのファブリックネームサービスに登録されます。SVM の WWNN と各 LIF の WWPN は、 ONTAP によって自動的に割り当てられます。

[NOTE]
====
FCを使用してホストからノードに直接接続することはできません。NPIVが必要なため、スイッチを使用する必要があります。iSCSIセッションでは、通信はネットワークルーティングされた接続または直接接続された接続で機能します。ただし、これらの方法はどちらもONTAPでサポートされています。

====


== FCノードの識別方法

FCが設定された各SVMは、World Wide Node Name（WWNN；ワールドワイドノード名）で識別されます。



== WWPNの使用方法

WWPN により、 FC をサポートするように設定されている SVM 内の各 LIF が識別されます。これらのLIFは、クラスタ内の各ノードの物理FCポート（ノードでFCまたはFCoEとして設定されたFCターゲットカード、UTA、UTA2）を使用します。

* igroupの作成
+
ホストのHBAのWWPNは、イニシエータグループ（igroup）の作成に使用されます。igroupは、特定のLUNへのホストアクセスの制御に使用されます。igroupを作成するには、FCネットワーク内のイニシエータの一連のWWPNを指定します。ストレージシステム上のLUNをigroupにマッピングすると、そのグループ内のすべてのイニシエータに、そのLUNへのアクセスを許可できます。ホストのWWPNがLUNにマッピングされたigroupに含まれていない場合、そのホストはLUNにアクセスできません。つまり、LUNはそのホストではディスクとして表示されません。

+
また、ポートセットを作成して、特定のターゲットポートでのみLUNが認識されるようにすることもできます。ポートセットは、FCターゲットポートをグループ化したものです。igroupはポートセットにバインドできます。igroup内のすべてのホストは、ポートセット内のターゲットポートからのみLUNにアクセスできます。

* FC LIFを一意に識別
+
WWPNはFC論理インターフェイスを一意に識別します。ホストオペレーティングシステムでは、WWNNとWWPNを組み合わせて使用してSVMとFC LIFを識別します。一部のオペレーティングシステムでは、ホスト上でLUNが同じターゲットIDで表示されるようにするためにパーシスタントバインディングが必要です。





== World Wide Nameの割り当ての仕組み

WWNは、ONTAPでシーケンシャルに作成されます。ただし、ONTAPによる割り当て方法が原因で、シーケンシャルではない順序で割り当てられているように見える場合があります。

各アダプタにはWWPNとWWNNが事前に設定されていますが、ONTAPでは事前設定された値は使用されません。代わりに、ONTAPはオンボードイーサネットポートのMACアドレスに基づいて、独自のWWPNまたはWWNNを割り当てます。

WWNが割り当て時にシーケンシャルでないように見える理由は次のとおりです。

* WWN は、クラスタ内のすべてのノードと Storage Virtual Machine （ SVM ）で一意に割り当てられます。
* 解放されたWWNはリサイクルされ、使用可能な名前のプールに再び追加されます。




== FCスイッチの識別方法

Fibre Channelスイッチには、デバイス自体に1つのWorld Wide Node Name（WWNN；ワールドワイドノード名）、デバイスの各ポートに1つのWorld Wide Port Name（WWPN；ワールドワイドポート名）があります。

たとえば、次の図は、16ポートBrocadeスイッチの各ポートにWWPNがどのように割り当てられているかを示しています。特定のスイッチのポート番号の詳細については、そのスイッチに対応するベンダー提供のマニュアルを参照してください。

image:drw-fcswitch-scrn-en-noscale.gif["Brocade Fibre Channelスイッチポート"]

ポート* 0 *、WWPN 20：** 00 **：00：60：69：51：06：b4

ポート * 1 * 、 WWPN 20 ： ** 01 ** 00 ： 60 ： 69 ： 51 ： 06 ： b4

ポート * 14 * 、 WWPN 20 ： ** 0e ** ： 00 ： 60 ： 69 ： 51 ： 06 ： B4

ポート * 15 * 、 WWPN 20 ： ** 0f ** ： 00 ： 60 ： 69 ： 51 ： 06 ： B4
