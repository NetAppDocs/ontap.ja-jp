---
permalink: san-admin/san-provisioning-fc-concept.html 
sidebar: sidebar 
keywords:  
summary: ONTAPでFC SANを実装する方法について理解する際に必要となる重要な概念について説明します。 
---
= FCを使用したSANプロビジョニング
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAPでFC SANを実装する方法について理解する際に必要となる重要な概念について説明します。



== FCターゲット ノードをネットワークに接続する方法

ストレージ システムとホストはいずれもアダプタを備えているので、ケーブルを使用してFCスイッチに接続できます。

ノードをFC SANに接続すると、スイッチのファブリック ネーム サービスに各SVMのLIFのWorld Wide Port Name（WWPN）が登録されます。SVMのWWNNと各LIFのWWPNは、ONTAPによって自動的に割り当てられます。

[NOTE]
====
FCを使用したホストからノードへの直接接続はサポートされていません。接続にはNPIVが必要なため、スイッチを使用する必要があります。iSCSIセッションの場合、ネットワーク経由の接続または直接接続がサポートされます。ONTAPはこれら両方の方法をサポートしています。

====


== FCノードの識別方法

FCを使用して設定された個々のSVMは、World Wide Node Name（WWNN）で識別されます。



== WWPNの使用方法

WWPNは、FCをサポートするように設定されたSVM内の各LIFを識別します。これらのLIFは、クラスタ内の各ノードの物理FCポート（ノードでFCまたはFCoEとして設定されたFCターゲット カード、UTA、またはUTA2）を使用します。

* イニシエータ グループの作成
+
ホストのHBAのWWPNは、イニシエータ グループ（igroup）の作成に使用します。igroupは、特定LUNへのホスト アクセスの制御に使用します。igroupを作成するには、FCネットワーク内の一連のイニシエータのWWPNを指定します。ストレージ システムのLUNをigroupにマッピングすると、このグループ内のすべてのイニシエータに対し、このLUNへのアクセスを許可することができます。LUNにマッピングされているigroupにWWPNが含まれていないホストは、そのLUNにアクセスできません。つまり、そのホストでは、そのLUNがディスクとして表示されません。

+
また、ポートセットを作成することで、特定のターゲット ポートに関してだけLUNを表示することもできます。ポートセットは、FCターゲット ポートをグループ化したものです。ポートセットにはigroupをバインドできます。このigroup内のすべてのホストは、ポートセット内のターゲット ポートからのみ各LUNにアクセスできます。

* FC LIFを一意に識別
+
WWPNは、FC論理インターフェイスを一意に識別します。ホストのOSは、WWNNとWWPNを組み合わせて使用し、SVMおよびFC LIFを識別します。一部のOSでは、パーシスタント バインディングがないと、ホストにおいて同じターゲットIDでLUNが表示されません。





== World Wide Name（WWN）の割り当ての仕組み

WWNは、ONTAPでシーケンシャルに作成されます。ただし、ONTAPによる割り当て方法が原因で、WWNがシーケンシャルに割り当てられていないように見える場合があります。

各アダプタにはWWPNおよびWWNNがあらかじめ設定されていますが、ONTAPではあらかじめ設定された値が使用されません。その代わりに、ONTAPはオンボード イーサネット ポートのMACアドレスに基づいて、固有のWWPNまたはWWNNを割り当てます。

WWNが割り当て時にシーケンシャルでないように見える理由は次のとおりです。

* WWNは、クラスタ内のすべてのノードとStorage Virtual Machine（SVM）で一意に割り当てられます。
* 解放されたWWNはリサイクルされ、利用可能な名前のプールに再び追加されます。




== FCスイッチの識別方法

Fibre Channelスイッチには、デバイス自体に1つ、デバイスの各ポートに1つ、Worldwide Port Name（WWPN）が割り当てられています。

たとえば次の図では、16ポートのBrocadeスイッチの各ポートにWWPNが割り当てられています。特定のスイッチのポート番号のレイアウトについては、ベンダーが提供しているそのスイッチのドキュメントを参照してください。

image:drw-fcswitch-scrn-en-noscale.gif["Brocade ファイバチャネルスイッチポート"]

ポート *0*、WWPN 20:**00**:00:60:69:51:06:b4

ポート *1*、WWPN 20:**01**:00:60:69:51:06:b4

ポート *14*、WWPN 20:**0e**:00:60:69:51:06:b4

ポート *15*、WWPN 20:**0f**:00:60:69:51:06:b4
