---
permalink: san-admin/selective-lun-map-concept.html 
sidebar: sidebar 
keywords: select, selective, lun, map, slm, enabled, modify, reporting, nodes, list 
summary: 選択的LUNマップ（SLM）では、ホストからLUNへのパスの数を減らすことができます。SLMを使用して新しいLUNマップを作成すると、LUNを所有するノードとそのHAパートナーのパス経由でのみLUNにアクセスできます。 
---
= 選択的LUNマップ - 概要
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
選択的LUNマップ（SLM）では、ホストからLUNへのパスの数を減らすことができます。SLMを使用して新しいLUNマップを作成すると、LUNを所有するノードとそのHAパートナーのパス経由でのみLUNにアクセスできます。

SLMを使用すると、ホストごとに1つのigroupを管理でき、システム停止を伴わないLUNの移動処理がサポートされます。ポートセットの操作やLUNの再マッピングは不要です。

link:create-port-sets-binding-igroups-task.html["ポートセット"]をSLMと併用することで、特定のターゲットから特定のイニシエータへのアクセスをさらに制限できます。SLMをポートセットと併用すると、LUNは、LUNを所有するノードとそのノードのHAパートナー上のポートセット内のLIFセットからアクセス可能になります。

新しいLUNマップではSLMがデフォルトで有効になります。



== SLMがLUNマップで有効かどうかの確認

ONTAP 9リリースで作成されたLUNと以前のバージョンから移行されたLUNが環境内に混在している場合は、特定のLUNでSelective LUN Map（SLM;選択的LUNマップ）が有効になっているかどうかを判断しなければならないことがあります。

 `lun mapping show -fields reporting-nodes, node`コマンドの出力に表示される情報を使用して、LUNマップでSLMが有効になっているかどうかを確認できます。SLMが有効になっていない場合、コマンド出力の「`reporting-nodes`」列の下のセルに「-」が表示されます。SLMが有効になっている場合、「`nodes`」列の下に表示されるノードのリストが「`reporting-nodes`」列に複製されます。

 `lun mapping show`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/lun-mapping-show.html["ONTAPコマンド リファレンス"^]を参照してください。



== SLMレポート ノード リストの変更

LUNまたはLUNが含まれているボリュームを同じクラスタ内の別のハイアベイラビリティ（HA）ペアに移動する場合は、移動を開始する前に選択的LUNマップ（SLM）のレポート ノード リストを変更して、LUNのアクティブな最適パスが維持されるようにする必要があります。

.手順
. デスティネーション ノードとそのパートナー ノードをアグリゲートまたはボリュームのレポート ノード リストに追加します。
+
[source, cli]
----
lun mapping add-reporting-nodes -vserver <vserver_name> -path <lun_path> -igroup <igroup_name> [-destination-aggregate <aggregate_name>|-destination-volume <volume_name>]
----
+
一貫した命名規則がある場合は、 `igroup_name`の代わりに `igroup_prefix*`を使用して、複数のLUNマッピングを同時に変更できます。

. ホストを再スキャンして、新しく追加したパスを検出します。
. OSで必要な場合は、マルチパス ネットワークI/O（MPIO）構成に新しいパスを追加します。
. 必要な移動処理のためのコマンドを実行して、処理が完了するまで待ちます。
. I/Oがアクティブな最適パス経由で処理されていることを確認します。
+
[source, cli]
----
lun mapping show -fields reporting-nodes
----
. レポート ノード リストから、前のLUN所有者とそのパートナー ノードを削除します。
+
[source, cli]
----
lun mapping remove-reporting-nodes -vserver <vserver_name> -path <lun_path> -igroup <igroup_name> -remote-nodes
----
. 既存のLUNマップからLUNが削除されていることを確認します。
+
[source, cli]
----
lun mapping show -fields reporting-nodes
----
. ホストOSの古いデバイスのエントリを削除します。
. 必要に応じて、マルチパス構成ファイルを変更します。
. ホストを再スキャンして、古いパスが削除されたことを確認します。+ ホストを再スキャンする具体的な手順については、ホストのドキュメントを参照してください。

