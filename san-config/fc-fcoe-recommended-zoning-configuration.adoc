---
permalink: san-config/fc-fcoe-recommended-zoning-configuration.html 
sidebar: sidebar 
keywords: individual zones 
summary: 推奨されるFCおよびFCoEゾーニング設定では、ゾーンごとに1つのホストイニシエータを使用します。ゾーンは、ホストイニシエータポートとストレージノード上の 1 つ以上のターゲット LIF で構成され、ターゲットあたりの希望する数のパスまで LUN へのアクセスを提供します。この構成では、各ホストイニシエータは任意のノードにアクセスできますが、同じノードにアクセスするホストはお互いのポートを認識できません。 
---
= ONTAPシステムヨウノFCオヨヒFCoEソオニンクセツテイ
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ホストにマルチパスソリューションがインストールされていない場合、SANにホストを4つ以上接続する場合、またはクラスタ内のノードに選択的LUNマッピングが実装されていない場合は、ゾーニング設定を作成する必要があります。

FCおよびFCoEの推奨されるゾーニング設定では、各ゾーンに1つのイニシエータポートと1つ以上のターゲットLIFが含まれます。この構成では、各ホストイニシエータは任意のノードにアクセスできますが、同じノードにアクセスするホストはお互いのポートを認識できません。

Storage Virtual Machine（SVM）のすべてのLIFをホストイニシエータを含むゾーンに追加します。これにより、既存のゾーンを編集したり、新しいゾーンを作成したりせずに、ボリュームや LUN を移動できます。



== dual-fabricゾーニング構成

単一コンポーネントの障害によるデータ損失から保護できるため、デュアルファブリックゾーニング構成を推奨します。デュアルファブリック構成では、各ホストイニシエータが異なるスイッチを使用してクラスタ内の各ノードに接続されます。一方のスイッチが使用できなくなっても、残りのスイッチを介してデータアクセスが維持されます。複数のパスを管理するには、ホストにマルチパスソフトウェアが必要です。

次の図では、ホストに2つのイニシエータがあり、マルチパスソフトウェアを実行しています。2つのゾーンがあります。link:../san-admin/selective-lun-map-concept.html["選択的LUNマッピング（SLM）"]すべてのノードがレポートノードとみなされるように設定されています。

[NOTE]
====
この図で使用されている命名規則は、ONTAPソリューションで使用できる一例です。

====
* ゾーン1：HBA 0、LIF_1、LIF_3、LIF_5、およびLIF_7
* ゾーン2：HBA 1、LIF_2、LIF_4、LIF_6、およびLIF_8


各ホストイニシエータは、異なるスイッチを使用してゾーニングされます。ゾーン1にはスイッチ1からアクセスします。ゾーン2にはスイッチ2からアクセスします。

各ホストは、すべてのノードのLIFにアクセスできます。これにより、ノードで障害が発生しても、ホストはLUNに引き続きアクセスできます。SVMは、SLMレポートノードの設定に基づいて、クラスタ内のすべてのノードのすべてのiSCSI LIFとFC LIFにアクセスできます。SLM、ポートセット、またはFCスイッチゾーニングを使用して、SVMからホストへのパスの数とSVMからLUNへのパスの数を減らすことができます。

構成に追加のノードが含まれている場合、追加のノードのLIFはこれらのゾーンに含まれます。

image:scm-en-drw-dual-fabric-zoning.png["デュアルファブリックゾーニング"]

[NOTE]
====
ホストオペレーティングシステムとマルチパスソフトウェアが、ノード上のLUNへのアクセスに使用される数のパスをサポートしている必要があります。

====


== 単一ファブリックゾーニング

単一ファブリック構成では、1つのスイッチを使用して各ホストイニシエータを各ストレージノードに接続します。単一ファブリックゾーニング構成は、単一コンポーネントの障害によるデータ損失から保護されないため、推奨されません。単一ファブリックゾーニングを設定する場合は、ソリューションの耐障害性を確保するために、マルチパス用のイニシエータを各ホストに2つ用意する必要があります。複数のパスを管理するには、ホストにマルチパスソフトウェアが必要です。

各ホストイニシエータには、イニシエータがアクセスできる各ノードのLIFが少なくとも1つ必要です。ホストイニシエータからクラスタ内のHAペアのノードへのパスが少なくとも1つあるようにゾーニングを設定して、LUN接続用のパスを提供する必要があります。つまり、ホスト上の各イニシエータには、そのゾーン構成内のノードごとにターゲットLIFが1つだけ割り当てられます。クラスタ内の同じノードまたは複数のノードへのパスが複数必要な場合は、ゾーン構成内の各ノードに複数のLIFが割り当てられます。これにより、ノードに障害が発生した場合や、LUNを含むボリュームが別のノードに移動された場合でも、ホストはLUNに引き続きアクセスできます。また、レポートノードを適切に設定する必要があります。

Cisco FC スイッチおよび FCoE スイッチを使用する場合、 1 つのファブリックゾーンに同じ物理ポートのターゲット LIF を複数含めることはできません。同じポートの LIF を同じゾーンに複数配置すると、接続が失われた場合に LIF ポートがリカバリできなくなる可能性があります。

次の図では、ホストに2つのイニシエータがあり、マルチパス ソフトウェアを実行しています。次の2つのゾーンがあります。

[NOTE]
====
この図で使用されている命名規則は、ONTAPソリューションで使用できる一例です。

====
* ゾーン1：HBA 0、LIF_1、およびLIF_3
* ゾーン2：HBA 1、LIF_2、およびLIF_4


構成に追加のノードが含まれている場合、追加のノードのLIFはこれらのゾーンに含まれます。

image:scm-en-drw-single-fabric-zoning.png["単一ファブリックゾーニング"]

この例では、各ゾーンに4つのLIFをすべて配置することもできます。その場合のゾーンは次のようになります。

* ゾーン1：HBA 0、LIF_1、LIF_2、LIF_3、およびLIF_4
* ゾーン2：HBA 1、LIF_1、LIF_2、LIF_3、およびLIF_4


[NOTE]
====
ホストオペレーティングシステムとマルチパスソフトウェアが、ノード上のLUNへのアクセスに使用される数のパスをサポートしている必要があります。ノードのLUNへのアクセスに使用するパスの数については、SAN構成の制限に関するセクションを参照してください。

====


== Cisco FCおよびFCoEスイッチのゾーニング制限

Cisco FCおよびFCoEスイッチを使用する場合、ゾーンでの物理ポートと論理インターフェイス（LIF）の使用には一定の制限が適用されます。

.物理ポート
* FC-NVMeとFCで同じ32Gb物理ポートを共有可能
* FC-NVMeとFCoEは同じ物理ポートを共有できない
* FCとFCoEは同じ物理ポートを共有できますが、プロトコルLIFは別 々 のゾーンに配置する必要があります。


.論理インターフェイス（LIF）
* ゾーンには、クラスタ内のすべてのターゲットポートのLIFを1つ含めることができます。
+
ホストへのパスの最大数を超えないように、SLMの設定を確認します。

* 特定のポートの各LIFは、そのポートの他のLIFとは別のゾーンに配置する必要があります。
* 物理ポートが異なる LIF は、同じゾーンに配置することもできます。

