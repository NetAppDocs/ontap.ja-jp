---
permalink: smb-admin/add-home-directory-share-task.html 
sidebar: sidebar 
keywords: smb, home, directory, feature, add, property, share, properties, property, add a home directory share 
summary: SMBホーム ディレクトリ機能を使用するためには、ホーム ディレクトリ プロパティが設定された共有を少なくとも1つ追加する必要があります。 
---
= ONTAP SMB ホームディレクトリ共有を追加する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SMBホーム ディレクトリ機能を使用するためには、ホーム ディレクトリ プロパティが設定された共有を少なくとも1つ追加する必要があります。

.タスク概要
 `vserver cifs share create`コマンドを使用して共有を作成するときにホーム ディレクトリ共有を作成することも、 `vserver cifs share modify`コマンドを使用していつでも既存の共有をホーム ディレクトリ共有に変更することもできます。

ホームディレクトリ共有を作成するには、共有の作成または変更時に `-share-properties`オプションに `homedirectory`値を含める必要があります。共有名と共有パスは、ユーザーがホームディレクトリに接続する際に動的に展開される変数を使用して指定できます。パスで使用できる変数は `%w`、 `%d`、 `%u`で、それぞれWindowsユーザー名、ドメイン、マッピングされたUNIXユーザー名に対応します。

.手順
. ホームディレクトリ共有を追加する：+
`vserver cifs share create -vserver _vserver_name_ -share-name _share_name_ -path _path_ -share-properties homedirectory[,...]`
+
`-vserver` `vserver`検索パスを追加する CIFS 対応のストレージ仮想マシン（SVM）を指定します。

+
`-share-name _share-name_`ホームディレクトリの共有名を指定します。

+
必須変数のいずれかに加えて、共有名にリテラル文字列 `%w`、 `%u`、または `%d`のいずれかが含まれている場合は、ONTAPがリテラル文字列を変数として扱うことを防ぐために、リテラル文字列の前に%（パーセント）文字を付ける必要があります（たとえば、 `%%w`）。

+
** 共有名には `%w`または `%u`変数のいずれかを含める必要があります。
** 共有名には、さらに `%d`変数（例： `%d`/`%w`）または共有名の静的部分（例：home1_/`%w`）を含めることができます。
** 管理者が他のユーザーのホーム ディレクトリに接続するために、またはユーザーが他のユーザーのホーム ディレクトリに接続することを許可するために共有を使用する場合、動的な共有名パターンの前にチルダ（~）を付ける必要があります。
+
 `vserver cifs home-directory modify`は、 `-is-home-dirs-access-for-admin-enabled`オプションを `true`に設定するか、詳細オプション `-is-home-dirs-access-for-public-enabled`を `true`に設定することによって、このアクセスを有効にするために使用されます。



+
`-path` `path` ホームディレクトリへの相対パスを指定します。



`-share-properties homedirectory[,...]` その共有の共有プロパティを指定します。 `homedirectory` 値を指定する必要があります。追加の共有プロパティは、カンマ区切りのリストで指定できます。

.  `vserver cifs share show`コマンドを使用して、ホームディレクトリ共有が正常に追加されたことを確認します。


.例
次のコマンドは、 `%w`という名前のホームディレクトリ共有を作成します。 `oplocks`、 `browsable`、および `changenotify`共有プロパティは、 `homedirectory`共有プロパティの設定に加えて設定されます。

[NOTE]
====
この例で表示されているのは、SVMの共有の出力の一部です。出力は省略されています。

====
[listing]
----
cluster1::> vserver cifs share create -vserver vs1 -share-name %w -path %w -share-properties oplocks,browsable,changenotify,homedirectory

vs1::> vserver cifs share show -vserver vs1
Vserver    Share    Path         Properties     Comment  ACL
---------- -------- ------------ -------------- -------- -----------
vs1        %w       %w           oplocks        -        Everyone / Full Control
                                 browsable
                                 changenotify
                                 homedirectory
----
.関連情報
* xref:add-home-directory-search-path-task.adoc[ホームディレクトリの検索パスを追加する]
* xref:requirements-automatic-node-referrals-concept.adoc[サーバー上で自動ノード紹介を使用するための要件とガイドライン]
* xref:manage-accessibility-users-home-directories-task.adoc[ユーザーのホームディレクトリへのアクセシビリティを管理する]

