---
permalink: smb-admin/display-session-task.html 
sidebar: sidebar 
keywords: display, information, establish, smb, session, connection, session, id, ip, address, workstation, protection, level, nondisruptive, operation, display smb session information 
summary: 確立されたSMBセッションに関する情報（SMB接続、セッションID、セッションを使用しているワークステーションのIPアドレスなど）を表示できます。セッションのSMBプロトコル バージョンと継続的可用性保護レベルに関する情報も表示できるため、セッションが無停止運用をサポートしているかどうかを確認できます。 
---
= ONTAP SMB セッション情報を表示する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SMB接続、SMBセッションID、セッションを使用しているワークステーションのIPアドレスなど、確立されたSMBセッションに関する情報を表示できます。セッションのSMBプロトコル バージョンや継続的可用性を備えた保護のレベルに関する情報を表示できます。この情報は、セッションでノンストップ オペレーションがサポートされているかどうか確認するのに役立ちます。

.タスク概要
Storage Virtual Machine（SVM）上のすべてのセッションに関する情報を概要形式で表示できます。ただし、多くの場合、大量の出力が返されます。オプションのパラメータを指定すると、出力に表示される情報をカスタマイズできます。

* オプションの `-fields`パラメータを使用して、選択したフィールドに関する出力を表示できます。
+
 `-fields ?`を入力すると、使用できるフィールドを確認できます。

*  `-instance`パラメータを使用すると、確立された SMB セッションに関する詳細情報を表示できます。
*  `-fields`パラメータまたは `-instance`パラメータは、単独で使用することも、他のオプション パラメータと組み合わせて使用することもできます。


.手順
. 次のいずれかを実行します。
+
|===
| SMB セッション情報を表示する場合： | 入力するコマンド 


 a| 
SVM上のすべてのセッション（概要）
 a| 
`vserver cifs session show -vserver vserver_name`



 a| 
指定した接続ID
 a| 
`vserver cifs session show -vserver vserver_name -connection-id integer`



 a| 
指定したワークステーションのIPアドレスからのセッション
 a| 
`vserver cifs session show -vserver vserver_name -address workstation_IP_address`



 a| 
指定したLIF IPアドレス
 a| 
`vserver cifs session show -vserver vserver_name -lif-address LIF_IP_address`



 a| 
指定したノード
 a| 
`vserver cifs session show -vserver vserver_name -node {node_name|local}`



 a| 
指定したWindowsユーザからのセッション
 a| 
`vserver cifs session show -vserver vserver_name -windows-user domain_name\\user_name`



 a| 
指定した認証メカニズムを使用しているセッション
 a| 
`vserver cifs session show -vserver vserver_name -auth-mechanism {NTLMv1|NTLMv2|Kerberos|Anonymous}`



 a| 
指定したプロトコル バージョンを使用しているセッション
 a| 
`vserver cifs session show -vserver vserver_name -protocol-version {SMB1|SMB2|SMB2_1|SMB3|SMB3_1}`

[NOTE]
====
継続的に利用可能な保護機能およびSMB Multichannelは、SMB 3.0以降のセッションでのみ利用できます。すべての該当セッションでこれらのステータスを表示するには、このパラメータの値を `SMB3`以降に設定する必要があります。

====


 a| 
指定したレベルの継続的可用性を備えた保護を使用しているセッション
 a| 
`vserver cifs session show -vserver vserver_name -continuously-available {No|Yes|Partial}`

[NOTE]
====
継続的可用性ステータスが `Partial`の場合、セッションには少なくとも1つの継続的可用性ファイルが開かれていますが、継続的可用性保護が適用されていないファイルもいくつかあります。 `vserver cifs sessions file show`コマンドを使用すると、確立されたセッション上のどのファイルで継続的可用性保護が適用されていないかを確認できます。

====


 a| 
指定したSMB署名セッション ステータスのセッション
 a| 
`vserver cifs session show -vserver vserver_name -is-session-signed {true|false}`

|===


.例
次のコマンドは、IPアドレス10.1.1.1のワークステーションから確立されたSVM vs1上のセッションに関する情報を表示します。

[listing]
----
cluster1::> vserver cifs session show -address 10.1.1.1
Node:    node1
Vserver: vs1
Connection Session                                    Open         Idle
ID          ID      Workstation      Windows User    Files         Time
----------  ------- ---------------- ------------- ------- ------------
3151272279,
3151272280,
3151272281  1       10.1.1.1         DOMAIN\joe          2          23s
----
次のコマンドは、SVM vs1上の継続的可用性を備えた保護を使用するセッションに関する詳細な情報を表示します。この接続はドメイン アカウントを使用して確立されています。

[listing]
----
cluster1::> vserver cifs session show -instance -continuously-available Yes

                        Node: node1
                     Vserver: vs1
                  Session ID: 1
               Connection ID: 3151274158
Incoming Data LIF IP Address: 10.2.1.1
      Workstation IP address: 10.1.1.2
    Authentication Mechanism: Kerberos
                Windows User: DOMAIN\SERVER1$
                   UNIX User: pcuser
                 Open Shares: 1
                  Open Files: 1
                  Open Other: 0
              Connected Time: 10m 43s
                   Idle Time: 1m 19s
            Protocol Version: SMB3
      Continuously Available: Yes
           Is Session Signed: false
       User Authenticated as: domain-user
                NetBIOS Name: -
       SMB Encryption Status: Unencrypted
----
次のコマンドは、SVM vs1上のSMB 3.0とSMBマルチチャネルを使用しているセッションに関する情報を表示します。この例では、ユーザはLIF IPアドレスを使用してSMB 3.0対応のクライアントからこの共有に接続しています。そのため、認証メカニズムはデフォルトのNTLMv2になっています。継続的可用性を備えた保護を使用して接続するためには、Kerberos認証を使用して接続を確立する必要があります。

[listing]
----
cluster1::> vserver cifs session show -instance -protocol-version SMB3

                        Node: node1
                     Vserver: vs1
                  Session ID: 1
              **Connection IDs: 3151272607,31512726078,3151272609
            Connection Count: 3**
Incoming Data LIF IP Address: 10.2.1.2
      Workstation IP address: 10.1.1.3
    Authentication Mechanism: NTLMv2
                Windows User: DOMAIN\administrator
                   UNIX User: pcuser
                 Open Shares: 1
                  Open Files: 0
                  Open Other: 0
              Connected Time: 6m 22s
                   Idle Time: 5m 42s
            Protocol Version: SMB3
      Continuously Available: No
           Is Session Signed: false
       User Authenticated as: domain-user
                NetBIOS Name: -
       SMB Encryption Status: Unencrypted
----
.関連情報
xref:display-open-files-task.adoc[開いているSMBファイルに関する情報の表示]
