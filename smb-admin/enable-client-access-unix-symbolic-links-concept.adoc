---
permalink: smb-admin/enable-client-access-unix-symbolic-links-concept.html 
sidebar: sidebar 
keywords: smybol, link, file, create, unix, environment, reference, directory, client, access, redirect, target, absolute, widelinks, local, file, system, how ontap enables you to provide smb client access to unix symbolic links 
summary: シンボリック リンクはUNIX環境で作成されるファイルで、別のファイルまたはディレクトリへの参照が含まれます。シンボリック リンクにアクセスしたクライアントは、シンボリック リンクが参照するターゲット ファイルまたはディレクトリにリダイレクトされます。ONTAPでは、相対シンボリック リンクと絶対シンボリック リンク（ローカル ファイルシステムの外部のターゲットとの絶対リンクであるワイドリンクを含む）をサポートしています。 
---
= ONTAP SMBクライアントにUNIXシンボリック リンクへのアクセスを提供する方法について学習します。
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
シンボリック リンクはUNIX環境で作成されるファイルで、別のファイルまたはディレクトリへの参照が含まれます。シンボリック リンクにアクセスしたクライアントは、シンボリック リンクが参照するターゲット ファイルまたはディレクトリにリダイレクトされます。ONTAPでは、相対シンボリック リンクと絶対シンボリック リンク（ローカル ファイルシステムの外部のターゲットとの絶対リンクであるワイドリンクを含む）をサポートしています。

ONTAPは、SVM上に設定されたUNIXシンボリック リンクをSMBクライアントが追跡する機能を提供します。この機能はオプションであり、 `vserver cifs share create`コマンドの `-symlink-properties`オプションを使用して、以下のいずれかの設定で共有ごとに設定できます：

* 読み取り / 書き込みアクセスで有効化
* 読み取り専用アクセスで有効化
* SMBクライアントに対してシンボリック リンクを非表示にして無効化
* SMBクライアントからシンボリック リンクへのアクセス権なしで無効化


共有でシンボリック リンクを有効にした場合、相対シンボリック リンクは追加の設定なしで機能します。

共有でシンボリック リンクを有効にしても、絶対シンボリック リンクはすぐには機能しません。まず、シンボリック リンクのUNIXパスと宛先SMBパスとのマッピングを作成する必要があります。絶対シンボリック リンク マッピングを作成する際に、ローカル リンクか_ワイドリンク_かを指定できます。ワイドリンクは、他のストレージ デバイス上のファイル システムへのリンク、または同じONTAPシステム上の別のSVMでホストされているファイル システムへのリンクにすることができます。ワイドリンクを作成する際は、クライアントがたどる情報を含める必要があります。つまり、クライアントがディレクトリ ジャンクション ポイントを検出するための再解析ポイントを作成します。ローカル共有外のファイルまたはディレクトリへの絶対シンボリック リンクを作成し、ローカル性をローカルに設定すると、ONTAPはターゲットへのアクセスを拒否します。

[NOTE]
====
クライアントがローカル シンボリック リンク（絶対または相対）を削除した場合、シンボリック リンクのみが削除され、ターゲット ファイルまたはターゲット ディレクトリは削除されません。それに対して、クライアントがワイドリンクを削除した場合には、ワイドリンクが参照する実際のターゲット ファイルやターゲット ディレクトリが削除されることがあります。クライアントはSVM外のターゲット ファイルまたはディレクトリを明示的に開いて削除できるため、ONTAPではこの操作を制御できません。

====
* *再解析ポイントとONTAPファイル システム サービス*
+
_リパース ポイント_は、ファイルと共にボリューム上にオプションで保存できるNTFSファイル システム オブジェクトです。リパース ポイントは、NTFS形式のボリュームを操作する際に、SMBクライアントが拡張または強化されたファイル システム サービスを受けられるようにします。リパース ポイントは、リパース ポイントのタイプを識別する標準タグと、SMBクライアントが取得してさらに処理できるリパース ポイントの内容で構成されます。拡張ファイル システム機能で使用可能なオブジェクト タイプのうち、ONTAPはリパース ポイント タグを使用してNTFSシンボリック リンクとディレクトリ ジャンクション ポイントのサポートを実装しています。リパース ポイントの内容を理解できないSMBクライアントは、リパース ポイントを無視し、リパース ポイントによって有効になる可能性のある拡張ファイル システム サービスを提供しません。

* *ディレクトリ ジャンクション ポイントと ONTAP によるシンボリック リンクのサポート*
+
ディレクトリ ジャンクション ポイントはファイルシステム ディレクトリ構造内の場所で、別のパス（シンボリック リンク）または別のストレージ デバイス（ワイドリンク）上のファイルが格納されている場所を参照できます。ONTAPのSMBサーバはディレクトリ ジャンクション ポイントをリパース ポイントとしてWindowsクライアントに公開するため、対応するクライアントがディレクトリ ジャンクション ポイントをトラバースしたときにONTAPからリパース ポイントのコンテンツを取得することができます。そのため、別のパスやストレージ デバイスであっても、同じファイルシステムに属しているかのように移動して接続することができます。

* *再解析ポイントオプションを使用したワイドリンクサポートの有効化*
+
 `-is-use-junctions-as-reparse-points-enabled`オプションは、ONTAP 9ではデフォルトで有効になっています。すべてのSMBクライアントがワイドリンクをサポートしているわけではないため、情報を有効にするオプションはプロトコル バージョンごとに設定できます。これにより、管理者はサポートされているSMBクライアントとサポートされていないSMBクライアントの両方に対応できます。ワイドリンクを使用して共有にアクセスするクライアント プロトコルごとに、 `-widelink-as-reparse-point-versions`オプションを有効にする必要があります（デフォルトはSMB1）。



.関連情報
* link:windows-backup-symlinks.html["Windowsのバックアップ アプリケーションとUNIX形式のシンボリック リンク"]
* https://docs.microsoft.com/en-us/windows/win32/fileio/reparse-points["Microsoft ドキュメント：再解析ポイント"^]

