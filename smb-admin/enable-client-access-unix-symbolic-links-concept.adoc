---
permalink: smb-admin/enable-client-access-unix-symbolic-links-concept.html 
sidebar: sidebar 
keywords: smybol, link, file, create, unix, environment, reference, directory, client, access, redirect, target, absolute, widelinks, local, file, system, how ontap enables you to provide smb client access to unix symbolic links 
summary: シンボリックリンクは UNIX 環境で作成されるファイルで、別のファイルまたはディレクトリへの参照が含まれます。シンボリックリンクにアクセスしたクライアントは、シンボリックリンクが参照するターゲットファイルまたはディレクトリにリダイレクトされます。ONTAPは、ワイドリンク（ローカルファイルシステムの外部にあるターゲットとの絶対リンク）を含む相対シンボリックリンクと絶対シンボリックリンクをサポートします。 
---
= ONTAP SMBクライアントにUNIXシンボリックリンクへのアクセスを提供する方法について学習します。
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
シンボリックリンクは UNIX 環境で作成されるファイルで、別のファイルまたはディレクトリへの参照が含まれます。シンボリックリンクにアクセスしたクライアントは、シンボリックリンクが参照するターゲットファイルまたはディレクトリにリダイレクトされます。ONTAPは、ワイドリンク（ローカルファイルシステムの外部にあるターゲットとの絶対リンク）を含む相対シンボリックリンクと絶対シンボリックリンクをサポートします。

ONTAP には、 SMB クライアントが SVM で設定されている UNIX のシンボリックリンクをたどるための機能が用意されています。この機能はオプションであり、次のいずれかの設定を指定してコマンドのオプションを `vserver cifs share create`使用すると、共有ごとに設定でき `-symlink-properties`ます。

* 読み取り / 書き込みアクセスで有効化
* 読み取り専用アクセスで有効化
* SMB クライアントに対してシンボリックリンクを非表示にして無効にしました
* SMB クライアントからシンボリックリンクへのアクセス権なしで無効になりました


共有でシンボリックリンクを有効にした場合、相対シンボリックリンクは追加の設定なしで機能します。

共有でシンボリックリンクを有効にしただけでは、絶対シンボリックリンクは機能しません。最初に、シンボリックリンクの UNIX パスからデスティネーション SMB パスへのマッピングを作成する必要があります。絶対シンボリックリンクのマッピングを作成する場合、ローカルリンクか a_widelink ；ワイドリンクを他のストレージデバイス上のファイルシステムにリンクするか、同じ ONTAP システム上の別々の SVM でホストされているファイルシステムにリンクするかを指定できます。ワイドリンクを作成するときは、クライアントがたどる情報を含める必要があります。つまり、クライアントがディレクトリジャンクションポイントを検出するためのリパースポイントを作成します。ローカル共有外のファイルまたはディレクトリへの絶対シンボリックリンクを作成しても、局所性をローカルに設定すると、 ONTAP はターゲットへのアクセスを許可しません。

[NOTE]
====
クライアントがローカルシンボリックリンク（絶対または相対）を削除しようとすると、シンボリックリンクのみが削除され、ターゲットファイルやターゲットディレクトリは削除されません。ただし、クライアントがワイドリンクを削除しようとすると、ワイドリンクが参照する実際のターゲットファイルやターゲットディレクトリが削除される可能性があります。クライアントは SVM 外のターゲットファイルまたはディレクトリを明示的に開いて削除できるため、 ONTAP ではこの操作を制御できません。

====
* * リパースポイントと ONTAP ファイルシステムサービス *
+
a_reparse point_ は、オプションでファイルとともにボリュームに格納できる NTFS ファイルシステムオブジェクトです。リパースポイントを使用すると、SMBクライアントは、NTFS形式のボリュームを使用する際に拡張ファイルシステムサービスを利用できます。リパースポイントは、リパースポイントのタイプを識別する標準のタグと、SMBクライアントが取得して以降の処理を実行できるリパースポイントの内容で構成されます。ファイルシステムの拡張機能で使用できるオブジェクトタイプのうち、ONTAPでは、リパースポイントタグを使用したNTFSシンボリックリンクとディレクトリジャンクションポイントのサポートが実装されています。リパースポイントの内容を理解できないSMBクライアントは、リパースポイントを無視し、リパースポイントで有効になる可能性のある拡張ファイルシステムサービスを提供しません。

* * ディレクトリジャンクションポイントおよびシンボリックリンクの ONTAP サポート *
+
ディレクトリジャンクションポイントはファイルシステムディレクトリ構造内の場所で、別のパス（シンボリックリンク）または別のストレージデバイス（ワイドリンク）上のファイルが格納されている別の場所を参照できます。ONTAP SMBサーバはディレクトリジャンクションポイントをリパースポイントとしてWindowsクライアントに公開するため、対応するクライアントは、ディレクトリジャンクションポイントがトラバースされたときにONTAPからリパースポイントのコンテンツを取得できます。これにより、同じファイルシステムの一部であるかのように、異なるパスやストレージデバイスに移動して接続できます。

* * リパースポイントオプションを使用したワイドリンクサポートの有効化 *
+
ONTAP 9では、この `-is-use-junctions-as-reparse-points-enabled`オプションはデフォルトで有効になっています。すべてのSMBクライアントがワイドリンクをサポートしているわけではないため、この情報を有効にするオプションはプロトコルバージョンごとに設定可能です。これにより、管理者はサポートされているSMBクライアントとサポートされていないSMBクライアントの両方に対応できます。このオプションを有効にする必要があります。  `-widelink-as-reparse-point-versions`ワイドリンクを使用して共有にアクセスする各クライアント プロトコル。デフォルトは SMB1 です。



.関連情報
* link:windows-backup-symlinks.html["WindowsバックアップアプリケーションとUNIX形式のシンボリックリンク"]
* https://docs.microsoft.com/en-us/windows/win32/fileio/reparse-points["Microsoft のドキュメント：「 Reparse Points"^]

