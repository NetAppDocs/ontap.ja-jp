---
permalink: smb-admin/enable-disable-oplocks-when-creating-shares-task.html 
sidebar: sidebar 
keywords: oplock, client, lock, file, cache, content, local, performance, operation, storage, virtual, machine, svm, circumstance, disable, share-by-share, basis, enable, disable, enable or disable oplocks when creating smb shares 
summary: oplockを使用すると、クライアントによりファイルがロックされてコンテンツがローカルにキャッシュされるため、ファイル操作のパフォーマンスを向上できます。Storage Virtual Machine（SVM）上にあるSMB共有では、oplockが有効になります。場合によっては、oplockの無効化が必要になることがあります。oplockは共有ごとに有効または無効にできます。 
---
= ONTAP SMB共有を作成するときにoplocksを有効または無効にする
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
oplockを使用すると、クライアントによりファイルがロックされてコンテンツがローカルにキャッシュされるため、ファイル操作のパフォーマンスを向上できます。Storage Virtual Machine（SVM）上にあるSMB共有では、oplockが有効になります。場合によっては、oplockの無効化が必要になることがあります。oplockは共有ごとに有効または無効にできます。

.タスク概要
共有を含むボリュームでoplockが有効になっているが、その共有のoplock共有プロパティが無効になっている場合、その共有のoplockは無効になります。共有でのoplockの無効化は、ボリュームのoplockの設定よりも優先されます。共有でoplockを無効にすると、便宜的oplockとoplockリースの両方が無効になります。

oplock共有プロパティに加えて、その他の共有プロパティをカンマで区切って指定できます。その他の共有パラメータを指定することもできます。

.手順
. 該当する処理を実行します。
+
|===
| 状況 | 操作 


 a| 
共有の作成時に共有でoplockを有効にする
 a| 
次のコマンドを入力します： `+vserver cifs share create -vserver _vserver_name_ -share-name share_name -path path_to_share -share-properties [oplocks,...]+`

[NOTE]
====
共有にデフォルトの共有プロパティ（ `oplocks`、 `browsable`、および `changenotify`が有効）のみを設定する場合は、SMB共有の作成時に `-share-properties`パラメータを指定する必要はありません。デフォルト以外の共有プロパティの組み合わせを設定する場合は、その共有で使用する共有プロパティのリストを `-share-properties`パラメータで指定する必要があります。

====


 a| 
共有の作成時に共有でoplockを無効にする
 a| 
次のコマンドを入力します： `+vserver cifs share create -vserver _vserver_name_ -share-name _share_name_ -path _path_to_share_ -share-properties [other_share_property,...]+`

[NOTE]
====
oplock を無効にする場合は、共有を作成するときに共有プロパティのリストを指定する必要がありますが、 `oplocks` プロパティは指定しないでください。

====
|===


.関連情報
xref:enable-disable-oplocks-existing-shares-task.adoc[既存のSMB共有でのoplockの有効化と無効化]

xref:monitor-oplock-status-task.adoc[oplockステータスの監視]
