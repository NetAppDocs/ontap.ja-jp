---
permalink: smb-admin/server-options-reference.html 
sidebar: sidebar 
keywords: useful, option, available, consider, customize, smb, cifs, server, general, enable, configure, functionality, vserver, modify, available smb server options 
summary: SMBサーバのカスタマイズ方法を検討する場合は、使用可能なオプションを把握しておくと役立ちます。一部のオプションは一般的なものですが、SMBの特定の機能を有効にして設定するためのオプションもいくつかあります。SMB サーバのオプションは、 vserver cifs options modify オプションで制御されます。 
---
= 使用できるSMBサーバオプション
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SMBサーバのカスタマイズ方法を検討する場合は、使用可能なオプションを把握しておくと役立ちます。一部のオプションは一般的なものですが、SMBの特定の機能を有効にして設定するためのオプションもいくつかあります。SMBサーバオプションは、オプションで制御し `vserver cifs options modify`ます。

次に、admin権限レベルで使用できるSMBサーバオプションについて説明します。

* * SMB セッションタイムアウト値の設定 *
+
このオプションでは、SMBセッションが切断されるまでのアイドル時間（秒）を指定できます。アイドルセッションとは、ユーザがクライアント上でファイルやディレクトリを開いていないセッションのことです。デフォルト値は900秒です。

* * デフォルトの UNIX ユーザーの構成 *
+
このオプションでは、SMBサーバで使用するデフォルトのUNIXユーザを指定できます。ONTAP はデフォルトユーザ「 pcuser 」（ UID は 65534 ）を自動的に作成し、グループ「 pcuser 」（ GID は 65534 ）を作成して、デフォルトユーザを「 pcuser 」グループに追加します。SMB サーバを作成すると、 ONTAP は自動的に「 pcuser 」をデフォルトの UNIX ユーザとして設定します。

* * ゲスト UNIX ユーザの設定 *
+
このオプションでは、信頼されていないドメインからログインしたユーザをマッピングするUNIXユーザの名前を指定できます。これにより、信頼されていないドメインのユーザがSMBサーバに接続できるようになります。デフォルトでは、このオプションは設定されていません（デフォルト値はありません）。そのため、信頼されていないドメインのユーザはSMBサーバへの接続を許可されません。

* * モードビットの読み取り権限付与の実行の有効化または無効化 *
+
このオプションを有効または無効にすると、UNIX実行可能ビットが設定されていない場合でも、UNIXモードビットが設定された実行可能ファイルの実行を、読み取りアクセス権を持つSMBクライアントに許可するかどうかを指定できます。このオプションは、デフォルトでは無効になっています。

* * NFS クライアントからの読み取り専用ファイルの削除機能の有効化または無効化 *
+
このオプションを有効または無効にして、読み取り専用属性が設定されたファイルまたはフォルダの削除をNFSクライアントに許可するかどうかを指定します。NTFSの削除セマンティクスでは、読み取り専用属性が設定されている場合、ファイルやフォルダの削除は許可されません。UNIXの削除セマンティクスでは読み取り専用ビットが無視され、代わりに親ディレクトリの権限を使用してファイルまたはフォルダを削除できるかどうかが判断されます。デフォルトの設定はで `disabled`、NTFSの削除セマンティクスが適用されます。

* * Windows Internet Name Service サーバーアドレスの設定 *
+
このオプションでは、Windows Internet Name Service（WINS）サーバアドレスのリストをカンマで区切って指定できます。IPv4アドレスを指定する必要があります。IPv6アドレスはサポートされません。デフォルト値はありません。



以下に、advanced権限レベルで使用できるSMBサーバオプションについて説明します。

* * CIFS ユーザーへの UNIX グループ権限の付与 *
+
このオプションでは、ファイルの所有者ではない受信CIFSユーザにグループ権限を付与するかどうかを指定します。CIFSユーザがUNIXセキュリティ形式のファイルの所有者ではない場合にこのパラメータをに設定する `true`と、ファイルに対するグループ権限が付与されます。CIFSユーザがUNIXセキュリティ形式のファイルの所有者ではない場合に、このパラメータをに設定する `false`と、通常のUNIXルールに従ってファイル権限が付与されます。このパラメータは、権限がに設定されたUNIXセキュリティ形式のファイルに適用さ `mode bits`れます。セキュリティモードがNTFSまたはNFSv4のファイルには適用されません。デフォルト設定はです `false`。

* * SMB 1.0の有効化または無効化*
+
ONTAP 9にSMBサーバが作成されているSVMでは、SMB 1.0はデフォルトで無効になっています。3.

+
[NOTE]
====
SMB.3以降ではONTAP 9、SMB.3で作成された新しいONTAP 9サーバについてはSMB 1.0がデフォルトで無効になります。セキュリティとコンプライアンスの強化に備えて、できるだけ早く新しいバージョンのSMBに移行する必要があります。詳細については、NetApp担当者にお問い合わせください。

====
* * SMB 2.x の有効化または無効化 *
+
SMB 2.0は、LIFフェイルオーバーをサポートするSMBの最小バージョンです。SMB 2.xを無効にすると、ONTAPはSMB 3.Xも自動的に無効にします。

+
SMB 2.0はSVMでのみサポートされます。このオプションは、SVMではデフォルトで有効になっています。

* * SMB 3.0の有効化または無効化*
+
SMB 3.0は、継続的可用性を備えた共有をサポートするSMBの最小バージョンです。SMB 3.0をサポートするWindowsの最小バージョンは、Windows Server 2012およびWindows 8です。

+
SMB 3.0はSVMでのみサポートされます。このオプションは、SVMではデフォルトで有効になっています。

* * SMB 3.1の有効化または無効化*
+
Windows 10は、SMB 3.1をサポートする唯一のWindowsバージョンです。

+
SMB 3.1はSVMでのみサポートされます。このオプションは、SVMではデフォルトで有効になっています。

* * ODX コピーオフロードの有効化または無効化 *
+
ODXコピーオフロードは、対応するWindowsクライアントで自動的に使用されます。このオプションはデフォルトで有効になっています。

* * ODX コピーオフロードの直接コピーメカニズムの有効化または無効化 *
+
直接コピーメカニズムを使用すると、Windowsクライアントがコピーの実行中にファイルが変更されないモードでコピーのソースファイルを開こうとすると、コピーオフロード処理のパフォーマンスが向上します。デフォルトでは、直接コピーメカニズムが有効になっています。

* * 自動ノードリファーラルの有効化または無効化 *
+
自動ノードリファーラルでは、SMBサーバはクライアントに対して、要求した共有を介してアクセスするデータのホストノードに対してローカルなデータLIFを自動的に参照することになります。

* * SMB * のエクスポート・ポリシーの有効化または無効化
+
このオプションは、デフォルトでは無効になっています。

* * ジャンクションポイントのリパースポイントとしての使用の有効化または無効化 *
+
このオプションを有効にすると、SMBサーバはジャンクションポイントをリパースポイントとしてSMBクライアントに公開します。このオプションは、SMB 2.x接続またはSMB 3.0接続でのみ有効です。このオプションはデフォルトで有効になっています。

+
このオプションはSVMでのみサポートされます。このオプションは、SVMではデフォルトで有効になっています。

* * TCP 接続ごとの最大同時操作数の設定 *
+
デフォルト値は255です。

* * ローカルの Windows ユーザーとグループ機能の有効化または無効化 *
+
このオプションはデフォルトで有効になっています。

* * ローカル Windows ユーザー認証の有効化または無効化 *
+
このオプションはデフォルトで有効になっています。

* * VSS シャドウ・コピー機能の有効化または無効化 *
+
ONTAPでは、シャドウコピー機能を使用して、Hyper-V over SMBソリューションを使用して格納されたデータのリモートバックアップを実行します。

+
このオプションは、SVM、およびHyper-V over SMB構成でのみサポートされます。このオプションは、SVMではデフォルトで有効になっています。

* * シャドウ・コピーのディレクトリ階層の設定 *
+
このオプションを設定すると、シャドウコピー機能を使用する場合に、シャドウコピーを作成するディレクトリの最大階層を定義できます。

+
このオプションは、SVM、およびHyper-V over SMB構成でのみサポートされます。このオプションは、SVMではデフォルトで有効になっています。

* * マルチドメインネームマッピングの検索機能の有効化または無効化 *
+
有効にすると、 UNIX ユーザが Windows ユーザ名のドメイン部分にワイルドカード（ * ）を使用して Windows ドメインユーザにマッピングされている場合に（ * \joe など）、 ONTAP はホームドメインと双方向の信頼関係が確立されたすべてのドメインで、指定したユーザを検索します。ホームドメインは、SMBサーバのコンピュータアカウントが含まれているドメインです。

+
双方向の信頼関係が確立されたすべてのドメインを検索する代わりに、信頼できるドメインのリストを設定することもできます。このオプションを有効にして優先リストを設定すると、その優先リストを使用してマルチドメインネームマッピングの検索が実行されます。

+
デフォルトでは、マルチドメインネームマッピングの検索は有効になります。

* * ファイルシステムセクターサイズの設定 *
+
このオプションでは、ONTAPがSMBクライアントに報告するファイルシステムセクターサイズをバイト単位で設定できます。このオプションには、との `512`2つの有効な値があります `4096`。デフォルト値はです `4096`。Windowsアプリケーションが512バイトのセクターサイズのみをサポートしている場合は、この値をに設定する必要が `512`あります。

* * ダイナミックアクセス制御の有効化または無効化 *
+
このオプションを有効にすると、監査を使用した集約型アクセスポリシーのステージングや、グループポリシーオブジェクトを使用した集約型アクセスポリシーの実装など、ダイナミックアクセス制御（DAC）を使用してSMBサーバ上のオブジェクトを保護できます。このオプションは、デフォルトでは無効になっています。

+
このオプションはSVMでのみサポートされます。

* * 認証されていないセッションのアクセス制限の設定（ restrict anonymous ） *
+
このオプションを設定すると、認証されていないセッションのアクセス制限を指定できます。制限は匿名ユーザに適用されます。デフォルトでは、匿名ユーザに対するアクセス制限はありません。

* * UNIX 対応のセキュリティを使用するボリューム（ UNIX セキュリティ形式のボリューム、または UNIX 対応のセキュリティを使用する mixed セキュリティ形式のボリューム）での NTFS ACL の提供を有効または無効にする *
+
このオプションを有効または無効にして、UNIXセキュリティ形式のファイルやフォルダのファイルセキュリティをSMBクライアントに提供する方法を指定します。有効にすると、ONTAP UNIXセキュリティ形式のボリューム内のファイルやフォルダが、NTFS ACLを使用するNTFSファイルセキュリティが設定されたファイルやフォルダとしてSMBクライアントに提供されます。無効にするとONTAP、UNIXセキュリティ形式のボリュームは、ファイルセキュリティのないFATボリュームとして表示されます。デフォルトでは、ボリュームはNTFS ACLを使用するNTFSファイルセキュリティが設定されたボリュームとして表示されます。

* * SMB 擬似オープン機能の有効化または無効化 *
+
この機能を有効にすると、ONTAPがファイルやディレクトリの属性情報を照会する際のオープン要求とクローズ要求の方法が最適化され、SMB 2.xおよびSMB 3.0のパフォーマンスが向上します。デフォルトでは、SMB擬似オープン機能は有効になっています。このオプションは、SMB 2.x以降を使用する接続にのみ役立ちます。

* * UNIX 拡張の有効化または無効化 *
+
このオプションを有効にすると、SMBサーバでUNIX拡張が有効になります。UNIX拡張を使用すると、SMBプロトコルを介してPOSIX/UNIX形式のセキュリティを表示できます。デフォルトでは、このオプションは無効になっています。

+
Mac OSXクライアントなどのUNIXベースのSMBクライアントが環境内にある場合は、UNIX拡張を有効にする必要があります。UNIX拡張を有効にすると、SMBサーバはPOSIX/UNIXセキュリティ情報をSMB経由でUNIXベースのクライアントに送信できるようになります。クライアントは、受け取ったセキュリティ情報をPOSIX/UNIXセキュリティに変換します。

* * 略称を使用した検索のサポートの有効化または無効化 *
+
このオプションを有効にすると、SMBサーバは短縮名に対して検索を実行できます。このオプションを有効にした検索クエリでは、8.3形式のファイル名と長いファイル名が照合されます。このパラメータのデフォルト値はです `false`。

* * DFS 対応の自動通知のサポートの有効化または無効化 *
+
このオプションを有効または無効にして、共有に接続するSMB 2.xおよびSMB 3.0クライアントにSMBサーバからDFS対応を自動的に通知するかどうかを指定します。ONTAPは、SMBアクセス用のシンボリックリンクの実装でDFSリファーラルを使用します。有効にすると、シンボリックリンクアクセスが有効かどうかに関係なく、SMBサーバは常にDFS対応を通知します。無効にすると、シンボリックリンクアクセスが有効になっている共有にクライアントが接続する場合にのみ、SMBサーバはDFS対応を通知します。

* * SMB クレジットの最大数の設定 *
+
ONTAP 9 .4以降では、クライアントとサーバがSMBバージョン2以降を実行している場合に、オプションを設定して `-max-credits`SMB接続に付与するクレジット数を制限できます。デフォルト値は128です。

* * SMB マルチチャネルのサポートの有効化または無効化 *
+
ONTAP 9 .4以降のリリースでこのオプションを有効にする `-is-multichannel-enabled`と、クラスタとそのクライアントに適切なNICが導入されている場合に、SMBサーバは単一のSMBセッションに対して複数の接続を確立できます。これにより、スループットとフォールトトレランスが向上します。このパラメータのデフォルト値はです `false`。

+
SMBマルチチャネルが有効な場合は、次のパラメータも指定できます。

+
** マルチチャネルセッションごとに許可される最大接続数。このパラメータのデフォルト値は32です。
** マルチチャネルセッションごとにアドバタイズされるネットワークインターフェイスの最大数。このパラメータのデフォルト値は256です。



