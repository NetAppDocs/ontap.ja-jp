---
sidebar: sidebar 
permalink: smb-admin/windows-backup-symlinks.html 
keywords: windows, windows server, backup, backup application, symbolic link, symlink, unix, unix-style 
summary: Windowsで実行されているバックアップアプリケーションでUNIX形式のシンボリックリンク（symlink）が検出されると、リンクに従ってデータがバックアップされます。ONTAP 9.15.1以降では、データの代わりにシンボリックリンクをバックアップするオプションが用意されています。この機能は、ONTAP FlexGroupボリュームとFlexVolで完全にサポートされています。 
---
= WindowsバックアップアプリケーションとUNIX形式のシンボリックリンク
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Windowsで実行されているバックアップアプリケーションでUNIX形式のシンボリックリンク（symlink）が検出されると、リンクに従ってデータがバックアップされます。ONTAP 9.15.1以降では、データの代わりにシンボリックリンクをバックアップするオプションが用意されています。この機能は、ONTAP FlexGroupボリュームとFlexVolで完全にサポートされています。



== 概要

Windowsバックアップ処理中のシンボリックリンクの処理方法を変更する前に、ONTAP利点、主要な概念、および設定オプションについて理解しておく必要があります。



=== メリット

この機能を無効にするか使用できない場合、各シンボリックリンクがトラバースされ、リンク先のデータがバックアップされます。このため、不要なデータがバックアップされることがあり、特定の状況ではアプリケーションがループに陥る可能性があります。代わりに、シンボリックリンクをバックアップすることでこれらの問題を回避できます。また、ほとんどの場合、シンボリックリンクファイルはデータに比べて非常に小さいため、バックアップにかかる時間が短縮されます。IO処理が減少するため、クラスタの全体的なパフォーマンスも向上します。



=== Windowsサーバ環境

この機能は、Windowsで実行されているバックアップアプリケーションでサポートされています。環境を使用する前に、環境の関連する技術的側面を理解しておく必要があります。

.拡張属性
Windowsでは、拡張属性（EA）がサポートされています。この拡張属性は、オプションでファイルに関連付けられた追加のメタデータをまとめて形成します。これらの属性は、Windows Subsystem for Linuxなどのさまざまなアプリケーションで使用されます（を参照） https://learn.microsoft.com/en-us/windows/wsl/file-permissions["WSLのファイル権限"^]。アプリケーションは、ONTAPからデータを読み取るときに、各ファイルの拡張属性を要求できます。

シンボリックリンクは、この機能が有効になっている場合に拡張属性で返されます。したがって、バックアップアプリケーションは、メタデータの格納に使用される標準のEAサポートを提供する必要があります。一部のWindowsユーティリティでは、拡張属性がサポートされ、保持されます。ただし、バックアップソフトウェアで拡張属性のバックアップとリストアがサポートされていない場合は、各ファイルに関連付けられているメタデータが保持されず、シンボリックリンクの適切な処理が失敗します。

.Windowsコウセイ
Microsoft Windowsサーバ上で実行されているバックアップアプリケーションには、通常のファイルセキュリティをバイパスできる特別な権限を付与できます。これは通常、アプリケーションをBackup Operatorsグループに追加することによって行われます。アプリケーションは、必要に応じてファイルをバックアップおよび復元したり、その他の関連システム操作を実行したりできます。バックアップアプリケーションで使用されるSMBプロトコルにはわずかな変更が加えられていますが、データの読み取りと書き込みの際にONTAPで検出される可能性があります。



=== 要件

シンボリックリンクバックアップ機能には、次のようないくつかの要件があります。

* クラスタでONTAP 9.15.1以降が実行されている。
* 特別なバックアップ権限が付与されたWindowsバックアップアプリケーション。
* バックアップアプリケーションでは、拡張属性もサポートし、バックアップ処理中に要求する必要があります。
* 該当するデータSVMに対してONTAPシンボリックリンクバックアップ機能が有効になっている。




=== 設定オプション

ONTAP CLIに加えて、REST APIを使用してこの機能を管理することもできます。詳細については、を参照してください https://docs.netapp.com/us-en/ontap-automation/whats-new.html["ONTAP REST APIと自動化の新機能"^] 。ONTAPでのUNIX形式のシンボリックリンクの処理方法を決定する設定は、SVMごとに個別に実行する必要があります。



== ONTAPでシンボリックリンクバックアップ機能を有効にする

ONTAP 9.15.1では、既存のCLIコマンドに設定オプションが導入されています。このオプションを使用すると、UNIX形式のシンボリックリンク処理を有効または無効にできます。

.開始する前に
基本を確認します <<要件>>。その他：

* CLI権限をadvancedレベルに昇格できるようにします。
* 変更するデータSVMを決定します。このコマンド例ではSVMを `vs1` 使用しています。


.手順
. advanced権限レベルを設定します。
+
[source, cli]
----
set privilege advanced
----
. シンボリックリンクファイルのバックアップを有効にします。
+
[source, cli]
----
vserver cifs options modify -vserver vs1 -is-backup-symlink-enabled true
----

