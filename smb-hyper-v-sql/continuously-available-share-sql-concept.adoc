---
permalink: smb-hyper-v-sql/continuously-available-share-sql-concept.html 
sidebar: sidebar 
keywords: continuously, share, requirements, considerations, sql, server, smb, nondisuptive, snapcenter plug-in 
summary: ノンストップオペレーションをサポートするSQL Server over SMB構成で継続的可用性を備えた共有を設定する場合は、一定の要件と考慮事項について理解しておく必要があります。 
---
= SQL Server over SMBでの継続的可用性を備えた共有の要件と考慮事項
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ノンストップオペレーションをサポートするSQL Server over SMB構成で継続的可用性を備えた共有を設定する場合は、一定の要件と考慮事項について理解しておく必要があります。



== 共有の要件

* 仮想マシンファイルを格納するボリュームは、NTFSセキュリティ形式のボリュームとして作成する必要があります。
+
継続的可用性を備えたSMB接続を使用してアプリケーションサーバのノンストップオペレーションを実現するには、共有を含むボリュームがNTFSボリュームである必要があります。さらに、常にNTFSボリュームである必要があります。mixedセキュリティ形式のボリュームまたはUNIXセキュリティ形式のボリュームをNTFSセキュリティ形式のボリュームに変更し、そのボリュームをSMB共有を介したノンストップオペレーションに直接使用することはできません。mixedセキュリティ形式のボリュームをNTFSセキュリティ形式のボリュームに変更し、そのボリュームをSMB共有を介したノンストップオペレーションに使用する場合は、ボリュームの最上位にACLを手動で配置し、格納されているすべてのファイルおよびフォルダにそのACLを適用する必要があります。そうしないと、ファイルを別のボリュームに移動する仮想マシンの移行またはデータベースファイルのエクスポート/インポートが、ソースボリュームまたはデスティネーションボリュームが最初はmixedセキュリティ形式またはUNIXセキュリティ形式のボリュームとして作成され、あとでNTFSセキュリティ形式に変更された場合に失敗する可能性があります。

* アプリケーションサーバで使用される共有には、continuously-availableプロパティが設定されている必要があります。
+
継続的可用性を備えた共有に接続するアプリケーションサーバは永続的ハンドルを受け取ります。永続的ハンドルを使用すると、テイクオーバー、ギブバック、アグリゲートの再配置などの停止イベントのあとにSMB共有に無停止で再接続し、ファイルロックを再要求できます。

* データベースファイルを含むボリュームにジャンクションを含めることはできますが、SQL Serverではデータベースディレクトリ構造の作成時にジャンクションをまたぐことはありません。
* SnapCenter Plug-in for Microsoft SQL Serverの処理を成功させるには、ボリュームに十分な利用可能スペースが必要です。
+
SQL Serverデータベースファイルが配置されているボリュームには、データベースディレクトリ構造と、共有内に格納されているすべてのファイルを格納できる十分なサイズが必要です。

* アプリケーションサーバで使用される継続的可用性を備えた共有では、次の共有プロパティを設定しないでください。
+
** ホームディレクトリ
** 属性のキャッシュ
** BranchCache






== 共有に関する考慮事項

* クォータは継続的可用性を備えた共有でサポートされます。
* SQL Server over SMB構成では、次の機能はサポートされません。
+
** 監査
** FPolicy


* 共有プロパティが設定されているSMB共有ではウィルススキャンは実行されません `continuously-availability`。

