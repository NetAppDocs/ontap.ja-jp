---
permalink: smb-hyper-v-sql/continuously-available-share-sql-concept.html 
sidebar: sidebar 
keywords: continuously, share, requirements, considerations, sql, server, smb, nondisuptive 
summary: ノンストップオペレーションをサポートする SQL Server over SMB 構成で継続的可用性を備えた共有を設定する場合は、一定の要件と考慮事項に注意する必要があります。 
---
= SQL Server over SMB での継続的可用性を備えた共有の要件と考慮事項
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ノンストップオペレーションをサポートする SQL Server over SMB 構成で継続的可用性を備えた共有を設定する場合は、一定の要件と考慮事項に注意する必要があります。



== 共有の要件

* 仮想マシンファイルを格納するためのボリュームは、 NTFS セキュリティ形式のボリュームとして作成されている必要があります。
+
継続的な可用性が確保された SMB 接続を使用してアプリケーションサーバのノンストップオペレーションを実現するには、共有を含むボリュームが NTFS ボリュームである必要があります。さらに、そのボリュームが常に NTFS ボリュームである必要があります。mixed セキュリティ形式のボリュームまたは UNIX セキュリティ形式のボリュームを NTFS セキュリティ形式のボリュームに変更し、そのボリュームを SMB 共有を介したノンストップオペレーションに直接使用することはできません。mixed セキュリティ形式のボリュームを NTFS セキュリティ形式のボリュームに変更し、そのボリュームを SMB 共有を介したノンストップオペレーションに使用する場合は、ボリュームの一番上に ACL を手動で配置し、格納されているすべてのファイルおよびフォルダにその ACL を適用する必要があります。そうしないと、ソースボリュームまたはデスティネーションボリュームが最初は mixed セキュリティ形式または UNIX セキュリティ形式のボリュームとして作成され、あとで NTFS セキュリティ形式に変更された場合は、ファイルを別のボリュームに移動する仮想マシンの移行またはデータベースファイルのエクスポートとインポートに失敗する可能性があります。

* アプリケーションサーバが使用する共有には、継続的可用性が設定されている必要があります。
+
継続的可用性を備えた共有に接続するアプリケーションサーバは永続的ハンドルを受け取ります。永続的ハンドルを使用すると、テイクオーバー、ギブバック、アグリゲートの再配置などの停止イベントのあとに SMB 共有に無停止で再接続し、ファイルロックを再取得することができます。

* データベースファイルが格納されたボリュームにジャンクションを含めることはできますが、 SQL Server はデータベースディレクトリ構造の作成時にジャンクションを横断しません。
* SnapManager for Microsoft SQL Server のバックアップ処理を正常に実行するには、ボリュームに十分な利用可能スペースが必要です。
+
SQL Server データベースファイルを格納するボリュームには、共有内にあるデータベースディレクトリ構造と、格納されているすべてのファイルを格納できる十分な容量が必要です。

* アプリケーションサーバが使用する継続的可用性を備えた共有では、次の共有プロパティを設定しないでください。
+
** ホームディレクトリ
** 属性のキャッシュ
** BranchCache
** アクセスベースの列挙






== 共有に関する考慮事項

* クォータは継続的可用性を備えた共有でサポートされます。
* SQL Server over SMB 構成では、次の機能はサポートされません。
+
** 監査
** FPolicy の


* ウィルス・スキャンは 'continuously-available 共有プロパティが設定されている SMB 共有では実行されません

