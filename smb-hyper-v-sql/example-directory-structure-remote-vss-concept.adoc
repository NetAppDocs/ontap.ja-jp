---
permalink: smb-hyper-v-sql/example-directory-structure-remote-vss-concept.html 
sidebar: sidebar 
keywords: directory, structure, remote, vss, hyper, v, virutal, machine, file, shadow, copy, backup 
summary: リモート VSS は、シャドウコピーの作成時に、 Hyper-V 仮想マシンファイルが格納されているディレクトリ構造をトラバースします。仮想マシンファイルのバックアップを正しく作成できるように、適切なディレクトリ構造について理解しておくことが重要です。 
---
= リモート VSS で使用されるディレクトリ構造の例
:icons: font
:imagesdir: ../media/


[role="lead"]
リモート VSS は、シャドウコピーの作成時に、 Hyper-V 仮想マシンファイルが格納されているディレクトリ構造をトラバースします。仮想マシンファイルのバックアップを正しく作成できるように、適切なディレクトリ構造について理解しておくことが重要です。

シャドウコピーを正常に作成するためにサポートされるディレクトリ構造は、次の要件を満たしています。

* 仮想マシンファイルの格納に使用されるディレクトリ構造内に存在するのは、ディレクトリと通常のファイルだけです。
+
ディレクトリ構造には、ジャンクション、リンク、通常以外のファイルは含まれません。

* 仮想マシンのファイルはすべて単一の共有内に存在します。
* 仮想マシンファイルの格納に使用されるディレクトリ構造は、設定されたシャドウコピーディレクトリの階層より深くなりません。
* 共有のルートディレクトリには、仮想マシンファイルまたはディレクトリのみが含まれます。


次の図では、 Storage Virtual Machine （ SVM ） vs1 上で /hyperv/vm1 をジャンクションポイントとして vm_vol1 という名前のボリュームが作成されています。ジャンクションポイントの下には、仮想マシンファイルを格納するサブディレクトリが作成されます。Hyper-V サーバの仮想マシンファイルには、パスが「 /hyperv/vm1/dir1/vmdir 」の share1 を経由してアクセスします。シャドウコピーサービスによって、 share1 の下のディレクトリ構造内（設定されたシャドウコピーのディレクトリ階層まで）に格納されたすべての仮想マシンファイルのシャドウコピーが作成されます。

image::../media/directory-structure-used-by-remote-vss.gif[リモート VSS が使用するディレクトリ構造]
