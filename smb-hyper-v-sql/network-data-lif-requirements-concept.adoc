---
permalink: smb-hyper-v-sql/network-data-lif-requirements-concept.html 
sidebar: sidebar 
keywords: network, data, lif, requirements, hyper, v, sql, server, protocol 
summary: ノンストップ オペレーション用にSQL ServerまたはHyper-V over SMB構成を作成する場合、一定のネットワークとデータLIF要件について理解しておく必要があります。 
---
= ネットワークとデータLIFの要件
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ノンストップ オペレーション用にSQL ServerまたはHyper-V over SMB構成を作成する場合、一定のネットワークとデータLIF要件について理解しておく必要があります。



== ネットワーク プロトコルの要件

* IPv4およびIPv6のネットワークがサポートされています。
* SMB 3.0以降が必要です。
+
SMB 3.0には、ノンストップ オペレーションを実現するために必要となる継続的可用性を備えたSMB接続の確立に欠かせない機能が備わっています。

* DNSサーバには、CIFSサーバ名をStorage Virtual Machine（SVM）上のデータLIFに割り当てられたIPアドレスにマッピングするエントリが格納されている必要があります。
+
通常、Hyper-VまたはSQL Serverアプリケーション サーバは、仮想マシンまたはデータベース ファイルへのアクセス時に複数のデータLIFを介して複数の接続を確立します。正常に機能するには、アプリケーション サーバは、複数の一意のIPアドレスへの複数の接続を確立するのではなく、CIFSサーバ名を使用してこのような複数のSMB接続を確立する必要があります。

+
監視でも、個々のLIF IPアドレスではなくCIFSサーバのDNS名を使用する必要があります。

+
ONTAP 9.4以降では、SMBマルチチャネルを有効にすることで、Hyper-V over SMB構成とSQL Server over SMB構成のスループットとフォールト トレランスを向上させることができます。そのためには、クラスタとクライアントに1G、10G、またはそれ以上のNICを複数配置しておく必要があります。





== データLIFの要件

* SMB経由のアプリケーション サーバ ソリューションをホストするSVMには、クラスタ内のすべてのノードに稼働しているデータLIFが少なくとも1つ必要です。
+
SVMデータLIFは、アプリケーション サーバがアクセスするデータを現在ホストしていないノードを含む、クラスタ内の他のデータ ポートにフェイルオーバーできます。さらに、監視ノードは常に、アプリケーション サーバが接続されているノードのSFOパートナーであるため、クラスタ内のどのノードも監視ノードになる可能性があります。

* データLIFは、自動的にリバートされるように設定されていない必要があります。
+
テイクオーバーまたはギブバックの発生後は、データLIFをホーム ポートに手動でリバートする必要があります。

* データLIFのすべてのIPアドレスがDNS内にエントリを保持する必要があり、すべてのエントリがCIFSサーバ名に解決される必要があります。
+
アプリケーション サーバは、CIFS サーバ名を使用して SMB 共有に接続する必要があります。LIF IP アドレスを使用して接続するようにアプリケーション サーバを設定しないでください。

* CIFSサーバ名がSVM名と異なる場合は、DNSエントリがCIFSサーバ名に解決される必要があります。

