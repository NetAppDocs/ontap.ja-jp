---
permalink: smb-hyper-v-sql/odx-copy-offload-concept.html 
sidebar: sidebar 
keywords: offload, data, transfer, odx, copy, application, server, copy, operation 
summary: オフロードデータ転送（ ODX ）はコピーオフロードとも呼ばれ、この機能を使用すると、互換性があるストレージデバイス内やストレージデバイス間で、ホストコンピュータを介さずにデータを直接転送できます。ONTAP ODXコピーオフロードを使用すると、アプリケーションサーバでSMBインストール経由のコピー処理を実行する際のパフォーマンスが向上します。 
---
= Hyper-V over SMBおよびSQL Server over SMB共有でのODXコピーオフロードの使用方法
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Offloaded Data Transfer （ ODX ；オフロードデータ転送）は _copy offloaded _ とも呼ばれ、この機能を使用すると、互換性があるストレージデバイス内やストレージデバイス間で、ホストコンピュータを介さずにデータを直接転送できます。ONTAP ODXコピーオフロードを使用すると、アプリケーションサーバでSMBインストール経由のコピー処理を実行する際のパフォーマンスが向上します。

ODX以外のファイル転送では、ソースCIFSサーバからデータが読み取られ、ネットワーク経由でクライアントコンピュータに転送されます。クライアントコンピュータは、データをネットワーク経由でデスティネーションCIFSサーバに転送します。要約すると、クライアントコンピュータはソースからデータを読み取り、デスティネーションに書き込みます。ODXファイル転送では、データがソースからデスティネーションに直接コピーされます。

ODXオフロードコピーはソースストレージとデスティネーションストレージの間で直接実行されるため、パフォーマンスが大幅に向上します。実現されるパフォーマンス上のメリットには、ソースとデスティネーションの間のコピー時間の短縮、クライアントでのリソース使用率（CPU、メモリ）の削減、ネットワークI/O帯域幅の使用量の削減などがあります。

 ONTAP ODX copy offload is supported on both SAN LUNs and SMB 3.0 continuously available connections.
ODXコピーと移動の使用は次のユースケースでサポートされます。

* ボリューム内
+
ソースとデスティネーションのファイルまたはLUNは、同じボリューム内にあります。

* ボリュームが異なり、ノードとStorage Virtual Machine（SVM）は同じ
+
ソースとデスティネーションのファイルまたはLUNは、同じノード上の異なるボリュームにあります。データは同じSVMに所有されます。

* ボリュームとノードが異なり、SVMは同じ
+
ソースとデスティネーションのファイルまたはLUNは、異なるノード上の異なるボリュームにあります。データは同じSVMに所有されます。

* SVMが異なり、ノードは同じ
+
ソースとデスティネーションのファイルまたはLUNは、同じノード上の異なるボリュームにあります。データは複数のSVMに所有されます。

* SVMとノードが異なる
+
ソースとデスティネーションのファイルまたはLUNは、異なるノード上の異なるボリュームにあります。データは複数のSVMに所有されます。



Hyper-VソリューションでのODXコピーオフロードの具体的なユースケースには、次のようなものがあります。

* Hyper-VでODXコピーオフロードのパススルーを使用すると、仮想ハードディスク（VHD）ファイル内またはVHDファイル間でデータをコピーしたり、同じクラスタ内のマッピングされたSMB共有と接続されたiSCSI LUNの間でデータをコピーしたりできます。
+
これにより、ゲストオペレーティングシステムからのコピーを基盤となるストレージに渡すことができます。

* 容量固定VHDを作成する場合、ODXを使用してディスクを初期化します。初期化された既知のトークンを使用してディスクを初期化します。
* ソースとデスティネーションのストレージが同じクラスタにある場合、ODXコピーオフロードを使用して仮想マシンのストレージを移行します。


[NOTE]
====
Hyper-VでのODXコピーオフロードのパススルーのユースケースを利用するには、ゲストオペレーティングシステムでODXがサポートされている必要があります。また、ゲストオペレーティングシステムのディスクが、ODXをサポートするストレージ（SMBまたはSAN）から作成されたSCSIディスクである必要があります。ゲストオペレーティングシステムのIDEディスクは、ODXパススルーをサポートしていません。

====
SQL ServerソリューションでのODXコピーオフロードの具体的なユースケースには、次のようなものがあります。

* ODXコピーオフロードを使用すると、マッピングされたSMB共有間、または同じクラスタ内のSMB共有と接続されたiSCSI LUNの間でSQL Serverデータベースのエクスポートとインポートを行うことができます。
* ソースとデスティネーションのストレージが同じクラスタにある場合は、ODXコピーオフロードを使用してデータベースのエクスポートとインポートを行います。

