---
permalink: smb-hyper-v-sql/odx-copy-offload-concept.html 
sidebar: sidebar 
keywords: offload, data, transfer, odx, copy, application, server, copy, operation 
summary: オフロードデータ転送（ODX）は、コピー オフロードとも呼ばれ、ホストコンピュータを介さずに、互換性のあるストレージデバイス内またはストレージデバイス間で直接データを転送することを可能にします。ONTAP ODXコピー オフロードは、SMBインストールを介してアプリケーションサーバでコピー操作を実行する際にパフォーマンス上のメリットをもたらします。 
---
= Hyper-V over SMBおよびSQL Server over SMB共有でのODXコピー オフロードの使用方法
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
オフロードデータ転送（ODX）は、コピー オフロードとも呼ばれ、ホストコンピュータを介さずに、互換性のあるストレージデバイス内またはストレージデバイス間で直接データを転送することを可能にします。ONTAP ODXコピー オフロードは、SMBインストールを介してアプリケーションサーバでコピー操作を実行する際に、パフォーマンス上のメリットをもたらします。

ODX以外のファイル転送では、ソースCIFSサーバからデータが読み取られ、ネットワーク経由でクライアント コンピュータに転送されます。クライアント コンピュータは、データをネットワーク経由でデスティネーションCIFSサーバに転送します。つまり、クライアント コンピュータがソースからデータを読み取り、デスティネーションに書き込みます。ODXファイル転送では、データはソースからデスティネーションに直接コピーされます。

ODXオフロード コピーはソース ストレージとデスティネーション ストレージの間で直接実行されるため、パフォーマンスが大幅に向上します。実現するパフォーマンスの向上には、ソースとデスティネーションの間のコピー時間の短縮、クライアントでのリソース使用量（CPU、メモリ）の削減、ネットワークI/O帯域幅の使用量の削減などが挙げられます。

 ONTAP ODX copy offload is supported on both SAN LUNs and SMB 3.0 continuously available connections.
ODXコピーおよび移動の使用は、以下の事例でサポートされます。

* ボリューム内
+
ソースとデスティネーションのファイルまたはLUNは、同じボリューム内にあります。

* ボリュームが異なり、ノードとStorage Virtual Machine（SVM）は同じ
+
ソースとデスティネーションのファイルまたはLUNは、同じノード上の異なるボリュームにあります。データは同じSVMに所有されます。

* ボリュームとノードが異なり、SVMは同じ
+
ソースとデスティネーションのファイルまたはLUNは、異なるノード上の異なるボリュームにあります。データは同じSVMに所有されます。

* SVMが異なり、ノードは同じ
+
ソースとデスティネーションのファイルまたはLUNは、同じノード上の異なるボリュームにあります。データは異なるSVMに所有されます。

* SVMとノードが異なる
+
ソースとデスティネーションのファイルまたはLUNは、異なるノード上の異なるボリュームにあります。データは異なるSVMに所有されます。



Hyper-VソリューションでのODXコピー オフロードの具体的な用途には、次のようなものがあります。

* Hyper-VでODXコピー オフロードのパススルーを使用して、仮想ハード ディスク（VHD）ファイル内およびVHDファイル間でのデータのコピー、または同じクラスタ内のマッピングされたSMB共有と接続されたiSCSI LUNの間でのデータのコピーを実行できます。
+
これにより、ゲスト オペレーティング システムからのコピーを基盤となるストレージに渡すことができます。

* 容量固定VHDを作成する際に、ODXを使用して、既知の初期化済みトークンによってディスクを初期化します。
* ソースとデスティネーションのストレージが同じクラスタにある場合に、ODXコピー オフロードを使用して、仮想マシンのストレージを移行します。


[NOTE]
====
Hyper-VでのODXコピー オフロードのパススルーの用途を活用するには、ゲスト オペレーティング システムでODXがサポートされている必要があります。また、ゲスト オペレーティング システムのディスクが、ODXをサポートするストレージ（SMBまたはSAN）から作成されたSCSIディスクである必要があります。ゲスト オペレーティング システムのディスクがIDEディスクの場合、ODXのパススルーはサポートされません。

====
SQL ServerソリューションでのODXコピー オフロードの具体的な用途には、次のようなものがあります。

* ODXコピー オフロードを使用して、マッピングされたSMB共有間、または同じクラスタ内のSMB共有と接続されたiSCSI LUNの間でSQL Serverデータベースのエクスポートとインポートを行うことができます。
* ソースとデスティネーションのストレージが同じクラスタにある場合に、ODXコピー オフロードを使用して、データベースのエクスポートとインポートを行います。

