---
permalink: smb-hyper-v-sql/odx-copy-offload-concept.html 
sidebar: sidebar 
keywords: offload, data, transfer, odx, copy, application, server, copy, operation 
summary: オフロードデータ転送（ ODX ）はコピーオフロードとも呼ばれ、この機能を使用すると、互換性があるストレージデバイス内やストレージデバイス間で、ホストコンピュータを介さずにデータを直接転送できます。ONTAP ODX コピーオフロードを使用すると、アプリケーションサーバで SMB 環境経由のコピー処理を実行する際のパフォーマンスが向上します。 
---
= Hyper-V over SMB および SQL Server over SMB 共有での ODX コピーオフロードの使用方法
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Offloaded Data Transfer （ ODX ；オフロードデータ転送）は _copy offloaded _ とも呼ばれ、この機能を使用すると、互換性があるストレージデバイス内やストレージデバイス間で、ホストコンピュータを介さずにデータを直接転送できます。ONTAP ODX コピーオフロードを使用すると、アプリケーションサーバで SMB 環境経由のコピー処理を実行する際のパフォーマンスが向上します。

ODX 以外のファイル転送では、ソース CIFS サーバからデータが読み取られ、ネットワーク経由でクライアントコンピュータに転送されます。クライアントコンピュータは、データをネットワーク経由でデスティネーション CIFS サーバに転送します。つまり、クライアントコンピュータはソースからデータを読み取り、デスティネーションに書き込みます。ODX ファイル転送では、データはソースからデスティネーションに直接コピーされます。

ODX オフロードコピーはソースストレージとデスティネーションストレージの間で直接実行されるため、パフォーマンスが大幅に向上します。実現するパフォーマンスの向上には、ソースとデスティネーションの間のコピー時間の短縮、クライアントでのリソース使用量（ CPU 、メモリ）の削減、ネットワーク I/O 帯域幅の使用量の削減などが挙げられます。

 ONTAP ODX copy offload is supported on both SAN LUNs and SMB 3.0 continuously available connections.
ODX コピーおよび移動の使用は、以下のユースケースでサポートされます。

* ボリューム内
+
ソースとデスティネーションのファイルまたは LUN は、同じボリューム内にあります。

* ボリュームが異なり、ノードと Storage Virtual Machine （ SVM ）は同じ
+
ソースとデスティネーションのファイルまたは LUN は、同じノード上の異なるボリュームにあります。データは同じ SVM に所有されます。

* ボリュームとノードが異なり、 SVM は同じです
+
ソースとデスティネーションのファイルまたは LUN は、異なるノード上の異なるボリュームにあります。データは同じ SVM に所有されます。

* SVM が異なり、ノードは同じです
+
ソースとデスティネーションのファイルまたは LUN は、同じノード上の異なるボリュームにあります。データは異なる SVM に所有されます。

* SVM とノードが異なります
+
ソースとデスティネーションのファイルまたは LUN は、異なるノード上の異なるボリュームにあります。データは異なる SVM に所有されます。



Hyper-V ソリューションでの ODX コピーオフロードの具体的な用途には、次のようなものがあります。

* Hyper-V で ODX コピーオフロードのパススルーを使用して、仮想ハードディスク（ VHD ）ファイル内および VHD ファイル間でのデータのコピー、または同じクラスタ内のマッピングされた SMB 共有と接続された iSCSI LUN の間でのデータのコピーを実行できます。
+
これにより、ゲストオペレーティングシステムからのコピーを基盤となるストレージに渡すことができます。

* 容量固定 VHD を作成する際に、 ODX を使用して、既知の初期化済みトークンによってディスクを初期化します。
* ソースとデスティネーションのストレージが同じクラスタにある場合に、 ODX コピーオフロードを使用して、仮想マシンのストレージを移行します。


[NOTE]
====
Hyper-V での ODX コピーオフロードのパススルーの用途を活用するには、ゲストオペレーティングシステムで ODX がサポートされている必要があります。また、ゲストオペレーティングシステムのディスクが、 ODX をサポートするストレージ（ SMB または SAN ）から作成された SCSI ディスクである必要があります。ゲストオペレーティングシステムのディスクが IDE ディスクの場合、 ODX のパススルーはサポートされません。

====
SQL Server ソリューションでの ODX コピーオフロードの具体的な用途には、次のようなものがあります。

* ODX コピーオフロードを使用して、マッピングされた SMB 共有間、または同じクラスタ内の SMB 共有と接続された iSCSI LUN の間で SQL Server データベースのエクスポートとインポートを行うことができます。
* ソースとデスティネーションのストレージが同じクラスタにある場合に、 ODX コピーオフロードを使用して、データベースのエクスポートとインポートを行います。

