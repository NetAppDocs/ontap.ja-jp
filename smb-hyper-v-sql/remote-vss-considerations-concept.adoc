---
permalink: smb-hyper-v-sql/remote-vss-considerations-concept.html 
sidebar: sidebar 
keywords: remote, vss, consideration, hyper, v, smb, configuration, backup, solution, automatic, recovery, shadow, copy 
summary: Hyper-V over SMB 構成用のリモート VSS に対応したバックアップソリューションを使用する場合は、一定の考慮事項について理解しておく必要があります。 
---
= Hyper-V over SMB 構成用のリモート VSS に関する考慮事項
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Hyper-V over SMB 構成用のリモート VSS に対応したバックアップソリューションを使用する場合は、一定の考慮事項について理解しておく必要があります。



== 一般的なリモート VSS の考慮事項

* Microsoft のアプリケーションサーバ 1 つにつき、最大 64 の共有を設定できます。
+
1 つのシャドウコピーセットに 64 個を超える共有がある場合、シャドウコピー処理は失敗します。これは Microsoft の要件です。

* アクティブなシャドウコピーセットは、 1 台の CIFS サーバで 1 つしか許可されません。
+
シャドウコピー処理は、同じ CIFS サーバ上で別のシャドウコピー処理が進行中である場合には失敗します。これは Microsoft の要件です。

* リモート VSS によってシャドウコピーが作成されるディレクトリ構造内では、ジャンクションは許可されません。
+
** 自動リカバリの場合、共有のトラバース時にジャンクションが見つかると、シャドウコピーの作成は失敗します。
** 自動リカバリではない場合、シャドウコピーの作成は失敗しませんが、ジャンクションは何も参照しません。






== 自動リカバリを行うシャドウコピーのみに適用されるリモート VSS の考慮事項

一部の制限は、自動リカバリを行うシャドウコピーにのみ適用されます。

* シャドウコピーの作成で許可される最大サブディレクトリ階層は 5 層です。
+
これは、シャドウコピーサービスによってシャドウコピーバックアップセットが作成されるディレクトリ階層です。仮想マシンファイルを含むディレクトリのネストレベルが 5 よりも深い場合、シャドウコピーの作成は失敗します。この目的は、共有のクローニング時におけるディレクトリのトラバーサルを制限することです。最大ディレクトリ階層は CIFS サーバオプションを使用して変更できます。

* ボリューム上に利用可能なスペースが十分ある必要があります。
+
使用可能なスペースは、シャドウコピーバックアップセットに含まれている共有内のすべてのファイル、ディレクトリ、およびサブディレクトリによって使用される合計スペースと同サイズ以上である必要があります。

* リモート VSS によってシャドウコピーが作成されるディレクトリ構造内では、リンクまたは通常以外のファイルは許可されません。
+
シャドウコピーの作成は、そのシャドウコピーに対応する共有内にリンクまたは通常以外のファイルがある場合には失敗します。これらのファイルはクローニングプロセスでサポートされていません。

* ディレクトリに対する NFSv4 ACL は許可されません。
+
シャドウコピーの作成では、ファイルの NFSv4 ACL は維持されますが、ディレクトリの NFSv4 ACL は失われます。

* シャドウコピーセットの作成に許可される時間は最大 60 秒です。
+
Microsoft の仕様により、シャドウコピーセットの作成に許可される時間は最大 60 秒です。この時間内に VSS クライアントでシャドウコピーセットを作成できない場合、シャドウコピー処理は失敗します。したがって、シャドウコピーセット内のファイル数には制限があります。バックアップセットに含めることができる実際のファイル数または仮想マシン数は、一定ではなく、多くの要因に依存するため、お客様の環境ごとに判断する必要があります。


