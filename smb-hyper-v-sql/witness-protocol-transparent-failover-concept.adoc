---
permalink: smb-hyper-v-sql/witness-protocol-transparent-failover-concept.html 
sidebar: sidebar 
keywords: witness, protocol, transparent, failover, lif, ca, share, client, smb, recovery 
summary: Witnessプロトコルは、SMB 3.0の継続的可用性共有（CA共有）のクライアント フェイルオーバー機能を強化します。Witnessは、LIFフェイルオーバーのリカバリ期間をバイパスするため、フェイルオーバーの高速化を実現します。ノードが利用できなくなった場合、SMB 3.0接続のタイムアウトを待つことなく、アプリケーション サーバーに通知します。 
---
= 透過的なフェイルオーバーを強化するための監視プロトコルの機能
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Witnessプロトコルは、SMB 3.0の継続的可用性共有（CA共有）のクライアント フェイルオーバー機能を強化します。Witnessは、LIFフェイルオーバーのリカバリ期間をバイパスするため、フェイルオーバーの高速化を実現します。ノードが利用できなくなった場合、SMB 3.0接続のタイムアウトを待つことなく、アプリケーション サーバーに通知します。

フェイルオーバーはシームレスに行われ、クライアント上で実行されているアプリケーションはフェイルオーバーの発生を認識しません。Witnessが利用できない場合でもフェイルオーバー操作は正常に実行されますが、Witnessを使用しないフェイルオーバーは効率が低下します。

Witness拡張フェイルオーバーは、次の要件が満たされている場合に可能です：

* SMB 3.0が有効になっているSMB 3.0対応CIFSサーバーでのみ使用できます。
* 共有では、継続的な可用性の共有プロパティが設定された SMB 3.0 を使用する必要があります。
* アプリケーション サーバの接続先のノードのSFOパートナーに、少なくとも1つ以上、アプリケーション サーバのデータをホスティングするStorage Virtual Machine（SVM）に割り当てられた運用中のデータLIFがある。
+
[NOTE]
====
WitnessプロトコルはSFOペア間で動作します。LIFはクラスタ内の任意のノードに移行できるため、任意のノードがSFOパートナーのWitnessとなる必要がある場合があります。アプリケーション サーバのデータをホストするSVMのパートナー ノードにアクティブなデータLIFがない場合、Witnessプロトコルは特定のノードでのSMB接続の迅速なフェイルオーバーを提供できません。したがって、クラスタ内のすべてのノードには、これらの構成のいずれかをホストするSVMごとに少なくとも1つのデータLIFが必要です。

====
* アプリケーション サーバーは、個別の LIF IP アドレスではなく、DNS に保存されている CIFS サーバー名を使用して CIFS サーバーに接続する必要があります。

