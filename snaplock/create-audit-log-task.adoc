---
permalink: snaplock/create-audit-log-task.html 
sidebar: sidebar 
keywords: create, audit, log, snaplock, protected, administrator, accounts 
summary: privileged delete または SnapLock ボリューム移動を実行する前に、 SnapLock で保護された監査ログを作成する必要があります。監査ログには、 SnapLock 管理者アカウントの作成と削除、ログボリュームに対する変更、 privileged delete が有効になっているかどうか、 privileged delete 処理、および SnapLock ボリューム移動処理に関する情報が記録されます。 
---
= 監査ログを作成します
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.9.1以前を使用している場合は、まずSnapLockアグリゲートを作成してから、privileged deleteまたはSnapLockボリュームの移動を実行する前にSnapLockで保護された監査ログを作成する必要があります。監査ログには、 SnapLock 管理者アカウントの作成と削除、ログボリュームに対する変更、 privileged delete が有効になっているかどうか、 privileged delete 処理、および SnapLock ボリューム移動処理に関する情報が記録されます。

ONTAP 9 .10.1以降では、SnapLockアグリゲートの作成は廃止されました。SnapLock link:../snaplock/create-snaplock-volume-task.html["SnapLockボリュームの明示的な作成"] SnapLockタイプとしてComplianceまたはEnterpriseのいずれかを指定して、に-replace-typeオプションを使用する必要があります。

.作業を開始する前に
ONTAP 9.9.1以前を使用している場合は、クラスタ管理者でSnapLockアグリゲートを作成する必要があります。

.このタスクについて
監査ログは、ログファイルの保持期間が経過するまで削除できません。保持期間が経過したあとも監査ログを変更することはできません。これは、SnapLock ComplianceモードとEnterpriseモードの両方に当てはまります。

[NOTE]
====
ONTAP 9.4 以前では、監査ログに SnapLock Enterprise ボリュームを使用することはできません。SnapLock Compliance ボリュームを使用する必要があります。ONTAP 9.5 以降では、監査ログに SnapLock Enterprise ボリュームまたは SnapLock Compliance ボリュームのいずれかを使用できます。いずれの場合も、監査ログボリュームはジャンクションパスにマウントする必要があります `/snaplock_audit_log`。他のボリュームはこのジャンクションパスを使用できません。

====
SnapLock 監査ログはにあります `/snaplock_log` 監査ログボリュームのルートの下のサブディレクトリにあるディレクトリ `privdel_log` （privileged delete処理）および `system_log` （その他すべて）。監査ログのファイル名には最初に記録された処理のタイムスタンプが含まれているため、処理が実行されたおおよその時間から簡単にレコードを検索できます。

* を使用できます `snaplock log file show` コマンドを使用して、監査ログボリューム上のログファイルを表示します。
* を使用できます `snaplock log file archive` コマンドを使用して現在のログファイルをアーカイブし、新しいログファイルを作成します。これは、監査ログ情報を別のファイルに記録する必要がある場合に便利です。


詳細については、コマンドのマニュアルページを参照してください。

[NOTE]
====
データ保護ボリュームは、 SnapLock 監査ログボリュームとしては使用できません。

====
.手順
. SnapLock アグリゲートを作成する。
+
xref:create-snaplock-aggregate-task.adoc[SnapLock アグリゲートを作成する]

. 監査ログを設定する SVM に SnapLock ボリュームを作成します。
+
xref:create-snaplock-volume-task.adoc[SnapLock ボリュームを作成します]

. SVM に監査ログを設定します。
+
`*snaplock log create -vserver _SVM_name_ -volume _snaplock_volume_name_ -max-log-size _size_ -retention-period _default_retention_period_*`

+
[NOTE]
====
監査ログファイルのデフォルトの最小保持期間は6カ月です。該当するファイルの保持期間が監査ログの保持期間よりも長い場合、ログの保持期間はファイルの保持期間を継承します。したがって、privileged deleteを使用して削除されたファイルの保持期間が10カ月で、監査ログの保持期間が8カ月の場合、ログの保持期間は10カ月に延長されます。保持期間とデフォルトの保持期間の詳細については、を参照してくださいlink:../snaplock/set-retention-period-task.html["保持期限を設定"]。

====
+
次のコマンドは、を設定します `SVM1` SnapLock ボリュームを使用した監査ログに使用します `logVol`。監査ログの最大サイズは 20GB 、保持期間は 8 カ月です。

+
[listing]
----
SVM1::> snaplock log create -vserver SVM1 -volume logVol -max-log-size 20GB -retention-period 8months
----
. 監査ログを設定したSVMで、ジャンクションパスにSnapLock ボリュームをマウントします `/snaplock_audit_log`。
+
xref:mount-snaplock-volume-task.adoc[SnapLock ボリュームをマウント]


