---
sidebar: sidebar 
permalink: snapmirror-active-sync/index.html 
keywords: SM-BC, SMBC, failover, terms, benefits, snapmirror active sync, TR-4878 
summary: SnapMirror Active Syncを使用してLUNでアプリケーションを保護し、アプリケーションが透過的にフェイルオーバーできるようにして、災害発生時のビジネス継続性を確保します。 
---
= SnapMirrorアクティブ同期の概要
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
SnapMirrorアクティブ同期（SnapMirrorビジネス継続性_[SM-BC]_とも呼ばれます）を使用すると、サイト全体で障害が発生してもビジネスサービスの運用を継続でき、アプリケーションがセカンダリコピーを使用して透過的にフェイルオーバーできるようになります。SnapMirrorアクティブ同期でフェイルオーバーをトリガーするための手動操作やカスタムスクリプトは必要ありません。

ONTAP 9.9.1以降では、AFFクラスタ、オールフラッシュSANアレイ（ASA）クラスタ、およびCシリーズ（AFFまたはASA）でSnapMirrorアクティブ同期がサポートされます。プライマリ クラスタとセカンダリ クラスタのタイプ（ASAまたはAFF）が同じである必要があります。SnapMirrorアクティブ同期は、iSCSI LUNまたはFCP LUNを使用してアプリケーションを保護します。

ONTAP 9.15.1以降では、SnapMirrorアクティブ同期でがサポートされxref:architecture-concept.html[対称アクティブ/アクティブ機能]ます。対称アクティブ/アクティブ：双方向同期レプリケーションにより、保護されたLUNの両方のコピーからの読み取りおよび書き込みI/O処理を有効にし、両方のLUNコピーがローカルでI/O処理を処理できるようにします。ONTAP 9.15.1より前のバージョンでは、SnapMirrorのアクティブ同期でサポートされるのは非対称アクティブ/アクティブ構成のみで、セカンダリサイトのデータがLUNにプロキシされます。ONTAP 9.16.1 GA以降では、4ノードのONTAPクラスタでも対称アクティブ/アクティブ構成がサポートされます。


NOTE: 2024年7月以降、これまでPDFとして公開されていたテクニカルレポートの内容がONTAPの製品ドキュメントに統合されました。ONTAP SnapMirrorアクティブ同期のドキュメントに、「TR-4878：SnapMirrorアクティブ同期_」の内容が追加されました。



== メリット

SnapMirror Active Syncには次のようなメリットがあります。

* ビジネスクリティカルなアプリケーションの継続的可用性：
* 重要なアプリケーションをプライマリサイトとセカンダリサイトから交互にホストできます。
* 整合グループを使用して従属書き込み順序の整合性を確保し、アプリケーション管理を簡易化
* 各アプリケーションのフェイルオーバーをテストする機能。
* アプリケーションの可用性に影響を与えることなく、ミラークローンを瞬時に作成できます。
* 保護されているワークロードと保護されていないワークロードを同じONTAPクラスタに導入できる。
* LUN IDは同じままであるため、アプリケーションはLUN IDを共有仮想デバイスとして認識します。
* セカンダリクラスタを柔軟に再利用して、アプリケーションのパフォーマンスや可用性に影響を与えることなく、開発テスト、UAT、レポート作成に使用するクローンを瞬時に作成できます。


SnapMirrorアクティブ同期を使用すると、データLUNを保護できます。これにより、災害発生時にビジネス継続性を確保するために、アプリケーションを透過的にフェイルオーバーできます。詳細については、を参照してください link:use-cases-concept.html["ユースケース"]。



== 主な概念

SnapMirrorのアクティブな同期では、整合グループとONTAPメディエーターを使用して、災害が発生した場合でもデータがレプリケートされて提供されるようにします。SnapMirrorアクティブ同期の導入を計画する際は、SnapMirrorアクティブ同期の基本概念とそのアーキテクチャを理解しておくことが重要です。

.非対称性と対称性
SnapMirrorアクティブ同期では、非対称アクティブ/アクティブソリューション（ONTAP 9 .15.1以降）がサポートされます。これらのオプションは、ホストがストレージパスにアクセスしてデータを書き込む方法を示します。非対称構成では、セカンダリサイトのデータがLUNにプロキシされます。対称アクティブ/アクティブ構成では、両方のサイトがアクティブI/Oのためにローカルストレージにアクセスできます。

対称アクティブ/アクティブ構成は、VMware vMSC、SQLを使用したWindowsフェイルオーバークラスタ、Oracle RACなどのクラスタアプリケーション向けに最適化されています。

詳細については、を参照してください xref:architecture-concept.html[SnapMirror Active Syncアーキテクチャ]。

.整合グループ
はlink:../consistency-groups/index.html["整合グループ"]、ビジネス継続性のために保護する必要があるアプリケーションワークロードの整合性を保証するFlexVolボリュームの集まりです。

整合性グループの目的は、複数のボリュームのSnapshotイメージを同時に作成して、ある時点における一連のボリュームのcrash-consistentコピーを作成することです。整合グループを使用すると、データセットのすべてのボリュームが休止され、正確に同じポイントインタイムにスナップされます。これにより、データセットをサポートするボリューム間でデータ整合性のあるリストアポイントが提供されます。これにより、整合グループは従属書き込み順序の整合性を維持します。ビジネス継続性のためにアプリケーションを保護する場合は、ソースとデスティネーションの整合グループの間にデータ保護関係を確立できるように、このアプリケーションに対応するボリュームグループを整合グループに追加する必要があります。ソース整合性とデスティネーション整合性には、同じ数とタイプのボリュームが含まれている必要があります。

.コンスティチュエント
SnapMirrorのアクティブな同期関係で保護されている整合性グループに属している個 々 のボリュームまたはLUN。

.ONTAP Mediator
はlink:../mediator/index.html["ONTAP Mediator"]、ピア関係にあるONTAPのクラスタとノードに関する健常性情報を受信し、2つの間でオーケストレーションを行い、各ノード/クラスタが正常に稼働しているかどうかを確認します。ONTAPメディエーターは、次の項目に関する健常性情報を提供します。

* ONTAPクラスタのピアリング
* ピアONTAPクラスタノード
* 整合グループ（SnapMirrorのアクティブな同期関係でフェイルオーバーユニットを定義）。整合グループごとに次の情報が表示されます。
+
** レプリケーションの状態：Uninitialized、In Sync、またはOut of Sync
** プライマリコピーをホストするクラスタ
** 操作コンテキスト（計画的フェイルオーバーに使用）




このONTAPメディエーターの健常性情報を使用すると、クラスタで障害のタイプを区別し、自動フェイルオーバーを実行するかどうかを判断できます。ONTAPメディエーターは、両方のONTAPクラスタ（プライマリおよびセカンダリ）とともにSnapMirrorアクティブ同期クォーラムを構成する3つのメンバーの1つです。合意に達するには、クォーラムの少なくとも2つの当事者が特定の処理に同意する必要があります。


NOTE: ONTAP 9 .15.1以降では、どちらかのクラスタのSnapMirrorのアクティブな同期関係のステータスが表示されます。ONTAPメディエーターのステータスは、System Managerのどちらのクラスタからも監視できます。以前のリリースのONTAPでは、ソースクラスタのSnapMirrorのアクティブな同期関係のステータスが表示されていました。

.計画的フェイルオーバー
SnapMirrorアクティブ同期関係でのコピーの役割を変更する手動処理。プライマリ サイトがセカンダリ サイトに、セカンダリ サイトがプライマリ サイトになります。

.プライマリファーストとプライマリバイアス
SnapMirrorアクティブ同期では、ネットワークが分割された場合のI/O処理にプライマリ コピーを優先するプライマリファーストの原則が使用されます。

プライマリバイアスとは、SnapMirrorアクティブ同期で保護されたデータセットの可用性を向上させる特別なクォーラムの実装です。どちらのクラスタからもONTAP Mediatorにアクセスできない場合に、プライマリ コピーが使用可能だと、プライマリバイアスが効果を発揮します。

ONTAP 9.15.1以降では、SnapMirrorアクティブ同期でプライマリファーストとプライマリバイアスがサポートされます。プライマリ コピーはSystem Managerで指定され、REST APIおよびCLIを使用して出力されます。

.自動計画外フェイルオーバー（AUFO）
ミラー コピーへのフェイルオーバーを実行する自動処理。この処理には、プライマリ コピーが使用できないことを検出するためにONTAP Mediatorが必要です。

.非同期（OOS）
アプリケーションI/Oがセカンダリ・ストレージ・システムにレプリケートされていない場合は'**out of sync**と報告されます非同期ステータスは、セカンダリボリュームがプライマリ（ソース）と同期されておらず、SnapMirrorレプリケーションが実行されていないことを示します。

ミラー状態がの場合 `Snapmirrored`は、転送の失敗またはサポートされていない処理による失敗を示します。

SnapMirror Active Syncは自動再同期をサポートしており、コピーをInSync状態に戻すことができます。

ONTAP 9 .15.1以降では、SnapMirrorアクティブ同期がサポートされてlink:interoperability-reference.html#fan-out-configurations["ファンアウト構成での自動再構成"]います。

.均一な構成と非均一な構成
* **均一なホストアクセス**は、両方のサイトのホストが両方のサイトのストレージクラスタへのすべてのパスに接続されていることを意味します。サイト間パスが複数の距離にわたってストレッチされている。
* **Non-uniform host access **は、各サイトのホストが同じサイトのクラスタにのみ接続されることを意味します。サイト間パスとストレッチパスは接続されません。



NOTE: 均一ホストアクセスは、すべてのSnapMirrorアクティブ同期配置でサポートされます。非均一ホストアクセスは、対称アクティブ/アクティブ配置でのみサポートされます。

.RPOゼロ
RPOはRecovery Point Objective（目標復旧時点）の略で、所定の期間内に許容可能とみなされるデータ損失量を指します。RPOゼロとは、データ損失が一切許容されないことを意味します。

.RTOゼロ
RTOはRecovery Time Objective（目標復旧時間）の略で、システム停止、障害、またはその他のデータ損失イベントが発生してから、アプリケーションが無停止で通常の処理に戻るまでに許容可能とみなされる時間です。RTOゼロとは、ダウンタイムが一切許容されないことを意味します。
