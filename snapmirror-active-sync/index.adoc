---
sidebar: sidebar 
permalink: snapmirror-active-sync/index.html 
keywords: SM-BC, SMBC, failover, terms, benefits, snapmirror active sync, TR-4878 
summary: SnapMirror Active Syncを使用してLUNでアプリケーションを保護し、アプリケーションが透過的にフェイルオーバーできるようにして、災害発生時のビジネス継続性を確保します。 
---
= SnapMirror Active Syncの概要
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
SnapMirrorアクティブ同期（SnapMirrorビジネス継続性[SM-BC]とも呼ばれます）を使用すると、サイト全体の障害が発生してもビジネスサービスの運用を継続でき、アプリケーションがセカンダリコピーを使用して透過的にフェイルオーバーできるようになります。SnapMirror Active Syncでフェイルオーバーをトリガーするには、手動操作やカスタムスクリプトが必要です。

ONTAP 9.9.1以降では、AFFクラスタ、オールフラッシュSANアレイ（ASA）クラスタ、およびCシリーズ（AFFまたはASA）でSnapMirrorアクティブ同期がサポートされます。プライマリクラスタとセカンダリクラスタのタイプが同じである必要があります（ASAまたはAFF）。SnapMirror Active Syncは、iSCSI LUNまたはFCP LUNを使用してアプリケーションを保護します。

ONTAP 9.15.1以降では、SnapMirrorアクティブ同期でAがサポートされます。 xref:architecture-concept.html[対称アクティブ/アクティブ機能]双方向同期レプリケーションを使用して、保護されたLUNの両方のコピーからの読み取りおよび書き込みI/O処理を有効にし、両方のLUNコピーがI/O処理をローカルで処理できるようにします。ONTAP 9.15.1より前のバージョンでは、SnapMirrorのアクティブな同期でサポートされるのは、セカンダリサイトのデータがLUNにプロキシされる非対称アクティブ/アクティブ構成のみです。


NOTE: 2024年7月以降、これまでPDFとして公開されていたテクニカルレポートの内容がONTAPの製品ドキュメントに統合されました。ONTAP SnapMirror Active Syncのドキュメントに、TR-4878：『SnapMirror active sync』の内容が追加されました。



== 利点

SnapMirror Active Syncには次のようなメリットがあります。

* ビジネスクリティカルなアプリケーションの継続的可用性：
* 重要なアプリケーションをプライマリサイトとセカンダリサイトから交互にホストできます。
* 整合グループを使用して従属書き込み順序の整合性を確保し、アプリケーション管理を簡易化
* 各アプリケーションのフェイルオーバーをテストする機能。
* アプリケーションの可用性に影響を与えることなく、ミラークローンを瞬時に作成できます。
* 保護されているワークロードと保護されていないワークロードを同じONTAPクラスタに導入できる。
* LUN IDは同じままであるため、アプリケーションはLUN IDを共有仮想デバイスとして認識します。
* セカンダリクラスタを柔軟に再利用して、アプリケーションのパフォーマンスや可用性に影響を与えることなく、開発テスト、UAT、レポート作成に使用するクローンを瞬時に作成できます。


SnapMirrorアクティブ同期を使用すると、データLUNを保護できます。これにより、災害発生時にビジネス継続性を確保するために、アプリケーションを透過的にフェイルオーバーできます。詳細については、を参照してください link:use-cases-concept.html["ユースケース"]。



== 主な概念

SnapMirrorアクティブ同期では、整合グループとONTAPメディエーターを使用して、災害が発生した場合でもデータがレプリケートされて提供されるようにします。SnapMirrorアクティブ同期の構成を計画する際は、SnapMirrorアクティブ同期の基本概念とそのアーキテクチャを理解しておくことが重要です。

.非対称性と対称性
SnapMirrorアクティブ同期では、非対称アクティブ/アクティブ構成がサポートされます。ONTAP 9.15.1以降では、対称アクティブ/アクティブ構成のソリューションがサポートされます。これらのオプションは、ホストがストレージパスにアクセスしてデータを書き込む方法を示します。非対称構成では、セカンダリサイトのデータがLUNにプロキシされます。対称アクティブ/アクティブ構成では、両方のサイトがアクティブI/Oのためにローカルストレージにアクセスできます。

対称アクティブ/アクティブ構成は、VMware VMSc、SQLを使用したWindowsフェイルオーバークラスタ、Oracle RACなどのクラスタ化されたアプリケーション向けに最適化されています。

詳細については、を参照してください xref:architecture-concept.html[SnapMirror Active Syncのアーキテクチャ]。

.整合グループ
A link:../consistency-groups/index.html["整合グループ"] は、ビジネス継続性のために保護する必要があるアプリケーションワークロードの整合性を保証するFlexVolボリュームの集まりです。

整合性グループの目的は、複数のボリュームのSnapshotイメージを同時に作成して、ある時点における一連のボリュームのcrash-consistentコピーを作成することです。整合グループを使用すると、データセットのすべてのボリュームが休止され、正確に同じポイントインタイムにスナップされます。これにより、データセットをサポートするボリューム間でデータ整合性のあるリストアポイントが提供されます。これにより、整合グループは従属書き込み順序の整合性を維持します。ビジネス継続性のためにアプリケーションを保護する場合は、ソースとデスティネーションの整合グループの間にデータ保護関係を確立できるように、このアプリケーションに対応するボリュームグループを整合グループに追加する必要があります。ソース整合性とデスティネーション整合性には、同じ数とタイプのボリュームが含まれている必要があります。

.構成要素
SnapMirrorのアクティブな同期関係で保護されている整合性グループに属している個 々 のボリュームまたはLUN。

.ONTAP メディエーター
。 link:../mediator/index.html["ONTAP メディエーター"] ピア関係にあるONTAPのクラスタとノードに関する健常性情報を受信し、2つのノード間でオーケストレーションを行い、各ノード/クラスタが正常で稼働しているかどうかを確認します。ONTAPメディエーターは、次の項目に関する健常性情報を提供します。

* ONTAPクラスタのピアリング
* ピアONTAPクラスタノード
* 整合グループ（SnapMirrorのアクティブな同期関係でフェイルオーバーユニットを定義）。整合グループごとに次の情報が表示されます。
+
** レプリケーションの状態：Uninitialized、In Sync、またはOut of Sync
** プライマリコピーをホストするクラスタ
** 操作コンテキスト（計画的フェイルオーバーに使用）




このONTAPメディエーターの健常性情報を使用すると、クラスタで障害のタイプを区別し、自動フェイルオーバーを実行するかどうかを判断できます。ONTAPメディエーターは、両方のONTAPクラスタ（プライマリおよびセカンダリ）とともに、SnapMirrorアクティブ同期クォーラムを構成する3つのメンバーの1つです。合意に達するには、クォーラムの少なくとも2つの当事者が特定の処理に同意する必要があります。


NOTE: ONTAP 9.15.1以降では、どちらかのクラスタのSnapMirrorアクティブな同期関係のステータスがSystem Managerに表示されます。ONTAPメディエーターのステータスは、System Managerのどちらのクラスタからも監視できます。以前のリリースのONTAPでは、ソースクラスタのSnapMirrorのアクティブな同期関係のステータスがSystem Managerに表示されていました。

.計画的フェイルオーバー
SnapMirrorのアクティブな同期関係におけるコピーの役割を変更する手動処理。プライマリサイトがセカンダリになり、セカンダリがプライマリになります。

.一次バイアスと一次バイアス
SnapMirrorのアクティブな同期では、ネットワークに分割された場合にI/Oを処理するためにプライマリファーストの原則が使用されます。

primary-biasは、SnapMirrorのアクティブな同期で保護されたデータセットの可用性を向上させる特別なクォーラムの実装です。プライマリコピーが使用可能な場合、両方のクラスタからONTAPメディエーターにアクセスできないときにプライマリバイアスが有効になります。

ONTAP 9.15.1以降では、SnapMirrorアクティブ同期でプライマリファーストとプライマリバイアスがサポートされます。プライマリコピーはSystem Managerで指定され、REST APIおよびCLIを使用して出力されます。

.自動計画外フェイルオーバー（AUFO）
ミラーコピーへのフェイルオーバーを実行する自動処理。この処理を実行するには、プライマリコピーを使用できないことを検出するためにONTAPメディエーターの支援が必要です。

.Out of Sync（OOS）
アプリケーションI/Oがセカンダリ・ストレージ・システムにレプリケートされていない場合は'**out of sync**と報告されます非同期ステータスは、セカンダリボリュームがプライマリ（ソース）と同期されておらず、SnapMirrorレプリケーションが実行されていないことを示します。

ミラーの状態が `Snapmirrored`は、サポートされていない処理が原因で転送が失敗したことを示しています。

SnapMirror Active Syncは自動再同期をサポートしており、コピーをInSync状態に戻すことができます。

ONTAP 9.15.1以降では、SnapMirrorアクティブ同期がサポートされます。 link:interoperability-reference.html#fan-out-configurations["ファンアウト構成での自動再構成"]。

.均一な構成と非均一な構成
* **均一なホストアクセス**は、両方のサイトのホストが両方のサイトのストレージクラスタへのすべてのパスに接続されていることを意味します。サイト間パスが複数の距離にわたってストレッチされている。
* **Non-uniform host access **は、各サイトのホストが同じサイトのクラスタにのみ接続されることを意味します。サイト間パスとストレッチパスは接続されません。



NOTE: SnapMirrorのアクティブな同期構成では、均一なホストアクセスがサポートされます。均一でないホストアクセスは、対称アクティブ/アクティブ構成でのみサポートされます。

.RPOはゼロです
RPOはRecovery Point Objective（目標復旧時点）の略で、所定の期間に許容可能とみなされるデータ損失量です。RPOがゼロの場合は、データ損失が許容されないことを意味します。

.RTOゼロ
RTOはRecovery Time Objective（目標復旧時間）の略で、システム停止、障害、またはその他のデータ損失イベントが発生した場合に、アプリケーションが無停止で通常の運用に復帰するのに許容される時間です。RTOゼロは、許容されるダウンタイムがないことを意味します。
