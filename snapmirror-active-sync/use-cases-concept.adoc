---
sidebar: sidebar 
permalink: snapmirror-active-sync/use-cases-concept.html 
keywords: SM-BC, SMBC, overview, benefits, use cases, architecture, snapmirror active sync 
summary: SnapMirror Active Syncを使用してアプリケーションをLUNで保護し、アプリケーションが透過的にフェイルオーバーできるようにして、災害発生時のビジネス継続性を確保します。 
---
= ONTAP SnapMirror Active Syncの使用例
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
グローバルに接続されたビジネス環境では、サイバー攻撃、停電、自然災害などの障害が発生した場合でも、データ損失なしでビジネスクリティカルなアプリケーション データを迅速に回復することが求められています。こうした要求は、一般データ保護規則（GDPR）といった規制要件を遵守する金融などの業界で高まっています。

SnapMirrorアクティブ同期には、次のようなユースケースがあります。

.アプリケーションの導入による目標復旧時間（RTO）ゼロ
SnapMirrorアクティブ同期環境では、プライマリ クラスタとセカンダリ クラスタを使用します。プライマリクラスタ内のLUN  `L1P` ）には鏡がある `L1S` ）はセカンダリLUNに同じシリアルIDを持ち、ホストには読み書き可能なLUNとして報告されます。しかし、非対称構成では、読み取りと書き込みの操作はプライマリLUNにのみサービスされる、 `L1P`。 `L1S`プロキシによって提供されます。

.RTOゼロまたは透過的なアプリケーションフェイルオーバー（TAF）のためのアプリケーション導入
TAFは、ホストのMPIOソフトウェアベースのパス フェイルオーバーに基づいて、ストレージへのノンストップ アクセスを実現します。プライマリとミラーの両方のLUNコピー（L1PとL1Sなど）に同じID（シリアル番号）が割り当てられ、両方が読み取り / 書き込み可能としてホストに報告されます。ただし、非対称構成では、読み取りと書き込みはプライマリ ボリュームによってのみ処理されます。ミラー コピーへのI/Oはプライマリ コピーにプロキシされます。ホストからL1への優先パスはVS1:N1で、これは非対称論理ユニット アクセス（ALUA）のアクセス状態「アクティブ / 最適化済み」（A/O）に基づきます。主にプライマリでストレージが停止した場合にフェイルオーバー（計画的または計画外）を実行するため、ONTAP Mediatorを使用する必要があります。

image:snapmirror-active-sync-alua-active-optimized.png["SnapMirrorアクティブ同期ALUAアクティブ最適化パス"]

TAFは、自動フェイルオーバーと自動フェイルオーバー・デュプレックスの2つのモードで動作します。自動フェイルオーバーでは、読み取りと書き込みはプライマリボリュームのみで処理されるため、ミラーコピー（ミラーコピー自身は書き込み処理を実行できません）へのIOはプライマリコピーにプロキシされます。自動フェイルオーバー・デュプレックスでは、プライマリコピーとセカンダリコピーの両方でIOを処理できるため、プロキシは不要です。

image:snapmirror-active-sync-automatedfailoverduplex-scenario.png["SnapMirrorアクティブ同期自動フェイルオーバーデュプレックスシナリオ"]

ONTAP 9.17.1 でホスト アクセスに NVMe を使用している場合は、AutomatedFailoverDuplex ポリシーのみがサポートされます。

SnapMirrorアクティブ同期では、ALUAが使用されます。ALUAは、アプリケーションホストのマルチパスソフトウェアに対して、優先順位およびアクセス可用性を指定してアドバタイズされたパスを使用して、アプリケーションホストとストレージアレイの通信を行うためのメカニズムです。ALUAは、LUNを所有するコントローラへのアクティブな最適パスおよびその他のパスをアクティブな非最適パスとしてマークします。このパスは、プライマリパスで障害が発生した場合にのみ使用されます。

NVMe プロトコルを使用したSnapMirrorアクティブ同期は非対称名前空間アクセス (ANA) を使用します。これにより、アプリケーション ホストは保護されている NVMe 名前空間への最適化されたパスと最適化されていないパスを検出できます。NVMeターゲットは適切なパス状態を公開し、アプリケーションホストが保護対象のNVMeネームスペースへの最適なパスを使用できるようにします。

.クラスタアプリケーション
VMware Metro Storage Cluster、Oracle RAC、Windows Failover Clustering with SQL などのクラスタ化されたアプリケーションでは、パフォーマンスのオーバーヘッドなしで VM を他のサイトにフェールオーバーできるように、同時アクセスが必要です。SnapMirrorアクティブ同期の対称アクティブ / アクティブは、双方向レプリケーションによってローカルでIOを処理することで、クラスタ アプリケーションの要件を満たします。  ONTAP 9.16.1 以降では、対称アクティブ/アクティブが 4 ノード クラスタの構成でサポートされ、 ONTAP 9.15.1 の 2 ノード クラスタの制限から拡張されました。

.災害シナリオ
地理的に分散したサイト間で、アプリケーション用の複数のボリュームを同期的にレプリケートします。プライマリが停止した場合に自動的にセカンダリ コピーにフェイルオーバーできるため、ティア1アプリケーションのビジネス継続性を確保できます。プライマリ クラスタをホストしているサイトで災害が発生すると、ホストのマルチパス ソフトウェアはそのクラスタを経由するすべてのパスを停止とマークし、セカンダリ クラスタからのパスを使用します。その結果、ONTAP Mediatorによる無停止でのミラー コピーへのフェイルオーバーが可能になります。

.拡張アプリケーションサポート
SnapMirrorアクティブ同期は柔軟性に優れ、使いやすいアプリケーションレベルのきめ細かい対応と自動フェイルオーバーを実現します。SnapMirrorアクティブ シンクは、IP ネットワーク経由の実績のあるSnapMirror同期レプリケーションを使用して、LAN または WAN 経由で高速にデータをレプリケートし、仮想環境と物理環境の両方で、Oracle、Microsoft SQL Server などのビジネス クリティカルなアプリケーションの高いデータ可用性と高速なデータ レプリケーションを実現します。

SnapMirrorアクティブ同期を使用すると、セカンダリ コピーへのTAFにより、サイト全体に障害が発生してもミッションクリティカルなビジネス サービスの運用を継続できます。このフェイルオーバーをトリガーするために、手動による介入や追加のスクリプトは必要ありません。
