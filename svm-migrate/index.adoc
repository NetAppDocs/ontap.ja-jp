---
permalink: svm-migrate/index.html 
sidebar: sidebar 
keywords: svm, migrate, workflow, relocate, prerequisites, data mobility 
summary: ONTAP 9.10.1 以降のクラスタ管理者は、ソースクラスタからデスティネーションクラスタに SVM を無停止で再配置して容量と負荷分散を管理したり、機器のアップグレードやデータセンターの統合を行ったりすることができます。ONTAP 9.12.1以降では、FAS およびAFF プラットフォーム、およびハイブリッドアグリゲートでこの機能がサポートされます。 
---
= SVM のデータ移動の概要
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAP 9.10.1以降では、ONTAP CLIを使用して、容量とロードバランシングを管理したり、機器のアップグレードやデータセンターの統合を有効にしたりするために、システムを停止することなくSVMをソースクラスタからデスティネーションクラスタに再配置できます。

この無停止のSVM再配置機能は、ONTAP 9.10.1および9.11.1のAFFプラットフォームでサポートされます。ONTAP 9.12.1以降では、この機能はFASプラットフォームとAFFプラットフォームの両方、およびハイブリッドアグリゲートでサポートされます。

SVM の名前と UUID は、移行後も変更されず、データ LIF 名、 IP アドレス、ボリューム名などのオブジェクト名も変更されません。SVM 内のオブジェクトの UUID は異なります。



== SVM 移行ワークフロー

次の図は、 SVM 移行の一般的なワークフローを示しています。SVM の移行はデスティネーションクラスタから開始します。移行元または移行先のどちらからでも移行を監視できます。手動カットオーバーまたは自動カットオーバーを実行できます。自動カットオーバーはデフォルトで実行されます。

image::../media/workflow_svm_migrate.gif[SVM 移行ワークフロー]



== SVM移行プラットフォームのサポート

[cols="1,1"]
|===


| コントローラファミリー | サポートされるONTAPのバージョン 


| AFF Aシリーズ | ONTAP 9.10.1 以降 


| AFF Cシリーズ | ONTAP 9.12.1パッチ4以降 


| FAS | ONTAP 9.12.1以降 
|===

NOTE:  AFF クラスタからハイブリッドアグリゲートを使用するFAS クラスタに移行する場合、ボリュームの自動配置で同様のアグリゲートの一致が試行されます。たとえば、ソースクラスタにボリュームが60個ある場合、ボリュームの配置では、ボリュームを配置するデスティネーションにAFF アグリゲートが検索されます。AFFアグリゲートに十分なスペースがない場合、ボリュームはフラッシュディスク以外のアグリゲートに配置されます。



== ONTAPのバージョンによる拡張性のサポート

[cols="1,1"]
|===


| ONTAPバージョン | ソースとデスティネーションのHAペア 


| ONTAP 9.14.1 | 12 


| ONTAP 9.13.1 | 6. 


| ONTAP 9.11.1 | 3. 


| ONTAP 9.10.1 | 1. 
|===


== ソースクラスタとデスティネーションクラスタ間のTCPラウンドトリップタイム（RTT）に関するネットワークインフラのパフォーマンス要件

クラスタにインストールされているONTAPのバージョンに応じて、ソースクラスタとデスティネーションクラスタを接続するネットワークの最大応答時間を次に示します。

|===


| ONTAPバージョン | 最大RTT 


| ONTAP 9.12.1以降 | 10ミリ秒 


| ONTAP 9.11.1以前 | 2ミリ秒 
|===


== SVMあたりのサポートされる最大ボリューム数

[cols="1,1,1,1,1,1"]
|===


| ソース | 宛先 | ONTAP 9.14.1 | ONTAP 9.13.1 | ONTAP 9.12.1 | ONTAP 9.11.1以前 


| AFF | AFF | 400 | 200 | 100 | 100 


| FAS | FAS | 80 | 80 | 80 | 該当なし 


| FAS | AFF | 80 | 80 | 80 | 該当なし 


| AFF | FAS | 80 | 80 | 80 | 該当なし 
|===


== 前提条件

SVMの移行を開始する前に、次の前提条件を満たしている必要があります。

* クラスタ管理者である必要があります。
* link:https://docs.netapp.com/us-en/ontap/peering/create-cluster-relationship-93-later-task.html["ソースクラスタとデスティネーションクラスタが相互にピア関係にある必要があります"^]。
* ソースクラスタとデスティネーションクラスタでSnapMirror同期が確立されている必要があります。 link:https://docs.netapp.com/us-en/ontap/system-admin/install-license-task.html["インストールされたライセンス"]。このライセンスは、 link:https://docs.netapp.com/us-en/ontap/system-admin/manage-licenses-concept.html#licenses-included-with-ontap-one["ONTAP One"]。
* ソースクラスタのすべてのノードでONTAP 9.10.1以降が実行されている必要があります。特定のONTAPアレイコントローラのサポートについては、を参照してください link:https://hwu.netapp.com/["Hardware Universe"^]。
* ソースクラスタ内のすべてのノードで同じバージョンのONTAPが実行されている必要があります。
* デスティネーションクラスタ内のすべてのノードで同じバージョンのONTAPが実行されている必要があります。
* デスティネーションクラスタは、ソースクラスタと同じかそれよりも新しいメジャーなEffective Cluster Version（ECV；有効なクラスタバージョン）が2つ以下である必要があります。
* ソースクラスタとデスティネーションクラスタで、データLIFへのアクセス用に同じIPサブネットがサポートされている必要があります。
* ソースSVMに含まれているボリュームの数がよりも少ない必要があります xref:Maximum supported volumes per SVM[このリリースでサポートされるデータボリュームの最大数]。
* デスティネーションにボリューム配置用の十分なスペースが必要です
* ソース SVM に暗号化されたボリュームがある場合は、デスティネーションでオンボードキーマネージャを設定する必要があります




== ベストプラクティス

SVM移行を実行するときは、CPUワークロードが実行されるように、ソースクラスタとデスティネーションクラスタの両方にCPUヘッドルームを30%確保しておくことを推奨します。



== SVM処理

SVM の移行と競合する可能性がある処理がないかどうかを確認する必要があります。

* 実行中のフェイルオーバー処理はありません
* wafliron を実行できない
* フィンガープリントを実行中ではありません
* vol move 、 rehost 、 clone 、 create 、 convert 、または analytics が実行されていません




== サポートされる機能とサポートされない機能

次の表に、SVMデータ移動とONTAPリリースでサポートされるONTAP機能を示します。

[cols="3,1,4"]
|===


| フィーチャー（ Feature ） | 最初にサポートされたリリース | コメント 


| 自律的なランサムウェア防御 | ONTAP 9.12.1 |  


| Cloud Volumes ONTAP | サポート対象外 |  


| 外部キー管理ツール | ONTAP 9.11.1 |  


| FabricPool | ONTAP 9.11.1  a| 
の詳細を確認してください xref:FabricPool support[FabricPoolのサポート]。



| ファンアウト関係（移行するソースにSnapMirrorソースボリュームと複数のデスティネーションがある） | ONTAP 9.11.1 |  


| FC SAN | サポート対象外 |  


| Flash Pool の機能です | ONTAP 9.12.1 |  


| FlexCache ボリューム | サポート対象外 |  


| FlexGroup | サポート対象外 |  


| IPSecポリシー | サポート対象外 |  


| IPv6 LIF | サポート対象外 |  


| iSCSI SAN | サポート対象外 |  


| ジョブスケジュールのレプリケーション | ONTAP 9.11.1 | ONTAP 9.10.1では、移行時にジョブスケジュールがレプリケートされないため、デスティネーションで手動で作成する必要があります。ONTAP 9.11.1以降では、ソースで使用されているジョブスケジュールが移行時に自動的にレプリケートされます。 


| 負荷共有ミラー | サポート対象外 |  


| MetroCluster SVM | サポート対象外 | SVMの移行ではMetroCluster SVMの移行がサポートされませんが、にSnapMirror非同期レプリケーションを使用できる場合があります link:https://www.netapp.com/media/83785-tr-4966.pdf["MetroCluster構成のSVMを移行する"]。MetroCluster構成でSVMを移行する手順は、無停止方式である_not_aであることに注意してください。 


| NetApp Aggregate Encryption （ NAE ） | サポート対象外 | 暗号化されていないソースから暗号化されたデスティネーションへの移行はサポートされていません。 


| NDMP構成 | サポート対象外 |  


| NetApp Volume Encryption （ NVE ） | ONTAP 9.10.1 |  


| NFSおよびSMB監査ログ | ONTAP 9.13.1  a| 
[NOTE]
====
監査ログリダイレクトは、クラウドモードでのみ使用できます。監査を有効にしたオンプレミスのSVM移行の場合は、ソースSVMで監査を無効にしてから移行を実行する必要があります。

====
SVM移行前：

* link:https://docs.netapp.com/us-en/ontap/nas-audit/enable-disable-auditing-svms-task.html["デスティネーションクラスタで監査ログリダイレクトを有効にする必要がある"]。
* link:https://docs.netapp.com/us-en/ontap/nas-audit/commands-modify-auditing-config-reference.html?q=audit+log+destination+path["ソースSVMからの監査ログデスティネーションパスがデスティネーションクラスタに作成されている必要があります。"]。




| NFS v3、NFS v4.1、NFS v4.2 | ONTAP 9.10.1 |  


| NFS v4.0 | ONTAP 9.12.1 |  


| pNFSを使用したNFSv4.1 | ONTAP 9.14.1 |  


| NVMe over Fabric | サポート対象外 |  


| ソースクラスタでCommon Criteriaモードを有効にしたオンボードキーマネージャ（OKM） | サポート対象外 |  


| qtree | ONTAP 9.14.1 |  


| クォータ | ONTAP 9.14.1 |  


| S3 | サポート対象外 |  


| SMBプロトコル | ONTAP 9.12.1  a| 
SMBの移行にはシステムの停止が伴い、移行後にクライアントの更新が必要になります。



| SnapMirrorCloudカンケイ | ONTAP 9.12.1 | ONTAP 9.12.1以降では、SnapMirror Cloud関係が設定されたSVMを移行する場合、デスティネーションクラスタに link:https://docs.netapp.com/us-en/ontap/data-protection/snapmirror-licensing-concept.html#snapmirror-cloud-license["SnapMirror Cloud ライセンス"] をインストールし、クラウドにミラーリングするボリューム内の容量を移動するための十分な容量が必要です。 


| SnapMirror非同期デスティネーション | ONTAP 9.12.1 |  


| SnapMirrorヒトウキソオス | ONTAP 9.11.1  a| 
* ほとんどのマイグレーション中、FlexVol SnapMirror関係では転送は通常どおり続行できます。
* 実行中の転送はカットオーバー中にキャンセルされ、カットオーバー中に新しい転送は失敗します。移行が完了するまで再開できません。
* 移行中にキャンセルされた、または実行されなかったスケジュールされた転送は、移行完了後に自動的には開始されません。
+
[NOTE]
====
SnapMirrorソースをマイグレートする場合、ONTAPでは、SnapMirror更新が実行されるまで、移行後のボリュームの削除は禁止されません。これは、移動されたSnapMirrorソースボリュームのSnapMirror関連情報を使用できるのは、移動が完了して最初の更新が実行されたあとに限られるためです。

====




| SMTape設定 | サポート対象外 |  


| SnapLock | サポート対象外 |  


| SnapMirror によるビジネス継続性 | サポート対象外 |  


| SnapMirror SVMピア関係 | ONTAP 9.12.1 |  


| SnapMirror SVMディザスタリカバリ | サポート対象外 |  


| SnapMirror Synchronous | サポート対象外 |  


| Snapshot コピー | ONTAP 9.10.1 |  


| タンパープルーフスナップショットコピーロック | ONTAP 9.14.1 | 改ざん防止機能を備えたSnapshotコピーロックは、SnapLockとは異なります。SnapLockはサポートされません。 


| 仮想IP LIF / BGP | サポート対象外 |  


| Virtual Storage Console 7.0以降 | サポート対象外 | VSCはに含まれています https://docs.netapp.com/us-en/ontap-tools-vmware-vsphere/index.html["ONTAP Tools for VMware vSphere 仮想アプライアンス"^] VSC 7.0以降 


| ボリュームクローン | サポート対象外 |  


| vStorageの略 | サポート対象外 |  
|===


=== FabricPoolのサポート

SVMの移行は、FabricPoolのボリュームで次のプラットフォームでサポートされます。

* Azure NetApp Filesプラットフォーム。すべての階層化ポリシーがサポートされます（snapshot-only、auto、all、none）。
* オンプレミスプラットフォーム：サポートされるボリューム階層化ポリシーは「none」のみです。




== 移行中にサポートされる処理

次の表に、移動中のSVMでサポートされるボリューム処理を、移動状態に基づいて示します。

[cols="2,1,1,1"]
|===


| ボリューム操作 3+| SVMの移行状態 


|  | * 実行中 * | *一時停止* | * カットオーバー * 


| 作成 | 許可されません | 許可されます | サポート対象外 


| 削除 | 許可されません | 許可されます | サポート対象外 


| ファイルシステム分析の無効化 | 許可されます | 許可されます | サポート対象外 


| ファイルシステム分析の有効化 | 許可されません | 許可されます | サポート対象外 


| 変更 | 許可されます | 許可されます | サポート対象外 


| オフライン/オンライン | 許可されません | 許可されます | サポート対象外 


| 移動/リホスト | 許可されません | 許可されます | サポート対象外 


| qtreeの作成/変更 | 許可されません | 許可されます | サポート対象外 


| クォータの作成/変更 | 許可されません | 許可されます | サポート対象外 


| 名前を変更する | 許可されません | 許可されます | サポート対象外 


| サイズ変更 | 許可されます | 許可されます | サポート対象外 


| 制限 | 許可されません | 許可されます | サポート対象外 


| Snapshotコピーの属性が変更されました | 許可されます | 許可されます | サポート対象外 


| Snapshotコピー自動削除の変更 | 許可されます | 許可されます | サポート対象外 


| Snapshotコピーの作成 | 許可されます | 許可されます | サポート対象外 


| Snapshotコピーの削除 | 許可されます | 許可されます | サポート対象外 


| Snapshotコピーからファイルをリストアします | 許可されます | 許可されます | サポート対象外 
|===