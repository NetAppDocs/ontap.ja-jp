---
permalink: system-admin/manage-cluster-time-concept.html 
sidebar: sidebar 
keywords: manage, cluster, time, administrator, ntp, network, time, protocol, zone 
summary: ONTAP ではクラスタのタイムゾーン、日付、時刻を手動で設定できますが、クラスタの時間を同期するように NTP サーバを設定する必要があります。 
---
= ONTAPクラスタ時間の管理（クラスタ管理者のみ）
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
クラスタ時間が不正確だと問題が発生する可能性があります。ONTAPではクラスタのタイム ゾーン、日付、時刻を手動で設定できますが、クラスタ時間を同期する場合はネットワーク タイム プロトコル（NTP）サーバを設定する必要があります。

ONTAP 9.5以降では、NTPサーバに対称認証を設定できます。

NTPは常に有効です。ただし、NTPを有効にしただけでは、クラスタは外部の時間ソースと同期されません。ONTAPでは、次の方法でクラスタのNTP設定を管理できます。

* 最大 10 台の外部 NTP サーバーをクラスターに関連付けることができます(`cluster time-service ntp server create`（：）
+
** タイム サービスの冗長性と品質を高めるためには、最低3台の外部NTPサーバをクラスタに関連付ける必要があります。
** NTPサーバはIPv4またはIPv6アドレス、あるいは完全修飾ホスト名で指定できます。
** 使用するNTPバージョン（v3またはv4）を手動で指定できます。
+
デフォルトでは、ONTAPは指定された外部NTPサーバでサポートされているNTPバージョンを自動的に選択します。

+
指定したNTPバージョンがNTPサーバでサポートされていない場合は、時間を同期できません。

** advanced権限レベルでは、クラスタに関連付けられている外部NTPサーバを、クラスタ時間を修正、調節するための主要時間ソースとして指定できます。


* クラスターに関連付けられている NTP サーバーを表示できます(`cluster time-service ntp server show`。
* クラスターの NTP 構成を変更できます(`cluster time-service ntp server modify`。
* クラスターと外部 NTP サーバーの関連付けを解除できます(`cluster time-service ntp server delete`。
* 高度な権限レベルでは、すべての外部 NTP サーバーとクラスターの関連付けをクリアすることで構成をリセットできます(`cluster time-service ntp server reset`。


クラスターに参加するノードは、クラスターの NTP 構成を自動的に採用します。

ONTAPでは、NTPを使用できるだけでなく、クラスタ時間を手動で管理できます。この機能は、間違った時間を修正するときに便利です（リブート後にノードの時間が著しくずれた場合など）。その場合は、NTPが外部の時間サーバと同期できるようになるまで、クラスタのおよその時間を指定します。手動で設定した時間は、クラスタ上のすべてのノードに反映されます。

クラスタ時間を手動で管理するには、次の方法があります。

* クラスターのタイムゾーン、日付、時刻を設定または変更できます(`cluster date modify`。
* クラスターの現在のタイムゾーン、日付、時刻設定を表示できます(`cluster date show`。


[NOTE]
====
ジョブスケジュールは、クラスタの日付と時刻の手動変更には対応しません。これらのジョブは、ジョブが作成された時点、または最後に実行された時点の現在のクラスタ時刻に基づいて実行されるようにスケジュールされます。したがって、クラスタの日付または時刻を手動で変更する場合は、 `job show`コマンドおよび `job history show`コマンドを使用して、スケジュールされたすべてのジョブがキューに登録され、要件に従って完了していることを確認する必要があります。

====


== クラスタ時間の管理用コマンド

 `cluster time-service ntp server`コマンドを使用して、クラスターのNTPサーバーを管理します。 `cluster date`コマンドを使用して、クラスターの時刻を手動で管理します。

ONTAP 9.5以降では、NTPサーバに対称認証を設定できます。

次のコマンドによって、クラスタのNTPサーバを管理できます。

|===
| 状況 | 使用するコマンド 


 a| 
対称認証を使用せずにクラスタを外部NTPサーバと関連付ける
 a| 
`cluster time-service ntp server create -server server_name`



 a| 
対称認証を使用してクラスタを外部NTPサーバと関連付ける（ONTAP 9.5以降）
 a| 
`cluster time-service ntp server create -server server_ip_address -key-id key_id`

[NOTE]
====
 `key_id`は、「`cluster time-service ntp key`」で設定された既存の共有キーを参照する必要があります。

====


 a| 
既存のNTPサーバで対称認証を有効にする。必要なキーIDを追加することで、既存のNTPサーバを変更して認証を有効にできます。

ONTAP 9.5以降で利用可能
 a| 
`cluster time-service ntp server modify -server server_name -key-id key_id`



 a| 
対称認証を無効にする
 a| 
`cluster time-service ntp server modify -server server_name -is-authentication-enabled false`



 a| 
共有NTPキーを設定する
 a| 
`cluster time-service ntp key create -id shared_key_id -type shared_key_type -value shared_key_value`

[NOTE]
====
共有キーはIDで参照されます。ID、そのタイプ、および値が、ノードとNTPサーバで同じであることが必要です。

====


 a| 
クラスタに関連付けられたNTPサーバに関する情報を表示する
 a| 
`cluster time-service ntp server show`



 a| 
クラスタに関連付けられた外部NTPサーバの設定を変更する
 a| 
`cluster time-service ntp server modify`



 a| 
クラスタからNTPサーバへの関連付けを解除する
 a| 
`cluster time-service ntp server delete`



 a| 
すべての外部NTPサーバのクラスタとの関連付けを消去して設定をリセットする
 a| 
`cluster time-service ntp server reset`

[NOTE]
====
このコマンドには、advanced権限レベルが必要です。

====
|===
次のコマンドによって、手動でクラスタ時間を管理できます。

|===
| 状況 | 使用するコマンド 


 a| 
タイム ゾーン、日付、および時刻を設定または変更する
 a| 
`cluster date modify`



 a| 
クラスタのタイム ゾーン、日付、および時刻の設定を表示する
 a| 
`cluster date show`

|===
.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/cluster-date-show.html["cluster date show"^]
* link:https://docs.netapp.com/us-en/ontap-cli/cluster-date-modify.html["cluster date modify"^]
* link:https://docs.netapp.com/us-en/ontap-cli/search.html?q=cluster+time-service+ntp["クラスタ時刻サービス NTP"^]
* link:https://docs.netapp.com/us-en/ontap-cli/job-show.html["job show"^]

