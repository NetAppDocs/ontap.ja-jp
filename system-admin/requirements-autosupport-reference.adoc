---
sidebar: sidebar 
permalink: system-admin/requirements-autosupport-reference.html 
keywords: requirements, autosupport, messages, http, https, smtp, smtps 
summary: セキュリティを最大限に高め、AutoSupportの最新機能をサポートするには、HTTPSとTLSv1.2またはセキュアなSMTPを使用してAutoSupportメッセージを配信する必要があります。 
---
= AutoSupportを使用する準備
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
AutoSupportメッセージをNetAppに配信するようにONTAPクラスタを設定できます。その一環として、通常は組織内のローカル電子メールアドレスにメッセージのコピーを送信することもできます。使用可能なオプションを確認して、AutoSupportを設定する準備をしておく必要があります。



== NetAppへのAutoSupportメッセージの配信

AutoSupportメッセージは、HTTPまたはSMTPプロトコルを使用してNetAppに配信できます。セキュリティを強化するには、HTTPでTLSを使用します。ONTAP 9.15.1以降では、SMTPでTLSを使用することもできます。


TIP: 可能な場合は常にTLS（HTTPS）でHTTPを使用してください。

次の点にも注意してください。

* AutoSupportメッセージに対して設定できるNetAppへの配信チャネルは1つだけです。2つのプロトコルを使用してAutoSupportメッセージをNetAppに配信することはできません。
* AutoSupport では、プロトコルごとに最大ファイルサイズが制限されます。AutoSupportメッセージのサイズが設定された制限を超えると、AutoSupportはできるだけ多くのメッセージを配信しますが、切り捨てが発生します。
* 必要に応じて最大ファイルサイズを変更できます。コマンドを参照 `system node autosupport modify` を参照してください。
* どちらのプロトコルも、名前が解決されるアドレスファミリーに基づいて、IPv4またはIPv6経由で転送できます。
* AutoSupportメッセージを送信するためにONTAPによって確立されたTCP接続は、一時的で短命です。




=== HTTP

これは最も堅牢な機能を提供します。次の点に注意してください。

* AutoSupport OnDemandと大容量ファイルの転送がサポートされています。
* 最初にHTTP PUT要求が試行されます。送信中に要求が失敗すると、停止した場所から要求が再開されます。
* サーバがPUTをサポートしていない場合は、代わりにHTTP POSTメソッドが使用されます。
* HTTP転送のデフォルトの制限は25MBです。
* セキュアでないHTTPプロトコルはポート80を使用します。




=== SMTP

原則として、何らかの理由でHTTPS / HTTPが許可されていないかサポートされていない場合にのみSMTPを使用してください。次の点に注意してください。

* AutoSupport OnDemandおよび大容量ファイルの転送はサポートされていません。
* SMTPサインインクレデンシャルが設定されている場合は、暗号化されずにクリアで送信されます。
* HTTP転送のデフォルトの制限は5MBです。
* セキュアでないSMTPプロトコルはポート25を使用します。




=== TLSによるセキュリティの向上

HTTPまたはSMTPを使用する場合、すべてのトラフィックは暗号化されず、簡単に傍受して読み取ることができます。HTTPを使用する場合は、常にTLS（HTTPS）も使用するようにプロトコルを設定する必要があります。


NOTE: ONTAP 9.15.1以降では、SMTP（SMTPS）でTLSを使用することもできます。この場合、TCP接続の確立後にセキュアチャネルをアクティブにする_explicit tls_が使用されます。

.セキュアなプロトコル用のポート
一般に、これらのプロトコルのセキュアバージョンには次のポートが使用されます。

* HTTPS -ポート443
* SMTPS -ポート587


.証明書の検証
TLSでは、サーバからダウンロードした証明書は、ルートCA証明書に基づいてONTAPによって検証されます。HTTPSまたはSMTPSを使用する前に、ルート証明書がONTAPにインストールされていることを確認する必要があります。を参照してください <<サーバ証明書をインストールする>> を参照してください。



== 設定に関するその他の考慮事項

AutoSupportを設定する際には、さらにいくつかの考慮事項があります。



=== 電子メールを使用したローカルコピーの送信

NetAppへのAutoSupportメッセージの配信に使用されるプロトコルに関係なく、各メッセージのコピーを1つ以上のローカルメールアドレスに送信することもできます。たとえば、社内のサポート部門やパートナー組織にメッセージを送信できます。


NOTE: SMTP（またはSMTPS）を使用してNetAppにメッセージを配信し、それらのメッセージのローカルEメールコピーも送信する場合は、同じEメールサーバ設定が使用されます。



=== HTTP プロキシ

ネットワーク構成によっては、HTTPSプロトコルでプロキシURLの追加設定が必要になる場合があります。テクニカルサポートへのAutoSupportメッセージの送信にHTTPSを使用していて、プロキシを使用している場合は、プロキシのURLを指定する必要があります。プロキシがデフォルト以外のポート（ポート3128）を使用している場合は、そのプロキシのポートを指定できます。必要に応じて、プロキシ認証のユーザ名とパスワードを指定することもできます。



== サーバ証明書をインストールする

TLS（HTTPSまたはSMTPS）を使用する場合は、ONTAPがサーバ証明書を検証できることを確認する必要があります。この検証は、サーバ証明書に署名したCAに基づいて実行されます。

ONTAPには、多数のルートCA証明書が事前にインストールされています。そのため、多くの場合、サーバの証明書は追加の設定なしでONTAPによってすぐに認識されます。ただし、サーバ証明書の署名方法によっては、ルートCA証明書と中間証明書のインストールが必要になる場合があります。

必要に応じて、次の手順に従って証明書をインストールします。必要な証明書はすべてクラスタレベルでインストールする必要があります。

.手順
[role="tabbed-block"]
====
.System Manager の略
--
. System Managerで、*[クラスタ]*>*[設定]*を選択します。
. [セキュリティ]*セクションまで下にスクロールします。
. 選択するオプション image:icon_arrow.gif["右矢印"] をクリックします。
. [信頼された認証局]*タブで*[追加]*をクリックします。
. [インポート]*をクリックし、証明書ファイルを選択します。
. 環境に合わせて設定パラメータを設定します。
. [ 追加（ Add ） ] をクリックします。


--
.CLI の使用
--
. インストールを開始します。
+
`security certificate install -type server-ca`

. 次のコンソールメッセージを確認します。
+
`Please enter Certificate: Press <Enter> when done`

. 証明書ファイルをテキストエディタで開きます。
. 次の行を含む証明書全体をコピーします。
+
`-----BEGIN CERTIFICATE-----`

+
`-----END CERTIFICATE-----`

. コマンドプロンプトの後に証明書を端末に貼り付けます。
. Enter*キーを押してインストールを完了します。
. 次のいずれかを使用して証明書がインストールされていることを確認します。
+
`security certificate show-user-installed`

+
`security certificate show`



--
====