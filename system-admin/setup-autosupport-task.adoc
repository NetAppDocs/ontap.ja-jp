---
permalink: system-admin/setup-autosupport-task.html 
sidebar: sidebar 
keywords: autosupport, set up autosupport, technical support, internal support organization, AutoSupport messages, AutoSupport configuration, AutoSupport OnDemand, HTTPS, SMTP, email, proxy, mail host, DNS, TLS, AutoSupport history, AutoSupport check 
summary: ONTAPクラスタを構成して、AutoSupportメッセージをNetAppテクニカルサポートに配信し、社内のサポート組織に電子メールのコピーを送信します。 
---
= ONTAP AutoSupportのセットアップ
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
AutoSupportメッセージをNetAppテクニカル サポートに配信し、社内のサポート部門にEメール コピーを送信するように、ONTAPクラスタを設定できます。その一環として、本番環境で使用する前に構成をテストすることもできます。

.タスク概要
ONTAP 9.5以降では、クラスタ内のすべてのノードに対してAutoSupportを同時に有効化および設定できます。新しいノードがクラスタに参加すると、そのノードは自動的に同じAutoSupport設定を継承します。これをサポートするため、CLIコマンド `system node autosupport modify`のスコープはクラスタレベルです。 `-node`コマンドオプションは下位互換性のために保持されていますが、無視されます。


NOTE: ONTAP 9.4以前のリリースでは、 `system node autosupport modify`コマンドは各ノードに固有です。クラスタでONTAP 9.4以前を実行している場合は、クラスタ内の各ノードでAutoSupportを有効化および設定する必要があります。

.開始する前に
AutoSupportメッセージをNetAppに配信する際の推奨される転送設定はHTTPS（TLSを使用したHTTP）です。このオプションは、最も堅牢な機能と最高レベルのセキュリティを提供します。

ONTAPクラスタを構成する前に、詳細についてはlink:requirements-autosupport-reference.html["AutoSupportを使用するための準備"]を確認してください。

.手順
. AutoSupportが有効になっていることを確認します。
+
[listing]
----
system node autosupport modify -state enable
----
. NetAppテクニカル サポートがAutoSupportメッセージを受信できるようにするには、次のコマンドを使用します。
+
[listing]
----
system node autosupport modify -support enable
----
+
AutoSupportでAutoSupport OnDemandを使用可能にする場合や、大容量ファイル（コア ダンプ ファイルやパフォーマンス アーカイブ ファイルなど）をテクニカル サポートまたは指定のURLにアップロードする場合は、このオプションを有効にする必要があります。

+

NOTE: HTTPS転送プロトコルを使用してテクニカル サポートにメッセージを送信するよう設定している場合は、AutoSupport OnDemandがデフォルトで有効になっており、機能しています。

. NetAppテクニカルサポートがAutoSupportメッセージを受信できるように設定した場合は、これらのメッセージに使用するトランスポートプロトコルを指定します。
+
次のオプションから選択できます。

+
|===


| 状況 | 次に、 `system node autosupport modify` コマンドの次のパラメータを設定します... 


 a| 
デフォルトのHTTPSプロトコルを使用する
 a| 
..  `-transport`を `https`に設定します。
.. プロキシを使用する場合は、 `-proxy-url`をプロキシのURLに設定してください。この設定は、AutoSupport OnDemandとの通信と大きなファイルのアップロードをサポートします。




 a| 
SMTPを使用する
 a| 
 `-transport`を `smtp`に設定します。

この設定では、AutoSupport OnDemandや大容量ファイルのアップロードはサポートされません。

|===
. 社内のサポート部門またはサポート パートナーにAutoSupportメッセージを送信するには、次の操作を実行します。
+
..  `system node autosupport modify`コマンドの次のパラメータを設定して、組織内の受信者を識別します：
+
|===


| 設定するパラメータ | パラメータの値 


 a| 
`-to`
 a| 
重要なAutoSupportメッセージを受信する社内サポート組織内の最大5つの個別の電子メールアドレスまたは配布リストをコンマで区切って指定します



 a| 
`-noteto`
 a| 
携帯電話やその他のモバイルデバイス向けに設計された重要なAutoSupportメッセージの短縮版を受信する、社内サポート組織内の最大5つの個別の電子メールアドレスまたは配布リスト（カンマで区切る）



 a| 
`-partner-address`
 a| 
すべてのAutoSupportメッセージを受信するサポート パートナー組織内の最大 5 つの個別の電子メール アドレスまたは配布リストをコンマで区切って指定します

|===
..  `system node autosupport destinations show`コマンドを使用して宛先を一覧表示し、アドレスが正しく設定されていることを確認します。


. 前の手順で社内サポート組織の受信者アドレスを構成した場合、またはテクニカル サポートへのメッセージに SMTP トランスポートを選択した場合は、 `system node autosupport modify`コマンドの次のパラメータを設定して SMTP を構成します：
+
**  `-mail-hosts`を、カンマで区切った 1 つ以上のメール ホストに設定します。
+
最大5件のメール ホストを設定できます。

+
メール ホスト名の後にコロンとポート番号を指定することにより、各メール ホストのポート値を設定できます：たとえば、 `mymailhost.example.com:5678`では、5678がメール ホストのポートです。

**  `-from`をAutoSupportメッセージを送信するメールアドレスに設定します。


. DNS を設定します。
. （オプション）特定の設定を変更する場合は、コマンドのオプションを追加します。
+
|===


| 実行する処理 | 次に、 `system node autosupport modify` コマンドの次のパラメータを設定します... 


 a| 
メッセージ内の機密データの削除、マスキング、またはエンコーディングによってプライベート データを非表示にする
 a| 
 `-remove-private-data`を `true`に設定します。 `false`から `true`に変更すると、すべてのAutoSupport履歴とすべての関連ファイルが削除されます。



 a| 
定期的なAutoSupportメッセージでのパフォーマンス データの送信を停止する
 a| 
 `-perf`を `false`に設定します。

|===
. SMTPを使用してAutoSupportメッセージをNetAppに配信する場合は、必要に応じてTLSを有効にしてセキュリティを強化できます。
+
.. 新しいパラメータに使用できる値を表示します。
+
[listing]
----
cluster1::> system node autosupport modify -smtp-encryption ?
----
.. SMTPメッセージ配信に対してTLSを有効にします。
+
[listing]
----
cluster1::> system node autosupport modify -smtp-encryption start_tls
----
.. 現在の設定を表示します。
+
[listing]
----
cluster1::> system node autosupport show -fields smtp-encryption
----


.  `-node`パラメータを指定した `system node autosupport show`コマンドを使用して、全体的な構成を確認します。
.  `system node autosupport check show`コマンドを使用してAutoSupport操作を確認します。
+
問題が報告された場合は、 `system node autosupport check show-details` コマンドを使用して詳細情報を表示します。

. AutoSupportメッセージが送受信されていることをテストします。
+
..  `system node autosupport invoke`コマンドを `-type`パラメータを `test`に設定して使用します：
+
[listing]
----
cluster1::> system node autosupport invoke -type test -node node1
----
.. NetAppがAutoSupportメッセージを受信していることを確認します。
+
[listing]
----
system node autosupport history show -node local
----
+
最新の送信AutoSupportメッセージのステータスは、すべての適切なプロトコルの宛先に対して最終的に `sent-successful`に変更されるはずです。

.. オプションで、 `system node autosupport modify`コマンドの `-to`、 `-noteto`、または `-partner-address`パラメータに設定したアドレスの電子メールをチェックして、AutoSupportメッセージが社内のサポート組織またはサポート パートナーに送信されていることを確認します。




.関連情報
* link:../system-admin/requirements-autosupport-reference.html["AutoSupportを使用するための準備"]
* link:https://docs.netapp.com/us-en/ontap-cli/["ONTAPコマンド リファレンス"^]

