---
permalink: tape-backup/dump-backup-concept.html 
sidebar: sidebar 
keywords: dump, backup, qtree, file, system, data 
summary: ダンプバックアップでは、事前定義されたプロセスを使用して、ファイルシステムデータがディスクからテープに書き込まれます。バックアップできるのは、ボリューム、qtree、またはボリューム全体でもqtree全体でもないサブツリーです。 
---
= ONTAP NDMPでのダンプバックアップの仕組み
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ダンプバックアップでは、事前定義されたプロセスを使用して、ファイルシステムデータがディスクからテープに書き込まれます。バックアップできるのは、ボリューム、qtree、またはボリューム全体でもqtree全体でもないサブツリーです。

次の表に、ダンプパスで指定されたオブジェクトについて、 ONTAP が実行するバックアッププロセスを示します。

[cols="1,4"]
|===
| 段階 | アクション 


 a| 
1
 a| 
フルボリュームバックアップまたはフルqtreeバックアップ以外の場合、ONTAPはディレクトリをトラバースしてバックアップ対象のファイルを特定します。ボリューム全体またはqtree全体をバックアップする場合、ONTAPはこの段階を第2段階と組み合わせます。



 a| 
2
 a| 
フルボリュームバックアップまたはフルqtreeバックアップの場合、ONTAPはボリュームまたはqtree内のバックアップ対象のディレクトリを特定します。



 a| 
3
 a| 
ONTAPはディレクトリをテープに書き込みます。



 a| 
4
 a| 
ONTAPはファイルをテープに書き込みます。



 a| 
5
 a| 
ONTAPはACL情報（該当する場合）をテープに書き込みます。

|===
ダンプバックアップでは、バックアップにデータのSnapshotが使用されます。したがって、バックアップを開始する前にボリュームをオフラインにする必要はありません。

ダンプバックアップでは、作成した各Snapshotにという名前を付け `snapshot_for_backup.n`ます（ `n`は0から始まる整数）。ダンプバックアップでSnapshotが作成されるたびに、この整数が1ずつ増分されます。この整数は、ストレージシステムのリブート後に0にリセットされます。バックアップ処理が完了すると、ダンプエンジンによってこのSnapshotが削除されます。

ONTAPで複数のダンプバックアップを同時に実行すると、ダンプエンジンによって複数のSnapshotが作成されます。たとえば、ONTAPで2つのダンプバックアップを同時に実行すると、データのバックアップ元のボリューム内にとの `snapshot_for_backup.1`Snapshotが作成されます `snapshot_for_backup.0`。

[NOTE]
====
Snapshotからバックアップする場合、ダンプエンジンでは追加のSnapshotは作成されません。

====


== ダンプエンジンでバックアップされるデータの種類

ダンプエンジンを使用すると、データをテープにバックアップして災害やコントローラの停止から保護できます。ダンプエンジンでは、ファイル、ディレクトリ、 qtree 、ボリューム全体などのデータオブジェクトだけでなく、各ファイルに関するさまざまな種類の情報もバックアップできます。ダンプエンジンでバックアップできるデータの種類と考慮すべき制限を理解しておくと、ディザスタリカバリのアプローチを計画する際に役立ちます。

ダンプエンジンでは、ファイルのデータをバックアップするだけでなく、必要に応じて、各ファイルに関する次の情報もバックアップできます。

* UNIX GID 、所有者の UID 、およびファイルのアクセス権
* UNIX のアクセス時間、作成時間、および変更時間
* ファイルタイプ
* ファイルサイズ
* DOS 名、 DOS 属性、および作成時間
* 1 、 024 個の Access Control Entry （ ACE ；アクセス制御エントリ）を含む ACL
* qtree 情報
* ジャンクションパス


ジャンクションパスはシンボリックリンクとしてバックアップされます。

* LUN クローンおよび LUN クローン
+
LUN オブジェクト全体をバックアップできますが、 LUN オブジェクト内の個別のファイルをバックアップすることはできません。同様に、 LUN オブジェクト全体をリストアできますが、 LUN オブジェクト内の個別のファイルをリストアすることはできません。

+
[NOTE]
====
ダンプエンジンでバックアップした LUN クローンは、独立した LUN になります。

====
* VM-aligned ファイル
+
Data ONTAP 8.1.2 より前のリリースでは、 VM-aligned ファイルのバックアップはサポートされていません。



[NOTE]
====
Snapshot でバックアップされた LUN クローンを Data ONTAP 7-Mode から ONTAP に移行した場合、一貫性のない LUN になります。ダンプエンジンでは、一貫性のない LUN はバックアップされません。

====
データをボリュームにリストアする場合は、リストア対象の LUN でクライアント I/O が制限されます。LUN に関するこの制限が解除されるのは、ダンプリストア処理が完了した場合のみです。同様に、 SnapMirror による単一ファイルまたは LUN のリストア処理中は、リストア対象のファイルと LUN でクライアント I/O が制限されます。この制限が解除されるのは、単一ファイル / LUN のリストア処理が完了した場合のみです。ダンプリストアまたは SnapMirror による単一ファイルまたは LUN のリストア処理を実行中のボリュームでダンプバックアップが実行される場合は、クライアント I/O が制限されているファイルまたは LUN がバックアップに含まれません。クライアント I/O の制限が解除されると、これらのファイルまたは LUN は後続のバックアップ処理に含まれます。

[NOTE]
====
Data ONTAP 8.3 で実行されているテープにバックアップした LUN は、 8.3 以降のリリースにのみリストアできます。 8.3 より前のリリースにはリストアできません。以前のリリースに LUN をリストアする場合、その LUN はファイルとしてリストアされます。

====
SnapVault セカンダリボリュームまたは Volume SnapMirror デスティネーションをテープにバックアップする場合は、ボリュームのデータだけがバックアップされます。関連付けられているメタデータはバックアップされません。したがって、ボリュームをリストアしようとすると、そのボリュームのデータだけがリストアされます。Volume SnapMirror 関係に関する情報はバックアップで使用できないため、リストアされません。

Windows NT のアクセス権しかないファイルをダンプし、 UNIX 形式の qtree またはボリュームにリストアした場合、リストアされたファイルには、その qtree またはボリュームに対する UNIX のデフォルトのアクセス権が付与されます。

UNIX のアクセス権しかないファイルをダンプし、 NTFS 形式の qtree またはボリュームにリストアした場合、リストアされたファイルには、その qtree またはボリュームに対する Windows のデフォルトのアクセス権が付与されます。

それ以外の場合は、ダンプとリストア後もアクセス権は維持

VM-alignedファイルとオプションをバックアップできます `vm-align-sector`。VM-alignedファイルの詳細については、を参照してくださいlink:../volumes/index.html["論理ストレージ管理"]。
