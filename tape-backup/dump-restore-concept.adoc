---
permalink: tape-backup/dump-restore-concept.html 
sidebar: sidebar 
keywords: dump, restore, file, write, system, data, disk 
summary: ダンプ リストアでは、事前定義されたプロセスを使用して、ファイル システム データをテープ デバイスからディスクに書き込みます。 
---
= ONTAP NDMPでのダンプリストアの仕組み
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ダンプ リストアでは、事前定義されたプロセスを使用して、ファイル システム データをテープ デバイスからディスクに書き込みます。

次の表のプロセスは、ダンプのリストアがどのように機能するかを示しています：

[cols="1,4"]
|===
| 段階 | アクション 


 a| 
1
 a| 
ONTAPは、テープから抽出する必要があるファイルをカタログ化します。



 a| 
2
 a| 
ONTAPはディレクトリと空のファイルを作成します。



 a| 
3
 a| 
ONTAPはテープからファイルを読み取り、ディスクに書き込み、そのファイルに権限（ACLを含む）を設定します。



 a| 
4
 a| 
ONTAPは、指定されたすべてのファイルがテープからコピーされるまで、ステージ2と3を繰り返します。

|===


== ダンプ エンジンでリストアされるデータの種類

災害やコントローラーの障害が発生した場合、ダンプ エンジンは、単一のファイルからファイル属性、ディレクトリ全体まで、バックアップしたすべてのデータをリカバリするための複数の方法を提供します。ダンプ エンジンがリストアできるデータのタイプと、どのリカバリ方法をいつ使用するかを知っておくことで、ダウンタイムを最小限に抑えることができます。

マッピングされたオンラインのLUNにデータをリストアできます。ただし、リストア処理が完了するまで、ホスト アプリケーションはこのLUNにアクセスできません。リストア処理が完了したら、LUNデータのホスト キャッシュをフラッシュして、リストアされたデータとの一貫性を確保する必要があります。

ダンプ エンジンでは、次のデータをリカバリできます。

* ファイルとディレクトリの内容
* UNIXファイル権限
* ACL
+
UNIXファイル権限のみを持つファイルをNTFS qtreeまたはボリュームにリストアした場合、そのファイルにはWindows NT ACLは設定されません。ストレージ システムは、このファイルにWindows NT ACLが作成されるまで、UNIXファイル権限のみを使用します。

+
[NOTE]
====
Data ONTAP 8.2を実行しているストレージ システムからバックアップされたACLを、ACE制限が1,024未満のData ONTAP 8.1.x以前を実行しているストレージ システムに復元すると、デフォルトのACLが復元されます。

====
* qtree情報
+
qtree情報は、qtreeがボリュームのルートにリストアされる場合にのみ使用されます。qtree情報は、qtreeが `/vs1/vol1/subdir/lowerdir`などの下位ディレクトリにリストアされ、qtreeでなくなる場合は使用されません。

* その他すべてのファイルとディレクトリの属性
* Windows NTストリーム
* LUN
+
** LUNをLUNとして残すには、ボリューム レベルまたはqtreeレベルに復元する必要があります。
+
ディレクトリに復元する場合は、有効なメタデータが含まれていないため、ファイルとして復元されます。

** 7-Mode LUN は ONTAP ボリューム上の LUN として復元されます。


* 7-ModeボリュームはONTAPボリュームに復元できます。
* デスティネーション ボリュームにリストアされたVMアライン ファイルは、デスティネーション ボリュームのVMアライン プロパティを継承します。
* 復元操作のデスティネーション ボリュームには、必須ロックまたは勧告ロックが設定されたファイルが含まれている可能性があります。
+
このような宛先ボリュームへの復元操作を実行する際、dumpエンジンはこれらのロックを無視します。


