---
permalink: tape-backup/dump-restore-concept.html 
sidebar: sidebar 
keywords: dump, restore, file, write, system, data, disk 
summary: ダンプリストアは、定義済みのプロセスに基づいてテープからディスクにファイルシステムのデータを書き込みます。 
---
= ONTAP NDMP でのダンプリストアの仕組み
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ダンプリストアは、定義済みのプロセスに基づいてテープからディスクにファイルシステムのデータを書き込みます。

次の表に、ダンプリストアの動作を示します。

[cols="1,4"]
|===
| 段階 | アクション 


 a| 
1
 a| 
ONTAP により、テープから抽出する必要のあるファイルがカタログ化されます。



 a| 
2
 a| 
ONTAP は、ディレクトリと空のファイルを作成します。



 a| 
3
 a| 
ONTAP は、テープからファイルを読み取り、ディスクに書き込み、 ACL などのアクセス権を設定します。



 a| 
4
 a| 
指定したファイルがテープからすべて複製されるまで、 ONTAP はステージ 2 と 3 を繰り返します。

|===


== ダンプエンジンでリストアされるデータの種類

災害が発生したりコントローラが停止した場合、ダンプエンジンでは、単一ファイルからファイル属性やディレクトリ全体まで、バックアップしたすべてのデータをさまざまな方法でリカバリできます。ダンプエンジンでリストアできるデータの種類と使用するリカバリ方法を理解しておくと、ダウンタイムを最小限に抑えるのに役立ちます。

マッピングされたオンラインのLUNにデータをリストアできます。ただし、リストア処理が完了するまで、ホストアプリケーションはこのLUNにアクセスできません。リストア処理の完了後、LUNデータのホストキャッシュをフラッシュして、リストアされたデータとの一貫性を確保する必要があります。

ダンプエンジンでは次のデータをリカバリできます。

* ファイルおよびディレクトリの内容
* UNIX ファイルアクセス権
* ACL
+
UNIX ファイルアクセス権だけを持つファイルを NTFS の qtree またはボリュームにリストアした場合、そのファイルには Windows NT ACL が含まれません。対象のファイルについて Windows NT ACL を作成しないかぎり、ストレージシステムではこのファイルに対して UNIX ファイルアクセス権だけを使用します。

+
[NOTE]
====
Data ONTAP 8.2 を実行するストレージシステムから、 Data ONTAP 8.1.x 以前を実行するストレージシステムに ACE の最大数が 1 、 024 より小さい ACL をリストアした場合、デフォルトの ACL がリストアされます。

====
* qtree 情報
+
qtree 情報は、 qtree がボリュームのルートにリストアされる場合にのみ使用されます。などの下位のディレクトリにqtreeをリストアすると、qtree情報は使用されず、qtreeとしての機能は失われ `/vs1/vol1/subdir/lowerdir`ます。

* その他のすべてのファイルおよびディレクトリ属性
* Windows NT ストリーム
* LUN
+
** LUN としての機能を維持するには、 LUN をボリュームレベルまたは qtree レベルでリストアする必要があります。
+
ディレクトリにリストアすると、有効なメタデータが含まれないため、ファイルとしてリストアされます。

** 7-Mode LUN は、 ONTAP ボリュームで LUN としてリストアされます。


* 7-Mode ボリュームは、 ONTAP ボリュームにリストアできます。
* デスティネーションボリュームにリストアされた VM-aligned ファイルは、デスティネーションボリュームの VM-align のプロパティを継承します。
* リストア処理のデスティネーションボリュームに、強制ロックまたは助言ロックが設定されたファイルが含まれていることがあります。
+
そのようなデスティネーションボリュームへのリストア処理を実行する場合、ダンプエンジンはそれらのロックを無視します。


