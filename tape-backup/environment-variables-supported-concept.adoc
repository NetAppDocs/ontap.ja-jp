---
permalink: tape-backup/environment-variables-supported-concept.html 
sidebar: sidebar 
keywords: environment, variables, ontap, ndmp, restore, operation, backup, default, value, dump, smtape 
summary: 環境変数は、 NDMP 対応のバックアップアプリケーションとストレージシステムの間でバックアップまたはリストア処理に関する情報をやり取りするために使用されます。ONTAP でサポートされる環境変数には、デフォルト値が関連付けられています。ただし、これらのデフォルト値は手動で変更できます。 
---
= ONTAP でサポートされる環境変数
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
環境変数は、 NDMP 対応のバックアップアプリケーションとストレージシステムの間でバックアップまたはリストア処理に関する情報をやり取りするために使用されます。ONTAP でサポートされる環境変数には、デフォルト値が関連付けられています。ただし、これらのデフォルト値は手動で変更できます。

バックアップアプリケーションによって設定された値を手動で変更すると、アプリケーションが想定外の動作をする可能性があります。これは、バックアップアプリケーションで想定されているバックアップまたはリストアとは異なる処理が行われるためです。ただし、変更を適切に行うと、問題の特定や回避に役立つ場合があります。

次の表は、動作がダンプと SMTape で共通であり、ダンプと SMTape でのみサポートされる環境変数を示しています。また、 ONTAP でサポートされる環境変数が使用された場合の動作の説明も記載されています。

[NOTE]
====
ほとんどの場合、値を持つ変数は、 `Y` 同意することもできます `T` および `N` 同意することもできます `F`。

====


== ダンプと SMTape 用にサポートされる環境変数

|===
| 環境変数 | 有効な値： | デフォルト | 説明 


 a| 
デバッグ
 a| 
`Y` または `N`
 a| 
`N`
 a| 
デバッグ情報を出力するように指定します。



 a| 
ファイルシステム
 a| 
`string`
 a| 
`none`
 a| 
バックアップされるデータのルートのパス名を指定します。



 a| 
NDMP_VERSION
 a| 
`return_only`
 a| 
`none`
 a| 
NDMP_VERSION 変数は変更しないでください。NDMP_VERSION 変数はバックアップ処理によって作成され、 NDMP のバージョンを返します。

ONTAP は、内部使用のため、および情報としてバックアップアプリケーションに渡すために、バックアップ時に NDMP_VERSION 変数を設定します。NDMP セッションの NDMP バージョンは、この変数では設定されません。



 a| 
pathname_separator
 a| 
`return_value`
 a| 
`none`
 a| 
パス名の区切り文字を指定します。

この文字は、バックアップ対象のファイルシステムによって異なります。ONTAP の場合、文字 "`/`" はこの変数に割り当てられます。NDMP サーバでは、この変数を設定してからテープバックアップ処理を開始します。



 a| 
を入力します
 a| 
`dump` または `smtape`
 a| 
`dump`
 a| 
テープバックアップおよびリストア処理の実行がサポートされているバックアップのタイプを指定します。



 a| 
詳細
 a| 
`Y` または `N`
 a| 
`N`
 a| 
テープバックアップまたはリストア処理の実行中のログメッセージの数を増やします。

|===


== ダンプ用にサポートされる環境変数

|===
| 環境変数 | 有効な値： | デフォルト | 説明 


 a| 
acl_start
 a| 
`return_only`
 a| 
`none`
 a| 
ACL_START 変数は、バックアップ処理によって作成され、直接アクセスリストアまたは再開可能 NDMP バックアップ処理で使用されるオフセット値を示します。

オフセット値は、ダンプファイル内で ACL データ（ Pass V ）が始まるバイトオフセットであり、バックアップ終了時に返されます。直接アクセスリストア処理でバックアップデータを正しくリストアするには、開始時に ACL_START 値がリストア処理に渡されなければなりません。NDMP 再開可能バックアップ処理では、 ACL_START 値を使用して、バックアップストリームで再開できない部分の開始位置をバックアップアプリケーションに伝えます。



 a| 
BASE_DATE
 a| 
`0`、 `-1`または `DUMP_DATE` 価値
 a| 
`-1`
 a| 
増分バックアップの開始日を指定します。

に設定すると `-1`では、BASE_DATE増分指定子は無効になっています。に設定すると `0` レベル0バックアップでは、増分バックアップが有効になります。最初のバックアップ後、前回の増分バックアップの DUMP_DATE 変数の値が BASE_DATE 変数に代入されます。

これらの変数は、 LEVEL または UPDATE に基づく増分バックアップに代わるものです。



 a| 
直接
 a| 
`Y` または `N`
 a| 
`N`
 a| 
リストアの際に、テープ全体をスキャンするのではなく、ファイルデータがある場所まで直接早送りするように指定します。

直接アクセスリカバリを使用するには、バックアップアプリケーションが位置情報を提供する必要があります。この変数がに設定されている場合 `Y`では、バックアップアプリケーションによって、ファイルまたはディレクトリの名前と位置情報が指定されます。



 a| 
dmp_name
 a| 
`string`
 a| 
`none`
 a| 
複数サブツリーバックアップの名前を指定します。

この変数は、複数サブツリーバックアップに必須です。



 a| 
DUMP_DATE
 a| 
`return_value`
 a| 
`none`
 a| 
この変数を直接変更することはありません。BASE_DATE変数が以外の値に設定された場合にバックアップによって作成されます `-1`。

DUMP_DATE 変数は、ダンプソフトウェアによって計算された 32 ビットの時刻値の前に 32 ビットのレベル値を付けることによって生成されます。レベルは、 BASE_DATE 変数に最後に渡されたレベル値から増分されます。作成された値は、次回の増分バックアップの BASE_DATE 値として使用されます。



 a| 
ENHANCED_DAR_ENABLED 環境
 a| 
`Y` または `N`
 a| 
`N`
 a| 
拡張 DAR 機能が有効になっているかどうかを示します。拡張 DAR 機能では、ディレクトリ DAR および NT ストリームを含むファイルの DAR をサポートします。パフォーマンスが向上します。

リストア時に拡張 DAR 機能を使用できるのは、次の条件が満たされている場合のみです。

* ONTAP で拡張 DAR がサポートされている。
* バックアップ時にファイル履歴が有効である（ HIST=Y ）。
* 。 `ndmpd.offset_map.enable` オプションはに設定されています `on`。
* ENHANCED_DAR_ENABLED変数がに設定されている `Y` リストア中。




 a| 
除外する
 a| 
`pattern_string`
 a| 
`none`
 a| 
データのバックアップ時に除外するファイルまたはディレクトリを指定します。

除外リストは、ファイル名またはディレクトリ名をカンマで区切ったリストです。ファイルまたはディレクトリの名前がリスト内の名前の 1 つに一致した場合、バックアップから除外されます。

除外リストで名前を指定する際に適用されるルールは次のとおりです。

* 正確なファイル名またはディレクトリ名を使用する必要があります。
* ワイルドカード文字であるアスタリスク（ * ）は、文字列の最初または最後の文字にする必要があります。
+
使用できるアスタリスクの数は文字列ごとに 2 つです。

* ファイル名またはディレクトリ名のカンマの前にバックスラッシュを付ける必要があります。
* 除外リストに含めることができる名前は 32 個までです。


[NOTE]
====
NON_QUOTA_TREEをに設定している場合、バックアップから除外するように指定したファイルまたはディレクトリは除外されません `Y` 同時に。

====


 a| 
抽出（ Extract ）
 a| 
`Y`、 `N`または `E`
 a| 
`N`
 a| 
バックアップデータセットのサブツリーをリストアするように指定します。

バックアップアプリケーションでは、抽出するサブツリーの名前を指定します。指定されたファイルが、内容がバックアップされたディレクトリに一致する場合、ディレクトリは再帰的に抽出されます。

DARを使用せずに、リストア時にファイル、ディレクトリ、またはqtreeの名前を変更するには、EXTRACT環境変数をに設定する必要があります `E`。



 a| 
extract_acl
 a| 
`Y` または `N`
 a| 
`Y`
 a| 
リストア処理でバックアップファイルの ACL がリストアされるように指定します。

デフォルトでは、 DAR （ DIRECT=Y ）を除いて、データをリストアするときに ACL がリストアされます。



 a| 
[-force]
 a| 
`Y` または `N`
 a| 
`N`
 a| 
デスティネーションボリュームで使用可能なボリュームスペースと inode をリストア処理で確認する必要があるかどうかを指定します。

この変数をに設定します `Y` デスティネーションパスで使用可能なボリュームスペースとinodeの確認をリストア処理でスキップします。

デスティネーションボリュームのボリュームスペースまたは inode が不足している場合は、デスティネーションボリュームで使用可能なボリュームスペースと inode で許容される量のデータがリストア処理によってリカバリされます。ボリュームスペースと inode を使用できない場合は、リストア処理が停止します。



 a| 
霧
 a| 
`Y` または `N`
 a| 
`N`
 a| 
ファイル履歴情報をバックアップアプリケーションに送信するように指定します。

ほとんどの市販のバックアップアプリケーションでは、HIST変数をに設定します `Y`。バックアップ処理の速度を上げる場合や、ファイル履歴収集に関する問題のトラブルシューティングを行う場合は、この変数をに設定できます `N`。

[NOTE]
====
HIST変数をに設定しないでください `Y` バックアップアプリケーションがファイル履歴をサポートしていない場合。

====


 a| 
IGNORE_CTime
 a| 
`Y` または `N`
 a| 
`N`
 a| 
前回の増分バックアップ以降に変更されたのが ctime 値だけである場合は、ファイルを増分バックアップしないことを指定します。

ウィルススキャンソフトウェアなどの一部のアプリケーションは、ファイルやファイル属性が変更されていなくても、 inode 内のファイルの ctime 値を変更します。その結果、変更されていないファイルが増分バックアップによってバックアップされることがあります。。 `IGNORE_CTIME` ctimeの値が変更されたために、増分バックアップに許容範囲を超える時間または容量が消費される場合にのみ、変数を指定してください。

[NOTE]
====
。 `NDMP dump` コマンドセット `IGNORE_CTIME` 終了： `false` デフォルトではに設定します `true` データが失われる可能性があります。

. 状況 `IGNORE_CTIME` は、ボリュームレベルの増分でtrueに設定されます `ndmpcopy`を指定すると、ファイルが削除され、ソースのqtree間で移動されます。
. 状況 `IGNORE_CTIME` ボリュームレベルの増分ダンプでtrueに設定されている場合、ファイルが削除され、増分リストア時にソースのqtree間で移動されます。


この問題を回避するには、 `IGNORE_CTIME` ボリュームレベルではfalseに設定する必要があります `NDMP dumps` または `ndmpcopy`。

====


 a| 
IGNORE_qtrees
 a| 
`Y` または `N`
 a| 
`N`
 a| 
リストア処理でバックアップ qtree から qtree 情報をリストアしないことを指定します。



 a| 
「レベル」
 a| 
`0`-`31`
 a| 
`0`
 a| 
バックアップレベルを指定します。

レベル 0 では、データセット全体がコピーされます。0 より大きい値で指定された増分バックアップレベルでは、前回の増分バックアップ以降に新規作成または変更されたすべてのファイルがコピーされます。たとえば、レベル 1 では、レベル 0 バックアップ以降に新規または変更されたファイルがバックアップされ、レベル 2 ではレベル 1 バックアップ以降に新規または変更されたファイルがバックアップされます。



 a| 
リスト
 a| 
`Y` または `N`
 a| 
`N`
 a| 
データを実際にはリストアせずに、バックアップファイル名と inode 番号を一覧表示します。



 a| 
リスト qtree
 a| 
`Y` または `N`
 a| 
`N`
 a| 
データを実際にはリストアせずに、バックアップ qtree を一覧表示します。



 a| 
multi_subtree_names
 a| 
`string`
 a| 
`none`
 a| 
バックアップが複数のサブツリーであることを指定します。

複数のサブツリーは、改行で区切られた null で終わるサブツリー名のリストの文字列で指定されます。サブツリーは、共通のルートディレクトリを基準とした相対パス名で指定されます。このパス名は、リストの最後の要素として指定する必要があります。

この変数を使用する場合は、 DMP_NAME 変数も使用する必要があります。



 a| 
NDMP_Unicode_FH
 a| 
`Y` または `N`
 a| 
`N`
 a| 
ファイルの NFS 名のほかに Unicode 名もファイル履歴情報に含めるように指定します。

このオプションは、ほとんどのバックアップアプリケーションでは使用されないため、バックアップアプリケーションがこれらの追加のファイル名を受け取るように設計されている場合以外は設定しないでください。HIST 変数も設定する必要があります。



 a| 
no_ACLs
 a| 
`Y` または `N`
 a| 
`N`
 a| 
データのバックアップ時に ACL をコピーしないように指定します。



 a| 
NON_QUOTA_TREE
 a| 
`Y` または `N`
 a| 
`N`
 a| 
データのバックアップ時に qtree 内のファイルおよびディレクトリを無視するように指定します。

に設定すると `Y`を指定すると、FILESYSTEM変数によって指定されたデータセット内のqtreeの項目はバックアップされません。この変数は、 FILESYSTEM 変数でボリューム全体が指定された場合のみ有効になります。NON_QUOTA_TREE 変数は、レベル 0 バックアップでのみ機能し、 MULTI_SUBTREE_NAMES 変数が指定された場合は機能しません。

[NOTE]
====
NON_QUOTA_TREEをに設定している場合、バックアップから除外するように指定したファイルまたはディレクトリは除外されません `Y` 同時に。

====


 a| 
NOWRITE
 a| 
`Y` または `N`
 a| 
`N`
 a| 
リストア処理でデータをディスクに書き込まないように指定します。

この変数はデバッグに使用されます。



 a| 
再帰的
 a| 
`Y` または `N`
 a| 
`Y`
 a| 
DAR リストア中にディレクトリエントリが拡張されるように指定します。

DIRECTおよびENHANCED_DAR_ENABLED環境変数が有効になっている必要があります（に設定） `Y`）も同様です。RECURSIVE変数がディセーブルの場合（に設定） `N`）を指定すると、元のソースパスのすべてのディレクトリに対する権限とACLだけがテープからリストアされ、ディレクトリの内容はリストアされません。RECURSIVE変数がに設定されている場合に使用します `N` またはRECOVER_FULL_PATHS変数がに設定されます `Y`リカバリパスは元のパスで終了する必要があります。

[NOTE]
====
RECURSIVE 変数が無効で、複数のリカバリパスがある場合には、すべてのリカバリパスを最長のリカバリパス内に含める必要があります。それ以外の場合は、エラーメッセージが表示されます。

====
たとえば、次に示すリカバリパスはに含まれているため、すべて有効です `foo/dir1/deepdir/myfile`：

* `/foo`
* `/foo/dir`
* `/foo/dir1/deepdir`
* `/foo/dir1/deepdir/myfile`


次のリカバリパスは無効です。

* `/foo`
* `/foo/dir`
* `/foo/dir1/myfile`
* `/foo/dir2`
* `/foo/dir2/myfile`




 a| 
RECOVER_FULL_paths
 a| 
`Y` または `N`
 a| 
`N`
 a| 
フルリカバリパスの権限および ACL が、 DAR のあとでリストアされるように指定します。

DIRECTおよびENHANCED_DAR_ENABLED環境変数が有効になっている必要があります（に設定） `Y`）も同様です。RECOVER_FULL_PATHSがに設定されている場合 `Y`リカバリパスは元のパスで終了する必要があります。デスティネーションボリュームにすでにディレクトリが存在する場合は、権限および ACL はテープからリストアされません。



 a| 
更新
 a| 
`Y` または `N`
 a| 
`Y`
 a| 
レベルベースの増分バックアップを有効にするために、メタデータ情報を更新します。

|===


== SMTape 用にサポートされる環境変数

|===
| 環境変数 | 有効な値： | デフォルト | 説明 


 a| 
BASE_DATE
 a| 
`DUMP_DATE`
 a| 
`-1`
 a| 
増分バックアップの開始日を指定します。

 `BASE_DATE` は、参照Snapshot識別子の文字列表現です。を使用する `BASE_DATE` SMTapeでは、参照Snapshotコピーを検索します。

 `BASE_DATE` は、ベースラインバックアップの場合は必要ありません。増分バックアップの場合は、の値 `DUMP_DATE` 前回のベースラインバックアップまたは増分バックアップの変数がに割り当てられます `BASE_DATE` 変数（Variable）：

バックアップアプリケーションによってが割り当てられます `DUMP_DATE` 前回のSMTapeのベースラインバックアップまたは増分バックアップの値。



 a| 
DUMP_DATE
 a| 
`return_value`
 a| 
`none`
 a| 
SMTape バックアップの終了時、 DUMP_DATE には、そのバックアップに使用される Snapshot コピーを識別する文字列識別子が含まれています。この Snapshot コピーを、次回の増分バックアップの参照 Snapshot コピーとして使用できます。

結果の DUMP_DATE の値が、次回の増分バックアップの BASE_DATE 値として使用されます。



 a| 
smtape _backup_set_ID
 a| 
`string`
 a| 
`none`
 a| 
ベースラインバックアップに関連付けられた増分バックアップのシーケンスを識別します。

バックアップセット ID は、ベースラインバックアップで生成される 128 ビットの一意の ID です。バックアップアプリケーションは、このIDをに入力として割り当てます `SMTAPE_BACKUP_SET_ID` 増分バックアップ時に変数が使用されます。



 a| 
smtape snapshot _name
 a| 
ボリューム内にある有効な Snapshot コピー
 a| 
`Invalid`
 a| 
SMTAPE_SNAPSHOT_NAME 変数を Snapshot コピーに設定すると、その Snapshot コピーと古い Snapshot コピーがテープにバックアップされます。

増分バックアップの場合は、この変数によって増分 Snapshot コピーが指定されます。BASE_DATE 変数はベースライン Snapshot コピーを指定します。



 a| 
smtape delete _snapshot
 a| 
`Y` または `N`
 a| 
`N`
 a| 
SMTAPE_DELETE_SNAPSHOT変数がに設定されている場合は、SMTapeで自動的に作成されるSnapshotコピーでは `Y`をクリックすると、バックアップ処理の完了後に、SMTapeはこのSnapshotコピーを削除します。ただし、バックアップアプリケーションで作成された Snapshot コピーは削除されません。



 a| 
smtape break _mirror
 a| 
`Y` または `N`
 a| 
`N`
 a| 
SMTAPE_BREAK_MIRROR変数がに設定されている場合 `Y`をクリックします `DP` がに変更されます `RW` リストアが成功したあとのボリューム。

|===