---
sidebar: sidebar 
permalink: task_nas_enable_nfs_and_smb.html 
keywords: ontap, netapp, provision nas storage, linux, windows, NFS, SMB, SMB, CIFS, enable NFS, enable SMB, configure DNS, modify storage VM, configure DNS, configure name server, configure Kerberos, map user names 
summary: LinuxおよびWindowsクライアントにデータを提供するために、Storage VMを変更してNFSサーバとSMBサーバを有効にします。 
---
= ONTAP System Managerで NFS と SMB の両方を使用して Windows と Linux の両方で NAS ストレージを有効にする
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
LinuxおよびWindowsクライアントにデータを提供するために、Storage VMを作成または変更してNFSサーバとSMBサーバを有効にします。

この手順を使用して、新規または既存のStorage VMでNFSとSMBの両方のプロトコルに対応できるようにします。

image:workflow_nas_enable_nfs_and_smb.png["ワークフローの概要：1 NFS を有効にする 2 SMB を有効にする 3 ルートボリュームエクスポートポリシーを開く 4 DNS を構成する 5 ネームサービスを構成する 6 必要に応じて暗号化を構成する 7 必要に応じて UNIX および Windows ユーザー名をマップする"]

.開始する前に
環境に必要なネットワーク、認証、セキュリティのサービスについて、設定の詳細を忘れないようにメモしておきます。

.手順
. Storage VMでNFSとSMBを有効にします。
+
.. 新しいストレージ VM の場合：*ストレージ > ストレージ VM* をクリックし、*追加* をクリックしてストレージ VM 名を入力し、*SMB/CIFS、NFS、S3* タブで *SMB/CIFS を有効にする* と *NFS を有効にする* を選択します。
.. 次の情報を入力してください：
+
*** 管理者の名前とパスワード
*** サーバ名
*** Active Directoryドメイン


.. 組織単位を確定します。
.. DNS値を確定します。
.. デフォルトの言語を確定します。
.. ネットワーク インターフェイスを追加します。
.. Storage VMの管理者アカウントの情報を更新します（オプション）。
.. 既存のストレージVMの場合：*ストレージ > ストレージVM*をクリックし、ストレージVMを選択して*設定*をクリックします。NFSまたはSMBがまだ有効になっていない場合は、以下のサブ手順を実行してください。
+
*** *NFS*の下にあるimage:icon_gear.gif["アクションアイコン"]をクリックします。
*** *SMB*の下のimage:icon_gear.gif["アクションアイコン"]をクリックします。




. Storage VMルート ボリュームのエクスポート ポリシーを開きます。
+
.. *[ストレージ] > [ボリューム]*をクリックし、Storage VMのルート ボリューム（デフォルトでは_volume-name_root_）を選択して、*[エクスポート ポリシー]*に表示されるポリシーをクリックします。
.. *[追加]*をクリックしてルールを追加します。
+
*** クライアント仕様 = `0.0.0.0/0`
*** アクセス プロトコル = NFS
*** アクセスの詳細 = NFS読み取り専用




. ホスト名解決に使用するDNSを設定します。
+
.. *ストレージ > ストレージ VM* をクリックし、ストレージ VM を選択して、*設定* をクリックし、*DNS* の下の image:icon_gear.gif["アクションアイコン"] をクリックします。
.. DNSの設定が完了したら、DNSサーバに切り替えてSMBサーバをマッピングします。
+
*** フォワード ルックアップ（A - アドレス レコード）とリバース ルックアップ（PTR - ポインタ レコード）のエントリを作成して、SMBサーバ名をデータ ネットワーク インターフェイスのIPアドレスにマッピングします。
*** NetBIOSエイリアスを使用する場合は、エイリアスの正規名（CNAMEリソース レコード）のルックアップ エントリを作成して、各エイリアスをSMBサーバのデータ ネットワーク インターフェイスのIPアドレスにマッピングします。




. 必要に応じて名前サービスを設定します：
+
.. *ストレージ > ストレージ VM* をクリックし、ストレージ VM を選択して、*設定* をクリックし、LDAP または NIS の image:icon_gear.gif["アクションアイコン"] をクリックします。
.. 名前サービス スイッチ ファイルに変更内容を含めます（*名前サービス スイッチ*の下のimage:icon_pencil.gif["編集アイコン"]をクリック）。


. 必要に応じて、Kerberosを設定します。
+
.. *[ストレージ] > [Storage VM]*をクリックし、Storage VMを選択して*[設定]*をクリックします。
.. Kerberos タイルの image:icon_arrow.gif["矢印アイコン"] をクリックし、* Add * をクリックします。


. 必要に応じて UNIX および Windows ユーザー名をマップします：*名前マッピング*の下のimage:icon_arrow.gif["矢印アイコン"]をクリックし、*追加*をクリックします。
+
この手順は、WindowsとUNIXのユーザ アカウントが暗黙的にマッピングされない場合にのみ使用します。小文字のWindowsユーザ名がUNIXユーザ名と一致していれば、ユーザ名は暗黙的にマッピングされます。ユーザ名は、LDAP、NIS、またはローカル ユーザを使用してマッピングできます。一致しない2組のユーザ セットがある場合、ネーム マッピングを設定する必要があります。


