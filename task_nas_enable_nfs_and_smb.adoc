---
sidebar: sidebar 
permalink: task_nas_enable_nfs_and_smb.html 
keywords: ontap, netapp, provision nas storage, linux, windows, NFS, SMB, SMB, CIFS, enable NFS, enable SMB, configure DNS, modify storage VM, configure DNS, configure name server, configure Kerberos, map user names 
summary: Storage VM を変更して、 NFS サーバと SMB サーバが Linux クライアントや Windows クライアントにデータを提供できるようにします。 
---
= NFS と SMB の両方を使用して、 Windows と Linux の両方で NAS ストレージを有効にします
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Storage VMを作成または変更して、NFSサーバとSMBサーバがLinuxクライアントやWindowsクライアントにデータを提供できるようにします。

新規または既存のStorage VMが、この手順を使用してNFSプロトコルとSMBプロトコルの両方を提供できるようにします。

image:workflow_nas_enable_nfs_and_smb.png["NFS と SMB を使用して Linux サーバと Windows サーバの両方で NAS を有効にするワークフロー図"]

.作業を開始する前に
環境で必要なネットワークサービス、認証サービス、またはセキュリティサービスの設定の詳細をメモしておいてください。

.手順
. Storage VMでNFSとSMBを有効にする
+
.. 新しいStorage VMの場合：* Storage > Storage VM*をクリックし、* Add *をクリックしてStorage VM名を入力し、* SMB / CIFS、NFS、S3 *タブで* SMB / CIFSの有効化*と* NFSの有効化*を選択します。
.. 次の情報を入力します。
+
*** 管理者の名前とパスワード
*** サーバ名
*** Active Directoryドメイン


.. 組織単位を確認します。
.. DNS値を確認します。
.. デフォルトの言語を確認します。
.. ネットワークインターフェイスを追加
.. Storage VM管理者アカウント情報を更新する（オプション）。
.. 既存のStorage VMの場合：* Storage > Storage VM*をクリックし、Storage VMを選択して* Settings *をクリックします。NFSまたはSMBがまだ有効になっていない場合は、次のサブ手順を実行します。
+
*** をクリックします image:icon_gear.gif["設定アイコン"] NFS * 。
*** をクリックします image:icon_gear.gif["設定アイコン"] * SMB * 。




. Storage VM ルートボリュームのエクスポートポリシーを開きます。
+
.. Storage > Volumes * をクリックし、 Storage VM のルートボリューム（デフォルトは _volume-name_root_） を選択し、 * Export Policy * に表示されるポリシーをクリックします。
.. ルールを追加するには、 [ * 追加 ] をクリックします。
+
*** クライアント仕様= `0.0.0.0/0`
*** アクセスプロトコル = nfs
*** アクセスの詳細= NFS読み取り専用




. ホスト名解決に使用する DNS を設定します。
+
.. Storage > Storage VM* の順にクリックし、 Storage VM を選択し、 * Settings * をクリックして、をクリックします image:icon_gear.gif["設定アイコン"] *DNS* の下。
.. DNS の設定が完了したら、 DNS サーバに切り替えて SMB サーバをマッピングします。
+
*** フォワードルックアップ（ A - アドレスレコード）とリバースルックアップ（ PTR - ポインタレコード）のエントリを作成して、 SMB サーバ名をデータネットワークインターフェイスの IP アドレスにマッピングします。
*** NetBIOS エイリアスを使用する場合は、エイリアスの正規名（ CNAME リソースレコード）のルックアップエントリを作成して、各エイリアスを SMB サーバのデータネットワークインターフェイスの IP アドレスにマッピングします。




. 必要に応じてネームサービスを設定します。
+
.. Storage > Storage VM* の順にクリックし、 Storage VM を選択し、 * Settings * をクリックして、をクリックします image:icon_gear.gif["設定アイコン"] LDAP または NIS 。
.. ネームサービススイッチファイルに変更を加えた場合は追加します。をクリックします image:icon_pencil.gif["編集アイコン"] ネームサービススイッチ * の下。


. 必要に応じて認証と暗号化を設定します。
+
[role="tabbed-block"]
====
.NFSクライアント用のTLSの設定
--

NOTE: ONTAP 9.15.1では、NFS over TLSがパブリックプレビューとして提供されています。プレビュー版として、ONTAP 9.15.1では本番ワークロードでNFS over TLSはサポートされていません。

.手順
.. を参照してください link:nfs-admin/tls-nfs-strong-security-concept.html["要件"^] （NFS over TLSの場合）を参照してください。
.. Storage > Storage VM* をクリックし、 Storage VM を選択して、 * Settings * をクリックします。
.. [NFS]タイルで、*[NFS over TLS設定]*をクリックします。
.. [NFS over TLS設定]*領域で、TLSを有効にするNFSネットワークインターフェイスを選択します。
.. をクリックします image:icon_kabob.gif["オプションアイコン"] そのインターフェイスのために。
.. [*Enable*] をクリックします。
.. [ネットワークインターフェイスのTLS設定]*ダイアログで、次のいずれかのオプションを選択して、TLSで使用する証明書を含めます。
+
*** *インストール済み証明書*：ドロップダウンリストから、以前にインストールした証明書を選択します。
*** *新しい証明書*：証明書の共通名を選択します。
*** *外部のCA署名証明書*：手順に従って、証明書と秘密鍵の内容をボックスに貼り付けます。


.. [ 保存（ Save ） ] をクリックします。


--
.Kerberosの設定
--
.手順
.. Storage > Storage VM* をクリックし、 Storage VM を選択して、 * Settings * をクリックします。
.. をクリックします image:icon_arrow.gif["矢印アイコン"] Kerberos タイルで、 * Add * をクリックします。


--
====
. 必要に応じて UNIX と Windows のユーザ名をマッピングします。をクリックします image:icon_arrow.gif["矢印アイコン"] [* ネームマッピング * ] で、 [* 追加 ] をクリックします。
+
この処理は、WindowsとUNIXのユーザアカウントが暗黙的にマッピングされない場合にのみ実行します。小文字のWindowsユーザ名がUNIXユーザ名と一致している場合は、この処理を実行します。ユーザ名は、LDAP、NIS、またはローカルユーザを使用してマッピングできます。一致しない 2 組のユーザセットがある場合、ネームマッピングを設定する必要があります。


