---
permalink: upgrade/concept_mixed_version_requirements.html 
sidebar: sidebar 
keywords: ontap, upgrade, mixed, version, clusters, mixed-version nodes, requirements 
summary: バージョンが混在したONTAPクラスタは、2つの異なるメジャーONTAPリリース（ONTAP 9.8と9.12.1など）を実行するノードで構成されます。バージョンの混在ONTAPクラスタは、特定のシナリオでのみサポートされます。 
---
= バージョンが混在したクラスタに対するONTAPのバージョンの互換性を確認する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
バージョンが混在したONTAPクラスタでは、ノードで2つの異なるメジャーバージョンのONTAPが短時間実行されます。たとえば、ONTAP 9.8と9.12.1を実行しているノード、またはONTAP 9.9.1と9.13.1を実行しているノードを含むクラスタは、バージョンが混在したクラスタです。ONTAP 9.9.1P1と9.9.1P5のように、同じバージョン内で異なるパッチレベルを実行しているノードを含むクラスタは、異なるバージョンが混在したクラスタではありません。


NOTE: Cloud Volumes ONTAPでは、バージョンの混在クラスタはサポートされません。

NetAppでは、一定期間、特定のシナリオにおいて、バージョンの異なるONTAPクラスタが混在してサポートされます。

ONTAPクラスタに複数のバージョンが混在する一般的なシナリオを次に示します。

* 大規模クラスタでのONTAPソフトウェアのアップグレード
+
大規模なクラスタ内のすべてのノードのアップグレードには、数日から数週間かかることがあります。クラスタは、すべてのノードがアップグレードされるまでバージョンが混在した状態になります。

* クラスタに新しいノードを追加する場合はONTAPソフトウェアのアップグレードが必要
+
クラスタに新しいノードを追加して容量を拡張したり、コントローラを完全に交換するプロセスで新しいノードを追加したりできます。いずれの場合も、既存のコントローラから新しいシステムの新しいノードにデータを移行するために、バージョンが混在した状態にしなければならない場合があります。



クラスタが最適に動作するためには、クラスタに複数のバージョンが混在した状態になるまでの時間をできるだけ短くする必要があります。クラスタに複数のバージョンが混在した状態でサポートされる最大期間は、クラスタ内の最も低いONTAPバージョンによって異なります。

[cols="2"]
|===
| 混在バージョンのクラスタで実行されているONTAPの最下位バージョン | バージョンが混在した状態を維持できる最大期間 


| ONTAP 9 .8以降 | 90日間 


| ONTAP 9.7以前 | 7日間 
|===
クラスタに複数のバージョンが混在している間は、アップグレードプロセスやデータ移行プロセスに必要なコマンドを除き、クラスタの処理や構成を変更するコマンドは実行しないでください。たとえば、LIFの移行、ストレージの計画的フェイルオーバー処理、大規模なオブジェクトの作成や削除などのアクティビティは、アップグレードとデータ移行が完了するまで実行しないでください。



== ONTAPソフトウェアのアップグレードでサポートされるバージョンの混在クラスタ

現在の最小リリースからの直接アップグレードでサポートされている任意のONTAPバージョンとバージョンが混在した状態にすることができます。たとえば、ONTAP 9.11.1を実行している場合は、ONTAP 9.15.1を実行しているノードとバージョンが混在した状態になることがあります。ONTAP 9.11.1とONTAP 9.16.1を実行しているノードとバージョンが混在する状態にすることはできません。ONTAP 9.16.1は、ONTAP 9.11.1からの直接アップグレードではサポートされません。


NOTE: ONTAPパッチ（P）リリースバージョンは、混合バージョンクラスタの互換性に影響を与えません。例えば、 ONTAP 9.11.1P6を実行している場合、混合バージョンクラスタの互換性のための現在のONTAPリリースはONTAP 9.11.1です。また、 ONTAP 9.12.1を実行していて、 ONTAP 9.15.1P2にアップグレードする場合、混合バージョンクラスタの互換性のためのターゲットONTAPリリースはONTAP 9.15.1です。

現在のリリースからの直接アップグレードではサポートされていないバージョンのONTAPにアップグレードするには、複数段階のアップグレードを実行する必要があります。マルチステージアップグレードでは、最初に現在のリリースからの直接アップグレードでサポートされている最も高いリリースでバージョンが混在した状態になります。アップグレードが完了したら、ターゲットリリースに個別にアップグレードを実行します。たとえば、現在の最小リリースがONTAP 9.10.1で、ONTAP 9.16.1にアップグレードする場合は、まずすべてのノードをONTAP 9.14.1にアップグレードするためにバージョンが混在した状態にしてから、ONTAP 9.14.1からONTAP 9.16.1に個別にアップグレードします。との詳細については、こちらをご覧くださいlink:concept_upgrade_paths.html#types-of-upgrade-paths["複数の段階でのアップグレード"]link:concept_upgrade_paths.html#supported-upgrade-paths["サポートされるアップグレードパス"]。

バージョンが混在したクラスタに含めることができるONTAPのメジャーリリースは2つだけです。たとえば、ONTAP 9.13.1と9.151を実行しているノードやONTAP 9.13.1と9.16.1を実行しているノードで、バージョンが混在したクラスタを作成できます。ONTAP 9.13.1、9.151、および9.16.1を実行しているノードでバージョンを混在させることはできません。

[cols="25,25,50"]
|===
| 現在の ONTAP リリース | ターゲットとなる ONTAP リリースは ... | アップグレードのバージョンが混在しています... 


| 9.16.1 | 9.17.1 | サポート対象 


.2+| 9.15.1 | 9.17.1 | サポート対象 


| 9.16.1 | サポート対象 


.3+| 9.14.1 | 9.17.1 | サポート対象 


| 9.16.1 | サポート対象 


| 9.15.1 | サポート対象 


.4+| 9.13.1 | 9.17.1 | サポート対象 


| 9.16.1 | サポート対象 


| 9.15.1 | サポート対象 


| 9.14.1 | サポート対象 


.5+| 9.12.1 | 9.17.1 | サポート対象外 


| 9.16.1 | サポート対象 


| 9.15.1 | サポート対象 


| 9.14.1 | サポート対象 


| 9.13.1 | サポート対象 


.6+| 9.11.1 | 9.17.1 | サポート対象外 


| 9.16.1  a| 
サポート対象外



| 9.15.1 | サポート対象 


| 9.14.1 | サポート対象 


| 9.13.1 | サポート対象 


| 9.12.1 | サポート対象 


.7+| 9.10.1 | 9.17.1 | サポート対象外 


| 9.16.1  a| 
サポート対象外



| 9.15.1  a| 
サポート対象外



| 9.14.1 | サポート対象 


| 9.13.1 | サポート対象 


| 9.12.1 | サポート対象 


| 9.11.1 | サポート対象 


.8+| 9.9.1 | 9.17.1 | サポート対象外 


| 9.16.1  a| 
サポート対象外



| 9.15.1  a| 
サポート対象外



| 9.14.1  a| 
サポート対象外



| 9.13.1 | サポート対象 


| 9.12.1 | サポート対象 


| 9.11.1 | サポート対象 


| 9.10.1 | サポート対象 


.9+| 9.8 | 9.17.1 | サポート対象外 


| 9.16.1  a| 
サポート対象外



| 9.15.1  a| 
サポート対象外



| 9.14.1  a| 
サポート対象外



| 9.13.1  a| 
サポート対象外



| 9.12.1 | サポート対象 


| 9.11.1 | サポート対象 


| 9.10.1  a| 
サポート対象



| 9.9.1 | サポート対象 
|===


== ONTAPクラスタへの新しいノードの追加

クラスタに新しいノードを追加する予定があり、それらのノードで最低限必要なONTAPバージョンが、現在クラスタで実行されているバージョンよりも新しい場合は、サポート範囲内でクラスタ内の既存のノードのソフトウェアをアップグレードしてから、新しいノードを追加する必要があります。既存のすべてのノードを、クラスタに追加するノードで最低限必要なONTAPバージョンにアップグレードするのが理想的です。ただし、既存のノードの一部で新しいバージョンのONTAPがサポートされていないためにそれができない場合は、アップグレード プロセスの一環として、限られた一定の期間、バージョンが混在する状態にならざるを得ません。

.手順
. link:concept_upgrade_methods.html["アップグレード"] 新しいコントローラに必要な最小のONTAPバージョンをサポートしていないノードを、サポートしている最高のONTAPバージョンにアップグレードします。
+
たとえば、 ONTAP 9.5 を実行している FAS8080 があり、 ONTAP 9.12.1 を実行している新しい C シリーズ プラットフォームを追加する場合は、FAS8080 をONTAP 9.8 (サポートされている最高ONTAPバージョン) にアップグレードする必要があります。

. link:../system-admin/add-nodes-cluster-concept.html["クラスタへの新しいノードの追加"^]です。
. link:https://docs.netapp.com/us-en/ontap-systems-upgrade/upgrade/upgrade-create-aggregate-move-volumes.html["データの移行"^]クラスタから削除するノードから新しく追加したノードに移動します。
. link:../system-admin/remove-nodes-cluster-concept.html["サポート対象外のノードをクラスタから削除します"^]です。
. link:concept_upgrade_methods.html["アップグレード"] クラスタを新しいノードで実行されている同じONTAPバージョンとパッチレベルに、または link:https://kb.netapp.com/Support_Bulletins/Customer_Bulletins/SU2["推奨される最新のパッチリリース"^] 新しいノードで実行されているONTAPバージョン用。
. すべてのノードが同じONTAPバージョンを実行していることを確認します。
+
.. クラスタで実行されているONTAP のバージョンを表示します。
+
[source, cli]
----
version
----
.. クラスタの各ノードで実行されているONTAP のバージョンを表示します。
+
[source, cli]
----
version *
----


+
出力で報告されたONTAPのバージョンと、 `version *` （クラスター）と `version` （個々のノード）コマンドを実行するには、すべてのノードを同じONTAPとパッチバージョンに更新します。 link:concept_upgrade_methods.html["クラスターイメージの更新"]。



データ移行の詳細については、以下を参照してください。

* link:https://docs.netapp.com/us-en/ontap-systems-upgrade/upgrade/upgrade-create-aggregate-move-volumes.html["アグリゲートを作成してボリュームを新しいノードに移動"^]
* link:https://docs.netapp.com/us-en/ontap-metrocluster/transition/task_move_linux_iscsi_hosts_from_mcc_fc_to_mcc_ip_nodes.html#setting-up-new-iscsi-connections["SANボリュームの移動用に新しいiSCSI接続をセットアップします"^]
* link:../encryption-at-rest/encrypt-existing-volume-task.html["暗号化を使用してボリュームを移動する"^]

