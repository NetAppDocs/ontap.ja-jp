---
permalink: upgrade/concept_mixed_version_requirements.html 
sidebar: sidebar 
keywords: ontap, upgrade, mixed, version, clusters, mixed-version nodes, requirements 
summary: バージョンが混在したONTAPクラスタは、2つの異なるメジャーONTAPリリース（ONTAP 9.8と9.12.1など）を実行するノードで構成されます。バージョンの混在ONTAPクラスタは、特定のシナリオでのみサポートされます。 
---
= バージョンが混在したONTAPクラスタ
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
バージョンが混在したONTAPクラスタは、2つの異なるメジャーONTAPリリースを一定期間実行するノードで構成されます。たとえば、クラスタが現在ONTAP 9 .8と9.12.1を実行しているノードで構成されている場合、クラスタはバージョンが混在したクラスタです。同様に、ノードでONTAP 9 .9.1と9.13.1が実行されているクラスタは、バージョンが混在したクラスタです。NetAppでは、一定期間、特定のシナリオにおいて、バージョンの異なるONTAPクラスタが混在してサポートされます。

ONTAPクラスタに複数のバージョンが混在する一般的なシナリオを次に示します。

* 大規模クラスタでのONTAPソフトウェアのアップグレード
* クラスタに新しいノードを追加する場合はONTAPソフトウェアのアップグレードが必要


この情報は、AFF AシリーズおよびCシリーズ、ASA、FAS、Cシリーズシステムなど、NetAppプラットフォームシステムをサポートするONTAPのバージョンに該当します。この情報は、9.12.0などのONTAPクラウドリリース（9.x.0）には適用されません。



== バージョンが混在したONTAPクラスタの要件

クラスタに複数のONTAPバージョンが混在する状態にする必要がある場合は、重要な要件と制限事項に注意する必要があります。

* 1つのクラスタに同時に使用できるメジャーONTAPバージョンは2つまでです。たとえば、ONTAP 9 .9.1と9.13.1がサポートされますが、ONTAP 9 .9.1、9.12.1、および9.13.1はサポートされません。同じONTAPリリースのPパッチレベルまたはDパッチレベルが異なるノード（ONTAP 9 .9.1P1と9.9.1P5など）を含むクラスタは、バージョンが混在したONTAPクラスタとはみなされません。
* クラスタに複数のバージョンが混在している間は、アップグレードプロセスやデータ移行プロセスに必要なコマンドを除き、クラスタの処理や構成を変更するコマンドは実行しないでください。たとえば、LIFの移行、ストレージの計画的フェイルオーバー処理、大規模なオブジェクトの作成や削除などのアクティビティは、アップグレードとデータ移行が完了するまで実行しないでください。
* クラスタが最適に動作するためには、クラスタに複数のバージョンが混在した状態になるまでの時間をできるだけ短くする必要があります。クラスタに複数のバージョンが混在した状態を維持できる最大期間は、クラスタ内の最も低いONTAPバージョンによって異なります。
+
[cols="2*"]
|===
| バージョンが混在したクラスタで実行されているONTAPの最下位バージョンが次の場合： | バージョンが混在した状態を維持できる期間は、最大で次のとおりです。 


| ONTAP 9.8以降 | 90日間 


| ONTAP 9.7以前 | 7日間 
|===
* ONTAP 9.8以降では、元のノードと新しいノードのバージョンの差を4つ以上にすることはできません。たとえば、バージョンが混在するONTAPクラスタでは、ONTAP 9.8と9.12.1が実行されているノードや、ONTAP 9.9.1と9.13.1が実行されているノードを使用できます。一方、バージョンが混在するONTAPクラスタにONTAP 9.8と9.13.1が実行されているノードがある場合、そのクラスタはサポートされません。
+
サポートされるバージョンの混在クラスタの一覧については、を参照してくださいlink:concept_upgrade_paths.html["サポートされるアップグレードパス"]。all_direct_upgradeパスは、バージョンが混在したクラスタでサポートされます。





== 大規模クラスタのONTAPバージョンの更新

バージョンが混在したクラスタ状態になるシナリオの1つは、新しいバージョンのONTAP 9で利用できる機能を利用するために、複数のノードを含むクラスタのONTAPバージョンをアップグレードすることです。大規模なクラスタのONTAPバージョンをアップグレードする必要がある場合は、クラスタ内の各ノードをアップグレードする間、一定期間バージョンが混在したクラスタ状態になります。



== ONTAPクラスタへの新しいノードの追加

バージョンが混在したクラスタ状態になるもう1つのシナリオは、クラスタに新しいノードを追加することです。クラスタに新しいノードを追加して容量を拡張したり、コントローラを完全に交換するプロセスで新しいノードを追加したりできます。どちらの場合も、既存のコントローラから新しいシステムの新しいノードにデータを移行できるようにする必要があります。

クラスタに新しいノードを追加する予定があり、それらのノードで最低限必要なONTAPバージョンが、現在クラスタで実行されているバージョンよりも新しい場合は、サポート範囲内でクラスタ内の既存のノードのソフトウェアをアップグレードしてから、新しいノードを追加する必要があります。

既存のすべてのノードを、クラスタに追加するノードで最低限必要なONTAPバージョンにアップグレードするのが理想的です。ただし、既存のノードの一部で新しいバージョンのONTAPがサポートされていないためにそれができない場合は、アップグレード プロセスの一環として、限られた一定の期間、バージョンが混在する状態にならざるを得ません。新しいコントローラで最低限必要なONTAPバージョンをサポートしていないノードがある場合は、次の手順を実行する必要があります。

. link:concept_upgrade_methods.html["アップグレード"]新しいコントローラで必要な最小ONTAPバージョンをサポートしていないノードが、新しいコントローラでサポートされる最大ONTAPバージョンまで。
+
たとえば、FAS8080でONTAP 9.5が実行されていて、ONTAP 9.12.1が実行される新しいCシリーズ プラットフォームを追加する場合は、FAS8080をONTAP 9.8（サポートされる最上位のONTAPバージョン）にアップグレードする必要があります。

. link:../system-admin/add-nodes-cluster-concept.html["クラスタへの新しいノードの追加"^]です。
. link:https://docs.netapp.com/us-en/ontap-systems-upgrade/upgrade/upgrade-create-aggregate-move-volumes.html["データの移行"^]クラスタから削除するノードから新しく追加したノードに移動します。
. link:../system-admin/remov-nodes-cluster-concept.html["サポート対象外のノードをクラスタから削除します"^]です。
. link:concept_upgrade_methods.html["アップグレード"]クラスタ内の残りのノードを新しいノードと同じバージョンに変更します。
+
必要に応じて、クラスタ全体（新しいノードを含む）を、新しいノードで実行されているONTAPのバージョンにアップグレードしlink:https://kb.netapp.com/Support_Bulletins/Customer_Bulletins/SU2["推奨される最新のパッチリリース"]ます。



データ移行の詳細については、以下を参照してください。

* link:https://docs.netapp.com/us-en/ontap-systems-upgrade/upgrade/upgrade-create-aggregate-move-volumes.html["アグリゲートを作成してボリュームを新しいノードに移動"^]
* link:https://docs.netapp.com/us-en/ontap-metrocluster/transition/task_move_linux_iscsi_hosts_from_mcc_fc_to_mcc_ip_nodes.html#setting-up-new-iscsi-connections["SANボリュームの移動用に新しいiSCSI接続をセットアップします"^]
* link:../encryption-at-rest/encrypt-existing-volume-task.html["暗号化を使用してボリュームを移動する"^]

