---
permalink: upgrade/concept_mixed_version_requirements.html 
sidebar: sidebar 
keywords: ontap, upgrade, mixed, version, clusters, mixed-version nodes, requirements 
summary: 混合バージョンのONTAPクラスタは、ONTAP 9.8と9.12.1など、2つの異なるメジャーONTAPリリースを実行するノードで構成されます。混合バージョンのONTAPクラスタは、特定のシナリオでのみサポートされます。 
---
= 混合バージョン クラスタの ONTAP バージョンの互換性を確認する
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
混合バージョン ONTAP クラスタでは、ノードは短期間、2 つの異なるメジャーバージョンの ONTAP を実行します。例えば、ONTAP 9.8 と 9.12.1、または ONTAP 9.9.1 と 9.13.1 を実行するノードを含むクラスタは、混合バージョン クラスタです。ONTAP 9.9.1P1 と 9.9.1P5 のように、同じバージョン内で異なるパッチ レベルを実行するノードを含むクラスタは、混合バージョン クラスタではありません。


NOTE: 混合バージョンのクラスタは Cloud Volumes ONTAP ではサポートされていません。

NetAppは、特定のシナリオについて、バージョンが混在するONTAPクラスタを一時的にサポートします。

ONTAP クラスタが混在バージョン状態になる最も一般的なシナリオは次のとおりです：

* 大規模クラスタでONTAPソフトウェアをアップグレードする場合
+
大規模クラスタ内のすべてのノードをアップグレードするには、数日から数週間かかる場合があります。すべてのノードがアップグレードされるまで、クラスタは混在バージョン状態に入り、その状態が維持されます。

* クラスタに新しいノードを追加する際にONTAPソフトウェアのアップグレードが必要な場合
+
クラスタの容量を拡張するために新しいノードを追加する場合もあれば、コントローラを完全に交換するプロセスの一環として新しいノードを追加する場合もあります。いずれの場合も、既存のコントローラから新しいシステムの新しいノードへのデータ移行を可能にするために、混在バージョン状態に移行する必要がある場合があります。



クラスタの最適な運用には、クラスタが混在バージョン状態にある時間を可能な限り短くする必要があります。クラスタが混在バージョン状態でサポートを受けられる最大期間は、クラスタ内の最も低い ONTAP バージョンによって異なります。

[cols="2"]
|===
| 混合バージョン クラスタで実行されている ONTAP の最も低いバージョンが... | その後、最大で混合バージョンの状態を維持できます... 


| ONTAP 9.8 以降 | 90日間 


| ONTAP 9.7以前 | 7日間 
|===
クラスタに異なるバージョンが混在する状態の間は、アップグレードやデータ移行プロセスに必要なコマンドを除き、クラスタの処理や構成を変更するコマンドは実行しないでください。たとえば、LIFの移行、ストレージの計画的フェイルオーバー処理、大規模なオブジェクトの作成や削除といった（これらに限らない）操作は、アップグレードとデータ移行が完了するまで実行しないでください。



== ONTAPソフトウェア アップグレードでサポートされる混合バージョン クラスタ

現在の最低リリースからの直接アップグレードでサポートされている任意の ONTAP バージョンで、混在バージョン状態にすることができます。たとえば、ONTAP 9.11.1 を実行している場合、ONTAP 9.15.1 を実行しているノードで混在バージョン状態にすることができます。ONTAP 9.11.1 と ONTAP 9.16.1 を実行しているノードで混在バージョン状態にすることはできません。ONTAP 9.16.1 は、ONTAP 9.11.1 からの直接アップグレードではサポートされていません。


NOTE: ONTAPパッチ（P）リリースバージョンは、混合バージョンクラスタの互換性に影響を与えません。たとえば、ONTAP 9.11.1P6を実行している場合、混合バージョンクラスタの互換性に対応する現在のONTAPリリースはONTAP 9.11.1です。また、ONTAP 9.12.1を実行していて、ONTAP 9.15.1P2にアップグレードする場合、混合バージョンクラスタの互換性に対応するターゲットONTAPリリースはONTAP 9.15.1です。

現在のリリースからの直接アップグレードがサポートされていないONTAPバージョンにアップグレードするには、段階的なアップグレードを実行する必要があります。段階的なアップグレードでは、まず、現在のリリースからの直接アップグレードがサポートされている最新リリースとの混在バージョン状態に移行します。そのアップグレードを完了した後、ターゲットリリースへの個別のアップグレードを実行します。たとえば、現在の最低リリースがONTAP 9.10.1で、ONTAP 9.16.1にアップグレードする場合、まず混在バージョン状態に移行してすべてのノードをONTAP 9.14.1にアップグレードします。その後、ONTAP 9.14.1からONTAP 9.16.1への個別のアップグレードを実行します。link:concept_upgrade_paths.html#types-of-upgrade-paths["多段階アップグレード"]およびlink:concept_upgrade_paths.html#supported-upgrade-paths["サポートされているアップグレード パス"]の詳細を確認してください。

混合バージョンクラスタには、2つのメジャーONTAPリリースのみを含めることができます。たとえば、ONTAP 9.13.1と9.15.1を実行するノード、またはONTAP 9.13.1と9.16.1を実行するノードで混合バージョンクラスタを構成できます。ONTAP 9.13.1、9.15.1、および9.16.1を実行するノードで混合バージョンクラスタを構成することはできません。

[cols="25,25,50"]
|===
| 現在の ONTAP リリースが… | 対象となるONTAPリリースは… | アップグレードの混合バージョン状態は… 


| 9.17.1 | 9.18.1 | サポート 


.2+| 9.16.1 | 9.18.1 | サポート 


| 9.17.1 | サポート 


.3+| 9.15.1 | 9.18.1 | サポート 


| 9.17.1 | サポート 


| 9.16.1 | サポート 


.4+| 9.14.1 | 9.18.1 | サポート 


| 9.17.1 | サポート 


| 9.16.1 | サポート 


| 9.15.1 | サポート 


.5+| 9.13.1 | 9.18.1 | サポート対象外 


| 9.17.1 | サポート 


| 9.16.1 | サポート 


| 9.15.1 | サポート 


| 9.14.1 | サポート 


.5+| 9.12.1 | 9.17.1以降 | サポート対象外 


| 9.16.1 | サポート 


| 9.15.1 | サポート 


| 9.14.1 | サポート 


| 9.13.1 | サポート 


.5+| 9.11.1 | 9.16.1以降  a| 
サポート対象外



| 9.15.1 | サポート 


| 9.14.1 | サポート 


| 9.13.1 | サポート 


| 9.12.1 | サポート 


.5+| 9.10.1 | 9.15.1以降  a| 
サポート対象外



| 9.14.1 | サポート 


| 9.13.1 | サポート 


| 9.12.1 | サポート 


| 9.11.1 | サポート 


.5+| 9.9.1 | 9.14.1以降  a| 
サポート対象外



| 9.13.1 | サポート 


| 9.12.1 | サポート 


| 9.11.1 | サポート 


| 9.10.1 | サポート 


.5+| 9.8 | 9.13.1以降  a| 
サポート対象外



| 9.12.1 | サポート 


| 9.11.1 | サポート 


| 9.10.1  a| 
サポート



| 9.9.1 | サポート 
|===


== ONTAPクラスタに新しいノードを追加する

クラスタに新しいノードを追加する予定があり、それらのノードで最低限必要なONTAPバージョンが、現在クラスタで実行されているバージョンよりも新しい場合は、サポート範囲内でクラスタ内の既存のノードのソフトウェアをアップグレードしてから、新しいノードを追加する必要があります。既存のすべてのノードを、クラスタに追加するノードで最低限必要なONTAPバージョンにアップグレードするのが理想的です。ただし、既存のノードの一部で新しいバージョンのONTAPがサポートされていないためにそれができない場合は、アップグレード プロセスの一環として、限られた一定の期間、バージョンが混在する状態にならざるを得ません。

.手順
. link:concept_upgrade_methods.html["Upgrade"]新しいコントローラに必要な最小の ONTAP バージョンをサポートしていないノードを、サポートしている最高の ONTAP バージョンにアップグレードします。
+
たとえば、ONTAP 9.5を実行しているFAS8080があり、ONTAP 9.12.1を実行している新しいCシリーズ プラットフォームを追加する場合は、FAS8080をONTAP 9.8（サポートされている最高のONTAPバージョン）にアップグレードする必要があります。

. link:../system-admin/add-nodes-cluster-concept.html["新しいノードをクラスタに追加する"^]。
. link:https://docs.netapp.com/us-en/ontap-systems-upgrade/upgrade/upgrade-create-aggregate-move-volumes.html["データを移行する"^]クラスタから削除されるノードから新しく追加されたノードへ。
. link:../system-admin/remove-nodes-cluster-concept.html["サポートされていないノードをクラスタから削除します"^]。
. link:concept_upgrade_methods.html["Upgrade"]クラスタを、新しいノードで実行されているのと同じONTAPバージョンおよびパッチレベルに、またはlink:https://kb.netapp.com/Support_Bulletins/Customer_Bulletins/SU2["最新の推奨パッチ リリース"^]新しいノードで実行されているONTAPバージョンにアップグレードします。
. すべてのノードが同じ ONTAP バージョンを実行していることを確認します。
+
.. クラスタで実行されている ONTAP のバージョンを表示します：
+
[source, cli]
----
version
----
.. クラスタの各ノードで実行されている ONTAP のバージョンを表示します。
+
[source, cli]
----
version *
----


+
 `version *`（クラスタ）コマンドと `version`（個々のノード）コマンドの出力で報告された ONTAP バージョンに違いがある場合は、link:concept_upgrade_methods.html["クラスタ イメージの更新"]を実行して、すべてのノードを同じ ONTAP およびパッチ バージョンに更新します。



データ移行の詳細については、以下を参照してください。

* link:https://docs.netapp.com/us-en/ontap-systems-upgrade/upgrade/upgrade-create-aggregate-move-volumes.html["アグリゲートを作成し、ボリュームを新しいノードに移動する"^]
* link:https://docs.netapp.com/us-en/ontap-metrocluster/transition/task_move_linux_iscsi_hosts_from_mcc_fc_to_mcc_ip_nodes.html#setting-up-new-iscsi-connections["SANボリューム移動のための新しいiSCSI接続の設定"^]
* link:../encryption-at-rest/encrypt-existing-volume-task.html["暗号化されたボリュームの移動"^]

