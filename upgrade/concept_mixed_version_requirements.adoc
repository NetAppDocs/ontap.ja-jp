---
permalink: upgrade/concept_mixed_version_requirements.html 
sidebar: sidebar 
keywords: ontap, upgrade, mixed, version, clusters, mixed-version nodes, requirements 
summary: バージョンが混在したONTAPクラスタは、2つの異なるメジャーONTAPリリース（ONTAP 9.8と9.12.1など）を実行するノードで構成されます。バージョンの混在ONTAPクラスタは、特定のシナリオでのみNetAppでサポートされます。 
---
= バージョンが混在したONTAPクラスタ
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
バージョンが混在したONTAPクラスタは、ONTAP 2つの異なるメジャーリリースを実行するノードで構成されます。  たとえば、ONTAP 9.8と9.12.1を実行するノードで構成されたクラスタは、バージョンが混在したクラスタです。  同様に、ノードでONTAP 9.9.1と9.13.1が実行されているクラスタは、バージョンが混在したクラスタです。  NetAppでは、一定期間、特定のシナリオにおいて、バージョンの異なるONTAPクラスタが混在してサポートされます。

ONTAPクラスタに複数のバージョンが混在する一般的なシナリオを次に示します。

* 大規模なクラスタでのONTAPソフトウェアのアップグレード
* クラスタに新しいノードを追加する場合は、ONTAPソフトウェアのアップグレードが必要です


NetAppプラットフォームシステム（AFF、ASA、FAS、Cシリーズシステムなど）をサポートする 環境 ONTAPのバージョンを記載します。  ここに記載されている情報は、9.12.0などのONTAPクラウドリリース（9.x.0）には適用されません。



== バージョンが混在したONTAPクラスタの要件

クラスタにONTAPバージョンが混在した状態にする必要がある場合は、重要な要件と制限事項を確認しておく必要があります。

* 1つのクラスタに同時に使用できるメジャーONTAPバージョンは2つまでです。同じONTAPリリースのPパッチレベルまたはDパッチレベルが異なるノード（ONTAP 9.9.1P1と9.9.1P5など）を含むクラスタは、バージョンが混在したONTAPクラスタとはみなされません。
* クラスタに複数のバージョンが混在している間は、アップグレードプロセスやデータ移行プロセスに必要なコマンドを除き、クラスタの処理や構成を変更するコマンドは実行しないでください。  たとえば、LIFの移行、ストレージの計画的フェイルオーバー処理、大規模オブジェクトの作成や破棄などのアクティビティは、アップグレードとデータ移行が完了するまで実行しないでください。
* クラスタが最適に動作するためには、クラスタに複数のバージョンが混在した状態になるまでの時間をできるだけ短くする必要があります。  クラスタに複数のバージョンが混在した状態を維持できる最大期間は、クラスタ内の最も低いONTAPバージョンによって異なります。
+
[cols="2*"]
|===
| バージョンが混在したクラスタで実行されているONTAPの最下位バージョンが次の場合： | その後、最大でバージョンが混在した状態のままにすることができます 


| ONTAP 9.8以降 | 90日 


| ONTAP 9.7以前 | 7日 
|===
* ONTAP 9.8以降では、複数のバージョンが混在したONTAPクラスタで最大4つのメジャーリリースを使用できます。たとえば、バージョンが混在したONTAPクラスタでは、ONTAP 9.8と9.12.1を実行しているノードや、ONTAP 9.9.1と9.13.1を実行しているノードを使用できます。ただし、ONTAP 9.8と9.13.1を実行するノードを含むバージョンが混在したONTAPクラスタは、5つのメジャーリリースにまたがるため、サポートされません。




== 大規模クラスタのONTAPバージョンの更新

ONTAPの各バージョンには、より堅牢な機能セットが用意されています。大規模なクラスタのONTAPを新しいバージョンのONTAPにアップグレードする必要がある場合は、クラスタ内の各ノードをアップグレードする際に、一定期間バージョンが混在したクラスタの状態にする必要があります。



== 新しいノードをクラスタに追加しています

クラスタに新しいノードを追加して容量を拡張したり、コントローラを完全に交換したりすることができます。いずれの場合も、古いコントローラから新しいシステムへのデータの移行を有効にする必要があります。

クラスタに新しいノードを追加する予定で、それらのノードにクラスタ内の既存のノードよりも新しいバージョンのONTAPが必要な場合は、クラスタ内のすべての既存のノードを新しいバージョンのONTAPにアップグレードしてから、新しいノードを追加する必要があります。ただし、既存のノードの一部で新しいバージョンのONTAPがサポートされていないためにこれができない場合は、アップグレードプロセスの一環として、限られた時間だけバージョンが混在した状態にする必要があります。
新しいコントローラに必要な最小バージョンのONTAPをサポートしていないノードがある場合は、次の手順を実行する必要があります。

. link:https://docs.netapp.com/us-en/ontap/upgrade/concept_upgrade_methods.html["アップグレード"] 新しいコントローラのONTAPバージョンをサポートするクラスタ内のノード。
. 新しいノードをクラスタに追加します。
+
新しいノードに追加するには、advanced権限レベルでONTAPコマンドcluster add-node-allow-mixed-version-joinを使用します。

. アップグレードできないノードから、上位のバージョンのONTAPを実行するノードにデータを移行します。
. link:https://docs.netapp.com/us-en/ontap/system-admin/remov-nodes-cluster-concept.html["サポート対象外のノードをクラスタから削除します"^]。
+
これらのノードを削除するには、ONTAPコマンドcluster remove-node-skip-last-low-version-node-checkを使用します。（ONTAP 9.3以前では、cluster unjoin-skip-last-low-version-node-checkコマンドを使用します）。



データ移行の詳細については、以下を参照してください。

* link:https://docs.netapp.com/us-en/ontap-systems-upgrade/upgrade/upgrade-create-aggregate-move-volumes.html["アグリゲートを作成してボリュームを新しいノードに移動"^]
* link:https://docs.netapp.com/us-en/ontap-metrocluster/transition/task_move_linux_iscsi_hosts_from_mcc_fc_to_mcc_ip_nodes.html#setting-up-new-iscsi-connections["SANボリュームの移動用に新しいiSCSI接続をセットアップします"^]
* link:https://docs.netapp.com/us-en/ontap/encryption-at-rest/encrypt-existing-volume-task.html["暗号化を使用してボリュームを移動する"^]

