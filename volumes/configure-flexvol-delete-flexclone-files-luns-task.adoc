---
permalink: volumes/configure-flexvol-delete-flexclone-files-luns-task.html 
sidebar: sidebar 
keywords: configure, flexvol volume, automatically, delete, flexclone files, flexclone luns, flexvol, volume, automatic, file, autodelete 
summary: ボリュームの空きスペースが特定のしきい値を下回った場合に、FlexCloneファイルとFlexClone LUNが自動的に削除されるようにFlexVolを設定できます。 
---
= FlexCloneファイルおよびFlexClone LUNを自動的に削除するためのFlexVolの設定
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ボリュームの空きスペースが一定のしきい値を下回ったときにFlexCloneファイルおよびFlexClone LUNの削除を自動的に開始し、指定した量の空きスペースが再生されたときにクローンの削除を自動的に停止するようにボリュームを設定できます。クローンの自動削除を開始するしきい値を指定することはできませんが、あるクローンを削除対象に含めるかどうかや、ボリュームの空きスペースの目標量を指定することはできます。

ボリューム内の空き領域が特定のしきい値を下回り、次の_両方_の要件が満たされると、ボリュームはFlexCloneファイルとFlexClone LUNを自動的に削除します：

* 自動削除機能が、FlexCloneファイルおよびFlexClone LUNを含むボリュームに対して有効になっている。
+
 `volume snapshot autodelete modify`コマンドを使用して、FlexVol ボリュームの自動削除機能を有効にできます。ボリュームでFlexClone ファイルとFlexClone LUNを自動的に削除するには、 `-trigger`パラメータを `volume`または `snap_reserve`に設定する必要があります。

* 自動削除機能が、FlexCloneファイルおよびFlexClone LUNに対して有効になっている。
+
 `file clone create`コマンドに `-autodelete`パラメータを指定することで、FlexCloneファイルまたはFlexClone LUNの自動削除を有効にすることができます。これにより、クローンの自動削除を無効にし、他のボリューム設定がクローン設定を上書きしないようにすることで、特定のFlexCloneファイルとFlexClone LUNを保持することができます。



.開始する前に
* FlexVolにFlexCloneファイルおよびFlexClone LUNが含まれていて、オンラインになっている必要があります。
* FlexVolが読み取り専用ボリュームでないことが必要です。


.手順
.  `volume snapshot autodelete modify`コマンドを使用して、FlexVolボリューム内のFlexCloneファイルおよびFlexCloneLUNの自動削除を有効にします。 `volume snapshot autodelete modify`についての詳細は、link:https://docs.netapp.com/us-en/ontap-cli/volume-snapshot-autodelete-modify.html["ONTAPコマンド リファレンス"^]をご覧ください。
+
**  `-trigger`パラメータには、 `volume`または `snap_reserve`を指定できます。
**  `-destroy-list`パラメータには、削除するクローンの種類が1つだけかどうかに関係なく、 `lun_clone,file_clone`を必ず指定する必要があります。次の例は、ボリュームvol1で、空き領域が25%になるまで、FlexCloneファイルとFlexClone LUNの自動削除をトリガーしてスペースを再利用するように設定する方法を示しています：
+
[listing]
----
cluster1::> volume snapshot autodelete modify -vserver vs1 -volume vol1 -enabled true -commitment disrupt -trigger volume -target-free-space 25 -destroy-list lun_clone,file_clone

Volume modify successful on volume:vol1
----
+
[NOTE]
====
FlexVolボリュームの自動削除を有効にしている際に、 `-commitment`パラメータの値を `destroy`に設定すると、ボリュームの空き容量が指定されたしきい値を下回った場合に、 `-autodelete`パラメータが `true`に設定されているすべてのFlexCloneファイルとFlexClone LUNが削除される可能性があります。ただし、 `-autodelete`パラメータが `false`に設定されているFlexCloneファイルとFlexClone LUNは削除されません。

====


. FlexVol volumeで `volume snapshot autodelete show`コマンドを使用して、FlexCloneファイルおよびFlexCloneLUNの自動削除が有効になっていることを確認します。 `volume snapshot autodelete show`についての詳細は、link:https://docs.netapp.com/us-en/ontap-cli/volume-snapshot-autodelete-show.html["ONTAPコマンド リファレンス"^]をご覧ください。
+
次の例では、ボリュームvol1でFlexCloneファイルとFlexClone LUNの自動削除が有効になっています。

+
[listing]
----
cluster1::> volume snapshot autodelete show -vserver vs1 -volume vol1

         Vserver Name: vs1
          Volume Name: vol1
          Enabled: true
           Commitment: disrupt
         Defer Delete: user_created
         Delete Order: oldest_first
  Defer Delete Prefix: (not specified)
    Target Free Space: 25%
              Trigger: volume
     *Destroy List: lun_clone,file_clone*
Is Constituent Volume: false
----
. 次の手順を実行して、ボリューム内の削除対象とするFlexCloneファイルとFlexClone LUNの自動削除を有効にします。
+
..  `volume file clone autodelete`コマンドを使用して、特定のFlexCloneファイルまたはFlexClone LUNの自動削除を有効にします。link:https://docs.netapp.com/us-en/ontap-cli/volume-file-clone-autodelete.html["ONTAPコマンド リファレンス"^]の `volume file clone autodelete`の詳細をご覧ください。
+
 `volume file clone autodelete`コマンドに `-force`パラメータを指定すると、特定のFlexCloneファイルまたはFlexClone LUNを強制的に自動削除できます。

+
次の例では、ボリュームvol1に含まれるFlexClone LUN lun1_cloneの自動削除が有効になっています。

+
[listing]
----
cluster1::> volume file clone autodelete -vserver vs1 -clone-path /vol/vol1/lun1_clone -enabled true
----
+
FlexCloneファイルおよびFlexClone LUNの作成時に自動削除を有効にすることができます。

..  `volume file clone show-autodelete`コマンドを使用して、FlexCloneファイルまたはFlexClone LUNの自動削除が有効になっていることを確認します。link:https://docs.netapp.com/us-en/ontap-cli/volume-file-clone-show-autodelete.html["ONTAPコマンド リファレンス"^]の `volume file clone show-autodelete`の詳細を確認してください。
+
次の例では、FlexClone LUN lun1_cloneで自動削除が有効になっています。

+
[listing]
----
cluster1::> volume file clone show-autodelete -vserver vs1 -clone-path vol/vol1/lun1_clone
Vserver Name: vs1
Clone Path: vol/vol1/lun1_clone
**Autodelete Enabled: true**
----


+
この手順で説明されているコマンドの詳細については、link:https://docs.netapp.com/us-en/ontap-cli/["ONTAPコマンド リファレンス"^]を参照してください。


