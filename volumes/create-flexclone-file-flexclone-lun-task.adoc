---
permalink: volumes/create-flexclone-file-flexclone-lun-task.html 
sidebar: sidebar 
keywords: create, flexclone file, flexclone lun, efficient, clone 
summary: FlexVolまたはFlexCloneボリューム内のファイルとLUNのスペース効率に優れた時間効率に優れたクローンを作成できます。 
---
= ONTAPでFlexCloneファイルまたはFlexClone LUNを作成
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
FlexVolボリュームまたはFlexCloneボリューム内に存在するファイルとLUNのスペース効率と時間効率に優れたクローンを作成するには、 `volume file clone create`コマンドを使用します。

.開始する前に
* FlexCloneライセンスはクラスタにインストールする必要があります。このライセンスはlink:../system-admin/manage-licenses-concept.html#licenses-included-with-ontap-one["ONTAP One"]に含まれています。
* サブLUNのクローニングまたはサブファイルのクローニングに複数のブロック範囲が使用される場合は、ブロック番号が重ならないようにする必要があります。
* 適応圧縮が有効なボリュームでサブLUNまたはサブファイルを作成する場合は、ブロック範囲がミスアライメントされないようにする必要があります。
+
つまり、ソースの開始ブロック番号とデスティネーションの開始ブロック番号が、偶数または奇数のいずれかでアライメントされている必要があります。



.タスク概要
SVM管理者は、クラスタ管理者によって割り当てられた権限に応じて、FlexCloneファイルおよびFlexClone LUNを作成できます。

FlexCloneファイルおよびFlexClone LUNに対して、クローンの作成時と変更時に自動削除設定を指定できます。デフォルトでは、自動削除設定は無効になります。

 `volume file clone create`コマンドを `-overwrite-destination`パラメータ付きで使用してクローンを作成するときに、既存のFlexCloneファイルまたはFlexClone LUNを上書きできます。

ノードの分割負荷が最大負荷に達すると、ノードはFlexCloneファイルとFlexClone LUNの作成要求の受付を一時的に停止し、 `EBUSY`エラー メッセージを表示します。ノードの分割負荷が最大負荷を下回ると、ノードはFlexCloneファイルとFlexClone LUNの作成要求の受付を再開します。クローンを作成できる容量がノードに確保されるまで待ってから、作成要求を再度実行してください。

FlexClone LUNは、親LUNのスペース リザベーション属性を継承します。スペース リザーブされたFlexClone LUNには、親のスペース リザーブLUNと同量のスペースが必要です。FlexClone LUNのスペースをリザーブしない場合は、クローンに対する変更を保存するための十分なスペースがボリュームに必要です。

.手順
. LUNのクローンを作成する場合は、LUNがマップされていないこと、または書き込みが行われていないことを確認します。
. FlexClone LUNまたはファイルを作成します：
+
`volume file clone create -vserver _vserver_name_ -volume _volume_name_ -source-path _source_path_ -destination-path _destination_path_`

+
次の例は、ボリュームvol1内の親ファイルfile1_sourceから、FlexCloneファイルfile1_cloneを作成する方法を示しています。

+
[listing]
----
cluster1::> volume file clone create -vserver vs0 -volume vol1 -source-path /file1_source -destination-path /file1_clone
----
+
 `volume file clone create`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/volume-file-clone-create.html["ONTAPコマンド リファレンス"^]を参照してください。





== ボリューム内のスナップショットからFlexClone LUNを作成する

ボリューム内のスナップショットを使用して、LUNのFlexCloneコピーを作成できます。LUNのFlexCloneコピーは読み取りと書き込みの両方が可能です。

.開始する前に
FlexCloneライセンスをインストールする必要があります。このライセンスはlink:../system-admin/manage-licenses-concept.html#licenses-included-with-ontap-one["ONTAP One"]に含まれています。

.タスク概要
FlexClone LUNは、親LUNのスペース リザベーション属性を継承します。スペース リザーブされたFlexClone LUNには、親のスペース リザーブLUNと同量のスペースが必要です。FlexClone LUNのスペースをリザーブしない場合は、クローンに対する変更を保存するための十分なスペースがボリュームに必要です。

.手順
. LUNがマッピングされていない、または書き込まれていないことを確認します。
. LUNを含むボリュームのスナップショットを作成します：
+
`volume snapshot create -vserver _vserver_name_ -volume _volume_name_ -snapshot _snapshot_name_`

+
クローンを作成するLUNのスナップショット（バッキングスナップショット）を作成する必要があります。

. スナップショットからFlexClone LUNを作成します：
+
`volume file clone create -vserver _vserver_name_ -volume _volume_name_ -source-path _source_path_ -snapshot-name _snapshot_name_ -destination-path _destination_path_`

+
FlexClone LUNを自動削除できるようにする必要がある場合は、 `-autodelete true`を含めます。セミシック プロビジョニングを使用してボリュームにこのFlexClone LUNを作成する場合は、すべてのFlexClone LUNに対して自動削除を有効にする必要があります。

. FlexClone LUNが正しいことを確認します。
+
`lun show -vserver _vserver_name_`

+
[listing]
----

Vserver Path                      State    Mapped    Type     Size
------- ----------------------    -------- --------- -------- -------
vs1     /vol/vol1/lun1_clone      online   unmapped windows   47.07MB
vs1     /vol/vol1/lun1_snap_clone online   unmapped windows   47.07MB
----

