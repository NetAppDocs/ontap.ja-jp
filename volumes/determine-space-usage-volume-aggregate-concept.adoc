---
permalink: volumes/determine-space-usage-volume-aggregate-concept.html 
sidebar: sidebar 
keywords: determine, space usage, volume, aggregate 
summary: ONTAPは、ボリューム、アグリゲート内のボリュームのフットプリント、およびアグリゲートに基づいてスペースの消費量を判断するのに役立ちます。 
---
= ONTAPのボリュームまたはアグリゲートのスペース使用量の確認
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
場合によっては、ONTAPで有効にした機能により、想定よりも多くのスペースが消費されることがあります。ONTAPでは、消費されるスペースを、ボリューム、アグリゲート内でのボリュームの占有量、およびアグリゲートの3つの観点から判定できます。



== スペースの割り当ての表示

ボリューム、アグリゲート、またはその両方でのスペース消費またはスペース不足により、ボリュームのスペースが不足することがあります。スペース使用量の機能別の内訳をさまざまな観点から確認することで、調整や無効化が必要な機能や、その他の対処（アグリゲートやボリュームのサイズ拡張など）を講じておくべきかどうかを判断できます。

スペース使用量は、以下の観点から詳細に確認できます。

* ボリュームのスペース使用量
+
このパースペクティブでは、Snapshotによる使用状況を含む、ボリューム内のスペース使用状況に関する詳細が提供されます。

+
 `volume show-space`コマンドを使用して、ボリュームのスペース使用量を確認します。

+
 `volume show-space`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/volume-show-space.html["ONTAPコマンド リファレンス"^]を参照してください。

+
ONTAP 9.14.1以降では、xref:enable-temperature-sensitive-efficiency-concept.html[温度感受性ストレージ効率（TSSE）]が有効になっているボリュームでは、 `volume show-space -physical used`コマンドによって報告されるボリュームの使用済みスペースの量に、TSSEの結果として実現されたスペース節約が含まれます。

* アグリゲート内のボリュームの占有量
+
ボリュームのメタデータも含め、アグリゲートで各ボリュームが使用しているスペースの量に関する詳細を把握できます。

+
 `volume show-footprint`コマンドを使用して、アグリゲートによるボリュームのフットプリントを確認します。

+
 `volume show-footprint`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/volume-show-footprint.html["ONTAPコマンド リファレンス"^]を参照してください。

* アグリゲートのスペース使用量
+
このパースペクティブには、アグリゲートに含まれるすべてのボリュームのボリューム フットプリントの合計、アグリゲートSnapshot用に予約されたスペース、およびその他のアグリゲートのメタデータが含まれます。

+
WAFLでは、アグリゲート レベルのメタデータおよびパフォーマンス用に総ディスク スペースの10%が予約されます。アグリゲート内のボリュームを維持するためのスペースはWAFLリザーブから使用され、変更することはできません。

+
ONTAP 9.12.1以降、AFFプラットフォームおよびFAS500fプラットフォームでは、30TBを超えるアグリゲートのWAFLリザーブが10%から5%に削減されます。ONTAP 9.14.1以降では、すべてのFASプラットフォームのアグリゲートに同じ削減が適用され、アグリゲートの使用可能スペースが5%増加します。

+
 `storage aggregate show-space`コマンドを使用して、アグリゲートのスペース使用量を確認します。

+
 `storage aggregate show-space`の詳細については、link:https://docs.netapp.com/us-en/ontap-cli/storage-aggregate-show-space.html["ONTAPコマンド リファレンス"^]を参照してください。



テープ バックアップおよび重複排除などの特定の機能は、ボリュームからとアグリゲートから直接、メタデータ用のスペースを使用します。これらの機能については、ボリュームとボリュームの占有量で異なるスペース使用量が表示されます。



== ボリュームのメタデータとデータに関する指標の報告方法

従来、いくつかのボリューム スペース指標では、消費された合計データがメタデータとユーザ データに関する2つの指標の組み合わせとして報告されてきました。ONTAP 9.15.1以降では、メタデータとユーザ データの指標が個別に報告されます。これをサポートするために、次の2つの新しいメタデータ カウンタが導入されました。

* total-metadata
+
このカウンタは、ボリューム内のメタデータの合計サイズを表します。アグリゲートに存在するボリュームのメタデータは含まれません。このカウンタが個別に報告されることで、ユーザによって割り当てられた論理データを確認するのに役立ちます。

* total-metadata-footprint
+
このカウンタは、ボリュームに存在するメタデータと、アグリゲートに存在するボリュームのメタデータの合計を表します。アグリゲートに含まれるボリュームのメタデータ占有量の合計がわかります。このカウンタが個別に報告されることで、ユーザによって割り当てられた物理データを把握するのに役立ちます。



また、いくつかの既存のカウンタが、メタデータ コンポーネントを除いてユーザ データのみを表示するように更新されました。

* ユーザ データ
* ボリュームのデータ容量


これらの変更により、ユーザによって消費されるデータを、より正確に確認できるようになります。これには、より正確にチャージバックを決定できることなど、いくつかのメリットがあります。

.関連情報
* link:https://kb.netapp.com/Advice_and_Troubleshooting/Data_Storage_Software/ONTAP_OS/Space_Usage["NetAppナレッジベース：スペースの使用"^]
* link:https://www.netapp.com/blog/free-up-storage-capacity-upgrade-ontap/["Free up 5% of your storage capacity by upgrading to ONTAP 9.12.1"^]

