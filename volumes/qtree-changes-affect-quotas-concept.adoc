---
permalink: volumes/qtree-changes-affect-quotas-concept.html 
sidebar: sidebar 
keywords: how, qtree, quota, delete qtree, rename qtree, tree quotas, security, style of a qtree, security style, style 
summary: qtreeの削除、名前変更、またはセキュリティ形式の変更を行う場合、現在適用されているクォータに応じて、ONTAPによって適用されるクォータが変更されることがあります。 
---
= qtreeの変更がクォータに与える影響
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
qtreeの削除、名前変更、またはセキュリティ形式の変更を行う場合、現在適用されているクォータに応じて、ONTAPによって適用されるクォータが変更されることがあります。



== qtreeの削除とツリー クォータ

qtreeを削除すると、明示的クォータか派生クォータかにかかわらず、そのqtreeに適用可能なすべてのクォータがONTAPによって適用されなくなります。

クォータ ルールが維持されるかどうかは、qtreeを削除した場所によって決まります。

* ONTAPを使用してqtreeを削除した場合、ツリー クォータのルールや、qtreeに設定されているユーザおよびグループ クォータのルールも含め、削除したqtreeのクォータ ルールは自動的に削除されます。
* CIFSまたはNFSクライアントを使用してqtreeを削除した場合、クォータの再初期化時のエラー発生を避けるため、このクォータのルールをすべて削除する必要があります。削除したqtreeと同じ名前の新しいqtreeを作成した場合、既存のクォータ ルールは、クォータを再初期化するまで新しいqtreeに適用されません。




== qtreeの名前変更がクォータに与える影響

ONTAPを使用してqtreeの名前を変更すると、そのqtreeのクォータ ルールが自動的に更新されます。CIFSまたはNFSクライアントを使用してqtreeの名前を変更する場合は、そのqtreeのクォータ ルールをすべて更新する必要があります。


NOTE: CIFSまたはNFSクライアントを使用してqtreeの名前を変更したあと、クォータを再初期化する前に新しい名前でそのqtreeのクォータ ルールを更新しない場合、クォータはqtreeに適用されません。ツリー クォータ、qtreeのユーザ クォータまたはグループ クォータなどの、qtreeの明示的クォータは、派生クォータに変換されることがあります。



== qtreeのセキュリティ形式とユーザ クォータ

アクセス制御リスト（ACL）は、NTFSまたはmixedセキュリティ形式ではqtreeに適用できますが、UNIXセキュリティ形式では適用できません。qtreeのセキュリティ形式を変更すると、クォータの計算方法に影響することがあります。qtreeのセキュリティ形式を変更した場合は、必ずクォータを再初期化する必要があります。

qtreeのセキュリティ形式をNTFS形式または混合形式からUNIX形式に変更した場合、そのqtree内のファイルに適用されたACLはすべて無視され、ファイルの使用量はUNIXユーザIDに基づいて加算されるようになります。

qtreeのセキュリティ形式をUNIX形式から混合形式またはNTFS形式に変更した場合は、それまで非表示だったACLが表示されるようになります。また、無視されていたACLが再び有効になり、NFSユーザ情報が無視されます。既存のACLがない場合、NFS情報がクォータの計算で引き続き使用されます。


NOTE: qtreeのセキュリティ形式を変更したあとは、UNIXユーザとWindowsユーザ両方のクォータの使用が正しく計算されるように、そのqtreeを含むボリュームのクォータを再初期化する必要があります。

.例
qtreeのセキュリティ形式の変更によって、特定のqtree内のファイルの使用量を加算されるユーザがどのように変わるかについての例を次に示します。

NTFS セキュリティが qtree A で有効になっており、ACL によって Windows ユーザ `corp\joe`に 5MB のファイルの所有権が付与されているとします。ユーザ `corp\joe`は qtree A に対して 5MB のディスク容量使用料を請求されます。

ここで qtree A のセキュリティ形式を NTFS から UNIX に変更します。クォータが再初期化されると、Windows ユーザ `corp\joe`はこのファイルに対して課金されなくなり、代わりにファイルの UID に対応する UNIX ユーザが課金されます。この UID は、 `corp\joe`にマッピングされている UNIX ユーザか root ユーザのいずれかです。
