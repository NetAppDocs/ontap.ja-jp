---
permalink: volumes/qtree-changes-affect-quotas-concept.html 
sidebar: sidebar 
keywords: how, qtree, quota, delete qtree, rename qtree, tree quotas, security, style of a qtree, security style, style 
summary: qtree を削除したり、名前やセキュリティ形式を変更したりすると、現在適用されているクォータに応じて、 ONTAP が適用するクォータが変更される場合があります。 
---
= qtree の変更がクォータに与える影響
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
qtree を削除したり、名前やセキュリティ形式を変更したりすると、現在適用されているクォータに応じて、 ONTAP が適用するクォータが変更される場合があります。



== qtreeの削除とツリークォータ

qtree を削除すると、その qtree に適用されるクォータはすべて、明示的クォータか派生クォータかにかかわらず、 ONTAP によって適用されなくなります。

クォータルールが維持されるかどうかは、 qtree を削除した場所によって異なります。

* ONTAP を使用して qtree を削除した場合、ツリークォータルールや、その qtree に設定されているユーザおよびグループクォータルールも含め、その qtree のクォータルールは自動的に削除されます。
* CIFS または NFS クライアントを使用して qtree を削除した場合、クォータの再初期化時のエラー発生を避けるため、このクォータのルールをすべて削除する必要があります。削除した qtree と同じ名前の新しい qtree を作成した場合、既存のクォータルールは、クォータを再初期化するまで新しい qtree に適用されません。




== qtree の名前変更がクォータに与える影響

ONTAP を使用して qtree の名前を変更すると、その qtree のクォータルールは自動的に更新されます。CIFS または NFS クライアントを使用して qtree の名前を変更する場合、その qtree のクォータルールをすべて更新する必要があります。


NOTE: CIFSまたはNFSクライアントを使用してqtreeの名前を変更し、クォータを再初期化する前に新しい名前でそのqtreeのクォータルールを更新しないと、クォータはqtreeに適用されません。qtreeの明示的クォータ（ツリークォータ、qtreeのユーザクォータまたはグループクォータなど）は、派生クォータに変換されることがあります。



== qtreeのセキュリティ形式とユーザクォータ

アクセス制御リスト（ ACL ）は、 NTFS または mixed セキュリティ形式では qtree に適用できますが、 UNIX セキュリティ形式では適用できません。qtreeのセキュリティ形式を変更すると、クォータの計算方法に影響することがあります。qtree のセキュリティ形式を変更した場合は、必ずクォータを再初期化してください。

qtree のセキュリティ形式を NTFS 形式または mixed 形式から UNIX 形式に変更した場合、その qtree 内のファイルに適用された ACL はすべて無視され、ファイルの使用量は UNIX ユーザ ID に基づいて加算されるようになります。

qtree のセキュリティ形式を UNIX 形式から mixed 形式、または NTFS 形式に変更した場合は、それまで非表示だった ACL が表示されるようになります。また、無視されていた ACL が再び有効になり、 NFS ユーザ情報が無視されます。既存の ACL がない場合、 NFS 情報がクォータの計算で引き続き使用されます。


NOTE: qtree のセキュリティ形式を変更したあとに UNIX ユーザと Windows ユーザ両方のクォータの使用が正しく計算されるように、その qtree を含むボリュームのクォータを再初期化する必要があります。

.例
次の例は、 qtree のセキュリティ形式の変更によって、特定の qtree 内のファイルの使用量を加算されるユーザがどのように変わるかを示しています。

qtree AでNTFSセキュリティが有効で、ACLによってWindowsユーザに `corp\joe`5MBのファイルの所有権が付与されているとします。ユーザ `corp\joe`には、qtree Aの5MBのディスクスペース使用量が課金されます。

次に、qtree Aのセキュリティ形式をNTFSからUNIXに変更します。クォータが再初期化されると、 `corp\joe`このファイルはWindowsユーザに課金されなくなり、ファイルのUIDに対応するUNIXユーザに課金されます。UIDには、マッピング先のUNIXユーザ `corp\joe`またはrootユーザを指定できます。
