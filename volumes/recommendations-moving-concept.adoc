---
permalink: volumes/recommendations-moving-concept.html 
sidebar: sidebar 
keywords: considerations, recommendations, when, moving, volumes, flexclone volume, metroCluster configuration 
summary: ボリュームを移動するときは、移動するボリュームやシステム構成（ MetroCluster 構成など）によって影響を受ける考慮事項や推奨事項が多数あります。ここでは、ボリュームの移動に関する考慮事項と推奨事項を示します。 
---
= ボリュームを移動する際の考慮事項と推奨事項
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ボリュームを移動するときは、移動するボリュームやシステム構成（ MetroCluster 構成など）によって影響を受ける考慮事項や推奨事項が多数あります。ここでは、ボリュームの移動に関する考慮事項と推奨事項を示します。



== 一般的な考慮事項と推奨事項

* クラスタのリリースファミリーをアップグレードする場合は、クラスタのすべてのノードをアップグレードするまでボリュームを移動しないでください。
+
この推奨事項に従うことで、ボリュームを新しいリリースファミリーから古いリリースファミリーに誤って移動するのを防ぐことができます。

* ソースボリュームには整合性が必要です。
* 関連 Storage Virtual Machine （ SVM ）に 1 つ以上のアグリゲートを割り当てている場合、デスティネーションアグリゲートは、割り当てられたアグリゲートのいずれかである必要があります。
* テイクオーバーされた CFO アグリゲートとの間でボリュームを移動することはできません。
* LUN を含むボリュームで NVFAIL が有効になっていない場合、ボリュームの移動後に NVFAIL が有効になります。
* ボリュームを Flash Pool アグリゲートから別の Flash Pool アグリゲートに移動することができます。
+
** ボリュームのキャッシングポリシーも一緒に移動されます。
** ボリュームのパフォーマンスに影響する可能性があります。


* ボリュームを Flash Pool アグリゲートと Flash Pool アグリゲート以外のアグリゲートの間で移動することができます。
+
** ボリュームを Flash Pool アグリゲートから Flash Pool アグリゲート以外のアグリゲートに移動する場合、ボリュームのパフォーマンスに影響する可能性があることを示す警告メッセージが ONTAP に表示され、続行するかどうかの確認を求められます。
** ボリュームをFlash Poolアグリゲート以外のアグリゲートからFlash Poolアグリゲートに移動すると、ONTAP によってが割り当てられます `auto` キャッシングポリシー。


* ボリュームには、そのボリュームが配置されているアグリゲートの保管データの保護機能が適用されます。NSE ドライブで構成されるアグリゲートからそれ以外のドライブで構成されるアグリゲートにボリュームを移動した場合、 NSE による保管データの保護機能は適用されなくなります。




== FlexClone ボリュームに関する考慮事項と推奨事項

* FlexClone ボリュームは、移動中にオフラインにすることはできません。
* FlexCloneボリュームは、を開始せずに、同じSVM内の同じノードまたは別のノード上のアグリゲート間で移動できます `vol clone split start` コマンドを実行します
+
FlexCloneボリューム上でボリューム移動処理を開始することにより、クローンボリュームは移動プロセス中に別のアグリゲートにスプリットされます。クローンボリューム上でのボリュームの移動が完了すると、移動したボリュームはクローンとしてではなく、前の親ボリュームとのクローン関係が設定されていない独立したボリュームとして表示されます。

* FlexClone ボリュームの Snapshot コピーはクローンの移動後も失われません。
* FlexClone の親ボリュームをアグリゲート間で移動することができます。
+
FlexClone の親ボリュームを移動すると、元のアグリゲートに一時ボリュームが残り、すべての FlexClone ボリュームの親ボリュームとして機能します。この一時ボリュームに対して実行できるのはオフラインにする処理と削除する処理だけで、それ以外の処理は実行できません。すべての FlexClone ボリュームのスプリットまたは破棄が完了すると、一時ボリュームは自動的にクリーンアップされます。

* FlexClone の子ボリュームは、移動後は FlexClone ボリュームではなくなります。
* FlexClone の移動処理は、 FlexClone のコピー処理やスプリット処理と同時に実行することはできません。
* クローンスプリット処理が実行中の場合、ボリュームの移動が失敗することがあります。
+
クローンスプリット処理が完了するまで、ボリュームを移動しないでください。





== MetroCluster の設定に関する考慮事項

* MetroCluster 構成内でボリュームを移動する際、ソースクラスタのデスティネーションアグリゲートに一時ボリュームが作成されると、ミラーされているが同期されていないアグリゲート内のボリュームに対応する一時ボリュームのレコードも稼働しているクラスタに作成されます。
* カットオーバー前に MetroCluster のスイッチオーバーが発生した場合、デスティネーションボリュームは一時ボリューム（タイプが TMP のボリューム）として記録されます。
+
稼働している（ディザスタリカバリ）クラスタで移動ジョブが再開され、障害を報告し、移動に関連する項目（一時ボリュームなど）をすべてクリーンアップします。クリーンアップを正しく実行できなかった場合は、必要なクリーンアップを実行するようシステム管理者に警告する EMS が生成されます。

* MetroCluster のスイッチオーバーが、カットオーバーフェーズは開始しているが移動ジョブは完了していない（つまり、デスティネーションアグリゲートを参照するようにクラスタを更新できるところまでは完了した）時点で発生した場合、移動ジョブは稼働している（ディザスタリカバリ）上で再開されます。 クラスタと実行されて処理が完了します。
+
移動に関連する項目は、一時ボリューム（元のソース）を含めてすべてクリーンアップされます。クリーンアップを正しく実行できなかった場合は、必要なクリーンアップを実行するようシステム管理者に警告する EMS が生成されます。

* スイッチオーバーされたサイトに属するボリュームに対して実行中のボリューム移動処理がある場合、 MetroCluster のスイッチバックは強制的かどうかに関係なく実行できません。
+
稼働しているサイトのローカルボリュームに対してボリューム移動処理を実行中の場合、スイッチバックはブロックされません。

* 実行中のボリューム移動処理がある場合、 MetroCluster の強制的でないスイッチオーバーはブロックされますが、 MetroCluster の強制的なスイッチオーバーはブロックされません。

