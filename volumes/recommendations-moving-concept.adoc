---
permalink: volumes/recommendations-moving-concept.html 
sidebar: sidebar 
keywords: considerations, recommendations, moving volumes, flexclone volume, metroCluster configuration 
summary: ボリュームを移動する際の考慮事項と推奨事項がいくつかあります。これらは、移動するボリュームおよびMetroClusterなどのシステム構成に基づいています。ボリュームを移動する前に、関連する問題をすべて理解しておく必要があります。 
---
= ボリュームを移動する際の考慮事項と推奨事項
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ボリュームを移動する際の考慮事項と推奨事項がいくつかあります。これらは、移動するボリュームおよびMetroClusterなどのシステム構成に基づいています。ボリュームを移動する前に、関連する問題をすべて理解しておく必要があります。



== 一般的な考慮事項と推奨事項

* クラスタのリリースファミリーをアップグレードする場合は、クラスタ内のすべてのノードをアップグレードするまでボリュームを移動しないでください。
+
この推奨事項により、ボリュームを新しいリリースファミリーから古いリリースファミリーに誤って移動しないようにすることができます。

* ソースボリュームに整合性がある必要があります。
* 関連Storage Virtual Machine（SVM）に1つ以上のアグリゲートを割り当てている場合、デスティネーションアグリゲートは割り当てられたアグリゲートのいずれかである必要があります。
* ボリュームは新しいバージョンのONTAPにのみ移動してください。
* テイクオーバーされたCFOアグリゲートとの間でボリュームを移動することはできません。
* LUNを含むボリュームでNVFAILが有効になっていない場合、移動後にNVFAILが有効になります。
* ボリュームをFlash Poolアグリゲートから別のFlash Poolアグリゲートに移動できます。
+
** ボリュームのキャッシングポリシーも一緒に移動されます。
** ボリュームのパフォーマンスに影響する可能性があります。


* ボリュームは、Flash PoolアグリゲートとFlash Poolアグリゲート以外のアグリゲートの間で移動できます。
+
** ボリュームを Flash Pool アグリゲートから Flash Pool アグリゲート以外のアグリゲートに移動する場合、ボリュームのパフォーマンスに影響する可能性があることを示す警告メッセージが ONTAP に表示され、続行するかどうかの確認を求められます。
** ボリュームをFlash Poolアグリゲート以外のアグリゲートからFlash Poolアグリゲートに移動すると、ONTAPによってキャッシングポリシーが割り当てられ `auto`ます。


* ボリュームには、そのボリュームが配置されているアグリゲートの保管データの保護機能が適用されます。NSEドライブで構成されるアグリゲートからNSEドライブで構成されないアグリゲートにボリュームを移動すると、NSEの保存データは保護されなくなります。
* ONTAP 9.13.1以前からONTAP 9.15.1以降にFabricPool最適化ボリュームを移動する場合は、link:https://kb.netapp.com/on-prem/ontap/Ontap_OS/FS_Issues/CONTAP-307878["NetAppナレッジベース: CONTAP-307878 - ソースONTAPが 9.14.1 未満で、宛先が 9.14.1 より大きい場合、 FabricPoolの最適化されたボリュームの移動中に予期しない再起動が発生する"^] 。




== FlexCloneボリュームに関する考慮事項と推奨事項

* FlexCloneボリュームは、移動中にオフラインにすることはできません。
* コマンドを実行せずに、同じSVM内の同じノードまたは別のノード上のアグリゲート間でFlexCloneボリュームを移動できます。 `vol clone split start`
+
FlexCloneでボリューム移動処理を開始すると、移動プロセス中にクローンボリュームが別のアグリゲートにスプリットされます。クローンボリュームでのボリューム移動が完了すると、移動したボリュームはクローンとしてではなく、以前の親ボリュームとのクローン関係がない独立したボリュームとして表示されます。

* FlexCloneボリュームのSnapshotは、クローンを移動しても失われません。
* FlexCloneの親ボリュームをアグリゲート間で移動できます。
+
FlexCloneの親ボリュームを移動すると、一時ボリュームが取り残され、すべてのFlexCloneボリュームの親ボリュームとして機能します。この一時ボリュームに対して実行できるのはオフラインにする処理と削除する処理だけで、それ以外の処理は実行できません。すべてのFlexCloneボリュームがスプリットまたは破棄されると、一時ボリュームは自動的にクリーンアップされます。

* FlexCloneの子ボリュームは、移動後はFlexCloneボリュームではなくなります。
* FlexCloneの移動処理とFlexCloneのコピー処理またはスプリット処理を同時に実行することはできません。
* クローンスプリット処理が実行中の場合、ボリュームの移動が失敗することがあります。
+
クローンスプリット処理が完了するまでボリュームを移動しないでください。





== MetroClusterに関する考慮事項と推奨事項

* MetroCluster構成でボリュームを移動する際に、ソースクラスタのデスティネーションアグリゲートに一時ボリュームが作成されると、ミラーされているが同期されていないアグリゲート内のボリュームに対応する一時ボリュームのレコードもサバイバークラスタに作成されます。
* カットオーバー前にMetroClusterスイッチオーバーが発生した場合、デスティネーションボリュームは一時ボリューム（タイプがTMPのボリューム）として記録されます。
+
稼働している（ディザスタリカバリ）クラスタで移動ジョブが再開され、障害が報告され、移動に関連する項目（一時ボリュームなど）がすべてクリーンアップされます。クリーンアップを正しく実行できない場合は、必要なクリーンアップを実行するようシステム管理者に警告するEMSが生成されます。

* カットオーバーフェーズが開始されてから移動ジョブが完了する（つまり、移動がデスティネーションアグリゲートを参照するようにクラスタを更新できる段階に達した）前にMetroClusterのスイッチオーバーが発生した場合、移動ジョブは稼働している（ディザスタリカバリ）クラスタで再開され、最後まで実行されます。
+
移動に関連する項目は、一時ボリューム（元のソース）を含めてすべてクリーンアップされます。クリーンアップを正しく実行できない場合は、必要なクリーンアップを実行するようシステム管理者に警告するEMSが生成されます。

* スイッチオーバーされたサイトに属するボリュームに対して実行中のボリューム移動処理がある場合、MetroClusterのスイッチバックは強制的かどうかに関係なく実行できません。
+
サバイバーサイトのローカルボリュームに対してボリューム移動処理を実行中の場合、スイッチバックはブロックされません。

* 実行中のボリューム移動処理がある場合、MetroClusterの強制的でないスイッチオーバーはブロックされますが、MetroClusterの強制的なスイッチオーバーはブロックされません。

