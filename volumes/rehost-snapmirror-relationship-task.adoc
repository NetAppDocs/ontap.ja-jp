---
permalink: volumes/rehost-snapmirror-relationship-task.html 
sidebar: sidebar 
keywords: rehost, volumes, snapmirror, relationship 
summary: SnapMirror関係の一部として定義されているボリュームをリホストできます。関係をリホストする前に考慮する必要があるいくつかの問題があります。 
---
= SnapMirror関係にあるボリュームのリホスト
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
SnapMirror関係の一部として定義されているボリュームをリホストできます。関係をリホストする前に考慮する必要があるいくつかの問題があります。

.タスク概要
* リホストはシステム停止を伴う処理です。
* リホスト処理が失敗した場合は、ソース ボリュームでボリュームのポリシーおよび関連するルールを再設定しなければならない場合があります。
* 次のボリューム ポリシー、ポリシー ルール、および構成はリホスト処理後にソース ボリュームから失われるため、リホスト後のボリュームで手動で再設定する必要があります。
+
** ボリュームとqtreeのエクスポート ポリシー
** ウィルス対策ポリシー
** ボリューム効率化ポリシー
** サービス品質（QoS）ポリシー
** Snapshotポリシー
** クォータ ルール
** ns-switchおよびネーム サービス構成のエクスポート ポリシーとルール
** ユーザIDとグループID




.開始する前に
* ボリュームはオンラインである必要があります。
* ボリューム管理処理（ボリュームの移動、LUNの移動など）を実行中のボリュームはリホストできません。
* リホストするボリュームへのデータ アクセスを停止する必要があります。
* リホストするボリュームのデータ アクセスをサポートするようにターゲットSVMのns-switchとネーム サービスを設定する必要があります。
* ボリュームのユーザIDとグループIDをターゲットSVMで使用可能であるか、またはホストするボリュームで変更する必要があります。


.手順
. SnapMirror関係のタイプを記録します。
+
`snapmirror show`

+
これは、ボリュームのリホストが失敗した場合にSnapMirror関係のタイプに関する情報が失われないようにするための予防的な手順です。

. デスティネーション クラスタから、SnapMirror関係を削除します。
+
`snapmirror delete`

+
SnapMirror関係を切断しないでください。切断すると、デスティネーションボリュームのデータ保護機能が失われ、リホスト処理後に関係を再確立できなくなります。

. ソース クラスタから、SnapMirror関係情報を削除します。
+
`snapmirror release -relationship-info-only true`

+
 `-relationship-info-only`パラメータを `true`に設定すると、Snapshotを削除せずにソース関係情報が削除されます。

. ボリュームがマウントされている場合は、マウント解除します：
+
`volume unmount -vserver <source_svm> -volume <vol_name>`

. advanced権限レベルに切り替えます。
+
`set -privilege advanced`

. デスティネーションSVMでボリュームをリホストします。
+
`volume rehost -vserver <source_svm> -volume <vol_name> -destination-vserver <destination_svm>`

. SVMピア関係が存在しない場合は、ソースSVMとデスティネーションSVM間にSVMピア関係を作成します。
+
`vserver peer create`

. ソース ボリュームとデスティネーション ボリューム間にSnapMirror関係を作成します。
+
`snapmirror create`

+
 `snapmirror create`コマンドは、DPボリュームをホストしているSVMから実行する必要があります。再ホストされたボリュームは、SnapMirror関係のソースまたはデスティネーションとして使用できます。

. SnapMirror関係を再同期します。


.関連情報
* link:https://docs.netapp.com/us-en/ontap-cli/set.html["設定"^]
* link:https://docs.netapp.com/us-en/ontap-cli/search.html?q=snapmirror["SnapMirror"^]
* link:https://docs.netapp.com/us-en/ontap-cli/volume-rehost.html["ボリュームの再ホスト"^]
* link:https://docs.netapp.com/us-en/ontap-cli/volume-unmount.html["volume unmount"^]
* link:https://docs.netapp.com/us-en/ontap-cli/vserver-peer-create.html["vserver peer create"^]

