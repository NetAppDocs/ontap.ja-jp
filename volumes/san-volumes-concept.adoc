---
permalink: volumes/san-volumes-concept.html 
sidebar: sidebar 
keywords: understand, san volumes 
summary: SANボリュームプロビジョニングの基本的なオプションと、各オプションがONTAPブロック共有テクノロジのボリュームスペースとスペースの要件をどのように管理するかを理解する。 
---
= SANボリュームプロビジョニングの概要
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ONTAPには、SANボリュームプロビジョニングの基本的なオプションがいくつかあります。各オプションでは、ONTAPブロック共有テクノロジに必要なボリュームスペースとスペースを、それぞれ異なる方法で管理します。環境に最適なオプションを選択できるように、各プロビジョニングオプションの仕組みを理解しておく必要があります。

[TIP]
====
SAN LUNとNAS共有を同じFlexVol volumeに配置することは推奨されません。SAN LUNとNAS共有用に別 々 のFlexVolをプロビジョニングする必要があります。これにより、管理とレプリケーションの展開が簡素化されます。また、Active IQ Unified Manager（旧OnCommand Unified Manager）でのFlexVolボリュームのサポート方法も並行しています。

====


== ボリュームのシンプロビジョニング

シンプロビジョニングボリュームは、作成時に ONTAP によって追加のスペースが確保されることはありません。ボリュームにデータが書き込まれるときに、書き込み処理に対応するために必要なアグリゲート内のストレージをボリュームが要求します。シンプロビジョニングボリュームを使用する場合はアグリゲートをオーバーコミットできますが、アグリゲートの空きスペースが不足すると、必要なスペースをボリュームが確保できなくなる可能性があります。

シンプロビジョニングFlexVol を作成するには、そのボリュームを設定します `-space-guarantee` オプションをに設定します `none`。



== ボリュームのシックプロビジョニング

シックプロビジョニングボリュームを作成すると、ボリューム内のブロックにいつでも書き込むことができるように、 ONTAP はアグリゲートから十分なストレージを確保します。シックプロビジョニングを使用するようにボリュームを構成する場合は、圧縮や重複排除などの ONTAP の Storage Efficiency 機能を使用して、事前に必要となる大容量のストレージをオフセットすることができます。

シックプロビジョニングFlexVol ボリュームを作成するには、そのボリュームを設定します `-space-slo` （サービスレベル目標）オプションをに設定します `thick`。



== ボリュームのセミシックプロビジョニング

セミシックプロビジョニングを利用するボリュームを作成すると、 ONTAP はボリュームサイズに相当するストレージスペースをアグリゲートから確保します。ブロック共有テクノロジでブロックが使用されているためにボリュームの空きスペースが不足しそうになると、 ONTAP は保護データオブジェクト（ Snapshot コピー、 FlexClone ファイル、 FlexClone LUN ）を削除して、該当するオブジェクトが保持しているスペースを解放します。上書きに必要なスペースを確保できる速度で ONTAP が保護データオブジェクトを削除できるかぎり、書き込み処理は続行されます。これは「ベストエフォート」書き込み保証と呼ばれます。

[NOTE]
====
セミシックプロビジョニングを使用しているボリュームでは、重複排除、圧縮、コンパクションなどのストレージ効率化テクノロジは使用できません。

====
セミシックプロビジョニングFlexVol ボリュームを作成するには、そのボリュームを設定します `-space-slo` （サービスレベル目標）オプションをに設定します `semi-thick`。



== スペースリザーブファイルおよびスペースリザーブ LUN で使用します

スペースリザーブファイルまたはスペースリザーブ LUN は、ストレージの作成時にそのストレージに割り当てられるものです。ネットアップではこれまで、スペース・リザベーションが無効になっている LUN （スペース・リザーブなしの LUN ）を「シン・プロビジョニング LUN 」と呼んできました。

[NOTE]
====
スペースリザーブなしのファイルは、一般に「シンプロビジョニングされたファイル」とは呼ばれません。

====
次の表に、スペースリザーブファイルおよびスペースリザーブ LUN で使用できる 3 つのボリュームプロビジョニングオプションの主な違いを示します。

[cols="5*"]
|===
| ボリュームのプロビジョニング | LUN/file のスペースリザベーション | 上書きします | 保護データ ^2^ | ストレージ効率 ^3^ 


 a| 
厚み（ Thick ）
 a| 
サポートされます
 a| 
保証された ^1
 a| 
保証
 a| 
サポートされます



 a| 
シン
 a| 
効果はありません
 a| 
なし
 a| 
保証
 a| 
サポートされます



 a| 
セミシック
 a| 
サポートされます
 a| 
ベストエフォート ^1 ^
 a| 
ベストエフォート
 a| 
サポート対象外

|===
* メモ *

. 上書きの保証またはベストエフォートの上書き保証が行われるには、 LUN またはファイルでスペースリザベーションが有効になっている必要があります。
. 保護データには、 Snapshot コピーおよび自動削除の対象とマークされた FlexClone ファイルと FlexClone LUN （バックアップクローン）が含まれます。
. Storage Efficiency には、重複排除、圧縮、自動削除の対象とマークされていない FlexClone ファイルと FlexClone LUN （アクティブクローン）、および FlexClone サブファイル（コピーオフロードに使用）が含まれます。




== SCSI シンプロビジョニング LUN のサポート

ONTAP は、 T10 SCSI シンプロビジョニング LUN に加え、ネットアップのシンプロビジョニング LUN もサポートしています。T10 SCSI シンプロビジョニングを使用すると、ホストアプリケーションで、 LUN のスペース再生やブロック環境の LUN スペース監視機能などの SCSI 機能をサポートできます。使用する SCSI ホストソフトウェアも、 T10 SCSI シンプロビジョニングをサポートしている必要があります。

ONTAP を使用します `space-allocation` LUNでのT10シンプロビジョニングのサポートを有効または無効にするための設定。ONTAP を使用します `space-allocation enable` LUNでT10 SCSIシンプロビジョニングを有効にするための設定。

。 `[-space-allocation {enabled|disabled}]` ONTAP でT10シンプロビジョニングのサポートを有効または無効にする方法、およびT10 SCSIシンプロビジョニングを有効にする方法の詳細については、『Command Reference Manual』のコマンドを参照してください。

.関連情報
* https://docs.netapp.com/us-en/ontap-cli["ONTAP コマンドリファレンス"^]

